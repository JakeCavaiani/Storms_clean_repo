library(wesanderson)
library(ggpubr)
library(dataRetrieval)
setwd("~/Documents/Storms_clean_repo")
# Import data #
FRCH_HI_doy_df_2018 <- read_csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.HI.df.doy.csv")
MOOS_HI_doy_df_2018 <- read_csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/MOOS/MOOS.HI.df.doy.csv")
CARI_HI_doy_df_2018 <- read_csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/CARI/CARI.HI.df.doy.csv")
CARI_HI_doy_df_2018 <- CARI_HI_doy_df_2018[,-2]
HI.dat_2018 <- rbind(FRCH_HI_doy_df_2018, MOOS_HI_doy_df_2018, CARI_HI_doy_df_2018)
HI.dat_2018$year <- "2018"
HI.dat <- rbind(HI.dat_2018)
write.csv(HI.dat, "~/Documents/Storms_clean_repo/Output_from_analysis/04_Antecedent_Conditions/HI.dat.csv")
View(HI.dat)
HI.mean<- HI.dat %>% group_by(site.ID, response, year) %>%
summarise_at(vars(HI), list(HI = median)) # takes the median by site response and year
View(HI.mean)
# merged #
# By site and response
FRCH.fDOM <- subset(HI.mean, site.ID == "FRCH" & response == "fDOM")
POKE.fDOM <- subset(HI.mean, site.ID == "POKE" & response == "fDOM")
MOOS.fDOM <- subset(HI.mean, site.ID == "MOOS" & response == "fDOM")
STRT.fDOM <- subset(HI.mean, site.ID == "STRT" & response == "fDOM")
VAUL.fDOM <- subset(HI.mean, site.ID == "VAUL" & response == "fDOM")
FRCH.NO3 <- subset(HI.mean, site.ID == "FRCH" & response == "NO3")
POKE.NO3 <- subset(HI.mean, site.ID == "POKE" & response == "NO3")
MOOS.NO3 <- subset(HI.mean, site.ID == "MOOS" & response == "NO3")
STRT.NO3 <- subset(HI.mean, site.ID == "STRT" & response == "NO3")
VAUL.NO3 <- subset(HI.mean, site.ID == "VAUL" & response == "NO3")
FRCH.fDOM$burn <- "unburned"
POKE.fDOM$burn <- "burned"
MOOS.fDOM$burn <- "burned"
STRT.fDOM$burn <- "burned"
VAUL.fDOM$burn <- "unburned"
FRCH.NO3$burn <- "unburned"
POKE.NO3$burn <- "burned"
MOOS.NO3$burn <- "burned"
STRT.NO3$burn <- "burned"
VAUL.NO3$burn <- "unburned"
fdom.hi <- rbind(FRCH.fDOM, POKE.fDOM, MOOS.fDOM, STRT.fDOM, VAUL.fDOM)
no3.hi <- rbind(FRCH.NO3, POKE.NO3, MOOS.NO3, STRT.NO3, VAUL.NO3)
fdom.hi$year <- as.character(fdom.hi$year)
no3.hi$year <- as.character(no3.hi$year)
fdom.lm <- lm(fdom.hi$HI ~ fdom.hi$burn)
no3.lm <- lm(no3.hi$HI ~ no3.hi$burn)
fdom.hi %>%
ggplot(aes(x=burn,
y=HI,
color=year))+
geom_point() +
geom_smooth(method = "lm") +
ylim(-1,1) +
ggtitle("DOC") +
xlab("Catchment burned (%)") +
ylab("HI-Solute Storage")
View(fdom.hi)
CARI.fDOM <- subset(HI.mean, site.ID == "CARI" & response == "fDOM")
CARI.NO3 <- subset(HI.mean, site.ID == "CARI" & response == "NO3")
CARI.fDOM$burn <- "burned"
CARI.NO3$burn <- "burned"
fdom.hi <- rbind(FRCH.fDOM, POKE.fDOM, MOOS.fDOM, STRT.fDOM, VAUL.fDOM, CARI.fDOM)
no3.hi <- rbind(FRCH.NO3, POKE.NO3, MOOS.NO3, STRT.NO3, VAUL.NO3, CARI.NO3)
fdom.hi$year <- as.character(fdom.hi$year)
no3.hi$year <- as.character(no3.hi$year)
fdom.lm <- lm(fdom.hi$HI ~ fdom.hi$burn)
no3.lm <- lm(no3.hi$HI ~ no3.hi$burn)
fdom.hi %>%
ggplot(aes(x=burn,
y=HI,
color=year))+
geom_boxplot() +
geom_smooth(method = "lm") +
ylim(-1,1) +
ggtitle("DOC") +
xlab("Catchment burned (%)") +
ylab("HI-Solute Storage")
no3.hi %>%
ggplot(aes(x=burn,
y=HI,
color=year))+
geom_boxplot() +
geom_smooth(method = "lm") +
ylim(-1,1) +
ggtitle("NO3") +
xlab("Catchment burned (%)") +
ylab("HI-Solute Storage")
# Permafrost #
FRCH.fDOM$pf <- "Moderate"
POKE.fDOM$pf <- "Moderate"
MOOS.fDOM$pf <- "Moderate"
STRT.fDOM$pf <- "High"
VAUL.fDOM$pf <- "High"
CARI.fDOM$pf <- "Moderate"
FRCH.NO3$pf <- "Moderate"
POKE.NO3$pf <- "Moderate"
MOOS.NO3$pf <- "Moderate"
STRT.NO3$pf <- "High"
VAUL.NO3$pf <- "High"
CARI.NO3$pf <- "Moderate"
pf.fdom.hi <- rbind(FRCH.fDOM, POKE.fDOM, MOOS.fDOM, STRT.fDOM, VAUL.fDOM, CARI.fDOM)
pf.no3.hi <- rbind(FRCH.NO3, POKE.NO3, MOOS.NO3, STRT.NO3, VAUL.NO3, CARI.NO3)
pf.fdom.hi$year <- as.character(pf.fdom.hi$year)
pf.no3.hi$year <- as.character(pf.no3.hi$year)
pf.fdom.lm <- lm(pf.fdom.hi$HI ~ pf.fdom.hi$burn)
pf.no3.lm <- lm(pf.no3.hi$HI ~ pf.no3.hi$burn)
pf.fdom.hi %>%
ggplot(aes(x=pf,
y=HI,
color=year))+
geom_boxplot() +
geom_smooth(method = "lm") +
ylim(-1,1) +
ggtitle("DOC") +
xlab("Permafrost Extent (%)") +
ylab("HI-Solute Storage")
pf.no3.hi %>%
ggplot(aes(x=pf,
y=HI,
color=year))+
geom_boxplot() +
geom_smooth(method = "lm") +
ylim(-1,1) +
ggtitle("NO3") +
xlab("Permafrost Extent (%)") +
ylab("HI-Solute Storage")
### H 1.1: HI against precip ###
HI.mean.precip <- HI.dat %>% group_by(site.ID, year, storm.num) %>%
summarise_at(vars(HI), list(HI = median)) # take mean by site response and year
HI.mean.precip.response <- HI.dat %>% group_by(site.ID, year, storm.num, response) %>%
summarise_at(vars(HI), list(HI = median)) # take mean by site response and year
View(HI.mean)
View(HI.mean.precip.response)
View(HI.mean.precip)
FRCHstorm_file_list <- list.files(path="~/Documents/Storms_clean_repo/Storm_Events/2018/All_Sites/",
recursive=F,
pattern="FRCH",
full.names=TRUE) # reading in individual storms by site
FRCH_storms<-do.call("rbind", lapply(FRCHstorm_file_list,
read.csv,
check.names = FALSE,
stringsAsFactors=FALSE,
header=T, blank.lines.skip = TRUE, fill=TRUE))
View(FRCH_storms)
View(FRCHstorm_file_list)
FRCHstorm_file_list
FRCH_storms$storm.num = c(rep("storm1", 142),
rep("storm10", 704),
rep("storm11a", 91),
rep("storm11b", 264),
rep("storm2a", 230),
rep("storm2b", 190),
rep("storm3", 212),
rep("storm4a", 72),
rep("storm4b", 383),
rep("storm5", 331),
rep("storm6", 303),
rep("storm7", 119),
rep("storm8a", 79),
rep("storm8b", 95),
rep("storm9", 115)) # naming each storm by the number of storm
View(FRCHstorm_file_list)
View(FRCH_storms)
nrow(FRCHstorm_file_list)
str(FRCHstorm_file_list)
FRCHstorm_file_list <- list.files(path="~/Documents/Storms_clean_repo/Storm_Events/2018/All_Sites",
recursive=F,
pattern="FRCH",
full.names=TRUE) # reading in individual storms by site
View(FRCHstorm_file_list)
FRCHstorm_file_list
rm(FRCHstorm_file_list)
FRCHstorm_file_list <- list.files(path="~/Documents/Storms_clean_repo/Storm_Events/2018/All_Sites/",
recursive=F,
pattern="FRCH",
full.names=TRUE) # reading in individual storms by site
FRCH_storms<-do.call("rbind", lapply(FRCHstorm_file_list,
read.csv,
check.names = FALSE,
stringsAsFactors=FALSE,
header=T, blank.lines.skip = TRUE, fill=TRUE))
FRCH_storms$storm.num = c(rep("storm1", 285),
rep("storm10", 1379),
rep("storm11a", 155),
rep("storm11b", 486),
rep("storm2a", 500),
rep("storm2b", 344),
rep("storm3", 393),
rep("storm4a", 177),
rep("storm4b", 734),
rep("storm5", 662),
rep("storm6", 605),
rep("storm7", 213),
rep("storm8a", 159),
rep("storm8b", 191),
rep("storm9", 196)) # naming each storm by the number of storm
POKE_RainGauge_2018 <- read_csv("~/Documents/DoD_2018_Jake/RainGauge/POKE.RainGauge.2018.csv") # Reading in rain gauge data in
attributes(POKE_RainGauge_2018$DateTime)$tzone <- 'America/Anchorage' # converting to AK time
airtempmean <- read_csv("~/Documents/Storms_clean_repo/Climate/airtempmean.csv")
attributes(airtempmean$date_timeAK)$tzone <- 'America/Anchorage'
names(airtempmean)[2] <- "DateTime"
FRCH_storms$DateTime <- as.POSIXct(FRCH_storms$DateTime, tz = "America/Anchorage", format = "%Y-%m-%d %H:%M") #making datetime column
FRCH.2018.storms.1<- left_join(FRCH_storms, POKE_RainGauge_2018, by = "DateTime") # joining
FRCH.2018.storms.1<- left_join(FRCH.2018.storms.1, airtempmean, by = "DateTime") # joining
View(FRCH.2018.storms.1)
names(FRCH.2018.storms.1)[names(FRCH.2018.storms.1) == ''] <- 'x'
FRCH.2018.per.storm.1 <- FRCH.2018.storms.1 %>% group_by(storm.num) %>%
summarise_at(vars(inst_rainfall_mm), list(precip = sum), na.rm = TRUE) # finding the total precip for each delineated storm
View(FRCH.2018.per.storm.1)
temp <- FRCH.2018.storms.1 %>% group_by(storm.num) %>%
summarise_at(vars(airtemp_100.1000cm_mean), list(temp = mean), na.rm = TRUE) # finding the mean temperature for each storm event
FRCH.2018.per.storm.1$temp <- temp$temp
chem.2018 <- read_csv("~/Documents/Storms_clean_repo/Q/Q_chem/DOD.2018.csv")
FRCH.2018 <- filter(chem.2018$site.ID == "FRCH")
FRCH.2018 <-  subset(chem.2018, site.ID == "FRCH")
chem.2018 <- read_csv("~/Documents/Storms_clean_repo/Q/Q_chem/DOD.2018.csv",
col_types = cols(NO3 = col_double())))
FRCH.2018 <-  subset(chem.2018, site.ID == "FRCH")
chem.2018 <- read_csv("~/Documents/Storms_clean_repo/Q/Q_chem/DOD.2018.csv",
col_types = cols(NO3 = col_double))
chem.2018 <- read_csv("~/Documents/Storms_clean_repo/Q/Q_chem/DOD.2018.csv",
col_types = cols(NO3 = col_double)))
chem.2018 <- read_csv("~/Documents/Storms_clean_repo/Q/Q_chem/DOD.2018.csv",
col_types = cols(NO3 = col_double()))
FRCH.2018 <-  subset(chem.2018, site.ID == "FRCH")
View(FRCH.2018)
FRCH.2018$DateTime <- as.POSIXct(FRCH.2018$datetimeAK, tz = "America/Anchorage", format = "%Y-%m-%d %H:%M")
FRCH.2018 <- left_join(FRCH.2018, POKE_RainGauge_2018, by = "DateTime")
FRCH.2018 <- left_join(FRCH.2018, airtempmean, by = "DateTime")
FRCH.2018$week <- rollapplyr(FRCH.2018$inst_rainfall_mm, 672, sum, na.rm = TRUE, fill = NA, partial = TRUE)
FRCH.2018$month <- rollapplyr(FRCH.2018$inst_rainfall_mm, 2688, sum, na.rm = TRUE, fill = NA, partial = TRUE)
FRCH.2018$ThreeMonth <- rollapplyr(FRCH.2018$inst_rainfall_mm, 8064, sum, na.rm = TRUE, fill = NA, partial = TRUE)
FRCH.2018$temp.week <- rollapplyr(FRCH.2018$airtemp_100.1000cm_mean, 672, mean, na.rm = TRUE, fill = NA, partial = TRUE)
FRCH.2018.1 <- left_join(FRCH.2018.storms.1, FRCH.2018, by = "DateTime") # week month and 3 month precip totals
View(FRCH.2018.1)
FRCH.2018.per.storm.2 <- FRCH.2018.1 %>% group_by(storm.num) %>%
summarise_at(vars(week), list(precip.week = first), na.rm = TRUE) # grouping weekly precip leading up to storm event
FRCH.2018.per.storm.3 <- FRCH.2018.1 %>% group_by(storm.num) %>%
summarise_at(vars(month), list(precip.month = first), na.rm = TRUE) # groouping monthly precip leading up to a storm
FRCH.2018.per.storm.4 <- FRCH.2018.1 %>% group_by(storm.num) %>%
summarise_at(vars(ThreeMonth), list(ThreeMonth = first), na.rm = TRUE) # grouping 3 month precip leading up to a storm
FRCH.2018.per.storm.5 <- FRCH.2018.1 %>% group_by(storm.num) %>%
summarise_at(vars(temp.week), list(temp.week = first), na.rm = TRUE) # grouping one week mean temperature leading up to a storm
HI.mean.precip.frch.NO3 <- subset(HI.mean.precip.response, year == "2018" & site.ID == "FRCH" & response == "NO3")
HI.mean.precip.frch.fDOM <- subset(HI.mean.precip.response, year == "2018" & site.ID == "FRCH" & response == "fDOM")
HI.mean.precip.frch.SPC <- subset(HI.mean.precip.response, year == "2018" & site.ID == "FRCH" & response == "SPC")
HI.mean.precip.frch.turb <- subset(HI.mean.precip.response, year == "2018" & site.ID == "FRCH" & response == "turb")
HI.frch.no3.2018 <- left_join(HI.mean.precip.frch.NO3, FRCH.2018.per.storm.1, by = "storm.num")
HI.frch.no3.2018 <- left_join(HI.frch.no3.2018, FRCH.2018.per.storm.1, by = "storm.num")
HI.frch.no3.2018 <- left_join(HI.frch.no3.2018, FRCH.2018.per.storm.2, by = "storm.num")
HI.frch.no3.2018 <- left_join(HI.frch.no3.2018, FRCH.2018.per.storm.3, by = "storm.num")
HI.frch.no3.2018 <- left_join(HI.frch.no3.2018, FRCH.2018.per.storm.4, by = "storm.num")
HI.frch.no3.2018 <- left_join(HI.frch.no3.2018, FRCH.2018.per.storm.5, by = "storm.num")
names(HI.frch.no3.2018)
HI.frch.no3.2018 <- HI.frch.no3.2018[,-c(6:7)]
names(HI.frch.no3.2018) <- c("site.ID", "year", "storm.num","response", "HI", "precip", "temp", "precip.week",
"precip.month", "ThreeMonth", "temp.week")
frch.lm.no3 <- lm(HI.frch.no3.2018$HI ~ HI.frch.no3.2018$precip) # model one with just total precip
frch.formula <- y ~ x
ba <- HI.frch.no3.2018 %>%
ggplot(aes(x=precip,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH NO3") +
xlab("Precip") +
ylab("HI-Solute Storage") # plot model
ba
bb <- HI.frch.no3.2018 %>%
ggplot(aes(x=precip.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH NO3") +
xlab("One-week Precip") +
ylab("HI-Solute Storage") # plot model
bc <- HI.frch.no3.2018 %>%
ggplot(aes(x=precip.month,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH NO3") +
xlab("One-month Precip") +
ylab("HI-Solute Storage") # plot model
bd <- HI.frch.no3.2018 %>%
ggplot(aes(x=ThreeMonth,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH NO3") +
xlab("Three-month Precip") +
ylab("HI-Solute Storage") # plot model
bd2 <- HI.frch.no3.2018 %>%
ggplot(aes(x=temp.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH NO3") +
xlab("temp.week") +
ylab("HI-Solute Storage") # plot model
bd2
HI.frch.fDOM.2018 <- left_join(HI.mean.precip.frch.fDOM, FRCH.2018.per.storm.1, by = "storm.num")
HI.frch.fDOM.2018 <- left_join(HI.frch.fDOM.2018, FRCH.2018.per.storm.2, by = "storm.num")
HI.frch.fDOM.2018 <- left_join(HI.frch.fDOM.2018, FRCH.2018.per.storm.3, by = "storm.num")
HI.frch.fDOM.2018 <- left_join(HI.frch.fDOM.2018, FRCH.2018.per.storm.4, by = "storm.num")
HI.frch.fDOM.2018 <- left_join(HI.frch.fDOM.2018, FRCH.2018.per.storm.5, by = "storm.num")
frch.lm.fDOM <- lm(HI.frch.fDOM.2018$HI ~ HI.frch.fDOM.2018$precip) # model one with just total precip
frch.lm.fDOM.2 <- lm(HI.frch.fDOM.2018$HI ~ HI.frch.fDOM.2018$precip.week) # model one with just total precip
frch.lm.fDOM.3 <- lm(HI.frch.fDOM.2018$HI ~ HI.frch.fDOM.2018$precip.month) # model one with just total precip
frch.lm.fDOM.4 <- lm(HI.frch.fDOM.2018$HI ~ HI.frch.fDOM.2018$ThreeMonth) # model one with just total precip
frch.lm.fDOM.5 <- lm(HI.frch.fDOM.2018$HI ~ HI.frch.fDOM.2018$temp.week) # model one with just total precip
frch.formula <- y ~ x
be <- HI.frch.fDOM.2018 %>%
ggplot(aes(x=precip,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH fDOM") +
xlab("Precip") +
ylab("HI-Solute Storage") # plot model
bf <- HI.frch.fDOM.2018 %>%
ggplot(aes(x=precip.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH fDOM") +
xlab("One-week Precip") +
ylab("HI-Solute Storage") # plot model
bg <- HI.frch.fDOM.2018 %>%
ggplot(aes(x=precip.month,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH fDOM") +
xlab("One-month Precip") +
ylab("HI-Solute Storage") # plot model
bh <- HI.frch.fDOM.2018 %>%
ggplot(aes(x=ThreeMonth,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH fDOM") +
xlab("Three-month Precip") +
ylab("HI-Solute Storage") # plot model
bh2 <- HI.frch.fDOM.2018 %>%
ggplot(aes(x=temp.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH fDOM") +
xlab("temp.week") +
ylab("HI-Solute Storage") # plot model
bh2
HI.frch.SPC.2018 <- left_join(HI.mean.precip.frch.SPC, FRCH.2018.per.storm.1, by = "storm.num")
HI.frch.SPC.2018 <- left_join(HI.frch.SPC.2018, FRCH.2018.per.storm.2, by = "storm.num")
HI.frch.SPC.2018 <- left_join(HI.frch.SPC.2018, FRCH.2018.per.storm.3, by = "storm.num")
HI.frch.SPC.2018 <- left_join(HI.frch.SPC.2018, FRCH.2018.per.storm.4, by = "storm.num")
HI.frch.SPC.2018 <- left_join(HI.frch.SPC.2018, FRCH.2018.per.storm.5, by = "storm.num")
frch.lm.SPC <- lm(HI.frch.SPC.2018$HI ~ HI.frch.SPC.2018$precip) # model one with just total precip
frch.lm.SPC.2 <- lm(HI.frch.SPC.2018$HI ~ HI.frch.SPC.2018$precip.week) # model one with just total precip
frch.lm.SPC.3 <- lm(HI.frch.SPC.2018$HI ~ HI.frch.SPC.2018$precip.month) # model one with just total precip
frch.lm.SPC.4 <- lm(HI.frch.SPC.2018$HI ~ HI.frch.SPC.2018$ThreeMonth) # model one with just total precip
bi <- HI.frch.SPC.2018 %>%
ggplot(aes(x=precip,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH SPC") +
xlab("Precip") +
ylab("HI-Solute Storage") # plot model
bj <- HI.frch.SPC.2018 %>%
ggplot(aes(x=precip.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH SPC") +
xlab("One-week Precip") +
ylab("HI-Solute Storage") # plot model
bk <- HI.frch.SPC.2018 %>%
ggplot(aes(x=precip.month,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH SPC") +
xlab("One-month Precip") +
ylab("HI-Solute Storage") # plot model
bl <- HI.frch.SPC.2018 %>%
ggplot(aes(x=ThreeMonth,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH SPC") +
xlab("Three-month Precip") +
ylab("HI-Solute Storage") # plot model
bl2 <- HI.frch.SPC.2018 %>%
ggplot(aes(x=temp.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH SPC") +
xlab("temp.week") +
ylab("HI-Solute Storage") # plot model
bl2
HI.frch.turb.2018 <- left_join(HI.mean.precip.frch.turb, FRCH.2018.per.storm.1, by = "storm.num")
HI.frch.turb.2018 <- left_join(HI.frch.turb.2018, FRCH.2018.per.storm.2, by = "storm.num")
HI.frch.turb.2018 <- left_join(HI.frch.turb.2018, FRCH.2018.per.storm.3, by = "storm.num")
HI.frch.turb.2018 <- left_join(HI.frch.turb.2018, FRCH.2018.per.storm.4, by = "storm.num")
HI.frch.turb.2018 <- left_join(HI.frch.turb.2018, FRCH.2018.per.storm.5, by = "storm.num")
frch.lm.turb <- lm(HI.frch.turb.2018$HI ~ HI.frch.turb.2018$precip) # model one with just total precip
frch.lm.turb.2 <- lm(HI.frch.turb.2018$HI ~ HI.frch.turb.2018$precip.week) # model one with just total precip
frch.lm.turb.3 <- lm(HI.frch.turb.2018$HI ~ HI.frch.turb.2018$precip.month) # model one with just total precip
frch.lm.turb.4 <- lm(HI.frch.turb.2018$HI ~ HI.frch.turb.2018$ThreeMonth) # model one with just total precip
bm <- HI.frch.turb.2018 %>%
ggplot(aes(x=precip,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH turb") +
xlab("Precip") +
ylab("HI-Solute Storage") # plot model
bn <- HI.frch.turb.2018 %>%
ggplot(aes(x=precip.week,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH turb") +
xlab("One-week Precip") +
ylab("HI-Solute Storage") # plot model
bo <- HI.frch.turb.2018 %>%
ggplot(aes(x=precip.month,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH turb") +
xlab("One-month Precip") +
ylab("HI-Solute Storage") # plot model
bp <- HI.frch.turb.2018 %>%
ggplot(aes(x=ThreeMonth,
y=HI)) +
geom_point() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = frch.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
ggtitle("FRCH turb") +
xlab("Three-month Precip") +
ylab("HI-Solute Storage") # plot model
sum.time <- FRCH.2018.storms.1 %>%
mutate(grp=data.table::rleid(storm.num))%>%
group_by(grp) %>%
summarise(storm.num=max(storm.num),TOTAL.TIME=difftime(max(DateTime),
min(DateTime),units="hour"))%>%
group_by(storm.num) %>%
summarise(TOTAL.TIME=sum(TOTAL.TIME)) # creating a total time column
View(sum.time)
HI.frch.no3.2.2018 <- left_join(HI.frch.no3.2018, sum.time, by = "storm.num") # merging total time per storm event and the HI per storm
HI.frch.no3.2.2018$TOTAL.TIME <- as.numeric(HI.frch.no3.2.2018$TOTAL.TIME)
HI.frch.no3.2.2018$Intensity <- HI.frch.no3.2.2018$precip/HI.frch.no3.2.2018$TOTAL.TIME # Intensity is total precip for individual storm divided by total time so we get mm/hr
frch.lm.no3.2 <- lm(HI.frch.no3.2.2018$HI ~ HI.frch.no3.2.2018$precip + HI.frch.no3.2.2018$Intensity) # model one with total precip and intensity
