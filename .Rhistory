label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic()
ggplot(NO3_data_year,aes(x = pctburn_lg, y = meanHI, color = site.ID))+
geom_point() +
geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic()
ggplot(NO3_data_year,aes(x = CatPF, y = meanHI, fill = CatPF))+
geom_boxplot() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic()
View(NO3_data_year)
?geom_smooth
ggplot(NO3_data_year,aes(x = CatPF, y = meanHI, fill = CatPF))+
geom_boxplot() +
geom_smooth(method = "lmer") +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic()
ggplot(NO3_data_year,aes(x = CatPF, y = meanHI, fill = CatPF))+
geom_boxplot() +
geom_smooth(method = "lm") +
stat_poly_eq(formula = y~x,
label.y = "top", label.x = "right",
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
theme_classic()
tab_model(HI.no3.year)
library(sjPlot)
tab_model(HI.no3.year)
plot(pr, add.data = TRUE)
tab_model(HI.no3.year)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
ggplot(mean_daily, aes(x = datetimeAK, y = dailyNO3, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year) +
theme_classic()
View(mean_daily)
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = meaen_daily)
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily)
summary(no3.mod)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily)
summary(no3.mod.gls)
mean_daily_site <- mean_daily %>%
group_by(site.ID) %>%
dplyr::summarise(meanNO3 <- mean(dailyNO3, na.rm = TRUE))
View(mean_daily)
View(mean_daily_site)
mean_daily_site <- mean_daily %>%
group_by(site.ID) %>%
dplyr::summarise(meanNO3 = mean(dailyNO3, na.rm = TRUE))
mean_daily_site <- mean_daily %>%
group_by(site.ID) %>%
dplyr::summarise(meanNO3 = mean(dailyNO3, na.rm = TRUE),
meanfDOM = mean(dailyfDOM, na.rm = TRUE),
mean = mean(dailySPC, na.rm = TRUE),
meanTurb = mean(dailyTurb, na.rm = TRUE))
mean_daily_long <- mean_daily %>%
pivot_longer(
cols = starts_with("daily"),
names_to = "response_var",
names_prefix = "wk",
values_to = "concentration",
values_drop_na = TRUE
) # converting to a long format so each response_var is within a single column
View(mean_daily_long)
NO3_data <- subset(mean_daily_long, response_var == "dailyNO3" )
View(NO3_data)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
mean_daily_site <- mean_daily %>%
group_by(site.ID) %>%
dplyr::summarise(meanNO3 = mean(dailyNO3, na.rm = TRUE),
meanfDOM = mean(dailyfDOM, na.rm = TRUE),
mean = mean(dailySPC, na.rm = TRUE),
meanTurb = mean(dailyTurb, na.rm = TRUE))
mean_daily_long <- mean_daily %>%
pivot_longer(
cols = starts_with("daily"),
names_to = "response_var",
names_prefix = "wk",
values_to = "concentration",
values_drop_na = TRUE
) # converting to a long format so each response_var is within a single column
NO3_data <- subset(mean_daily_long, response_var == "dailyNO3" )
no3.mod.1 <- lm(concentration ~ site.ID*year,
data = NO3_data)
summary(no3.mod.1)
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year))
summary(no3.mod.ar1) # Phi1 = 0.9844227
plot(no3.mod.ar1, resid(., type = "p") ~ fitted(.), abline = 0)
plot(no3.mod.ar1, dailyNO3 ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(no3.mod.ar1, abline = c(0,1))
Ear1<-residuals(no3.mod.ar1, type="normalized")
I1<-!is.na(mean_daily$logdailyNO3)
Efulla<-vector(length = length(mean_daily$logdailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year))
summary(no3.mod.ar1) # Phi1 = 0.9844227
Ear1<-residuals(no3.mod.ar1, type="normalized")
I1<-!is.na(mean_daily$dailyNO3)
Efulla<-vector(length = length(mean_daily$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
acf(Efulla, na.action=na.pass)
ggplot(mean_daily, aes(x = julian, y = dailyNO3, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year) +
theme_classic()
ggplot(mean_daily, aes(x = julian, y = dailyfDOM, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year) +
theme_classic()
ggplot(mean_daily, aes(x = julian, y = dailyfDOM, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year, scales = "free") +
theme_classic()
View(mean_daily_site)
fDOM.mod <- gls(dailyfDOM ~ site.ID*year,
na.action = na.omit,
data = mean_daily)
summary(fDOM.mod)
structure(mean_daily)
str(mean_daily)
mean_daily_character <- mean_daily
mean_daily_character$year <- as.character(mean_daily_character$year)
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily_character)
summary(no3.mod)
mean_daily$year <- as.character(mean_daily$year)
ggplot(mean_daily, aes(x = julian, y = dailyNO3, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year, scales = "freey") +
theme_classic()
ggplot(mean_daily, aes(x = julian, y = dailyNO3, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year, scales = "free") +
theme_classic()
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year))
str(mean_daily)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily)
str(mean_daily)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
View(mean_daily)
str(mean_daily)
mean_daily_character <- mean_daily
mean_daily_character$year <- as.character(mean_daily_character$year)
ggplot(mean_daily, aes(x = julian, y = dailyNO3, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year, scales = "free") +
theme_classic()
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily)
summary(no3.mod)
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily_character)
summary(no3.mod)
mean_daily$year <- as.character(mean_daily$year)
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily)
summary(no3.mod)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily)
summary(no3.mod.gls)
rm(mean_daily)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily)
summary(no3.mod)
no3.mod <- lm(dailyNO3 ~ site.ID*year,
data = mean_daily_character)
summary(no3.mod)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily)
summary(no3.mod.gls)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character)
summary(no3.mod.gls)
rm(no3.mod.gls)
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character)
summary(no3.mod.gls)
mean_daily_character_dropped <- transform(na.omit(mean_daily_character), site.IDyear=droplevels(interaction(site.ID,year)))
no3.mod.gls <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character_dropped)
summary(no3.mod.gls)
View(mean_daily_character_dropped)
View(mean_daily_character)
View(mean_daily_character_dropped)
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character,
correlation = corAR1(form = ~ julian|site.ID/year))
mean_daily
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year))
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year),
control = list(singular.ok = TRUE))
no3.mod.ar1 <- gls(dailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character,
correlation = corAR1(form = ~ julian|site.ID/year),
control = list(singular.ok = TRUE))
summary(no3.mod.ar1) # Phi1 = 0.9844227
plot(no3.mod.ar1, resid(., type = "p") ~ fitted(.), abline = 0)
plot(no3.mod.ar1, dailyNO3 ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(no3.mod.ar1, abline = c(0,1))
mean_daily$logdailyNO3 <- log((mean_daily$dailyNO3))
no3.mod.ar1.log <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character,
correlation = corAR1(form = ~ julian|site.ID/year))
mean_daily$logdailyNO3 <- log((mean_daily$dailyNO3))
no3.mod.ar1.log <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character,
correlation = corAR1(form = ~ julian|site.ID/year))
mean_daily$year <- as.character(mean_daily$year)
mean_daily_character_dropped <- transform(na.omit(mean_daily_character), site.IDyear=droplevels(interaction(site.ID,year)))
mean_daily$logdailyNO3 <- log((mean_daily$dailyNO3))
no3.mod.ar1.log <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily_character,
correlation = corAR1(form = ~ julian|site.ID/year))
no3.mod.ar1.log <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year))
no3.mod.ar1.log <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corAR1(form = ~ julian|site.ID/year),
control = list(singular.ok = TRUE))
summary(no3.mod.ar1.log) # Phi1 = 0.9844227
plot((no3.mod.ar1.log))
plot(no3.mod.ar1.log, resid(., type = "p") ~ fitted(.) | site.ID, abline = 0)
plot(no3.mod.ar1.log, logdailyNO3 ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(no3.mod.ar1.log, abline = c(0,1))
Ear1<-residuals(no3.mod.ar1, type="normalized")
I1<-!is.na(mean_daily$dailyNO3)
Efulla<-vector(length = length(mean_daily$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
Ear1<-residuals(no3.mod.ar1, type="normalized")
I1<-!is.na(mean_daily$dailyNO3)
Efulla<-vector(length = length(mean_daily$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
no3.mod.arma.1 <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corARMA(form = ~ julian|site.ID/year, p = 1, q = 1))
no3.mod.arma.1 <- gls(logdailyNO3 ~ site.ID*year,
na.action = na.omit,
data = mean_daily,
correlation = corARMA(form = ~ julian|site.ID/year, p = 1, q = 1),
control = list(singular.ok = TRUE))
plot((no3.mod.arma.1))
plot(no3.mod.arma.1, resid(., type = "p") ~ fitted(.) | site.ID, abline = 0)
plot(no3.mod.arma.1, logdailyNO3 ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(no3.mod.arma.1, abline = c(0,1))
Ear1<-residuals(no3.mod.arma.1, type="normalized")
I1<-!is.na(mean_daily$logdailyNO3)
Efulla<-vector(length = length(mean_daily$logdailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
site.ID.comp <- glht(no3.mod.arma.1, linfct = mcp(site.ID = "Tukey"))
ggplot(mean_daily, aes(x = julian, y = dailySPC, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year, scales = "free") +
theme_classic()
ggplot(mean_daily, aes(x = julian, y = dailyTurb, color = site.ID)) +
geom_line() +
facet_grid(site.ID ~ year, scales = "free") +
theme_classic()
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
mean_daily_long <- mean_daily %>%
pivot_longer(
cols = starts_with("daily"),
names_to = "response_var",
names_prefix = "wk",
values_to = "concentration",
values_drop_na = TRUE
) # converting to a long format so each response_var is within a single column
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(MEANconc = mean(concentration, na.rm = TRUE),
SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc,
datetimeAK = as.Date(datetimeAK))
CV_mean_conc <- CV_mean_conc[!duplicated(CV_mean_conc$MEANconc), ] # removing duplicated rows
##subsetting by solute
# NO3 #
CV_NO3 = subset(CV_mean_conc, response_var == "dailyNO3")
# fDOM #
CV_fDOM = subset(CV_mean_conc, response_var == "dailyfDOM")
# SPC #
CV_SPC = subset(CV_mean_conc, response_var == "dailySPC")
# turb #
CV_turb = subset(CV_mean_conc, response_var == "dailyTurb")
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
mean_daily <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/08_Catchment_characteristics/mean_daily.csv")
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
mean_daily_long <- mean_daily %>%
pivot_longer(
cols = starts_with("daily"),
names_to = "response_var",
names_prefix = "wk",
values_to = "concentration",
values_drop_na = TRUE
) # converting to a long format so each response_var is within a single column
View(mean_daily_long)
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(MEANconc = mean(concentration, na.rm = TRUE),
SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc,
datetimeAK = as.Date(datetimeAK))
View(CV_mean_conc)
CV_mean_conc <- CV_mean_conc[!duplicated(CV_mean_conc$MEANconc), ] # removing duplicated rows
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(MEANconc = mean(concentration, na.rm = TRUE),
SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc)
CV_mean_conc <- CV_mean_conc[!duplicated(CV_mean_conc$MEANconc), ] # removing duplicated rows
##subsetting by solute
# NO3 #
CV_NO3 = subset(CV_mean_conc, response_var == "dailyNO3")
# fDOM #
CV_fDOM = subset(CV_mean_conc, response_var == "dailyfDOM")
# SPC #
CV_SPC = subset(CV_mean_conc, response_var == "dailySPC")
# turb #
CV_turb = subset(CV_mean_conc, response_var == "dailyTurb")
View(mean_daily_long)
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year, datetimeAK) %>%
dplyr::summarise(SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc)
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc)
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(SDconc = sd(concentration, na.rm = TRUE))
rm(CV_mean_conc)
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(MEANconc = mean(concentration, na.rm = TRUE),
SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc)
CV_NO3 = subset(CV_mean_conc, response_var == "dailyNO3")
# fDOM #
CV_fDOM = subset(CV_mean_conc, response_var == "dailyfDOM")
# SPC #
CV_SPC = subset(CV_mean_conc, response_var == "dailySPC")
# turb #
CV_turb = subset(CV_mean_conc, response_var == "dailyTurb")
ggplot(CV_mean_conc, aes(site.ID, CVconc, fill = site.ID)) +
geom_boxplot() +
facet_grid(response_var ~ year, scales = "free") +
theme_classic()
ggplot(CV_mean_conc, aes(site.ID, CVconc, fill = site.ID)) +
geom_bpoint() +
facet_grid(response_var ~ year, scales = "free") +
theme_classic()
ggplot(CV_mean_conc, aes(site.ID, CVconc, fill = site.ID)) +
geom_point() +
facet_grid(response_var ~ year, scales = "free") +
theme_classic()
ggplot(CV_mean_conc, aes(site.ID, CVconc, color = site.ID)) +
geom_point() +
facet_grid(response_var ~ year, scales = "free") +
theme_classic()
ggplot(CV_mean_conc, aes(site.ID, CVconc, color = site.ID)) +
geom_point() +
facet_grid(response_var ~ year, scales = "free") +
theme_bw()
#NO3
NO3 <- aov(CVconc ~ site.ID*year,
data = CV_NO3)
summary(NO3) # nothing is significant
summary.lm(NO3)
plot(NO3)
View(CV_NO3)
CV_NO3$logCVconc <- log(abs(CV_NO3$CVconc))
NO3.log <- aov(logCVconc ~ site.ID*year,
data = CV_NO3)
summary(NO3.log) # nothing is significant
summary.lm(NO3.log)
plot(NO3.log)
summary(NO3.log) # nothing is significant
