Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
no3.mod.arma.2.2 <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
Ear1<-residuals(no3.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2018$dailyNO3)
Efulla<-vector(length = length(mean_daily_2018$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
Ear1<-residuals(no3.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2018$dailyNO3)
Efulla<-vector(length = length(mean_daily_2018$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
models <- list(no3.mod.ar1.2018,no3.mod.arma.1.1, no3.mod.arma.1.2, no3.mod.arma.2.1, no3.mod.arma.2.2)
aictab(cand.set = models) # no3.mod.arma.1.1 is the best model
mean_daily_2018$site.ID <-as.factor(mean_daily_2018$site.ID)
site.ID.comp <- glht(no3.mod.arma.1.1, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp) # no site is significantly different
summary(no3.mod.arma.1.1)
intervals(no3.mod.arma.1.1)
plot(print(confint(site.ID.comp)))
anova(no3.mod.arma.1.1)
ggplot(mean_daily_2018, aes(x = julian, y = dailyfDOM, color = site.ID)) +
geom_line() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D")) +
facet_wrap(~site.ID, scales = "free") +
theme_classic()
fDOM.2018 <- ggplot(mean_daily_2018, aes(x = site.ID, y = dailyfDOM, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#A6761D"), "Site") +
xlab("") +
ylab("Daily fDOM (QSU)") +
theme_classic()
fDOM.mod.2018 <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018)
plot(fDOM.mod.2018, resid(., type = "p") ~ fitted(.), abline = 0)
plot(fDOM.mod.2018, dailyfDOM ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(fDOM.mod.2018, ~ resid(., type = "p"), abline = c(0, 1))
mean_daily_2018$logDailyfDOM <- log(mean_daily_2018$dailyfDOM)
# removing clear outliers here
which(mean_daily_2018$logDailyfDOM > 5.4)
mean_daily_2018 <- mean_daily_2018 %>%
mutate(across(c(logDailyfDOM),
~ifelse(logDailyfDOM > 5.4, NA, .)))
fDOM.mod.ar1.log <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018)
plot(fDOM.mod.ar1.log, resid(., type = "p") ~ fitted(.), abline = 0)
plot(fDOM.mod.ar1.log, logDailyfDOM ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(fDOM.mod.ar1.log, ~ resid(., type = "p"), abline = c(0, 1))
varfixed <- varIdent(form = ~ 1 | site.ID)
fDOM.mod.ar1.log <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
weights = varfixed)
plot(fDOM.mod.ar1.log, resid(., type = "p") ~ fitted(.), abline = 0)
plot(fDOM.mod.ar1.log, logDailyfDOM ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(fDOM.mod.ar1.log, ~ resid(., type = "p"), abline = c(0, 1))
fDOM.mod.ar1.log <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corAR1(form = ~ julian|site.ID))
Ear1<-residuals(fDOM.mod.ar1.log, type="normalized")
I1<-!is.na(mean_daily_2018$logDailyfDOM)
Efulla<-vector(length = length(mean_daily_2018$logDailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.1.1 <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 1))
Ear1<-residuals(fDOM.mod.arma.1.1, type="normalized")
I1<-!is.na(mean_daily_2018$logDailyfDOM)
Efulla<-vector(length = length(mean_daily_2018$logDailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.2.1 <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 1))
Ear1<-residuals(fDOM.mod.arma.2.1, type="normalized")
I1<-!is.na(mean_daily_2018$logDailyfDOM)
Efulla<-vector(length = length(mean_daily_2018$logDailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.1.2 <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 2))
Ear1<-residuals(fDOM.mod.arma.1.2, type="normalized")
I1<-!is.na(mean_daily_2018$logDailyfDOM)
Efulla<-vector(length = length(mean_daily_2018$logDailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.2.2 <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
Ear1<-residuals(fDOM.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2018$logDailyfDOM)
Efulla<-vector(length = length(mean_daily_2018$logDailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
models <- list(fDOM.mod.arma.1.1, fDOM.mod.arma.1.2, fDOM.mod.arma.2.1, fDOM.mod.arma.2.2)
aictab(cand.set = models) # fDOM.mod.arma.1.2 is the best model
site.ID.comp <- glht(fDOM.mod.arma.1.2, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(fDOM.mod.arma.1.2)
plot(print(confint(site.ID.comp)))
tab_model(fDOM.mod.arma.1.2)
anova(fDOM.mod.arma.1.2)
site.ID.comp <- glht(fDOM.mod.arma.1.2, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(fDOM.mod.arma.1.2)
mean_daily_2018$site.ID <-as.factor(mean_daily_2018$site.ID)
site.ID.comp <- glht(no3.mod.arma.1.1, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp) # no site is significantly different
summary(no3.mod.arma.1.1)
intervals(no3.mod.arma.1.1)
plot(print(confint(site.ID.comp)))
anova(no3.mod.arma.1.1)
site.ID.comp <- glht(fDOM.mod.arma.1.2, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(fDOM.mod.arma.1.2)
plot(print(confint(site.ID.comp)))
tab_model(fDOM.mod.arma.1.2)
anova(fDOM.mod.arma.1.2)
SPC.mod <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2018)
plot(SPC.mod, resid(., type = "p") ~ fitted(.), abline = 0)
plot(SPC.mod, dailySPC ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(SPC.mod, ~ resid(., type = "p"), abline = c(0, 1))
SPC.mod.ar1 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corAR1(form = ~ julian|site.ID))
Ear1<-residuals(SPC.mod.ar1, type="normalized")
I1<-!is.na(mean_daily_2018$dailySPC)
Efulla<-vector(length = length(mean_daily_2018$dailySPC))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
SPC.mod.arma.1.1 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 1))
SPC.mod.arma.2.1 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 1))
SPC.mod.arma.1.2 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 2))
SPC.mod.arma.2.2 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2018,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
models <- list(SPC.mod.ar1, SPC.mod.arma.1.1, SPC.mod.arma.1.2, SPC.mod.arma.2.1, SPC.mod.arma.2.2)
aictab(cand.set = models) # SPC.mod.arma.1.1 is the best model
models <- list(SPC.mod.ar1, SPC.mod.arma.1.1, SPC.mod.arma.1.2, SPC.mod.arma.2.1, SPC.mod.arma.2.2)
aictab(cand.set = models) # SPC.mod.arma.1.1 is the best model
site.ID.comp <- glht(SPC.mod.arma.1.1, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(SPC.mod.arma.1.1)
intervals(SPC.mod.arma.1.1)
plot(print(confint(site.ID.comp)))
anova(SPC.mod.arma.1.1)
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(lme4)
# library(MuMIn)
library(multcomp)
library(ggpattern)
library(emmeans)
library(multcompView)
AMC <- read.csv(here("Output_from_analysis", "07_Combine_HI_BETA_FI", "antecedent_HI_FI_AllYears.csv"))
AMC <- AMC[c("Hyst_index","site.ID", "storm.ID", "response_var", "Flush_index", "month.y", "day.y", "year", "Beta_index", "doy", "burn", "pf", "date")] # selecting the columns that I want
colNames <- c("Hyst_index", "site.ID", "storm.ID", "response_var", "Flush_index", "month", "day", "year", "Beta_index", "doy", "burn", "pf", "date")
names(AMC)<- colNames # renaming columns
AMC <- AMC %>%
group_by(site.ID, response_var, year) %>%
dplyr::summarise(meanHI = mean(Hyst_index, na.rm = TRUE),
meanBETA = mean(Beta_index, na.rm = TRUE),
sdHI = sd(Hyst_index, na.rm = TRUE),
sdBETA = sd(Beta_index, na.rm = TRUE),
CVhi = sdHI/meanHI,
CVbeta = sdBETA/meanBETA,
response_var = paste(response_var),
Date = as.Date(date),
DOY = as.numeric(doy),
burn = paste(burn),
PF = paste(pf))
AMC <- AMC[!duplicated(AMC$meanHI), ] # removing duplicated rows
AMC$year <- as.character(AMC$year)
AMC <- AMC %>%
mutate(across(c(burn),
~ifelse(site.ID == "CARI" | site.ID == "FRCH" | site.ID == "VAUL", "unburned", "burned")))
AMC <- AMC %>%
mutate(across(c(PF),
~ifelse(site.ID == "VAUL" | site.ID == "STRT", "High", "Moderate")))
##subsetting by solute
# NO3 #
HI_FI_NO3 = subset(AMC, response_var == "NO3")
# fDOM #
HI_FI_fDOM = subset(AMC, response_var == "fDOM")
# SPC #
HI_FI_SPC = subset(AMC, response_var == "SPC")
# turb #
HI_FI_turb = subset(AMC, response_var == "turb")
AMC_new <- AMC # reordering the sites to group by burn categorization
AMC_new$site.ID <- factor(AMC_new$site.ID,     # Reorder factor levels
c("CARI", "FRCH", "VAUL", "MOOS", "POKE", "STRT"))
vn = expression(paste(N*O[3]^"-"))
supp.labs <- c("fDOM","NO3-", "SPC", "Turbidity")
names(supp.labs) <- c("fDOM", "NO3", "SPC", "turb")
AMC_new <- AMC_new[-c(21,42,62,79,96), ] # removing absorbance for now
AMC_new$facets = factor(AMC_new$response_var, labels = c(
"fDOM",
"NO3~^{-})",
"SPC",
"Turbidity"))
AMC_new$facets = factor(AMC_new$response_var, labels = c(
"fDOM",
"NO3~^{-})",
"SPC",
"Turbidity",
"ABS"))
my_labeller <- as_labeller(c(fDOM="fDOM", NO3="NO[3]", SPC="SPC", turb = "Turbidity"),
default = label_parsed)
ggplot(AMC_new, aes(x = site.ID, y = meanHI, pattern = PF, fill = site.ID)) +
geom_hline(yintercept= 0, linetype="dashed", color = "red")+
geom_boxplot() +
geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c(High = "stripe", Moderate = "none"), "Permafrost") +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5")) +
xlab("") +
ylab("Mean HI") +
theme_classic() +
facet_wrap(~response_var, labeller = my_labeller) +
theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.position = "none",
strip.text = element_text(size = 20))
View(AMC_new)
my_labeller <- as_labeller(c(abs = "ABS_254", fDOM="fDOM", NO3="NO[3]", SPC="SPC", turb = "Turbidity"),
default = label_parsed)
ggplot(AMC_new, aes(x = site.ID, y = meanHI, pattern = PF, fill = site.ID)) +
geom_hline(yintercept= 0, linetype="dashed", color = "red")+
geom_boxplot() +
geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c(High = "stripe", Moderate = "none"), "Permafrost") +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5")) +
xlab("") +
ylab("Mean HI") +
theme_classic() +
facet_wrap(~response_var, labeller = my_labeller) +
theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.position = "none",
strip.text = element_text(size = 20))
NO3.CV.HI.mod <- lmer(meanHI ~ site.ID + (1|year), data = HI_FI_NO3)
plot(NO3.CV.HI.mod)
qqnorm(resid(NO3.CV.HI.mod))
summary(NO3.CV.HI.mod)
emmeans(NO3.CV.HI.mod, list(pairwise ~ site.ID), adjust = "tukey")
summary(NO3.CV.HI.mod)
summary(NO3.CV.HI.mod)
emmeans(NO3.CV.HI.mod, list(pairwise ~ site.ID), adjust = "tukey")
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_fDOM)
summary(anova)
#tukeys test
tukey <- TukeyHSD(anova)
print(tukey)
#cld
cld <- multcompLetters4(anova, tukey)
print(cld)
summary(anova)
#tukeys test
tukey <- TukeyHSD(anova)
#SPC
ggplot(HI_FI_SPC, aes(site.ID, meanHI, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
ggsave("HI_SPC.pdf",
path = here("plots", "Storm_metrics_sites"),
width = 10, height = 10)
SPC.CV.HI.mod <- lmer(meanHI ~ site.ID + (1|year), data = HI_FI_SPC)
plot(SPC.CV.HI.mod)
qqnorm(resid(SPC.CV.HI.mod))
summary(SPC.CV.HI.mod)
emmeans(SPC.CV.HI.mod, list(pairwise ~ site.ID), adjust = "tukey")
# add post hoc pairwise comparisons
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_turb)
summary(anova)
#tukeys test
tukey <- TukeyHSD(anova)
print(tukey)
#cld
cld <- multcompLetters4(anova, tukey)
print(cld)
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_turb)
summary(anova)
#cld
cld <- multcompLetters4(anova, tukey)
print(cld)
#SPC
ggplot(HI_FI_SPC, aes(site.ID, meanHI, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
NO3.CV.HI.mod <- lmer(meanHI ~ site.ID + (1|year), data = HI_FI_NO3)
plot(NO3.CV.HI.mod)
qqnorm(resid(NO3.CV.HI.mod))
summary(NO3.CV.HI.mod)
emmeans(NO3.CV.HI.mod, list(pairwise ~ site.ID), adjust = "tukey")
summary(NO3.CV.HI.mod)
#turb
ggplot(HI_FI_turb, aes(site.ID, meanHI, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
turb.CV.HI.mod <- lmer(meanHI ~ site.ID + (1|year), data = HI_FI_turb)
plot(turb.CV.HI.mod)
qqnorm(resid(turb.CV.HI.mod))
summary(turb.CV.HI.mod)
emmeans(turb.CV.HI.mod, list(pairwise ~ site.ID), adjust = "tukey")
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_turb)
summary(anova)
#tukeys test
tukey <- TukeyHSD(anova)
print(tukey)
#cld
cld <- multcompLetters4(anova, tukey)
print(cld)
summary(anova)
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_turb)
summary(anova)
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_turb)
# getting the letter designation for significance
anova <- aov(meanHI ~ site.ID, data = HI_FI_SPC)
summary(anova)
#tukeys test
tukey <- TukeyHSD(anova)
print(tukey)
#cld
cld <- multcompLetters4(anova, tukey)
print(cld)
anova <- aov(meanHI ~ site.ID, data = HI_FI_turb)
summary(anova)
#tukeys test
tukey <- TukeyHSD(anova)
print(tukey)
#cld
cld <- multcompLetters4(anova, tukey)
print(cld)
ggplot(AMC_new, aes(x = site.ID, y = meanBETA, pattern = PF, fill = site.ID)) +
geom_hline(yintercept= 0, linetype="dashed", color = "red")+
geom_boxplot() +
geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c(High = "stripe", Moderate = "none")) +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5")) +
xlab("") +
ylab("Mean ß") +
theme_classic() +
facet_wrap(~response_var, labeller = my_labeller) +
theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.position = "none",
strip.text = element_text(size = 20))
ggplot(AMC_new, aes(x = site.ID, y = meanBETA, pattern = PF, fill = site.ID)) +
geom_hline(yintercept= 0, linetype="dashed", color = "red")+
geom_boxplot() +
geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c(High = "stripe", Moderate = "none")) +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5")) +
xlab("") +
ylab("Mean ß") +
ylim(-5,5) +
theme_classic() +
facet_wrap(~response_var, labeller = my_labeller) +
theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.position = "none",
strip.text = element_text(size = 20))
ggplot(AMC_new, aes(x = site.ID, y = meanBETA, pattern = PF, fill = site.ID)) +
geom_hline(yintercept= 0, linetype="dashed", color = "red")+
geom_boxplot() +
geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c(High = "stripe", Moderate = "none")) +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5")) +
xlab("") +
ylab("Mean ß") +
ylim(-2,2) +
theme_classic() +
facet_wrap(~response_var, labeller = my_labeller) +
theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.position = "none",
strip.text = element_text(size = 20))
ggplot(AMC_new, aes(x = site.ID, y = meanBETA, pattern = PF, fill = site.ID)) +
geom_hline(yintercept= 0, linetype="dashed", color = "red")+
geom_boxplot() +
geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
scale_pattern_manual(values = c(High = "stripe", Moderate = "none")) +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5")) +
xlab("") +
ylab("Mean ß") +
ylim(-1.5,2) +
theme_classic() +
facet_wrap(~response_var, labeller = my_labeller) +
theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust = 1),
axis.text.y = element_text(size = 20),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20),
legend.position = "none",
strip.text = element_text(size = 20))
NO3.CV.BETA.mod <- lmer(meanBETA ~ site.ID + (1|year), data = HI_FI_NO3)
plot(NO3.CV.BETA.mod)
qqnorm(resid(NO3.CV.BETA.mod))
summary(NO3.CV.BETA.mod)
emmeans(NO3.CV.BETA.mod, list(pairwise ~ site.ID), adjust = "tukey")
summary(NO3) # nothing is significant
summary(NO3.CV.BETA.mod) # nothing is significant
summary.lm(NO3.CV.BETA.mod)
fDOM.CV.BETA.mod <- lmer(meanBETA ~ site.ID + (1|year), data = HI_FI_fDOM)
plot(fDOM.CV.BETA.mod)
qqnorm(resid(fDOM.CV.BETA.mod))
summary(fDOM.CV.BETA.mod)
emmeans(fDOM.CV.BETA.mod, list(pairwise ~ site.ID), adjust = "tukey")
# add post hoc pairwise comparisons
# getting the letter designation for significance
anova <- aov(meanBETA ~ site.ID, data = HI_FI_fDOM)
summary(anova)
SPC.CV.BETA.mod <- lmer(meanBETA ~ site.ID + (1|year), data = HI_FI_SPC)
plot(SPC.CV.BETA.mod)
qqnorm(resid(SPC.CV.BETA.mod))
summary(SPC.CV.BETA.mod)
emmeans(SPC.CV.BETA.mod, list(pairwise ~ site.ID), adjust = "tukey")
# getting the letter designation for significance
anova <- aov(meanBETA ~ site.ID, data = HI_FI_SPC)
summary(anova)
#turb
ggplot(HI_FI_turb, aes(site.ID, meanBETA, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
ggsave("BETA_turb.pdf",
path = here("plots", "Storm_metrics_sites"),
width = 10, height = 10)
turb.CV.BETA.mod <- lmer(meanBETA ~ site.ID + (1|year), data = HI_FI_turb)
plot(turb.CV.BETA.mod)
qqnorm(resid(turb.CV.BETA.mod))
summary(turb.CV.BETA.mod)
emmeans(turb.CV.BETA.mod, list(pairwise ~ site.ID), adjust = "tukey")
# getting the letter designation for significance
anova <- aov(meanBETA ~ site.ID, data = HI_FI_turb)
summary(anova)
