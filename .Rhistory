geom_line() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_wrap(~site.ID, scales = "free") +
theme_classic()
ggplot(mean_daily_2021, aes(x = site.ID, y = dailyNO3, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
no3.mod.gls <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2021)
plot(no3.mod.gls, resid(., type = "p") ~ fitted(.), abline = 0)
plot(no3.mod.gls, dailyNO3 ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(no3.mod.gls, ~resid(., type = "p"), abline = c(0,1))
# CorAR1 structure #
```{r}
no3.mod.gls <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corAR1(form = ~ julian|site.ID))
```
Ear1<-residuals(no3.mod.gls, type="normalized")
I1<-!is.na(mean_daily_2021$dailyNO3)
Efulla<-vector(length = length(mean_daily_2021$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
NO3.mod.arma.1.1 <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 1))
Ear1<-residuals(NO3.mod.arma.1.1, type="normalized")
I1<-!is.na(mean_daily_2021$dailyNO3)
Efulla<-vector(length = length(mean_daily_2021$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
NO3.mod.arma.1.2 <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 2))
Ear1<-residuals(NO3.mod.arma.1.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailyNO3)
Efulla<-vector(length = length(mean_daily_2021$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
NO3.mod.arma.2.1 <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 1))
Ear1<-residuals(NO3.mod.arma.1.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailyNO3)
Efulla<-vector(length = length(mean_daily_2021$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
NO3.mod.arma.2.2 <- gls(dailyNO3 ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
Ear1<-residuals(NO3.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailyNO3)
Efulla<-vector(length = length(mean_daily_2021$dailyNO3))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
models <- list(no3.mod.arma.1.1, no3.mod.arma.1.2, no3.mod.arma.2.1, no3.mod.arma.2.2)
aictab(cand.set = models) # no3.mod.arma.1.1 is the best model
models <- list(NO3.mod.arma.1.1, NO3.mod.arma.1.2, NO3.mod.arma.2.1, NO3.mod.arma.2.2)
aictab(cand.set = models) # no3.mod.arma.1.1 is the best model
site.ID.comp <- glht(NO3.mod.arma.1.1, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
mean_daily_2021 <- mean_daily_2021 %>%
mutate(across(c(dailyfDOM),
~ifelse(dailyfDOM < 0, NA, .)))
ggplot(mean_daily_2021, aes(x = julian, y = dailyfDOM, color = site.ID)) +
geom_line() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_wrap(~site.ID, scales = "free") +
theme_classic()
ggplot(mean_daily_2021, aes(x = site.ID, y = dailyfDOM, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
mean_daily_2021 <- mean_daily_2021 %>%
mutate(across(c(dailyfDOM),
~ifelse(site.ID == "FRCH" & dailyfDOM < 20, NA, .)))
ggplot(mean_daily_2021, aes(x = julian, y = dailyfDOM, color = site.ID)) +
geom_line() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_wrap(~site.ID, scales = "free") +
theme_classic()
ggplot(mean_daily_2021, aes(x = site.ID, y = dailyfDOM, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
fDOM.mod.gls <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021)
plot(fDOM.mod.gls, resid(., type = "p") ~ fitted(.), abline = 0)
plot(fDOM.mod.gls, dailyfDOM ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(fDOM.mod.gls, ~resid(., type = "p"), abline = c(0,1))
fDOM.mod.gls <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
weights = varfixed,
data = mean_daily_2021)
plot(fDOM.mod.gls, resid(., type = "p") ~ fitted(.), abline = 0)
plot(fDOM.mod.gls, dailyfDOM ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(fDOM.mod.gls, ~resid(., type = "p"), abline = c(0,1))
mean_daily_2021$logDailyfDOM <- log(mean_daily_2021$dailyfDOM)
fDOM.mod.gls.log <- gls(logDailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed)
plot(fDOM.mod.gls.log, resid(., type = "p") ~ fitted(.), abline = 0)
plot(fDOM.mod.gls.log, dailyfDOM ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(fDOM.mod.gls.log, ~resid(., type = "p"), abline = c(0,1))
fDOM.mod.ar1 <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corAR1(form = ~ julian|site.ID))
Ear1<-residuals(fDOM.mod.ar1.log, type="normalized")
I1<-!is.na(mean_daily_2021$dailyfDOM)
Efulla<-vector(length = length(mean_daily_2021$dailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.1.1 <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 1))
Ear1<-residuals(fDOM.mod.arma.1.1, type="normalized")
I1<-!is.na(mean_daily_2021$dailyfDOM)
Efulla<-vector(length = length(mean_daily_2021$dailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
acf(Efulla, na.action=na.pass)
fDOM.mod.arma.2.1 <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 1))
Ear1<-residuals(fDOM.mod.arma.2.1, type="normalized")
I1<-!is.na(mean_daily_2021$dailyfDOM)
Efulla<-vector(length = length(mean_daily_2021$dailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.1.2 <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 2))
Ear1<-residuals(fDOM.mod.arma.1.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailyfDOM)
Efulla<-vector(length = length(mean_daily_2021$dailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
fDOM.mod.arma.2.2 <- gls(dailyfDOM ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
Ear1<-residuals(fDOM.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailyfDOM)
Efulla<-vector(length = length(mean_daily_2021$dailyfDOM))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
models <- list(fDOM.mod.arma.1.1, fDOM.mod.arma.1.2, fDOM.mod.arma.2.1, fDOM.mod.arma.2.2)
aictab(cand.set = models) # no3.mod.arma.1.1 is the best model
site.ID.comp <- glht(fDOM.mod.arma.2.2, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(fDOM.mod.arma.2.2)
summary(site.ID.comp)
summary(fDOM.mod.arma.2.2)
summary(site.ID.comp)
ggplot(mean_daily_2021, aes(x = julian, y = dailySPC, color = site.ID)) +
geom_line() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_wrap(~site.ID, scales = "free") +
theme_classic()
ggplot(mean_daily_2021, aes(x = site.ID, y = dailySPC, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
SPC.mod.gls <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2021)
plot(SPC.mod.gls, resid(., type = "p") ~ fitted(.), abline = 0)
plot(SPC.mod.gls, dailySPC ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(SPC.mod.gls, ~ resid(., type = "p"), abline = c(0,1))
SPC.mod.gls <- gls(dailySPC ~ site.ID,
na.action = na.omit,
weights = varfixed,
data = mean_daily_2021)
plot(SPC.mod.gls, resid(., type = "p") ~ fitted(.), abline = 0)
plot(SPC.mod.gls, dailySPC ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(SPC.mod.gls, ~ resid(., type = "p"), abline = c(0,1))
SPC.mod.ar1 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corAR1(form = ~ julian|site.ID))
Ear1<-residuals(SPC.mod.ar1, type="normalized")
I1<-!is.na(mean_daily_2021$dailySPC)
Efulla<-vector(length = length(mean_daily_2021$dailySPC))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
SPC.mod.arma.1.1 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 1))
Ear1<-residuals(SPC.mod.arma.1.1, type="normalized")
I1<-!is.na(mean_daily_2021$dailySPC)
Efulla<-vector(length = length(mean_daily_2021$dailySPC))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
SPC.mod.arma.2.1 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 1))
Ear1<-residuals(SPC.mod.arma.2.1, type="normalized")
I1<-!is.na(mean_daily_2021$dailySPC)
Efulla<-vector(length = length(mean_daily_2021$dailySPC))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
SPC.mod.arma.1.2 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 2))
Ear1<-residuals(SPC.mod.arma.1.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailySPC)
Efulla<-vector(length = length(mean_daily_2021$dailySPC))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
SPC.mod.arma.2.2 <- gls(dailySPC ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
weights = varfixed,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
Ear1<-residuals(SPC.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2021$dailySPC)
Efulla<-vector(length = length(mean_daily_2021$dailySPC))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
models <- list(SPC.mod.arma.1.1, SPC.mod.arma.1.2, SPC.mod.arma.2.1, SPC.mod.arma.2.2)
aictab(cand.set = models) # no3.mod.arma.1.1 is the best model
site.ID.comp <- glht(SPC.mod.arma.1.1, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(SPC.mod.arma.1.1)
summary(site.ID.comp)
ggplot(mean_daily_2021, aes(x = julian, y = dailyTurb, color = site.ID)) +
geom_line() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_wrap(~site.ID, scales = "free") +
theme_classic()
ggplot(mean_daily_2021, aes(x = site.ID, y = dailyTurb, fill = site.ID)) +
geom_boxplot() +
scale_fill_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
theme_classic()
turb.mod.gls <- gls(dailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021)
plot(turb.mod.gls, resid(., type = "p") ~ fitted(.), abline = 0)
plot(turb.mod.gls, dailyTurb ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(turb.mod.gls, ~resid(., type = "p"), abline = c(0,1))
mean_daily_2021$logDailyTurb <- log(mean_daily_2021$dailyTurb)
turb.mod.gls.log <- gls(logDailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021)
plot(turb.mod.gls.log, resid(., type = "p") ~ fitted(.), abline = 0)
plot(turb.mod.gls.log, logDailyTurb ~ fitted(.) | site.ID, abline = c(0,1))
qqnorm(turb.mod.gls.log, ~resid(., type = "p"), abline = c(0,1))
turb.mod.ar1.log <- gls(logDailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corAR1(form = ~ julian|site.ID))
Ear1<-residuals(turb.mod.ar1.log, type="normalized")
I1<-!is.na(mean_daily_2021$logDailyTurb)
Efulla<-vector(length = length(mean_daily_2021$logDailyTurb))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
turb.mod.arma.1.1 <- gls(logDailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 1))
Ear1<-residuals(turb.mod.arma.1.1, type="normalized")
I1<-!is.na(mean_daily_2021$logDailyTurb)
Efulla<-vector(length = length(mean_daily_2021$logDailyTurb))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
turb.mod.arma.1.2 <- gls(logDailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 1, q = 2))
Ear1<-residuals(turb.mod.arma.1.2, type="normalized")
I1<-!is.na(mean_daily_2021$logDailyTurb)
Efulla<-vector(length = length(mean_daily_2021$logDailyTurb))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
turb.mod.arma.2.1 <- gls(logDailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 1))
Ear1<-residuals(turb.mod.arma.2.1, type="normalized")
I1<-!is.na(mean_daily_2021$logDailyTurb)
Efulla<-vector(length = length(mean_daily_2021$logDailyTurb))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
turb.mod.arma.2.2 <- gls(logDailyTurb ~ site.ID,
na.action = na.omit,
data = mean_daily_2021,
correlation = corARMA(form = ~ julian|site.ID, p = 2, q = 2))
Ear1<-residuals(turb.mod.arma.2.2, type="normalized")
I1<-!is.na(mean_daily_2021$logDailyTurb)
Efulla<-vector(length = length(mean_daily_2021$logDailyTurb))
Efulla<-NA
Efulla[I1]<-Ear1
acf(Efulla, na.action=na.pass)
pacf(Efulla, na.action=na.pass)
models <- list(turb.mod.arma.1.1, turb.mod.arma.1.2, turb.mod.arma.2.1, turb.mod.arma.2.2)
aictab(cand.set = models) # no3.mod.arma.1.1 is the best model
site.ID.comp <- glht(turb.mod.arma.2.1, linfct = mcp(site.ID = "Tukey"))
summary(site.ID.comp)
summary(turb.mod.arma.2.1)
mean_daily_long <- mean_daily %>%
pivot_longer(
cols = starts_with("daily"),
names_to = "response_var",
values_to = "concentration") # converting to a long format so each response_var is within a single column
View(mean_daily_long)
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(MEANconc = mean(concentration, na.rm = TRUE),
SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc)
View(CV_mean_conc)
CV_mean_conc_all_years <- CV_mean_conc %>%
group_by(response_var,site.ID) %>%
dplyr::summarise(meanCV = mean(CVconc, na.rm = TRUE))
View(CV_mean_conc_all_years)
##subsetting by solute
# NO3 #
CV_NO3 = subset(CV_mean_conc, response_var == "dailyNO3")
# fDOM #
CV_fDOM = subset(CV_mean_conc, response_var == "dailyfDOM")
# SPC #
CV_SPC = subset(CV_mean_conc, response_var == "dailySPC")
# turb #
CV_turb = subset(CV_mean_conc, response_var == "dailyTurb")
ggplot(CV_mean_conc, aes(site.ID, CVconc, color = site.ID)) +
geom_point() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_grid(response_var ~ year, scales = "free") +
theme_bw()
ggsave("CV_all_sites.pdf",
path = here("plots", "Chem_variation"),
width = 10, height = 10)
#NO3
NO3 <- aov(CVconc ~ site.ID*year,
data = CV_NO3)
plot(NO3)
View(CV_NO3)
summary(NO3)
TukeyHSD(NO3, which = "site.ID")
plot(NO3)
#NO3
CV_NO3_1 <- subset(CV_NO3, year != "2018")
View(CV_NO3_1)
NO3 <- aov(CVconc ~ site.ID*year,
data = CV_NO3_1)
plot(NO3)
NO3 <- aov(CVconc ~ site.ID*year,
data = CV_NO3)
summary(NO3)
TukeyHSD(NO3, which = "site.ID")
library(stats)
?aov
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
library(sjPlot)
library(AICcmodavg)
library(stats)
NO3 <- aov(CVconc ~ site.ID*year,
data = CV_NO3)
plot(NO3)
NO3 <- aov(CVconc ~ site.ID,
data = CV_NO3)
plot(NO3)
str
CV_NO3
str(CV_NO3)
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
library(sjPlot)
library(AICcmodavg)
library(stats)
install.packages(c("ggExtra", "GGally", "plotly")
install.packages(c("ggExtra", "GGally", "plotly"))
mean_daily <- read.csv(here("Output_from_analysis", "08_Catchment_characteristics", "mean_daily.csv"))
mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]
mean_daily$year <- as.character(mean_daily$year)
# mean concentration across years for each site
mean_daily_site <- mean_daily %>%
group_by(site.ID) %>%
dplyr::summarise(meanNO3 = mean(dailyNO3, na.rm = TRUE),
meanfDOM = mean(dailyfDOM, na.rm = TRUE),
meanSPC = mean(dailySPC, na.rm = TRUE),
meanTurb = mean(dailyTurb, na.rm = TRUE))
mean_daily_long <- mean_daily %>%
pivot_longer(
cols = starts_with("daily"),
names_to = "response_var",
names_prefix = "wk",
values_to = "concentration") # converting to a long format so each response_var is within a single column
CV_mean_conc <- mean_daily_long %>% group_by(response_var,site.ID, year) %>%
dplyr::summarise(MEANconc = mean(concentration, na.rm = TRUE),
SDconc = sd(concentration, na.rm = TRUE),
CVconc = SDconc/MEANconc)
CV_mean_conc_all_years <- CV_mean_conc %>%
group_by(response_var,site.ID) %>%
dplyr::summarise(meanCV = mean(CVconc, na.rm = TRUE))
##subsetting by solute
# NO3 #
CV_NO3 = subset(CV_mean_conc, response_var == "dailyNO3")
# fDOM #
CV_fDOM = subset(CV_mean_conc, response_var == "dailyfDOM")
# SPC #
CV_SPC = subset(CV_mean_conc, response_var == "dailySPC")
# turb #
CV_turb = subset(CV_mean_conc, response_var == "dailyTurb")
```{r}
ggplot(CV_mean_conc, aes(site.ID, CVconc, color = site.ID)) +
geom_point() +
scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) +
facet_grid(response_var ~ year, scales = "free") +
theme_bw()
NO3.CV.mod <- lmer(CVconc ~ site.ID, (1|year), data = CV_NO3)
NO3.CV.mod <- lmer(CVconc ~ site.ID, (1|year), data = CV_NO3)
library(lmer)
library(lme4)
NO3.CV.mod <- lmer(CVconc ~ site.ID, (1|year), data = CV_NO3)
NO3.CV.mod <- lmer(CVconc ~ site.ID + (1|year), data = CV_NO3)
plot(NO3.CV.mod)
qqnorm(NO3.CV.mod)
qqnorm(resid(NO3.CV.mod))
summary(NO3.CV.mod)
