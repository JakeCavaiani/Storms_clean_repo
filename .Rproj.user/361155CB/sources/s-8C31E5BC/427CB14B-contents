---
title: "HI_FI"
author: "Jake Cavaiani"
date: "8/29/2022"
output: pdf_document
---

```{r setup, include=FALSE}
setwd("~/Documents/Storms_clean_repo")
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
Sys.which("python")
use_python("/usr/bin/python")
library(tidyverse)
options(tz="America/Anchorage")
library(ggplot2)
library(gridExtra)
library(boot)
```


# Python setup
```{python}
import pickle
import pandas as pd
import datetime
from hysteresis_metrics import hysteresisMetrics
pd.set_option('display.max_columns', 500)
pd.set_option('display.width', 1000)
datetime.date.today()
quit()
```
### Load data to pandas 2018
```{python}
# FRCH #
FRCH_storm1_06_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm1_06_21_Q.csv")
FRCH_storm1_06_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm1_06_21_NO3.csv")
FRCH_storm1_06_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm1_06_21_fDOM.csv")
FRCH_storm1_06_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm1_06_21_SPC.csv")
FRCH_storm1_06_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm1_06_21_turb.csv")

FRCH_storm2a_06_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2a_06_29_Q.csv")
FRCH_storm2a_06_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2a_06_29_NO3.csv")
FRCH_storm2a_06_29_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2a_06_29_fDOM.csv")
FRCH_storm2a_06_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2a_06_29_SPC.csv")
FRCH_storm2a_06_29_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2a_06_29_turb.csv")

FRCH_storm2b_07_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2b_07_04_Q.csv")
FRCH_storm2b_07_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2b_07_04_NO3.csv")
FRCH_storm2b_07_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2b_07_04_fDOM.csv")
FRCH_storm2b_07_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2b_07_04_SPC.csv")
FRCH_storm2b_07_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm2b_07_04_turb.csv")

FRCH_storm3_07_10_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm3_07_10_Q.csv")
FRCH_storm3_07_10_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm3_07_10_NO3.csv")
FRCH_storm3_07_10_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm3_07_10_fDOM.csv")
FRCH_storm3_07_10_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm3_07_10_SPC.csv")
FRCH_storm3_07_10_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm3_07_10_turb.csv")

FRCH_storm4a_07_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4a_07_15_Q.csv")
FRCH_storm4a_07_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4a_07_15_NO3.csv")
FRCH_storm4a_07_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4a_07_15_fDOM.csv")
FRCH_storm4a_07_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4a_07_15_SPC.csv")
FRCH_storm4a_07_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4a_07_15_turb.csv")

FRCH_storm4b_07_16_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4b_07_16_Q.csv")
FRCH_storm4b_07_16_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4b_07_16_NO3.csv")
FRCH_storm4b_07_16_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4b_07_16_fDOM.csv")
FRCH_storm4b_07_16_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4b_07_16_SPC.csv")
FRCH_storm4b_07_16_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm4b_07_16_turb.csv")

FRCH_storm5_08_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm5_08_04_Q.csv")
FRCH_storm5_08_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm5_08_04_NO3.csv")
FRCH_storm5_08_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm5_08_04_fDOM.csv")
FRCH_storm5_08_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm5_08_04_SPC.csv")
FRCH_storm5_08_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm5_08_04_turb.csv")

FRCH_storm6_08_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm6_08_13_Q.csv")
FRCH_storm6_08_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm6_08_13_NO3.csv")
FRCH_storm6_08_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm6_08_13_fDOM.csv")
FRCH_storm6_08_13_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm6_08_13_SPC.csv")
FRCH_storm6_08_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm6_08_13_turb.csv")

FRCH_storm7_08_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm7_08_23_Q.csv")
FRCH_storm7_08_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm7_08_23_NO3.csv")
FRCH_storm7_08_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm7_08_23_fDOM.csv")
FRCH_storm7_08_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm7_08_23_SPC.csv")
FRCH_storm7_08_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm7_08_23_turb.csv")

FRCH_storm8a_08_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8a_08_26_Q.csv")
FRCH_storm8a_08_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8a_08_26_NO3.csv")
FRCH_storm8a_08_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8a_08_26_fDOM.csv")
FRCH_storm8a_08_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8a_08_26_SPC.csv")
FRCH_storm8a_08_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8a_08_26_turb.csv")

FRCH_storm8b_08_28_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8b_08_28_Q.csv")
FRCH_storm8b_08_28_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8b_08_28_NO3.csv")
FRCH_storm8b_08_28_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8b_08_28_fDOM.csv")
FRCH_storm8b_08_28_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8b_08_28_SPC.csv")
FRCH_storm8b_08_28_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm8b_08_28_turb.csv")

FRCH_storm9_08_30_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm9_08_30_Q.csv")
FRCH_storm9_08_30_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm9_08_30_NO3.csv")
FRCH_storm9_08_30_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm9_08_30_fDOM.csv")
FRCH_storm9_08_30_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm9_08_30_SPC.csv")
FRCH_storm9_08_30_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm9_08_30_turb.csv")

FRCH_storm10_09_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm10_09_01_Q.csv")
FRCH_storm10_09_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm10_09_01_NO3.csv")
FRCH_storm10_09_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm10_09_01_fDOM.csv")
FRCH_storm10_09_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm10_09_01_SPC.csv")
FRCH_storm10_09_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm10_09_01_turb.csv")

FRCH_storm11a_09_22_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11a_09_22_Q.csv")
FRCH_storm11a_09_22_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11a_09_22_NO3.csv")
FRCH_storm11a_09_22_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11a_09_22_fDOM.csv")
FRCH_storm11a_09_22_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11a_09_22_SPC.csv")
FRCH_storm11a_09_22_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11a_09_22_turb.csv")

FRCH_storm11b_09_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11b_09_24_Q.csv")
FRCH_storm11b_09_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11b_09_24_NO3.csv")
FRCH_storm11b_09_24_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11b_09_24_fDOM.csv")
FRCH_storm11b_09_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11b_09_24_SPC.csv")
FRCH_storm11b_09_24_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/FRCH/FRCH_storm11b_09_24_turb.csv")


```

FRCH_storms
```{python}
## NO3 ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_NO3 = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_29_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_29_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_29_NO3 = hysteresisMetrics(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2b_07_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2b_07_04_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2b_07_04_NO3 = hysteresisMetrics(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_10_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_10_NO3 = hysteresisMetrics(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_NO3 = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_16_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_16_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_16_NO3 = hysteresisMetrics(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_04_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_04_NO3 = hysteresisMetrics(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_NO3 = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_23_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_23_NO3 = hysteresisMetrics(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_NO3 = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8b_08_28_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8b_08_28_NO3 = hysteresisMetrics(FRCH_storm8b_08_28_Q, FRCH_storm8b_08_28_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_NO3 = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_NO3 = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_NO3 = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11b_09_24_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11b_09_24_NO3 = hysteresisMetrics(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_fDOM = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_29_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_29_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_29_fDOM = hysteresisMetrics(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2b_07_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2b_07_04_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2b_07_04_fDOM = hysteresisMetrics(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_10_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_10_fDOM = hysteresisMetrics(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_fDOM = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_16_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_16_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_16_fDOM = hysteresisMetrics(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_04_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_04_fDOM = hysteresisMetrics(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_fDOM = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_23_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_23_fDOM = hysteresisMetrics(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_fDOM = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8b_08_28_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8b_08_28_fDOM = hysteresisMetrics(FRCH_storm8b_08_28_Q, FRCH_storm8b_08_28_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_fDOM = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_fDOM = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_fDOM = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11b_09_24_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11b_09_24_fDOM = hysteresisMetrics(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_SPC = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_29_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_29_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_29_SPC = hysteresisMetrics(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2b_07_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2b_07_04_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2b_07_04_SPC = hysteresisMetrics(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_10_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_10_SPC = hysteresisMetrics(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_SPC = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_16_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_16_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_16_SPC = hysteresisMetrics(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_04_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_04_SPC = hysteresisMetrics(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_SPC = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_23_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_23_SPC = hysteresisMetrics(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_SPC = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8b_08_28_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8b_08_28_SPC = hysteresisMetrics(FRCH_storm8b_08_28_Q, FRCH_storm8b_08_28_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_SPC = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_SPC = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_SPC = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11b_09_24_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11b_09_24_SPC = hysteresisMetrics(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_turb = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_29_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_29_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_29_turb = hysteresisMetrics(FRCH_storm2a_06_29_Q, FRCH_storm2a_06_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2b_07_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2b_07_04_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2b_07_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2b_07_04_turb = hysteresisMetrics(FRCH_storm2b_07_04_Q, FRCH_storm2b_07_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_10_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_10_turb = hysteresisMetrics(FRCH_storm3_07_10_Q, FRCH_storm3_07_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_turb = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_16_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_16_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_16_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_16_turb = hysteresisMetrics(FRCH_storm4b_07_16_Q, FRCH_storm4b_07_16_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_04_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_04_turb = hysteresisMetrics(FRCH_storm5_08_04_Q, FRCH_storm5_08_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_turb = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_23_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_23_turb = hysteresisMetrics(FRCH_storm7_08_23_Q, FRCH_storm7_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_turb = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8b_08_28_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm8b_08_28_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8b_08_28_turb = hysteresisMetrics(FRCH_storm8b_08_28_Q, FRCH_storm8b_08_28_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_turb = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_turb = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_turb = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11b_09_24_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm11b_09_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11b_09_24_turb = hysteresisMetrics(FRCH_storm11b_09_24_Q, FRCH_storm11b_09_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


FRCH results
```{r}
FRCH.hyst.results.list = list(py$hysdict_FRCH_storm1_06_21_NO3,
                              py$hysdict_FRCH_storm1_06_21_fDOM,
                              py$hysdict_FRCH_storm1_06_21_SPC,
                              py$hysdict_FRCH_storm1_06_21_turb,
                              py$hysdict_FRCH_storm2a_06_29_NO3,
                              py$hysdict_FRCH_storm2a_06_29_fDOM,
                              py$hysdict_FRCH_storm2a_06_29_SPC,
                              py$hysdict_FRCH_storm2a_06_29_turb,
                              py$hysdict_FRCH_storm2b_07_04_NO3,
                              py$hysdict_FRCH_storm2b_07_04_fDOM,
                              py$hysdict_FRCH_storm2b_07_04_SPC,
                              py$hysdict_FRCH_storm2b_07_04_turb,
                              py$hysdict_FRCH_storm3_07_10_NO3,
                              py$hysdict_FRCH_storm3_07_10_fDOM,
                              py$hysdict_FRCH_storm3_07_10_SPC,
                              py$hysdict_FRCH_storm3_07_10_turb,
                              py$hysdict_FRCH_storm4a_07_15_NO3,
                              py$hysdict_FRCH_storm4a_07_15_fDOM,
                              py$hysdict_FRCH_storm4a_07_15_SPC,
                              py$hysdict_FRCH_storm4a_07_15_turb,
                              py$hysdict_FRCH_storm4b_07_16_NO3,
                              py$hysdict_FRCH_storm4b_07_16_fDOM,
                              py$hysdict_FRCH_storm4b_07_16_SPC,
                              py$hysdict_FRCH_storm4b_07_16_turb,
                              py$hysdict_FRCH_storm5_08_04_NO3,
                              py$hysdict_FRCH_storm5_08_04_fDOM,
                              py$hysdict_FRCH_storm5_08_04_SPC,
                              py$hysdict_FRCH_storm5_08_04_turb,
                             
                              py$hysdict_FRCH_storm6_08_13_fDOM,
                              py$hysdict_FRCH_storm6_08_13_SPC,
                              py$hysdict_FRCH_storm6_08_13_turb,
                              py$hysdict_FRCH_storm7_08_23_fDOM,
                              py$hysdict_FRCH_storm7_08_23_SPC,
                              py$hysdict_FRCH_storm7_08_23_turb,
                              py$hysdict_FRCH_storm8a_08_26_fDOM,
                              py$hysdict_FRCH_storm8a_08_26_SPC,
                              py$hysdict_FRCH_storm8a_08_26_turb,
                              py$hysdict_FRCH_storm8b_08_28_fDOM,
                              py$hysdict_FRCH_storm8b_08_28_SPC,
                              py$hysdict_FRCH_storm8b_08_28_turb,
                              py$hysdict_FRCH_storm9_08_30_fDOM,
                              py$hysdict_FRCH_storm9_08_30_SPC,
                              py$hysdict_FRCH_storm9_08_30_turb,
                              py$hysdict_FRCH_storm10_09_01_fDOM,
                              py$hysdict_FRCH_storm10_09_01_SPC,
                              py$hysdict_FRCH_storm10_09_01_turb,
                              
                              py$hysdict_FRCH_storm11a_09_22_fDOM,
                              py$hysdict_FRCH_storm11a_09_22_SPC,
                              py$hysdict_FRCH_storm11a_09_22_turb,
                             
                              py$hysdict_FRCH_storm11b_09_24_fDOM,
                              py$hysdict_FRCH_storm11b_09_24_SPC,
                              py$hysdict_FRCH_storm11b_09_24_turb)
                           
                      
                          

FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm1_06_21_NO3",
                                  "FRCH_storm1_06_21_fDOM",
                                  "FRCH_storm1_06_21_SPC",
                                  "FRCH_storm1_06_21_turb",
                                  "FRCH_storm2a_06_29_NO3",
                                  "FRCH_storm2a_06_29_fDOM",
                                  "FRCH_storm2a_06_29_SPC",
                                  "FRCH_storm2a_06_29_turb",
                                  "FRCH_storm2b_07_04_NO3",
                                  "FRCH_storm2b_07_04_fDOM",
                                  "FRCH_storm2b_07_04_SPC",
                                  "FRCH_storm2b_07_04_turb",
                                  "FRCH_storm3_07_10_NO3",
                                  "FRCH_storm3_07_10_fDOM",
                                  "FRCH_storm3_07_10_SPC",
                                  "FRCH_storm3_07_10_turb",
                                  "FRCH_storm4a_07_15_NO3",
                                  "FRCH_storm4a_07_15_fDOM",
                                  "FRCH_storm4a_07_15_SPC",
                                  "FRCH_storm4a_07_15_turb",
                                  "FRCH_storm4b_07_16_NO3",
                                  "FRCH_storm4b_07_16_fDOM",
                                  "FRCH_storm4b_07_16_SPC",
                                  "FRCH_storm4b_07_16_turb",
                                  "FRCH_storm5_08_04_NO3",
                                  "FRCH_storm5_08_04_fDOM",
                                  "FRCH_storm5_08_04_SPC",
                                  "FRCH_storm5_08_04_turb",
                                  "FRCH_storm6_08_13_fDOM",
                                  "FRCH_storm6_08_13_SPC",
                                  "FRCH_storm6_08_13_turb",
                                  "FRCH_storm7_08_23_fDOM",
                                  "FRCH_storm7_08_23_SPC",
                                  "FRCH_storm7_08_23_turb",
                                  "FRCH_storm8a_08_26_fDOM",
                                  "FRCH_storm8a_08_26_SPC",
                                  "FRCH_storm8a_08_26_turb",
                                  "FRCH_storm8b_08_28_fDOM",
                                  "FRCH_storm8b_08_28_SPC",
                                  "FRCH_storm8b_08_28_turb",
                                  "FRCH_storm9_08_30_fDOM",
                                  "FRCH_storm9_08_30_SPC",
                                  "FRCH_storm9_08_30_turb",
                                  "FRCH_storm10_09_01_fDOM",
                                  "FRCH_storm10_09_01_SPC",
                                  "FRCH_storm10_09_01_turb",
                                
                                  "FRCH_storm11a_09_22_fDOM",
                                  "FRCH_storm11a_09_22_SPC",
                                  "FRCH_storm11a_09_22_turb",
                                  "FRCH_storm11b_09_24_fDOM",
                                  "FRCH_storm11b_09_24_SPC",
                                  "FRCH_storm11b_09_24_turb"
                                  )


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
# pdf("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(rep("FRCH_storm1_06_21_NO3", 50),
                        rep("FRCH_storm1_06_21_fDOM", 50),
                        rep("FRCH_storm1_06_21_SPC", 50),
                        rep("FRCH_storm1_06_21_turb", 50),
                        rep("FRCH_storm2a_06_29_NO3", 50),
                        rep("FRCH_storm2a_06_29_fDOM", 50),
                        rep("FRCH_storm2a_06_29_SPC", 50),
                        rep("FRCH_storm2a_06_29_turb", 50),
                        rep("FRCH_storm2b_07_04_NO3", 50),
                        rep("FRCH_storm2b_07_04_fDOM", 50),
                        rep("FRCH_storm2b_07_04_SPC", 50),
                        rep("FRCH_storm2b_07_04_turb", 50),
                        rep("FRCH_storm3_07_10_NO3", 50),
                        rep("FRCH_storm3_07_10_fDOM", 50),
                        rep("FRCH_storm3_07_10_SPC", 50),
                        rep("FRCH_storm3_07_10_turb", 50),
                        rep("FRCH_storm4a_07_15_NO3", 50),
                        rep("FRCH_storm4a_07_15_fDOM", 50),
                        rep("FRCH_storm4a_07_15_SPC", 50),
                        rep("FRCH_storm4a_07_15_turb", 50),
                        rep("FRCH_storm4b_07_16_NO3", 50),
                        rep("FRCH_storm4b_07_16_fDOM", 50),
                        rep("FRCH_storm4b_07_16_SPC", 50),
                        rep("FRCH_storm4b_07_16_turb", 50),
                        rep("FRCH_storm5_08_04_NO3", 50),
                        rep("FRCH_storm5_08_04_fDOM", 50),
                        rep("FRCH_storm5_08_04_SPC", 50),
                        rep("FRCH_storm5_08_04_turb", 50),
                        rep("FRCH_storm6_08_13_fDOM", 50),
                        rep("FRCH_storm6_08_13_SPC", 50),
                        rep("FRCH_storm6_08_13_turb", 50),
                        rep("FRCH_storm7_08_23_fDOM", 50),
                        rep("FRCH_storm7_08_23_SPC", 50),
                        rep("FRCH_storm7_08_23_turb", 50),
                        rep("FRCH_storm8a_08_26_fDOM", 50),
                        rep("FRCH_storm8a_08_26_SPC", 50),
                        rep("FRCH_storm8a_08_26_turb", 50),
                        rep("FRCH_storm8b_08_28_fDOM", 50),
                        rep("FRCH_storm8b_08_28_SPC", 50),
                        rep("FRCH_storm8b_08_28_turb", 50),
                        rep("FRCH_storm9_08_30_fDOM", 50),
                        rep("FRCH_storm9_08_30_SPC", 50),
                        rep("FRCH_storm9_08_30_turb", 50),
                        rep("FRCH_storm10_09_01_fDOM", 50),
                        rep("FRCH_storm10_09_01_SPC", 50),
                        rep("FRCH_storm10_09_01_turb", 50),
                        rep("FRCH_storm11a_09_22_fDOM", 50),
                        rep("FRCH_storm11a_09_22_SPC", 50),
                        rep("FRCH_storm11a_09_22_turb", 50),
                        rep("FRCH_storm11b_09_24_fDOM", 50),
                        rep("FRCH_storm11b_09_24_SPC", 50),
                        rep("FRCH_storm11b_09_24_turb", 50))
                   

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/FRCH/FRCH.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.HI.df.csv")

FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/FRCH/FRCH.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.HI.df.doy.csv")

```

```{python}
# MOOS #
MOOS_storm1_06_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm1_06_21_Q.csv")
MOOS_storm1_06_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm1_06_21_NO3.csv")
MOOS_storm1_06_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm1_06_21_fDOM.csv")
MOOS_storm1_06_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm1_06_21_SPC.csv")
MOOS_storm1_06_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm1_06_21_turb.csv")

MOOS_storm2a_06_30_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2a_06_30_Q.csv")
MOOS_storm2a_06_30_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2a_06_30_NO3.csv")
MOOS_storm2a_06_30_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2a_06_30_fDOM.csv")
MOOS_storm2a_06_30_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2a_06_30_SPC.csv")
MOOS_storm2a_06_30_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2a_06_30_Turb.csv")

MOOS_storm2b_07_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2b_07_01_Q.csv")
MOOS_storm2b_07_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2b_07_01_NO3.csv")
MOOS_storm2b_07_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2b_07_01_fDOM.csv")
MOOS_storm2b_07_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2b_07_01_SPC.csv")
MOOS_storm2b_07_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2b_07_01_turb.csv")

MOOS_storm2c_07_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2c_07_04_Q.csv")
MOOS_storm2c_07_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2c_07_04_NO3.csv")
MOOS_storm2c_07_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2c_07_04_fDOM.csv")
MOOS_storm2c_07_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2c_07_04_SPC.csv")
MOOS_storm2c_07_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm2c_07_04_turb.csv")

MOOS_storm3_07_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm3_07_09_Q.csv")
MOOS_storm3_07_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm3_07_09_NO3.csv")
MOOS_storm3_07_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm3_07_09_fDOM.csv")
MOOS_storm3_07_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm3_07_09_SPC.csv")
MOOS_storm3_07_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm3_07_09_turb.csv")

MOOS_storm4_07_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm4_07_15_Q.csv")
MOOS_storm4_07_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm4_07_15_NO3.csv")
MOOS_storm4_07_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm4_07_15_fDOM.csv")
MOOS_storm4_07_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm4_07_15_SPC.csv")
MOOS_storm4_07_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm4_07_15_turb.csv")

MOOS_storm5_08_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm5_08_04_Q.csv")
MOOS_storm5_08_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm5_08_04_NO3.csv")
MOOS_storm5_08_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm5_08_04_fDOM.csv")
MOOS_storm5_08_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm5_08_04_SPC.csv")
MOOS_storm5_08_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm5_08_04_turb.csv")

MOOS_storm6_08_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm6_08_13_Q.csv")
MOOS_storm6_08_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm6_08_13_NO3.csv")
MOOS_storm6_08_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm6_08_13_fDOM.csv")
MOOS_storm6_08_13_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2018/MOOS/MOOS_storm6_08_13_SPC.csv")
MOOS_storm6_08_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm6_08_13_turb.csv")

MOOS_storm7_08_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm7_08_23_Q.csv")
MOOS_storm7_08_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm7_08_23_NO3.csv")
MOOS_storm7_08_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm7_08_23_fDOM.csv")
MOOS_storm7_08_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm7_08_23_SPC.csv")
MOOS_storm7_08_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm7_08_23_turb.csv")

MOOS_storm8a_08_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8a_08_26_Q.csv")
MOOS_storm8a_08_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8a_08_26_NO3.csv")
MOOS_storm8a_08_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8a_08_26_fDOM.csv")
MOOS_storm8a_08_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8a_08_26_SPC.csv")
MOOS_storm8a_08_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8a_08_26_turb.csv")

MOOS_storm8b_08_28_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8b_08_28_Q.csv")
MOOS_storm8b_08_28_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8b_08_28_NO3.csv")
MOOS_storm8b_08_28_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8b_08_28_fDOM.csv")
MOOS_storm8b_08_28_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8b_08_28_SPC.csv")
MOOS_storm8b_08_28_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm8b_08_28_turb.csv")

MOOS_storm9_08_30_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm9_08_30_Q.csv")
MOOS_storm9_08_30_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm9_08_30_NO3.csv")
MOOS_storm9_08_30_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm9_08_30_fDOM.csv")
MOOS_storm9_08_30_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm9_08_30_SPC.csv")
MOOS_storm9_08_30_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm9_08_30_turb.csv")

MOOS_storm10_09_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm10_09_01_Q.csv")
MOOS_storm10_09_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm10_09_01_NO3.csv")
MOOS_storm10_09_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm10_09_01_fDOM.csv")
MOOS_storm10_09_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm10_09_01_SPC.csv")
MOOS_storm10_09_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm10_09_01_turb.csv")

MOOS_storm11a_09_22_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11a_09_22_Q.csv")
MOOS_storm11a_09_22_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11a_09_22_NO3.csv")
MOOS_storm11a_09_22_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11a_09_22_fDOM.csv")
MOOS_storm11a_09_22_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11a_09_22_SPC.csv")
MOOS_storm11a_09_22_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11a_09_22_turb.csv")

MOOS_storm11b_09_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11b_09_24_Q.csv")
MOOS_storm11b_09_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11b_09_24_NO3.csv")
MOOS_storm11b_09_24_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11b_09_24_fDOM.csv")
MOOS_storm11b_09_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11b_09_24_SPC.csv")
MOOS_storm11b_09_24_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm11b_09_24_turb.csv")

MOOS_storm12_09_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm12_09_24_Q.csv")
MOOS_storm12_09_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm12_09_24_NO3.csv")
MOOS_storm12_09_24_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm12_09_24_fDOM.csv")
MOOS_storm12_09_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm12_09_24_SPC.csv")
MOOS_storm12_09_24_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/MOOS/MOOS_storm12_09_24_turb.csv")



```

MOOS_storms
```{python}
## NO3 ##
MOOS_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_21_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_21_NO3 = hysteresisMetrics(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_NO3 = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_07_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_07_01_NO3 = hysteresisMetrics(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2c_07_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2c_07_04_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2c_07_04_NO3 = hysteresisMetrics(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_09_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_09_NO3 = hysteresisMetrics(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_15_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_15_NO3 = hysteresisMetrics(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_04_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_04_NO3 = hysteresisMetrics(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_NO3 = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_NO3 = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_NO3 = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8b_08_28_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8b_08_28_NO3 = hysteresisMetrics(MOOS_storm8b_08_28_Q, MOOS_storm8b_08_28_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_NO3 = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_NO3 = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_NO3 = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11b_09_24_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11b_09_24_NO3 = hysteresisMetrics(MOOS_storm11b_09_24_Q, MOOS_storm11b_09_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm12_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm12_09_24_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm12_09_24_NO3 = hysteresisMetrics(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
MOOS_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_21_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_21_fDOM = hysteresisMetrics(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_fDOM = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_07_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_07_01_fDOM = hysteresisMetrics(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2c_07_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2c_07_04_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2c_07_04_fDOM = hysteresisMetrics(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_09_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_09_fDOM = hysteresisMetrics(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_15_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_15_fDOM = hysteresisMetrics(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_04_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_04_fDOM = hysteresisMetrics(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_fDOM = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_fDOM = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_fDOM = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8b_08_28_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8b_08_28_fDOM = hysteresisMetrics(MOOS_storm8b_08_28_Q, MOOS_storm8b_08_28_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_fDOM = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_fDOM = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_fDOM = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11b_09_24_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11b_09_24_fDOM = hysteresisMetrics(MOOS_storm11b_09_24_Q, MOOS_storm11b_09_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm12_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm12_09_24_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm12_09_24_fDOM = hysteresisMetrics(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
MOOS_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_21_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_21_SPC = hysteresisMetrics(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_SPC = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_07_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_07_01_SPC = hysteresisMetrics(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2c_07_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2c_07_04_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2c_07_04_SPC = hysteresisMetrics(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_09_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_09_SPC = hysteresisMetrics(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_15_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_15_SPC = hysteresisMetrics(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_04_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_04_SPC = hysteresisMetrics(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_SPC = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_SPC = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_SPC = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8b_08_28_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8b_08_28_SPC = hysteresisMetrics(MOOS_storm8b_08_28_Q, MOOS_storm8b_08_28_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_SPC = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_SPC = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_SPC = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11b_09_24_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11b_09_24_SPC = hysteresisMetrics(MOOS_storm11b_09_24_Q, MOOS_storm11b_09_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm12_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm12_09_24_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm12_09_24_SPC = hysteresisMetrics(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
MOOS_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_21_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_21_turb = hysteresisMetrics(MOOS_storm1_06_21_Q, MOOS_storm1_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_turb = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_07_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_07_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_07_01_turb = hysteresisMetrics(MOOS_storm2b_07_01_Q, MOOS_storm2b_07_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2c_07_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2c_07_04_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2c_07_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2c_07_04_turb = hysteresisMetrics(MOOS_storm2c_07_04_Q, MOOS_storm2c_07_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_09_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_09_turb = hysteresisMetrics(MOOS_storm3_07_09_Q, MOOS_storm3_07_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_15_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_15_turb = hysteresisMetrics(MOOS_storm4_07_15_Q, MOOS_storm4_07_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_04_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_04_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_04_turb = hysteresisMetrics(MOOS_storm5_08_04_Q, MOOS_storm5_08_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_turb = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_turb = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_turb = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8b_08_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8b_08_28_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm8b_08_28_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8b_08_28_turb = hysteresisMetrics(MOOS_storm8b_08_28_Q, MOOS_storm8b_08_28_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_29_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_29_turb = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_turb = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_turb = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11b_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11b_09_24_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm11b_09_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11b_09_24_turb = hysteresisMetrics(MOOS_storm11b_09_24_Q, MOOS_storm11b_09_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm12_09_24_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm12_09_24_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm12_09_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm12_09_24_turb = hysteresisMetrics(MOOS_storm12_09_24_Q, MOOS_storm12_09_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


MOOS results
```{r}
MOOS.hyst.results.list = list(py$hysdict_MOOS_storm1_06_21_NO3,
                              py$hysdict_MOOS_storm1_06_21_fDOM,
                              py$hysdict_MOOS_storm1_06_21_SPC,
                              py$hysdict_MOOS_storm1_06_21_turb,
                              py$hysdict_MOOS_storm2a_06_30_fDOM,
                              py$hysdict_MOOS_storm2a_06_30_SPC,
                              py$hysdict_MOOS_storm2b_07_01_fDOM,
                              py$hysdict_MOOS_storm2b_07_01_SPC,
                              py$hysdict_MOOS_storm2b_07_01_turb,
                              py$hysdict_MOOS_storm2c_07_04_fDOM,
                              py$hysdict_MOOS_storm2c_07_04_SPC,
                              py$hysdict_MOOS_storm2c_07_04_turb,
                              py$hysdict_MOOS_storm3_07_09_NO3,
                              py$hysdict_MOOS_storm3_07_09_fDOM,
                              py$hysdict_MOOS_storm3_07_09_SPC,
                              py$hysdict_MOOS_storm3_07_09_turb,
                              py$hysdict_MOOS_storm5_08_04_NO3,
                              py$hysdict_MOOS_storm5_08_04_fDOM,
                              py$hysdict_MOOS_storm5_08_04_SPC,
                              py$hysdict_MOOS_storm5_08_04_turb,
                              py$hysdict_MOOS_storm6_08_13_NO3,
                              py$hysdict_MOOS_storm6_08_13_fDOM,
                              py$hysdict_MOOS_storm6_08_13_SPC,
                              py$hysdict_MOOS_storm6_08_13_turb,
                              py$hysdict_MOOS_storm7_08_23_NO3,
                              py$hysdict_MOOS_storm7_08_23_fDOM,
                              py$hysdict_MOOS_storm7_08_23_SPC,
                              py$hysdict_MOOS_storm7_08_23_turb,
                              py$hysdict_MOOS_storm8a_08_26_NO3,
                              py$hysdict_MOOS_storm8a_08_26_fDOM,
                              py$hysdict_MOOS_storm8a_08_26_SPC,
                              py$hysdict_MOOS_storm8a_08_26_turb,
                              py$hysdict_MOOS_storm8b_08_28_fDOM,
                              py$hysdict_MOOS_storm8b_08_28_SPC,
                              py$hysdict_MOOS_storm8b_08_28_turb,
                              py$hysdict_MOOS_storm9_08_30_NO3,
                              py$hysdict_MOOS_storm10_09_01_NO3,
                              
                              py$hysdict_MOOS_storm11a_09_22_NO3,
                              py$hysdict_MOOS_storm11a_09_22_fDOM,
                              py$hysdict_MOOS_storm11a_09_22_SPC,
                              py$hysdict_MOOS_storm11a_09_22_turb,
                              py$hysdict_MOOS_storm11b_09_24_NO3,
                              py$hysdict_MOOS_storm11b_09_24_fDOM,
                              py$hysdict_MOOS_storm11b_09_24_SPC,
                              py$hysdict_MOOS_storm11b_09_24_turb,
                              py$hysdict_MOOS_storm12_09_24_NO3,
                              py$hysdict_MOOS_storm12_09_24_fDOM)

MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c("MOOS_storm1_06_21_NO3",
                                  "MOOS_storm1_06_21_fDOM",
                                  "MOOS_storm1_06_21_SPC",
                                  "MOOS_storm1_06_21_turb",
                                  "MOOS_storm2a_06_30_fDOM",
                                  "MOOS_storm2a_06_30_SPC",
                                  
                                  "MOOS_storm2b_07_01_fDOM",
                                  "MOOS_storm2b_07_01_SPC",
                                  "MOOS_storm2b_07_01_turb",
                                  "MOOS_storm2c_07_04_fDOM",
                                  "MOOS_storm2c_07_04_SPC",
                                  "MOOS_storm2c_07_04_turb",
                                  "MOOS_storm3_07_09_NO3",
                                  "MOOS_storm3_07_09_fDOM",
                                  "MOOS_storm3_07_09_SPC",
                                  "MOOS_storm3_07_09_turb",
                              
                                  "MOOS_storm5_08_04_NO3",
                                  "MOOS_storm5_08_04_fDOM",
                                  "MOOS_storm5_08_04_SPC",
                                  "MOOS_storm5_08_04_turb",
                                  "MOOS_storm6_08_13_NO3",
                                  "MOOS_storm6_08_13_fDOM",
                                  "MOOS_storm6_08_13_SPC",
                                  "MOOS_storm6_08_13_turb",
                                  "MOOS_storm7_08_23_NO3",
                                  "MOOS_storm7_08_23_fDOM",
                                  "MOOS_storm7_08_23_SPC",
                                  "MOOS_storm7_08_23_turb",
                                  "MOOS_storm8a_08_26_NO3",
                                  "MOOS_storm8a_08_26_fDOM",
                                  "MOOS_storm8a_08_26_SPC",
                                  "MOOS_storm8a_08_26_turb",
                                  
                                  "MOOS_storm8b_08_28_fDOM",
                                  "MOOS_storm8b_08_28_SPC",
                                  "MOOS_storm8b_08_28_turb",
                                  "MOOS_storm9_08_29_NO3",
                                  
                                  
                        
                                  "MOOS_storm10_09_01_NO3",
                                  
                                  "MOOS_storm11a_09_22_NO3",
                                  "MOOS_storm11a_09_22_fDOM",
                                  "MOOS_storm11a_09_22_SPC",
                                  "MOOS_storm11a_09_22_turb",
                                  "MOOS_storm11b_09_24_NO3",
                                  "MOOS_storm11b_09_24_fDOM",
                                  "MOOS_storm11b_09_24_SPC",
                                  "MOOS_storm11b_09_24_turb",
                                  "MOOS_storm12_09_24_NO3",
                                  "MOOS_storm12_09_24_fDOM")
                                  
                                 


MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/MOOS/MOOS.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2018/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(rep("MOOS_storm1_06_21_NO3", 50),
                        rep("MOOS_storm1_06_21_fDOM", 50),
                        rep("MOOS_storm1_06_21_SPC", 50),
                        rep("MOOS_storm1_06_21_turb", 50),
                        rep("MOOS_storm2a_06_30_fDOM", 50),
                        rep("MOOS_storm2a_06_30_SPC", 50),
                        
                        rep("MOOS_storm2b_07_01_fDOM", 50),
                        rep("MOOS_storm2b_07_01_SPC", 50),
                        rep("MOOS_storm2b_07_01_turb", 50),
                        rep("MOOS_storm2c_07_04_fDOM", 50),
                        rep("MOOS_storm2c_07_04_SPC", 50),
                        rep("MOOS_storm2c_07_04_turb", 50),
                        rep("MOOS_storm3_07_09_NO3", 50),
                        rep("MOOS_storm3_07_09_fDOM", 50),
                        rep("MOOS_storm3_07_09_SPC", 50),
                        rep("MOOS_storm3_07_09_turb", 50),
                        
                        rep("MOOS_storm5_08_04_NO3", 49),
                        rep("MOOS_storm5_08_04_fDOM", 50),
                        rep("MOOS_storm5_08_04_SPC", 50),
                        rep("MOOS_storm5_08_04_turb", 50),
                        rep("MOOS_storm6_08_13_NO3", 50),
                        rep("MOOS_storm6_08_13_fDOM", 50),
                        rep("MOOS_storm6_08_13_SPC", 50),
                        rep("MOOS_storm6_08_13_turb", 50),
                        rep("MOOS_storm7_08_23_NO3", 50),
                        rep("MOOS_storm7_08_23_fDOM", 50),
                        rep("MOOS_storm7_08_23_SPC", 50),
                        rep("MOOS_storm7_08_23_turb", 50),
                        rep("MOOS_storm8a_08_26_NO3", 50),
                        rep("MOOS_storm8a_08_26_fDOM", 50),
                        rep("MOOS_storm8a_08_26_SPC", 50),
                        rep("MOOS_storm8a_08_26_turb", 50),
                        
                        rep("MOOS_storm8b_08_27_fDOM", 50),
                        rep("MOOS_storm8b_08_27_SPC", 50),
                        rep("MOOS_storm8b_08_27_turb", 50),
                        rep("MOOS_storm9_08_29_NO3", 50),
                        
                        
                       
                        rep("MOOS_storm10_09_01_NO3", 50),
                        
                        rep("MOOS_storm11a_09_22_NO3", 50),
                        rep("MOOS_storm11a_09_22_fDOM", 50),
                        rep("MOOS_storm11a_09_22_SPC", 50),
                        rep("MOOS_storm11a_09_22_turb", 50),
                        rep("MOOS_storm11b_09_24_NO3", 50),
                        rep("MOOS_storm11b_09_24_fDOM", 50),
                        rep("MOOS_storm11b_09_24_SPC", 50),
                        rep("MOOS_storm11b_09_24_turb", 50),
                        rep("MOOS_storm12_09_24_NO3", 50),
                        rep("MOOS_storm12_09_24_fDOM", 51))

MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/MOOS/MOOS.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/MOOS/MOOS.HI.df.csv")

MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/MOOS/MOOS.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/MOOS/MOOS.HI.df.doy.csv")

```


### CARI ### 
```{python}
# CARI #
CARI_storm1_06_10_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm1_06_10_Q.csv")
CARI_storm1_06_10_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm1_06_10_NO3.csv")
CARI_storm1_06_10_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm1_06_10_fDOM.csv")
CARI_storm1_06_10_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm1_06_10_SPC.csv")
CARI_storm1_06_10_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm1_06_10_Turb.csv")

CARI_storm2_06_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm2_06_21_Q.csv")
CARI_storm2_06_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm2_06_21_NO3.csv")
CARI_storm2_06_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm2_06_21_fDOM.csv")
CARI_storm2_06_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm2_06_21_SPC.csv")
CARI_storm2_06_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm2_06_21_Turb.csv")

CARI_storm3_06_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm3_06_29_Q.csv")
CARI_storm3_06_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm3_06_29_NO3.csv")
CARI_storm3_06_29_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm3_06_29_fDOM.csv")
CARI_storm3_06_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm3_06_29_SPC.csv")
CARI_storm3_06_29_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm3_06_29_Turb.csv")

CARI_storm4a_06_30_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4a_06_30_Q.csv")
CARI_storm4a_06_30_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4a_06_30_NO3.csv")
CARI_storm4a_06_30_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4a_06_30_fDOM.csv")
CARI_storm4a_06_30_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4a_06_30_SPC.csv")
CARI_storm4a_06_30_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4a_06_30_Turb.csv")

CARI_storm4b_07_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4b_07_01_Q.csv")
CARI_storm4b_07_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4b_07_01_NO3.csv")
CARI_storm4b_07_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4b_07_01_fDOM.csv")
CARI_storm4b_07_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4b_07_01_SPC.csv")
CARI_storm4b_07_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm4b_07_01_Turb.csv")

CARI_storm5a_08_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5a_08_04_Q.csv")
CARI_storm5a_08_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5a_08_04_NO3.csv")
CARI_storm5a_08_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5a_08_04_fDOM.csv")
CARI_storm5a_08_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5a_08_04_SPC.csv")
CARI_storm5a_08_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5a_08_04_Turb.csv")

CARI_storm5b_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5b_08_05_Q.csv")
CARI_storm5b_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5b_08_05_NO3.csv")
CARI_storm5b_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5b_08_05_fDOM.csv")
CARI_storm5b_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5b_08_05_SPC.csv")
CARI_storm5b_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5b_08_05_Turb.csv")

CARI_storm5c_08_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5c_08_06_Q.csv")
CARI_storm5c_08_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5c_08_06_NO3.csv")
CARI_storm5c_08_06_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5c_08_06_fDOM.csv")
CARI_storm5c_08_06_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5c_08_06_SPC.csv")
CARI_storm5c_08_06_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm5c_08_06_Turb.csv")

CARI_storm6_08_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm6_08_13_Q.csv")
CARI_storm6_08_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm6_08_13_NO3.csv")
CARI_storm6_08_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm6_08_13_fDOM.csv")
CARI_storm6_08_13_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm6_08_13_SPC.csv")
CARI_storm6_08_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm6_08_13_Turb.csv")

CARI_storm7_08_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm7_08_21_Q.csv")
CARI_storm7_08_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm7_08_21_NO3.csv")
CARI_storm7_08_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm7_08_21_fDOM.csv")
CARI_storm7_08_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm7_08_21_SPC.csv")
CARI_storm7_08_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm7_08_21_Turb.csv")

CARI_storm8_08_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm8_08_24_Q.csv")
CARI_storm8_08_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm8_08_24_NO3.csv")
CARI_storm8_08_24_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm8_08_24_fDOM.csv")
CARI_storm8_08_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm8_08_24_SPC.csv")
CARI_storm8_08_24_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm8_08_24_Turb.csv")

CARI_storm9_08_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm9_08_26_Q.csv")
CARI_storm9_08_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm9_08_26_NO3.csv")
CARI_storm9_08_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm9_08_26_fDOM.csv")
CARI_storm9_08_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm9_08_26_SPC.csv")
CARI_storm9_08_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm9_08_26_Turb.csv")

CARI_storm10_08_30_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm10_08_30_Q.csv")
CARI_storm10_08_30_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm10_08_30_NO3.csv")
CARI_storm10_08_30_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm10_08_30_fDOM.csv")
CARI_storm10_08_30_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm10_08_30_SPC.csv")
CARI_storm10_08_30_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm10_08_30_Turb.csv")

CARI_storm11_09_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm11_09_02_Q.csv")
CARI_storm11_09_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm11_09_02_NO3.csv")
CARI_storm11_09_02_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm11_09_02_fDOM.csv")
CARI_storm11_09_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm11_09_02_SPC.csv")
CARI_storm11_09_02_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm11_09_02_Turb.csv")

CARI_storm12a_09_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12a_09_20_Q.csv")
CARI_storm12a_09_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12a_09_20_NO3.csv")
CARI_storm12a_09_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12a_09_20_fDOM.csv")
CARI_storm12a_09_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12a_09_20_SPC.csv")
CARI_storm12a_09_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12a_09_20_Turb.csv")

CARI_storm12b_09_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12b_09_25_Q.csv")
CARI_storm12b_09_25_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12b_09_25_NO3.csv")
CARI_storm12b_09_25_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12b_09_25_fDOM.csv")
CARI_storm12b_09_25_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12b_09_25_SPC.csv")
CARI_storm12b_09_25_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2018/CARI/CARI_storm12b_09_25_Turb.csv")

```


CARI_storms
```{python}
## NO3 ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_NO3 = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_21_NO3 = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_NO3 = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_NO3 = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_07_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_07_01_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_07_01_NO3 = hysteresisMetrics(CARI_storm4b_07_01_Q, CARI_storm4b_07_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5a_08_04_NO3 = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5b_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5b_08_05_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5b_08_05_NO3 = hysteresisMetrics(CARI_storm5b_08_05_Q, CARI_storm5b_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5c_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5c_08_06_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5c_08_06_NO3 = hysteresisMetrics(CARI_storm5c_08_06_Q, CARI_storm5c_08_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_NO3 = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_NO3 = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm8_08_24_NO3 = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_NO3 = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_NO3 = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_02_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_02_NO3 = hysteresisMetrics(CARI_storm11_09_02_Q, CARI_storm11_09_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 1 minutes between records
hysdict_CARI_storm12a_09_20_NO3 = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_NO3 = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_fDOM = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_21_fDOM = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_fDOM = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_fDOM = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_07_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_07_01_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_07_01_fDOM = hysteresisMetrics(CARI_storm4b_07_01_Q, CARI_storm4b_07_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5a_08_04_fDOM = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5b_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5b_08_05_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm5b_08_05_fDOM = hysteresisMetrics(CARI_storm5b_08_05_Q, CARI_storm5b_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5c_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5c_08_06_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5c_08_06_fDOM = hysteresisMetrics(CARI_storm5c_08_06_Q, CARI_storm5c_08_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_fDOM = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_fDOM = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_24_fDOM = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_fDOM = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_fDOM = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_02_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_02_fDOM = hysteresisMetrics(CARI_storm11_09_02_Q, CARI_storm11_09_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12a_09_20_fDOM = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_fDOM = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_SPC = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_21_SPC = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_SPC = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_SPC = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_07_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_07_01_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_07_01_SPC = hysteresisMetrics(CARI_storm4b_07_01_Q, CARI_storm4b_07_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5a_08_04_SPC = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5b_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5b_08_05_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5b_08_05_SPC = hysteresisMetrics(CARI_storm5b_08_05_Q, CARI_storm5b_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5c_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5c_08_06_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5c_08_06_SPC = hysteresisMetrics(CARI_storm5c_08_06_Q, CARI_storm5c_08_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_SPC = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_SPC = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_24_SPC = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_SPC = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_SPC = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_02_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_02_SPC = hysteresisMetrics(CARI_storm11_09_02_Q, CARI_storm11_09_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12a_09_20_SPC = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_SPC = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_turb['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_turb = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm2_06_21_turb = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_turb['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_turb = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_turb = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_07_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_07_01_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4b_07_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15# 15 minutes between records
hysdict_CARI_storm4b_07_01_turb = hysteresisMetrics(CARI_storm4b_07_01_Q, CARI_storm4b_07_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm5a_08_04_turb = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5b_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5b_08_05_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5b_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5b_08_05_turb = hysteresisMetrics(CARI_storm5b_08_05_Q, CARI_storm5b_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5c_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5c_08_06_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5c_08_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm5c_08_06_turb = hysteresisMetrics(CARI_storm5c_08_06_Q, CARI_storm5c_08_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_turb = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_turb = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_24_turb = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_turb['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_turb = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_turb['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_turb = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_02_turb['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_02_turb = hysteresisMetrics(CARI_storm11_09_02_Q, CARI_storm11_09_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_turb['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12a_09_20_turb = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_turb['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_turb = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')
```


CARI results
```{r}
CARI.hyst.results.list = list(py$hysdict_CARI_storm2_06_21_NO3,
                              py$hysdict_CARI_storm2_06_21_fDOM,
                              py$hysdict_CARI_storm2_06_21_SPC,
                              py$hysdict_CARI_storm2_06_21_turb,
                              py$hysdict_CARI_storm3_06_29_NO3,
                              py$hysdict_CARI_storm3_06_29_fDOM,
                              py$hysdict_CARI_storm3_06_29_SPC,
                              py$hysdict_CARI_storm3_06_29_turb,
                              
                          
                              py$hysdict_CARI_storm5a_08_04_NO3,
                              py$hysdict_CARI_storm5a_08_04_fDOM,
                              py$hysdict_CARI_storm5a_08_04_SPC,
                              py$hysdict_CARI_storm5a_08_04_turb,
                              py$hysdict_CARI_storm5b_08_05_NO3,
                              py$hysdict_CARI_storm5b_08_05_fDOM,
                              py$hysdict_CARI_storm5b_08_05_SPC,
                              py$hysdict_CARI_storm5b_08_05_turb,
                              py$hysdict_CARI_storm5c_08_06_NO3,
                              py$hysdict_CARI_storm5c_08_06_fDOM,
                              py$hysdict_CARI_storm5c_08_06_SPC,
                              py$hysdict_CARI_storm5c_08_06_turb,
                              py$hysdict_CARI_storm6_08_13_NO3,
                              py$hysdict_CARI_storm6_08_13_fDOM,
                              py$hysdict_CARI_storm6_08_13_SPC,
                              py$hysdict_CARI_storm6_08_13_turb,
                              py$hysdict_CARI_storm7_08_21_NO3,
                              py$hysdict_CARI_storm7_08_21_fDOM,
                              py$hysdict_CARI_storm7_08_21_SPC,
                              py$hysdict_CARI_storm7_08_21_turb,
                              py$hysdict_CARI_storm8_08_24_NO3,
                              py$hysdict_CARI_storm8_08_24_fDOM,
                              py$hysdict_CARI_storm8_08_24_SPC,
                              py$hysdict_CARI_storm8_08_24_turb,
                              py$hysdict_CARI_storm9_08_26_NO3,
                              py$hysdict_CARI_storm9_08_26_fDOM,
                              py$hysdict_CARI_storm9_08_26_SPC,
                              py$hysdict_CARI_storm9_08_26_turb,
                              py$hysdict_CARI_storm10_08_30_NO3,
                              py$hysdict_CARI_storm10_08_30_fDOM,
                              py$hysdict_CARI_storm10_08_30_SPC,
                              py$hysdict_CARI_storm10_08_30_turb,
                              py$hysdict_CARI_storm11_09_02_NO3,
                              py$hysdict_CARI_storm11_09_02_fDOM,
                              py$hysdict_CARI_storm11_09_02_SPC,
                              py$hysdict_CARI_storm11_09_02_turb,
                              py$hysdict_CARI_storm12a_09_20_NO3,
                              py$hysdict_CARI_storm12a_09_20_fDOM,
                              py$hysdict_CARI_storm12a_09_20_SPC,
                              py$hysdict_CARI_storm12a_09_20_turb,
                              
                              py$hysdict_CARI_storm12b_09_25_fDOM,
                              py$hysdict_CARI_storm12b_09_25_SPC,
                              py$hysdict_CARI_storm12b_09_25_turb)
                              

CARI.hyst.results.list.2 = list()
for (i in 1:length(CARI.hyst.results.list)){
CARI.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
CARI.hyst.results.list[[i]][["HI_mean_with_Interp"]],
CARI.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
CARI.hyst.results.list[[i]][["Normalized slope of response"]],
CARI.hyst.results.list[[i]][["interpolated Max width of response"]],
CARI.hyst.results.list[[i]][["Min response"]],
CARI.hyst.results.list[[i]][["Max response"]],
CARI.hyst.results.list[[i]][["Peak Q"]]
))))
names(CARI.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(CARI.hyst.results.list)){
  HIs.list[[i]] = unlist(CARI.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

CARI.hyst.results.list.3 =list()
for (i in 1:length(CARI.hyst.results.list)){
  CARI.hyst.results.list.3[[i]] = cbind(CARI.hyst.results.list.2[[i]], HIs.tests[[i]])
}

CARI.hyst.results.df = bind_rows(CARI.hyst.results.list.3, .id = "column_label")



CARI.hyst.results.df$storm.ID = c(
                                  "CARI_storm2_06_21_NO3",
                                  "CARI_storm2_06_21_fDOM",
                                  "CARI_storm2_06_21_SPC",
                                  "CARI_storm2_06_21_turb",
                                  "CARI_storm3_06_29_NO3",
                                  "CARI_storm3_06_29_fDOM",
                                  "CARI_storm3_06_29_SPC",
                                  "CARI_storm3_06_29_turb",
                                  
                                  "CARI_storm5a_08_04_NO3",
                                  "CARI_storm5a_08_04_fDOM",
                                  "CARI_storm5a_08_04_SPC",
                                  "CARI_storm5a_08_04_turb",
                                  "CARI_storm5b_08_05_NO3",
                                  "CARI_storm5b_08_05_fDOM",
                                  "CARI_storm5b_08_05_SPC",
                                  "CARI_storm5b_08_05_turb",
                                  "CARI_storm5c_08_06_NO3",
                                  "CARI_storm5c_08_06_fDOM",
                                  "CARI_storm5c_08_06_SPC",
                                  "CARI_storm5c_08_06_turb",
                                  "CARI_storm6_08_13_NO3",
                                  "CARI_storm6_08_13_fDOM",
                                  "CARI_storm6_08_13_SPC",
                                  "CARI_storm6_08_13_turb",
                                  "CARI_storm7_08_21_NO3",
                                  "CARI_storm7_08_21_fDOM",
                                  "CARI_storm7_08_21_SPC",
                                  "CARI_storm7_08_21_turb",
                                  "CARI_storm8_08_24_NO3",
                                  "CARI_storm8_08_24_fDOM",
                                  "CARI_storm8_08_24_SPC",
                                  "CARI_storm8_08_24_turb",
                                  "CARI_storm9_08_26_NO3",
                                  "CARI_storm9_08_26_fDOM",
                                  "CARI_storm9_08_26_SPC",
                                  "CARI_storm9_08_26_turb",
                                  "CARI_storm10_08_30_NO3",
                                  "CARI_storm10_08_30_fDOM",
                                  "CARI_storm10_08_30_SPC",
                                  "CARI_storm10_08_30_turb",
                                  "CARI_storm11_09_02_NO3",
                                  "CARI_storm11_09_02_fDOM",
                                  "CARI_storm11_09_02_SPC",
                                  "CARI_storm11_09_02_turb",
                                  "CARI_storm12a_09_20_NO3",
                                  "CARI_storm12a_09_20_fDOM",
                                  "CARI_storm12a_09_20_SPC",
                                  "CARI_storm12a_09_20_turb",
                                  
                                  "CARI_storm12b_09_25_fDOM",
                                  "CARI_storm12b_09_25_SPC",
                                  "CARI_storm12b_09_25_turb"
                                  )
                                  
                                 


CARI.hyst.results.df$site.ID = "CARI"

write.csv(CARI.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/CARI/CARI.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2018/CARI/CARI.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= CARI.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

CARI.HI.df = bind_rows(HIs.df.list, .id = "column_label")
CARI.HI.df$storm.ID = c(
                        
                        rep("CARI_storm2_06_21_NO3", 50),
                        rep("CARI_storm2_06_21_fDOM", 50),
                        rep("CARI_storm2_06_21_SPC", 50),
                        rep("CARI_storm2_06_21_turb", 50),
                        rep("CARI_storm3_06_29_NO3", 50),
                        rep("CARI_storm3_06_29_fDOM", 50),
                        rep("CARI_storm3_06_29_SPC", 50),
                        rep("CARI_storm3_06_29_turb", 50),
                        
                      
                        rep("CARI_storm5a_08_04_NO3", 50),
                        rep("CARI_storm5a_08_04_fDOM", 50),
                        rep("CARI_storm5a_08_04_SPC", 50),
                        rep("CARI_storm5a_08_04_turb", 50),
                        rep("CARI_storm5b_08_05_NO3", 50),
                        rep("CARI_storm5b_08_05_fDOM", 50),
                        rep("CARI_storm5b_08_05_SPC", 50),
                        rep("CARI_storm5b_08_05_turb", 50),
                        rep("CARI_storm5c_08_06_NO3", 50),
                        rep("CARI_storm5c_08_06_fDOM", 50),
                        rep("CARI_storm5c_08_06_SPC", 50),
                        rep("CARI_storm5c_08_06_turb", 50),
                        rep("CARI_storm6_08_13_NO3", 50),
                        rep("CARI_storm6_08_13_fDOM", 50),
                        rep("CARI_storm6_08_13_SPC", 50),
                        rep("CARI_storm6_08_13_turb", 50),
                        rep("CARI_storm7_08_21_NO3", 50),
                        rep("CARI_storm7_08_21_fDOM", 50),
                        rep("CARI_storm7_08_21_SPC", 50),
                        rep("CARI_storm7_08_21_turb", 50),
                        rep("CARI_storm8_08_24_NO3", 50),
                        rep("CARI_storm8_08_24_fDOM", 50),
                        rep("CARI_storm8_08_24_SPC", 50),
                        rep("CARI_storm8_08_24_turb", 50),
                        rep("CARI_storm9_08_26_NO3", 50),
                        rep("CARI_storm9_08_26_fDOM", 50),
                        rep("CARI_storm9_08_26_SPC", 50),
                        rep("CARI_storm9_08_26_turb", 50),
                        rep("CARI_storm10_08_30_NO3", 50),
                        rep("CARI_storm10_08_30_fDOM", 50),
                        rep("CARI_storm10_08_30_SPC", 50),
                        rep("CARI_storm10_08_30_turb", 50),
                        rep("CARI_storm11_09_02_NO3", 50),
                        rep("CARI_storm11_09_02_fDOM", 50),
                        rep("CARI_storm11_09_02_SPC", 50),
                        rep("CARI_storm11_09_02_turb", 50),
                        rep("CARI_storm12a_09_20_NO3", 50),
                        rep("CARI_storm12a_09_20_fDOM", 50),
                        rep("CARI_storm12a_09_20_SPC", 50),
                        rep("CARI_storm12a_09_20_turb", 50),
                        
                        rep("CARI_storm12b_09_25_fDOM", 50),
                        rep("CARI_storm12b_09_25_SPC", 50),
                        rep("CARI_storm12b_09_25_turb", 50))

CARI.HI.df$storm.ID = as.factor(CARI.HI.df$storm.ID)
CARI.HI.df = separate(data=CARI.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(CARI.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/CARI/CARI.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/CARI/CARI.HI.df.csv")

CARI.HI.df <- read_csv("~/Documents/Storms/Output_from_analysis/HI_plots/2018/CARI/CARI.HI.df.csv")

CARI.HI.df$date <- as.Date(with(CARI.HI.df, paste(month, day, sep = "-")), "%m-%d")
CARI.HI.df$doy <- yday(CARI.HI.df$date) 

g0 <- ggplot(CARI.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/CARI/CARI.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/CARI/CARI.HI.df.doy.csv")

```


# ALL results

```{r}
FRCH.HI.2018 <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.hyst.results.csv")
MOOS.HI.2018 <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/MOOS/MOOS.hyst.results.csv")
CARI.HI.2018 <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/CARI/CARI.hyst.results.csv")

HI.2018 <- rbind(FRCH.HI.2018, MOOS.HI.2018, CARI.HI.2018)

HI.2018$year <- "2018"


all.results <- rbind(HI.2018)

all.results$date <- as.Date(with(all.results, paste(year, month, day,sep="-")), "%Y-%m-%d")
   

all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)

all.results.sig$site.ID <- factor(all.results.sig$site.ID, levels = c('FRCH','MOOS', 'CARI'))
all.results$site.ID <- factor(all.results$site.ID, levels = c('FRCH','MOOS','CARI'))

show_col(brewer_pal(palette="RdBu",-1)(4))
ggplot(all.results.sig) +
  geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
  #scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
  scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
  facet_wrap(~ response) +
  theme_bw()


ggplot(all.results.sig) +
  geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
  scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
  facet_wrap(~ response) +
  theme_bw() +
  geom_errorbar(aes(x=storm.ID, 
                    ymin=HI_mean_Interp-(HI_sd_with_Interp*2), 
                    ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
  geom_hline(yintercept=0)

all.HI.p = ggplot(all.results) +
  geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
  scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
  facet_wrap(~ response, scales = "free_x") +
  theme_bw() +
  geom_errorbar(aes(x=storm.ID, 
                    ymin=HI_mean_Interp-(HI_sd_with_Interp*2), 
                    ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
  geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1))

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/all.HI.p.pdf", plot=all.HI.p, width = 20, height = 10, units ="in")



```













