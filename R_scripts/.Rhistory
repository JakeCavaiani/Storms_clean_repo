POKE_storm4_09_14_Turb <- read_csv(here("Storm_events", "2022", "POKE", "POKE_storm4_09_14_turb.csv"))
POKE_storm4_09_14_abs <- read_csv(here("Storm_events", "2022", "POKE", "POKE_storm4_09_14_abs.csv"))
# normalize
dfList <- Filter(function(x) is(x, "data.frame"), mget(ls()))
for(i in 1:length(dfList)) {
dfList[[i]][["datavalue"]] =
(dfList[[i]][["datavalue"]] - min(dfList[[i]][["datavalue"]], na.rm=T)) / (max(dfList[[i]][["datavalue"]], na.rm=T) - min(dfList[[i]][["datavalue"]], na.rm=T))
}
list2env(dfList ,.GlobalEnv)
#fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(dat_response$datavalue),
color = as.numeric(dat_Q$valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
# NO3 #
POKE_storm1_07_15_NO3.p = hyst_plot(POKE_storm1_07_15_Q, POKE_storm1_07_15_NO3, "POKE", "NO3", "0715")
POKE_storm2_09_03_NO3.p = hyst_plot(POKE_storm2_09_03_Q, POKE_storm2_09_03_NO3, "POKE", "NO3", "0903")
POKE_storm3_09_09_NO3.p = hyst_plot(POKE_storm3_09_09_Q, POKE_storm3_09_09_NO3, "POKE", "NO3", "0909")
POKE_storm4_09_14_NO3.p = hyst_plot(POKE_storm4_09_14_Q, POKE_storm4_09_14_NO3, "POKE", "NO3", "0914")
multiplot(POKE_storm1_07_15_NO3.p)
multiplot(POKE_storm2_09_03_NO3.p)
multiplot(POKE_storm3_09_09_NO3.p)
multiplot(POKE_storm4_09_14_NO3.p)
# fDOM #
POKE_storm1_07_15_fDOM.p = hyst_plot(POKE_storm1_07_15_Q, POKE_storm1_07_15_fDOM, "POKE", "fDOM", "0715")
POKE_storm2_09_03_fDOM.p = hyst_plot(POKE_storm2_09_03_Q, POKE_storm2_09_03_fDOM, "POKE", "fDOM", "0903")
POKE_storm3_09_09_fDOM.p = hyst_plot(POKE_storm3_09_09_Q, POKE_storm3_09_09_fDOM, "POKE", "fDOM", "0909")
POKE_storm4_09_14_fDOM.p = hyst_plot(POKE_storm4_09_14_Q, POKE_storm4_09_14_fDOM, "POKE", "fDOM", "0914")
multiplot(POKE_storm1_07_15_fDOM.p)
multiplot(POKE_storm2_09_03_fDOM.p)
multiplot(POKE_storm3_09_09_fDOM.p)
multiplot(POKE_storm4_09_14_fDOM.p)
# SPC #
POKE_storm1_07_15_SPC.p = hyst_plot(POKE_storm1_07_15_Q, POKE_storm1_07_15_SPC, "POKE", "SPC", "0715")
POKE_storm2_09_03_SPC.p = hyst_plot(POKE_storm2_09_03_Q, POKE_storm2_09_03_SPC, "POKE", "SPC", "0903")
POKE_storm3_09_09_SPC.p = hyst_plot(POKE_storm3_09_09_Q, POKE_storm3_09_09_SPC, "POKE", "SPC", "0909")
POKE_storm4_09_14_SPC.p = hyst_plot(POKE_storm4_09_14_Q, POKE_storm4_09_14_SPC, "POKE", "SPC", "0914")
multiplot(POKE_storm1_07_15_SPC.p)
multiplot(POKE_storm2_09_03_SPC.p)
multiplot(POKE_storm3_09_09_SPC.p)
multiplot(POKE_storm4_09_14_SPC.p)
# turb #
POKE_storm1_07_15_turb.p = hyst_plot(POKE_storm1_07_15_Q, POKE_storm1_07_15_Turb, "POKE", "Turb", "0715")
POKE_storm2_09_03_turb.p = hyst_plot(POKE_storm2_09_03_Q, POKE_storm2_09_03_Turb, "POKE", "Turb", "0903")
POKE_storm3_09_09_turb.p = hyst_plot(POKE_storm3_09_09_Q, POKE_storm3_09_09_Turb, "POKE", "Turb", "0909")
POKE_storm4_09_14_turb.p = hyst_plot(POKE_storm4_09_14_Q, POKE_storm4_09_14_Turb, "POKE", "Turb", "0914")
multiplot(POKE_storm1_07_15_turb.p)
multiplot(POKE_storm2_09_03_turb.p)
multiplot(POKE_storm3_09_09_turb.p)
multiplot(POKE_storm4_09_14_turb.p)
# abs #
POKE_storm1_07_15_abs.p = hyst_plot(POKE_storm1_07_15_Q, POKE_storm1_07_15_abs, "POKE", "abs", "0715")
POKE_storm2_09_03_abs.p = hyst_plot(POKE_storm2_09_03_Q, POKE_storm2_09_03_abs, "POKE", "abs", "0903")
POKE_storm3_09_09_abs.p = hyst_plot(POKE_storm3_09_09_Q, POKE_storm3_09_09_abs, "POKE", "abs", "0909")
POKE_storm4_09_14_abs.p = hyst_plot(POKE_storm4_09_14_Q, POKE_storm4_09_14_abs, "POKE", "abs", "0914")
multiplot(POKE_storm1_07_15_abs.p)
multiplot(POKE_storm2_09_03_abs.p)
multiplot(POKE_storm3_09_09_abs.p)
multiplot(POKE_storm4_09_14_abs.p)
POKE_HI_Loop <- multiplot(POKE_storm1_07_15_NO3.p,POKE_storm1_07_15_fDOM.p, POKE_storm1_07_15_SPC.p,POKE_storm1_07_15_turb.p,POKE_storm1_07_15_abs.p,
POKE_storm2_09_03_NO3.p,POKE_storm2_09_03_fDOM.p, POKE_storm2_09_03_SPC.p,POKE_storm2_09_03_turb.p, POKE_storm2_09_03_abs.p,
POKE_storm3_09_09_NO3.p,POKE_storm3_09_09_fDOM.p, POKE_storm3_09_09_SPC.p,POKE_storm3_09_09_turb.p,POKE_storm3_09_09_abs.p,
POKE_storm4_09_14_NO3.p,POKE_storm4_09_14_fDOM.p, POKE_storm4_09_14_SPC.p,POKE_storm4_09_14_turb.p,POKE_storm4_09_14_abs.p)
VAUL_storm1_08_01_Q <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm1_08_01_Q.csv"))
VAUL_storm1_08_01_NO3 <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm1_08_01_NO3.csv"))
VAUL_storm1_08_01_fDOM <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm1_08_01_fDOM.csv"))
VAUL_storm1_08_01_SPC <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm1_08_01_SPC.csv"))
VAUL_storm1_08_01_Turb <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm1_08_01_turb.csv"))
VAUL_storm1_08_01_abs <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm1_08_01_abs.csv"))
# VAUL_storm2_09_14 <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14.csv"))
VAUL_storm2_09_14_Q <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14_Q.csv"))
VAUL_storm2_09_14_NO3 <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14_NO3.csv"))
VAUL_storm2_09_14_fDOM <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14_fDOM.csv"))
VAUL_storm2_09_14_SPC <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14_SPC.csv"))
VAUL_storm2_09_14_Turb <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14_turb.csv"))
VAUL_storm2_09_14_abs <- read_csv(here("Storm_events", "2022", "VAUL", "VAUL_storm2_09_14_abs.csv"))
# normalize
dfList <- Filter(function(x) is(x, "data.frame"), mget(ls()))
for(i in 1:length(dfList)) {
dfList[[i]][["datavalue"]] =
(dfList[[i]][["datavalue"]] - min(dfList[[i]][["datavalue"]], na.rm=T)) / (max(dfList[[i]][["datavalue"]], na.rm=T) - min(dfList[[i]][["datavalue"]], na.rm=T))
}
list2env(dfList ,.GlobalEnv)
#fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(dat_response$datavalue),
color = as.numeric(dat_Q$valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
# NO3 #
VAUL_storm1_08_01_NO3.p = hyst_plot(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_NO3, "VAUL", "NO3", "0801")
VAUL_storm2_09_14_NO3.p = hyst_plot(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_NO3, "VAUL", "NO3", "0914")
multiplot(VAUL_storm1_08_01_NO3.p)
multiplot(VAUL_storm2_09_14_NO3.p)
# fDOM #
VAUL_storm1_08_01_fDOM.p = hyst_plot(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_fDOM, "VAUL", "fDOM", "0801")
VAUL_storm2_09_14_fDOM.p = hyst_plot(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_fDOM, "VAUL", "fDOM", "0914")
multiplot(VAUL_storm1_08_01_fDOM.p)
multiplot(VAUL_storm2_09_14_fDOM.p)
# SPC #
VAUL_storm1_08_01_SPC.p = hyst_plot(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_SPC, "VAUL", "SPC", "0801")
VAUL_storm2_09_14_SPC.p = hyst_plot(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_SPC, "VAUL", "SPC", "0914")
multiplot(VAUL_storm1_08_01_SPC.p)
multiplot(VAUL_storm2_09_14_SPC.p)
# turb #
VAUL_storm1_08_01_turb.p = hyst_plot(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_Turb, "VAUL", "turb", "0801")
VAUL_storm2_09_14_turb.p = hyst_plot(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_Turb, "VAUL", "turb", "0914")
multiplot(VAUL_storm1_08_01_turb.p)
multiplot(VAUL_storm2_09_14_turb.p)
# abs #
VAUL_storm1_08_01_abs.p = hyst_plot(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_abs, "VAUL", "abs", "0801")
VAUL_storm2_09_14_abs.p = hyst_plot(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_abs, "VAUL", "abs", "0914")
multiplot(VAUL_storm1_08_01_abs.p)
multiplot(VAUL_storm2_09_14_abs.p)
VAUL_HI_Loop <- multiplot(VAUL_storm1_08_01_NO3.p,VAUL_storm1_08_01_fDOM.p, VAUL_storm1_08_01_SPC.p,VAUL_storm1_08_01_turb.p,VAUL_storm1_08_01_abs.p,
VAUL_storm2_09_14_NO3.p,VAUL_storm2_09_14_fDOM.p, VAUL_storm2_09_14_SPC.p,VAUL_storm2_09_14_turb.p, VAUL_storm2_09_14_abs.p)
STRT_storm1_08_19_Q <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm1_08_19_Q.csv"))
STRT_storm1_08_19_NO3 <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm1_08_19_NO3.csv"))
STRT_storm1_08_19_fDOM <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm1_08_19_fDOM.csv"))
STRT_storm1_08_19_SPC <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm1_08_19_SPC.csv"))
STRT_storm1_08_19_Turb <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm1_08_19_turb.csv"))
STRT_storm1_08_19_abs <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm1_08_19_abs.csv"))
# STRT_storm2_09_04 <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04.csv"))
STRT_storm2_09_04_Q <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04_Q.csv"))
STRT_storm2_09_04_NO3 <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04_NO3.csv"))
STRT_storm2_09_04_fDOM <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04_fDOM.csv"))
STRT_storm2_09_04_SPC <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04_SPC.csv"))
STRT_storm2_09_04_Turb <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04_turb.csv"))
STRT_storm2_09_04_abs <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm2_09_04_abs.csv"))
# STRT_storm3_09_22 <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22.csv"))
STRT_storm3_09_22_Q <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22_Q.csv"))
STRT_storm3_09_22_NO3 <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22_NO3.csv"))
STRT_storm3_09_22_fDOM <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22_fDOM.csv"))
STRT_storm3_09_22_SPC <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22_SPC.csv"))
STRT_storm3_09_22_Turb <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22_turb.csv"))
STRT_storm3_09_22_abs <- read_csv(here("Storm_events", "2022", "STRT", "STRT_storm3_09_22_abs.csv"))
# normalize
dfList <- Filter(function(x) is(x, "data.frame"), mget(ls()))
for(i in 1:length(dfList)) {
dfList[[i]][["datavalue"]] =
(dfList[[i]][["datavalue"]] - min(dfList[[i]][["datavalue"]], na.rm=T)) / (max(dfList[[i]][["datavalue"]], na.rm=T) - min(dfList[[i]][["datavalue"]], na.rm=T))
}
list2env(dfList ,.GlobalEnv)
#fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(dat_response$datavalue),
color = as.numeric(dat_Q$valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
# NO3 #
STRT_storm1_08_19_NO3.p = hyst_plot(STRT_storm1_08_19_Q, STRT_storm1_08_19_NO3, "STRT", "NO3", "0819")
STRT_storm2_09_04_NO3.p = hyst_plot(STRT_storm2_09_04_Q, STRT_storm2_09_04_NO3, "STRT", "NO3", "0904")
STRT_storm3_09_22_NO3.p = hyst_plot(STRT_storm3_09_22_Q, STRT_storm3_09_22_NO3, "STRT", "NO3", "0922")
multiplot(STRT_storm1_08_19_NO3.p)
multiplot(STRT_storm2_09_04_NO3.p)
multiplot(STRT_storm3_09_22_NO3.p)
# fDOM #
STRT_storm1_08_19_fDOM.p = hyst_plot(STRT_storm1_08_19_Q, STRT_storm1_08_19_fDOM, "STRT", "fDOM", "0819")
STRT_storm2_09_04_fDOM.p = hyst_plot(STRT_storm2_09_04_Q, STRT_storm2_09_04_fDOM, "STRT", "fDOM", "0904")
STRT_storm3_09_22_fDOM.p = hyst_plot(STRT_storm3_09_22_Q, STRT_storm3_09_22_fDOM, "STRT", "fDOM", "0922")
multiplot(STRT_storm1_08_19_fDOM.p)
multiplot(STRT_storm2_09_04_fDOM.p)
multiplot(STRT_storm3_09_22_fDOM.p)
# SPC #
STRT_storm1_08_19_SPC.p = hyst_plot(STRT_storm1_08_19_Q, STRT_storm1_08_19_SPC, "STRT", "SPC", "0819")
STRT_storm2_09_04_SPC.p = hyst_plot(STRT_storm2_09_04_Q, STRT_storm2_09_04_SPC, "STRT", "SPC", "0904")
STRT_storm3_09_22_SPC.p = hyst_plot(STRT_storm3_09_22_Q, STRT_storm3_09_22_SPC, "STRT", "SPC", "0922")
multiplot(STRT_storm1_08_19_SPC.p)
multiplot(STRT_storm2_09_04_SPC.p)
multiplot(STRT_storm3_09_22_SPC.p)
# turb #
STRT_storm1_08_19_turb.p = hyst_plot(STRT_storm1_08_19_Q, STRT_storm1_08_19_Turb, "STRT", "Turb", "0819")
STRT_storm2_09_04_turb.p = hyst_plot(STRT_storm2_09_04_Q, STRT_storm2_09_04_Turb, "STRT", "Turb", "0904")
STRT_storm3_09_22_turb.p = hyst_plot(STRT_storm3_09_22_Q, STRT_storm3_09_22_Turb, "STRT", "Turb", "0922")
multiplot(STRT_storm1_08_19_turb.p)
multiplot(STRT_storm2_09_04_turb.p)
multiplot(STRT_storm3_09_22_turb.p)
# abs #
STRT_storm1_08_19_abs.p = hyst_plot(STRT_storm1_08_19_Q, STRT_storm1_08_19_abs, "STRT", "abs", "0819")
STRT_storm2_09_04_abs.p = hyst_plot(STRT_storm2_09_04_Q, STRT_storm2_09_04_abs, "STRT", "abs", "0904")
STRT_storm3_09_22_abs.p = hyst_plot(STRT_storm3_09_22_Q, STRT_storm3_09_22_abs, "STRT", "abs", "0922")
multiplot(STRT_storm1_08_19_abs.p)
multiplot(STRT_storm2_09_04_abs.p)
multiplot(STRT_storm3_09_22_abs.p)
STRT_HI_Loop <- multiplot(STRT_storm1_08_19_NO3.p,STRT_storm1_08_19_fDOM.p, STRT_storm1_08_19_SPC.p,STRT_storm1_08_19_turb.p,STRT_storm1_08_19_abs.p,
STRT_storm2_09_04_NO3.p,STRT_storm2_09_04_fDOM.p, STRT_storm2_09_04_SPC.p,STRT_storm2_09_04_turb.p, STRT_storm2_09_04_abs.p,
STRT_storm3_09_22_NO3.p,STRT_storm3_09_22_fDOM.p, STRT_storm3_09_22_SPC.p,STRT_storm3_09_22_turb.p, STRT_storm3_09_22_abs.p)
CARI_storm1_07_15_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm1_07_15_Q.csv"))
CARI_storm1_07_15_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm1_07_15_NO3.csv"))
CARI_storm1_07_15_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm1_07_15_fDOM.csv"))
CARI_storm1_07_15_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm1_07_15_SPC.csv"))
CARI_storm1_07_15_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm1_07_15_turb.csv"))
# CARI_storm2_07_19 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm2_07_19.csv"))
CARI_storm2_07_19_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm2_07_19_Q.csv"))
CARI_storm2_07_19_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm2_07_19_NO3.csv"))
CARI_storm2_07_19_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm2_07_19_fDOM.csv"))
CARI_storm2_07_19_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm2_07_19_SPC.csv"))
CARI_storm2_07_19_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm2_07_19_turb.csv"))
# CARI_storm3_08_01 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm3_08_01.csv"))
CARI_storm3_08_01_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm3_08_01_Q.csv"))
CARI_storm3_08_01_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm3_08_01_NO3.csv"))
CARI_storm3_08_01_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm3_08_01_fDOM.csv"))
CARI_storm3_08_01_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm3_08_01_SPC.csv"))
CARI_storm3_08_01_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm3_08_01_turb.csv"))
# CARI_storm4a_08_05 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4a_08_05.csv"))
CARI_storm4a_08_05_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4a_08_05_Q.csv"))
CARI_storm4a_08_05_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4a_08_05_NO3.csv"))
CARI_storm4a_08_05_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4a_08_05_fDOM.csv"))
CARI_storm4a_08_05_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4a_08_05_SPC.csv"))
CARI_storm4a_08_05_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4a_08_05_turb.csv"))
# CARI_storm4b_08_06 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4b_08_06.csv"))
CARI_storm4b_08_06_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4b_08_06_Q.csv"))
CARI_storm4b_08_06_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4b_08_06_NO3.csv"))
CARI_storm4b_08_06_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4b_08_06_fDOM.csv"))
CARI_storm4b_08_06_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4b_08_06_SPC.csv"))
CARI_storm4b_08_06_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm4b_08_06_turb.csv"))
# CARI_storm5_08_08 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm5_08_08.csv"))
CARI_storm5_08_08_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm5_08_08_Q.csv"))
CARI_storm5_08_08_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm5_08_08_NO3.csv"))
CARI_storm5_08_08_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm5_08_08_fDOM.csv"))
CARI_storm5_08_08_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm5_08_08_SPC.csv"))
CARI_storm5_08_08_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm5_08_08_turb.csv"))
# CARI_storm6_08_15 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm6_08_15.csv"))
CARI_storm6_08_15_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm6_08_15_Q.csv"))
CARI_storm6_08_15_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm6_08_15_NO3.csv"))
CARI_storm6_08_15_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm6_08_15_fDOM.csv"))
CARI_storm6_08_15_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm6_08_15_SPC.csv"))
CARI_storm6_08_15_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm6_08_15_turb.csv"))
# CARI_storm7_08_18 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm7_08_18.csv"))
CARI_storm7_08_18_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm7_08_18_Q.csv"))
CARI_storm7_08_18_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm7_08_18_NO3.csv"))
CARI_storm7_08_18_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm7_08_18_fDOM.csv"))
CARI_storm7_08_18_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm7_08_18_SPC.csv"))
CARI_storm7_08_18_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm7_08_18_turb.csv"))
# CARI_storm8_09_04 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm8_09_04.csv"))
CARI_storm8_09_04_Q <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm8_09_04_Q.csv"))
CARI_storm8_09_04_NO3 <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm8_09_04_NO3.csv"))
CARI_storm8_09_04_fDOM <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm8_09_04_fDOM.csv"))
CARI_storm8_09_04_SPC <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm8_09_04_SPC.csv"))
CARI_storm8_09_04_Turb <- read_csv(here("Storm_events", "2022", "CARI", "CARI_storm8_09_04_turb.csv"))
# normalize
dfList <- Filter(function(x) is(x, "data.frame"), mget(ls()))
for(i in 1:length(dfList)) {
dfList[[i]][["datavalue"]] =
(dfList[[i]][["datavalue"]] - min(dfList[[i]][["datavalue"]], na.rm=T)) / (max(dfList[[i]][["datavalue"]], na.rm=T) - min(dfList[[i]][["datavalue"]], na.rm=T))
}
list2env(dfList ,.GlobalEnv)
#fxn: plot hysteresis loop #
hyst_plot = function(dat_Q, dat_response, site, response_var, storm_num) {
dat.p = ggplot(data = dat_Q,
aes(x=(dat_Q$datavalue),
y=(dat_response$datavalue),
color = as.numeric(dat_Q$valuedatetime))) +
geom_point() +
scale_colour_gradientn(colors = rainbow(3)) +
theme_bw() +
theme(legend.position="none") +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=14,face="bold")) +
ylab(paste(site, response_var))+
xlab("Normalized Discharge") +
ggtitle(paste("Storm", storm_num))
return(dat.p)
}
multiplot <- function(..., plotlist=NULL, file, cols=1, layout=NULL) {
library(grid)
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
CARI_storm1_07_15_NO3.p = hyst_plot(CARI_storm1_07_15_Q, CARI_storm1_07_15_NO3, "CARI", "NO3", "0715")
CARI_storm2_07_19_NO3.p = hyst_plot(CARI_storm2_07_19_Q, CARI_storm2_07_19_NO3, "CARI", "NO3", "0719")
CARI_storm3_08_01_NO3.p = hyst_plot(CARI_storm3_08_01_Q, CARI_storm3_08_01_NO3, "CARI", "NO3", "0801")
CARI_storm4a_08_05_NO3.p = hyst_plot(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_NO3, "CARI", "NO3", "0805a")
CARI_storm4b_08_06_NO3.p = hyst_plot(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_NO3, "CARI", "NO3", "0806b")
CARI_storm5_08_08_NO3.p = hyst_plot(CARI_storm5_08_08_Q, CARI_storm5_08_08_NO3, "CARI", "NO3", "0808")
CARI_storm6_08_15_NO3.p = hyst_plot(CARI_storm6_08_15_Q, CARI_storm6_08_15_NO3, "CARI", "NO3", "0815")
CARI_storm7_08_18_NO3.p = hyst_plot(CARI_storm7_08_18_Q, CARI_storm7_08_18_NO3, "CARI", "NO3", "0818")
CARI_storm8_09_04_NO3.p = hyst_plot(CARI_storm8_09_04_Q, CARI_storm8_09_04_NO3, "CARI", "NO3", "0904")
multiplot(CARI_storm1_07_15_NO3.p)
multiplot(CARI_storm2_07_19_NO3.p)
multiplot(CARI_storm3_08_01_NO3.p)
multiplot(CARI_storm4a_08_05_NO3.p)
multiplot(CARI_storm4b_08_06_NO3.p)
multiplot(CARI_storm5_08_08_NO3.p)
multiplot(CARI_storm6_08_15_NO3.p)
multiplot(CARI_storm7_08_18_NO3.p)
multiplot(CARI_storm8_09_04_NO3.p)
# fDOM #
CARI_storm1_07_15_fDOM.p = hyst_plot(CARI_storm1_07_15_Q, CARI_storm1_07_15_fDOM, "CARI", "fDOM", "0715")
CARI_storm2_07_19_fDOM.p = hyst_plot(CARI_storm2_07_19_Q, CARI_storm2_07_19_fDOM, "CARI", "fDOM", "0719")
CARI_storm3_08_01_fDOM.p = hyst_plot(CARI_storm3_08_01_Q, CARI_storm3_08_01_fDOM, "CARI", "fDOM", "0801")
CARI_storm4a_08_05_fDOM.p = hyst_plot(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_fDOM, "CARI", "fDOM", "0805a")
CARI_storm4b_08_06_fDOM.p = hyst_plot(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_fDOM, "CARI", "fDOM", "0806b")
CARI_storm5_08_08_fDOM.p = hyst_plot(CARI_storm5_08_08_Q, CARI_storm5_08_08_fDOM, "CARI", "fDOM", "0808")
CARI_storm6_08_15_fDOM.p = hyst_plot(CARI_storm6_08_15_Q, CARI_storm6_08_15_fDOM, "CARI", "fDOM", "0815")
CARI_storm7_08_18_fDOM.p = hyst_plot(CARI_storm7_08_18_Q, CARI_storm7_08_18_fDOM, "CARI", "fDOM", "0818")
CARI_storm8_09_04_fDOM.p = hyst_plot(CARI_storm8_09_04_Q, CARI_storm8_09_04_fDOM, "CARI", "fDOM", "0904")
multiplot(CARI_storm1_07_15_fDOM.p)
multiplot(CARI_storm2_07_19_fDOM.p)
multiplot(CARI_storm3_08_01_fDOM.p)
multiplot(CARI_storm4a_08_05_fDOM.p)
multiplot(CARI_storm4b_08_06_fDOM.p)
multiplot(CARI_storm5_08_08_fDOM.p)
multiplot(CARI_storm6_08_15_fDOM.p)
multiplot(CARI_storm7_08_18_fDOM.p)
multiplot(CARI_storm8_09_04_fDOM.p)
# SPC #
CARI_storm1_07_15_SPC.p = hyst_plot(CARI_storm1_07_15_Q, CARI_storm1_07_15_SPC, "CARI", "SPC", "0715")
CARI_storm2_07_19_SPC.p = hyst_plot(CARI_storm2_07_19_Q, CARI_storm2_07_19_SPC, "CARI", "SPC", "0719")
CARI_storm3_08_01_SPC.p = hyst_plot(CARI_storm3_08_01_Q, CARI_storm3_08_01_SPC, "CARI", "SPC", "0801")
CARI_storm4a_08_05_SPC.p = hyst_plot(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_SPC, "CARI", "SPC", "0805a")
CARI_storm4b_08_06_SPC.p = hyst_plot(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_SPC, "CARI", "SPC", "0806b")
CARI_storm5_08_08_SPC.p = hyst_plot(CARI_storm5_08_08_Q, CARI_storm5_08_08_SPC, "CARI", "SPC", "0808")
CARI_storm6_08_15_SPC.p = hyst_plot(CARI_storm6_08_15_Q, CARI_storm6_08_15_SPC, "CARI", "SPC", "0815")
CARI_storm7_08_18_SPC.p = hyst_plot(CARI_storm7_08_18_Q, CARI_storm7_08_18_SPC, "CARI", "SPC", "0818")
CARI_storm8_09_04_SPC.p = hyst_plot(CARI_storm8_09_04_Q, CARI_storm8_09_04_SPC, "CARI", "SPC", "0904")
multiplot(CARI_storm1_07_15_SPC.p)
multiplot(CARI_storm2_07_19_SPC.p)
multiplot(CARI_storm3_08_01_SPC.p)
multiplot(CARI_storm4a_08_05_SPC.p)
multiplot(CARI_storm4b_08_06_SPC.p)
multiplot(CARI_storm5_08_08_SPC.p)
multiplot(CARI_storm6_08_15_SPC.p)
multiplot(CARI_storm7_08_18_SPC.p)
multiplot(CARI_storm8_09_04_SPC.p)
# turb #
CARI_storm1_07_15_turb.p = hyst_plot(CARI_storm1_07_15_Q, CARI_storm1_07_15_Turb, "CARI", "Turb", "0715")
CARI_storm2_07_19_turb.p = hyst_plot(CARI_storm2_07_19_Q, CARI_storm2_07_19_Turb, "CARI", "Turb", "0719")
CARI_storm3_08_01_turb.p = hyst_plot(CARI_storm3_08_01_Q, CARI_storm3_08_01_Turb, "CARI", "Turb", "0801")
CARI_storm4a_08_05_turb.p = hyst_plot(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_Turb, "CARI", "Turb", "0805a")
CARI_storm4b_08_06_turb.p = hyst_plot(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_Turb, "CARI", "Turb", "0806b")
CARI_storm5_08_08_turb.p = hyst_plot(CARI_storm5_08_08_Q, CARI_storm5_08_08_Turb, "CARI", "Turb", "0808")
CARI_storm6_08_15_turb.p = hyst_plot(CARI_storm6_08_15_Q, CARI_storm6_08_15_Turb, "CARI", "Turb", "0815")
CARI_storm7_08_18_turb.p = hyst_plot(CARI_storm7_08_18_Q, CARI_storm7_08_18_Turb, "CARI", "Turb", "0818")
CARI_storm8_09_04_turb.p = hyst_plot(CARI_storm8_09_04_Q, CARI_storm8_09_04_Turb, "CARI", "Turb", "0904")
multiplot(CARI_storm1_07_15_turb.p)
multiplot(CARI_storm2_07_19_turb.p)
multiplot(CARI_storm3_08_01_turb.p)
multiplot(CARI_storm4a_08_05_turb.p)
multiplot(CARI_storm4b_08_06_turb.p)
multiplot(CARI_storm5_08_08_turb.p)
multiplot(CARI_storm6_08_15_turb.p)
multiplot(CARI_storm7_08_18_turb.p)
multiplot(CARI_storm8_09_04_turb.p)
# Plot all the storms that are correct:
CARI_HI_Loop <- multiplot(CARI_storm1_07_15_NO3.p,CARI_storm1_07_15_fDOM.p, CARI_storm1_07_15_SPC.p,CARI_storm1_07_15_turb.p,
CARI_storm2_07_19_NO3.p,CARI_storm2_07_19_fDOM.p, CARI_storm2_07_19_SPC.p,CARI_storm2_07_19_turb.p,
CARI_storm3_08_01_NO3.p,CARI_storm3_08_01_fDOM.p, CARI_storm3_08_01_SPC.p,CARI_storm3_08_01_turb.p,
CARI_storm4a_08_05_NO3.p,CARI_storm4a_08_05_fDOM.p, CARI_storm4a_08_05_SPC.p,CARI_storm4a_08_05_turb.p,
CARI_storm4b_08_06_NO3.p,CARI_storm4b_08_06_fDOM.p, CARI_storm4b_08_06_SPC.p,CARI_storm4b_08_06_turb.p,
CARI_storm5_08_08_NO3.p,CARI_storm5_08_08_fDOM.p, CARI_storm5_08_08_SPC.p,CARI_storm5_08_08_turb.p,
CARI_storm6_08_15_NO3.p,CARI_storm6_08_15_fDOM.p, CARI_storm6_08_15_SPC.p,CARI_storm6_08_15_turb.p,
CARI_storm7_08_18_NO3.p,CARI_storm7_08_18_fDOM.p, CARI_storm7_08_18_SPC.p,CARI_storm7_08_18_turb.p,
CARI_storm8_09_04_NO3.p,CARI_storm8_09_04_fDOM.p, CARI_storm8_09_04_SPC.p,CARI_storm8_09_04_turb.p)
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(boot)
library(lubridate)
library(here)
Sys.which("python")
use_python("/usr/local/bin/python3")
options(tz="America/Anchorage")
# install pandas #
virtualenv_create("r-reticulate")
# RETICULATE_PYTHON = "lib/python3.8"
reticulate::py_config()
reticulate::py_install("pandas")
reticulate::repl_python()
