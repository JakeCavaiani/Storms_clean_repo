---
title: "HI_FI"
author: "Jake Cavaiani"
date: "8/29/2022"
output: pdf_document
---
The purpose of this script is generate HI for each storm for each constituent
Input: Storm csv's
Step 1) import individual storm csv's
Step 2) Run it through the HI function
Step 3) Export HI csv's for each site for each year
Output: HI csv's for each site for each year 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(reticulate)
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(boot)
library(lubridate)
library(here)
Sys.which("python")
use_python("/usr/local/bin/python3")

options(tz="America/Anchorage")


# install pandas #
virtualenv_create("r-reticulate")
# RETICULATE_PYTHON = "lib/python3.8"
reticulate::py_config()
reticulate::py_install("pandas")

```


# Python setup
```{python}
import pyprojroot
from pyprojroot.here import here
import pickle
import pandas
import pandas as pd
import datetime
from hysteresis_metrics import hysteresisMetrics
pd.set_option('display.max_columns', 500)
pd.set_option('display.width', 1000)
quit()

```

### Load data to pandas 2015
```{python}

# FRCH #
FRCH_storm1_07_01_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm1_07_01_Q.csv'))
FRCH_storm1_07_01_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm1_07_01_NO3.csv'))
FRCH_storm1_07_01_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm1_07_01_fDOM.csv'))
FRCH_storm1_07_01_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm1_07_01_SPC.csv'))
FRCH_storm1_07_01_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm1_07_01_turb.csv'))
FRCH_storm1_07_01_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm1_07_01_abs.csv'))

FRCH_storm2_07_19_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm2_07_19_Q.csv'))
FRCH_storm2_07_19_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm2_07_19_NO3.csv'))
FRCH_storm2_07_19_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm2_07_19_fDOM.csv'))
FRCH_storm2_07_19_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm2_07_19_SPC.csv'))
FRCH_storm2_07_19_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm2_07_19_turb.csv'))
FRCH_storm2_07_19_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm2_07_19_abs.csv'))

FRCH_storm3_07_26_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm3_07_26_Q.csv'))
FRCH_storm3_07_26_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm3_07_26_NO3.csv'))
FRCH_storm3_07_26_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm3_07_26_fDOM.csv'))
FRCH_storm3_07_26_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm3_07_26_SPC.csv'))
FRCH_storm3_07_26_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm3_07_26_turb.csv'))
FRCH_storm3_07_26_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm3_07_26_abs.csv'))

FRCH_storm4_08_12_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm4_08_12_Q.csv'))
FRCH_storm4_08_12_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm4_08_12_NO3.csv'))
FRCH_storm4_08_12_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm4_08_12_fDOM.csv'))
FRCH_storm4_08_12_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm4_08_12_SPC.csv'))
FRCH_storm4_08_12_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm4_08_12_turb.csv'))
FRCH_storm4_08_12_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm4_08_12_abs.csv'))

FRCH_storm5a_08_18_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm5a_08_18_Q.csv'))
FRCH_storm5a_08_18_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm5a_08_18_NO3.csv'))
FRCH_storm5a_08_18_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm5a_08_18_fDOM.csv'))
FRCH_storm5a_08_18_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm5a_08_18_SPC.csv'))
FRCH_storm5a_08_18_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm5a_08_18_turb.csv'))
FRCH_storm5a_08_18_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm5a_08_18_abs.csv'))

FRCH_storm6a_08_25_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_Q.csv'))
FRCH_storm6a_08_25_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_NO3.csv'))
FRCH_storm6a_08_25_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_fDOM.csv'))
FRCH_storm6a_08_25_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_SPC.csv'))
FRCH_storm6a_08_25_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_turb.csv'))
FRCH_storm6a_08_25_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_abs.csv'))

FRCH_storm6a_08_25_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_Q.csv'))
FRCH_storm6a_08_25_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_NO3.csv'))
FRCH_storm6a_08_25_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_fDOM.csv'))
FRCH_storm6a_08_25_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_SPC.csv'))
FRCH_storm6a_08_25_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_turb.csv'))
FRCH_storm6a_08_25_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm6a_08_25_abs.csv'))

FRCH_storm7_09_13_Q = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm7_09_13_Q.csv'))
FRCH_storm7_09_13_NO3 = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm7_09_13_NO3.csv'))
FRCH_storm7_09_13_fDOM = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm7_09_13_fDOM.csv'))
FRCH_storm7_09_13_SPC = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm7_09_13_SPC.csv'))
FRCH_storm7_09_13_turb = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm7_09_13_turb.csv'))
FRCH_storm7_09_13_abs = pd.read_csv(here('Storm_events/2015/FRCH/FRCH_storm7_09_13_abs.csv'))

```

FRCH_storms
```{python}
## NO3 ##
FRCH_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_01_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_01_NO3 = hysteresisMetrics(FRCH_storm1_07_01_Q, FRCH_storm1_07_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_19_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_19_NO3 = hysteresisMetrics(FRCH_storm2_07_19_Q, FRCH_storm2_07_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_26_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_26_NO3 = hysteresisMetrics(FRCH_storm3_07_26_Q, FRCH_storm3_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_12_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_12_NO3 = hysteresisMetrics(FRCH_storm4_08_12_Q, FRCH_storm4_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_18_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_18_NO3 = hysteresisMetrics(FRCH_storm5a_08_18_Q, FRCH_storm5a_08_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm6a_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_25_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_25_NO3 = hysteresisMetrics(FRCH_storm6a_08_25_Q, FRCH_storm6a_08_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm7_09_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_09_13_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_09_13_NO3 = hysteresisMetrics(FRCH_storm7_09_13_Q, FRCH_storm7_09_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
FRCH_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_01_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_01_fDOM = hysteresisMetrics(FRCH_storm1_07_01_Q, FRCH_storm1_07_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_19_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_19_fDOM = hysteresisMetrics(FRCH_storm2_07_19_Q, FRCH_storm2_07_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_26_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_26_fDOM = hysteresisMetrics(FRCH_storm3_07_26_Q, FRCH_storm3_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_12_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_12_fDOM = hysteresisMetrics(FRCH_storm4_08_12_Q, FRCH_storm4_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_18_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_18_fDOM = hysteresisMetrics(FRCH_storm5a_08_18_Q, FRCH_storm5a_08_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm6a_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_25_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_25_fDOM = hysteresisMetrics(FRCH_storm6a_08_25_Q, FRCH_storm6a_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm7_09_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_09_13_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_09_13_fDOM = hysteresisMetrics(FRCH_storm7_09_13_Q, FRCH_storm7_09_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
FRCH_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_01_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_01_SPC = hysteresisMetrics(FRCH_storm1_07_01_Q, FRCH_storm1_07_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_19_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_19_SPC = hysteresisMetrics(FRCH_storm2_07_19_Q, FRCH_storm2_07_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_26_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_26_SPC = hysteresisMetrics(FRCH_storm3_07_26_Q, FRCH_storm3_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_12_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_12_SPC = hysteresisMetrics(FRCH_storm4_08_12_Q, FRCH_storm4_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_18_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_18_SPC = hysteresisMetrics(FRCH_storm5a_08_18_Q, FRCH_storm5a_08_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm6a_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_25_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_25_SPC = hysteresisMetrics(FRCH_storm6a_08_25_Q, FRCH_storm6a_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_09_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_09_13_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_09_13_SPC = hysteresisMetrics(FRCH_storm7_09_13_Q, FRCH_storm7_09_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
FRCH_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_01_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_01_turb = hysteresisMetrics(FRCH_storm1_07_01_Q, FRCH_storm1_07_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_19_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_19_turb= hysteresisMetrics(FRCH_storm2_07_19_Q, FRCH_storm2_07_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_26_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_26_turb = hysteresisMetrics(FRCH_storm3_07_26_Q, FRCH_storm3_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_12_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_12_turb = hysteresisMetrics(FRCH_storm4_08_12_Q, FRCH_storm4_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_18_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_18_turb = hysteresisMetrics(FRCH_storm5a_08_18_Q, FRCH_storm5a_08_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm6a_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_25_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_25_turb = hysteresisMetrics(FRCH_storm6a_08_25_Q, FRCH_storm6a_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm7_09_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_09_13_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_09_13_turb = hysteresisMetrics(FRCH_storm7_09_13_Q, FRCH_storm7_09_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
FRCH_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_01_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_01_abs = hysteresisMetrics(FRCH_storm1_07_01_Q, FRCH_storm1_07_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_19_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_19_abs= hysteresisMetrics(FRCH_storm2_07_19_Q, FRCH_storm2_07_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_26_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_26_abs = hysteresisMetrics(FRCH_storm3_07_26_Q, FRCH_storm3_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_12_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_12_abs = hysteresisMetrics(FRCH_storm4_08_12_Q, FRCH_storm4_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_18_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_18_abs = hysteresisMetrics(FRCH_storm5a_08_18_Q, FRCH_storm5a_08_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm6a_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_25_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_25_abs = hysteresisMetrics(FRCH_storm6a_08_25_Q, FRCH_storm6a_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm7_09_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_09_13_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm7_09_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_09_13_abs = hysteresisMetrics(FRCH_storm7_09_13_Q, FRCH_storm7_09_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


FRCH results
```{r}
FRCH.hyst.results.list = list(py$hysdict_FRCH_storm1_07_01_NO3,
                              py$hysdict_FRCH_storm1_07_01_fDOM,
                              py$hysdict_FRCH_storm1_07_01_SPC,
                              py$hysdict_FRCH_storm1_07_01_turb,
                              py$hysdict_FRCH_storm1_07_01_abs,
                              
                              py$hysdict_FRCH_storm2_07_19_fDOM,
                              py$hysdict_FRCH_storm2_07_19_SPC,
                              py$hysdict_FRCH_storm2_07_19_turb,
                              
                              py$hysdict_FRCH_storm3_07_26_NO3,
                              py$hysdict_FRCH_storm3_07_26_fDOM,
                              py$hysdict_FRCH_storm3_07_26_SPC,
                              py$hysdict_FRCH_storm3_07_26_turb,
                              py$hysdict_FRCH_storm3_07_26_abs,
                              py$hysdict_FRCH_storm4_08_12_NO3,
                              py$hysdict_FRCH_storm4_08_12_fDOM,
                              py$hysdict_FRCH_storm4_08_12_SPC,
                              py$hysdict_FRCH_storm4_08_12_turb,
                              py$hysdict_FRCH_storm4_08_12_abs,
                              py$hysdict_FRCH_storm5a_08_18_NO3,
                              py$hysdict_FRCH_storm5a_08_18_fDOM,
                              py$hysdict_FRCH_storm5a_08_18_SPC,
                              py$hysdict_FRCH_storm5a_08_18_turb,
                              py$hysdict_FRCH_storm5a_08_18_abs,
                              
                             
                              py$hysdict_FRCH_storm6a_08_25_fDOM,
                              py$hysdict_FRCH_storm6a_08_25_SPC,
                              py$hysdict_FRCH_storm6a_08_25_turb,
                              
                              
                              
                             
                              py$hysdict_FRCH_storm7_09_13_NO3,
                              py$hysdict_FRCH_storm7_09_13_fDOM,
                              py$hysdict_FRCH_storm7_09_13_SPC,
                              py$hysdict_FRCH_storm7_09_13_turb,
                              py$hysdict_FRCH_storm7_09_13_abs)
                              
                              

                              
                                                  
                      
                          

FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm1_07_01_NO3",
                                  "FRCH_storm1_07_01_fDOM",
                                  "FRCH_storm1_07_01_SPC",
                                  "FRCH_storm1_07_01_turb",
                                  "FRCH_storm1_07_01_abs",
                                  
                                  "FRCH_storm2_07_19_fDOM",
                                  "FRCH_storm2_07_19_SPC",
                                  "FRCH_storm2_07_19_turb",
                                  
                                  "FRCH_storm3_07_26_NO3",
                                  "FRCH_storm3_07_26_fDOM",
                                  "FRCH_storm3_07_26_SPC",
                                  "FRCH_storm3_07_26_turb",
                                  "FRCH_storm3_07_26_abs",
                                  "FRCH_storm4_08_12_NO3",
                                  "FRCH_storm4_08_12_fDOM",
                                  "FRCH_storm4_08_12_SPC",
                                  "FRCH_storm4_08_12_turb",
                                  "FRCH_storm4_08_12_abs",
                                  "FRCH_storm5a_08_18_NO3",
                                  "FRCH_storm5a_08_18_fDOM",
                                  "FRCH_storm5a_08_18_SPC",
                                  "FRCH_storm5a_08_18_turb",
                                  "FRCH_storm5a_08_18_abs",
                                
                                  
                                  "FRCH_storm6a_08_25_fDOM",
                                  "FRCH_storm6a_08_25_SPC",
                                  "FRCH_storm6a_08_25_turb",
                                  
                                
                                  
                                  "FRCH_storm7_09_13_NO3",
                                  "FRCH_storm7_09_13_fDOM",
                                  "FRCH_storm7_09_13_SPC",
                                  "FRCH_storm7_09_13_turb",
                                  "FRCH_storm7_09_13_abs")


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, "~/GitHub/Storms_clean_repo/Output_from_analysis/03_HI_FI/2015/FRCH/FRCH.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
# pdf("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(rep("FRCH_storm1_07_01_NO3", 50),
                        rep("FRCH_storm1_07_01_fDOM", 50),
                        rep("FRCH_storm1_07_01_SPC", 50),
                        rep("FRCH_storm1_07_01_turb", 50),
                        rep("FRCH_storm1_07_01_abs", 50),
                        
                        rep("FRCH_storm2_07_19_fDOM", 50),
                        rep("FRCH_storm2_07_19_SPC", 50),
                        rep("FRCH_storm2_07_19_turb", 50),
                        
                        rep("FRCH_storm3_07_26_NO3", 50),
                        rep("FRCH_storm3_07_26_fDOM", 50),
                        rep("FRCH_storm3_07_26_SPC", 50),
                        rep("FRCH_storm3_07_26_turb", 50),
                        rep("FRCH_storm3_07_26_abs", 50),
                        rep("FRCH_storm4_08_12_NO3", 50),
                        rep("FRCH_storm4_08_12_fDOM", 50),
                        rep("FRCH_storm4_08_12_SPC", 50),
                        rep("FRCH_storm4_08_12_turb", 50),
                        rep("FRCH_storm4_08_12_abs", 50),
                        rep("FRCH_storm5a_08_18_NO3", 50),
                        rep("FRCH_storm5a_08_18_fDOM", 50),
                        rep("FRCH_storm5a_08_18_SPC", 50),
                        rep("FRCH_storm5a_08_18_turb", 50),
                        rep("FRCH_storm5a_08_18_abs", 50),
                       
                        rep("FRCH_storm6a_08_25_fDOM", 50),
                        rep("FRCH_storm6a_08_25_SPC", 50),
                        rep("FRCH_storm6a_08_25_turb", 50),
                        
                       
                        
                        rep("FRCH_storm7_09_13_NO3", 50),
                        rep("FRCH_storm7_09_13_fDOM", 50),
                        rep("FRCH_storm7_09_13_SPC", 50),
                        rep("FRCH_storm7_09_13_turb", 50),
                        rep("FRCH_storm7_09_13_abs", 50))
                        
                       
                   

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/GitHub/Storms_clean_repo/plots/HI_plots/2015/FRCH/FRCH.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/GitHub/Storms_clean_repo/Output_from_analysis/03_HI_FI/2015/FRCH/FRCH.HI.df.csv")

FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/GitHub/Storms_clean_repo/plots/HI_plots/2015/FRCH/FRCH.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/GitHub/Storms_clean_repo/Output_from_analysis/03_HI_FI/2015/FRCH/FRCH.HI.df.doy.csv")

```

### MOOS
```{python}
# MOOS #
MOOS_storm1_07_01_Q = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm1_07_01_Q.csv'))
MOOS_storm1_07_01_NO3 = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm1_07_01_NO3.csv'))
MOOS_storm1_07_01_fDOM = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm1_07_01_fDOM.csv'))
MOOS_storm1_07_01_SPC = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm1_07_01_SPC.csv'))
MOOS_storm1_07_01_turb = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm1_07_01_turb.csv'))
MOOS_storm1_07_01_abs = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm1_07_01_abs.csv'))

MOOS_storm2_07_18_Q = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm2_07_18_Q.csv'))
MOOS_storm2_07_18_NO3 = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm2_07_18_NO3.csv'))
MOOS_storm2_07_18_fDOM = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm2_07_18_fDOM.csv'))
MOOS_storm2_07_18_SPC = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm2_07_18_SPC.csv'))
MOOS_storm2_07_18_turb = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm2_07_18_turb.csv'))
MOOS_storm2_07_18_abs = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm2_07_18_abs.csv'))

MOOS_storm3a_07_27_Q = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm3a_07_27_Q.csv'))
MOOS_storm3a_07_27_NO3 = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm3a_07_27_NO3.csv'))
MOOS_storm3a_07_27_fDOM = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm3a_07_27_fDOM.csv'))
MOOS_storm3a_07_27_SPC = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm3a_07_27_SPC.csv'))
MOOS_storm3a_07_27_turb = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm3a_07_27_turb.csv'))
MOOS_storm3a_07_27_abs = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm3a_07_27_abs.csv'))

MOOS_storm4_08_16_Q = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm4_08_16_Q.csv'))
MOOS_storm4_08_16_NO3 = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm4_08_16_NO3.csv'))
MOOS_storm4_08_16_fDOM = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm4_08_16_fDOM.csv'))
MOOS_storm4_08_16_SPC = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm4_08_16_SPC.csv'))
MOOS_storm4_08_16_turb = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm4_08_16_turb.csv'))
MOOS_storm4_08_16_abs = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm4_08_16_abs.csv'))

MOOS_storm5_08_25_Q = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm5_08_25_Q.csv'))
MOOS_storm5_08_25_NO3 = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm5_08_25_NO3.csv'))
MOOS_storm5_08_25_fDOM = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm5_08_25_fDOM.csv'))
MOOS_storm5_08_25_SPC = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm5_08_25_SPC.csv'))
MOOS_storm5_08_25_turb = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm5_08_25_turb.csv'))
MOOS_storm5_08_25_abs = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm5_08_25_abs.csv'))

MOOS_storm6_09_14_Q = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm6_09_14_Q.csv'))
MOOS_storm6_09_14_NO3 = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm6_09_14_NO3.csv'))
MOOS_storm6_09_14_fDOM = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm6_09_14_fDOM.csv'))
MOOS_storm6_09_14_SPC = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm6_09_14_SPC.csv'))
MOOS_storm6_09_14_turb = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm6_09_14_turb.csv'))
MOOS_storm6_09_14_abs = pd.read_csv(here('Storm_events/2015/MOOS/MOOS_storm6_09_14_abs.csv'))

```

MOOS_storms
```{python}
## NO3 ##
MOOS_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_01_NO3 = hysteresisMetrics(MOOS_storm1_07_01_Q, MOOS_storm1_07_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_18_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_18_NO3 = hysteresisMetrics(MOOS_storm2_07_18_Q, MOOS_storm2_07_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_07_27_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_07_27_NO3 = hysteresisMetrics(MOOS_storm3a_07_27_Q, MOOS_storm3a_07_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm4_08_16_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_08_16_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_08_16_NO3 = hysteresisMetrics(MOOS_storm4_08_16_Q, MOOS_storm4_08_16_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_25_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_25_NO3 = hysteresisMetrics(MOOS_storm5_08_25_Q, MOOS_storm5_08_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_09_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_09_14_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_09_14_NO3 = hysteresisMetrics(MOOS_storm6_09_14_Q, MOOS_storm6_09_14_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
MOOS_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_01_fDOM = hysteresisMetrics(MOOS_storm1_07_01_Q, MOOS_storm1_07_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_18_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_18_fDOM = hysteresisMetrics(MOOS_storm2_07_18_Q, MOOS_storm2_07_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_07_27_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_07_27_fDOM = hysteresisMetrics(MOOS_storm3a_07_27_Q, MOOS_storm3a_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm4_08_16_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_08_16_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_08_16_fDOM = hysteresisMetrics(MOOS_storm4_08_16_Q, MOOS_storm4_08_16_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_25_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_25_fDOM = hysteresisMetrics(MOOS_storm5_08_25_Q, MOOS_storm5_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_09_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_09_14_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_09_14_fDOM = hysteresisMetrics(MOOS_storm6_09_14_Q, MOOS_storm6_09_14_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
MOOS_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_01_SPC = hysteresisMetrics(MOOS_storm1_07_01_Q, MOOS_storm1_07_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_18_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_18_SPC = hysteresisMetrics(MOOS_storm2_07_18_Q, MOOS_storm2_07_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_07_27_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_07_27_SPC = hysteresisMetrics(MOOS_storm3a_07_27_Q, MOOS_storm3a_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm4_08_16_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_08_16_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_08_16_SPC = hysteresisMetrics(MOOS_storm4_08_16_Q, MOOS_storm4_08_16_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_25_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_25_SPC = hysteresisMetrics(MOOS_storm5_08_25_Q, MOOS_storm5_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_09_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_09_14_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_09_14_SPC = hysteresisMetrics(MOOS_storm6_09_14_Q, MOOS_storm6_09_14_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
MOOS_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_01_turb = hysteresisMetrics(MOOS_storm1_07_01_Q, MOOS_storm1_07_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_18_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_18_turb = hysteresisMetrics(MOOS_storm2_07_18_Q, MOOS_storm2_07_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_07_27_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_07_27_turb = hysteresisMetrics(MOOS_storm3a_07_27_Q, MOOS_storm3a_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm4_08_16_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_08_16_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_08_16_turb = hysteresisMetrics(MOOS_storm4_08_16_Q, MOOS_storm4_08_16_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_25_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_25_turb = hysteresisMetrics(MOOS_storm5_08_25_Q, MOOS_storm5_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_09_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_09_14_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_09_14_turb = hysteresisMetrics(MOOS_storm6_09_14_Q, MOOS_storm6_09_14_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## abs ##
MOOS_storm1_07_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_01_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_01_abs = hysteresisMetrics(MOOS_storm1_07_01_Q, MOOS_storm1_07_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_18_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_18_abs = hysteresisMetrics(MOOS_storm2_07_18_Q, MOOS_storm2_07_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_07_27_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_07_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_07_27_abs = hysteresisMetrics(MOOS_storm3a_07_27_Q, MOOS_storm3a_07_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm4_08_16_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_08_16_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm4_08_16_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_08_16_abs = hysteresisMetrics(MOOS_storm4_08_16_Q, MOOS_storm4_08_16_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_25_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_25_abs = hysteresisMetrics(MOOS_storm5_08_25_Q, MOOS_storm5_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_09_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_09_14_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6_09_14_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_09_14_abs = hysteresisMetrics(MOOS_storm6_09_14_Q, MOOS_storm6_09_14_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

MOOS results
```{r}
MOOS.hyst.results.list = list(py$hysdict_MOOS_storm1_07_01_NO3,
                              py$hysdict_MOOS_storm1_07_01_fDOM,
                              py$hysdict_MOOS_storm1_07_01_SPC,
                              py$hysdict_MOOS_storm1_07_01_turb,
                              py$hysdict_MOOS_storm1_07_01_abs,
                              py$hysdict_MOOS_storm2_07_18_NO3,
                              py$hysdict_MOOS_storm2_07_18_fDOM,
                              py$hysdict_MOOS_storm2_07_18_SPC,
                              py$hysdict_MOOS_storm2_07_18_turb,
                              
                              py$hysdict_MOOS_storm3a_07_27_NO3,
                              
                              
                              
                              py$hysdict_MOOS_storm3a_07_27_abs,
                              
                              
                              
                              
                              
                              py$hysdict_MOOS_storm4_08_16_NO3,
                              py$hysdict_MOOS_storm4_08_16_fDOM,
                              py$hysdict_MOOS_storm4_08_16_SPC,
                              py$hysdict_MOOS_storm4_08_16_turb,
                              py$hysdict_MOOS_storm4_08_16_abs,
                              
                              py$hysdict_MOOS_storm5_08_25_fDOM,
                              
                              py$hysdict_MOOS_storm5_08_25_turb,
                              
                              py$hysdict_MOOS_storm6_09_14_NO3,
                              py$hysdict_MOOS_storm6_09_14_fDOM,
                              py$hysdict_MOOS_storm6_09_14_SPC,
                              py$hysdict_MOOS_storm6_09_14_turb,
                              py$hysdict_MOOS_storm6_09_14_abs
                              )
                              
                              
                              

MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c("MOOS_storm1_07_01_NO3",
                                  "MOOS_storm1_07_01_fDOM",
                                  "MOOS_storm1_07_01_SPC",
                                  "MOOS_storm1_07_01_turb",
                                  "MOOS_storm1_07_01_abs",
                                  "MOOS_storm2_07_18_NO3",
                                  "MOOS_storm2_07_18_fDOM",
                                  "MOOS_storm2_07_18_SPC",
                                  "MOOS_storm2_07_18_turb",
                                  
                                  "MOOS_storm3a_07_27_NO3",
                                 
                                  
                                  
                                  "MOOS_storm3a_07_27_abs",
                                  
                                 
                                  
                                  
                                  
                                  "MOOS_storm4_08_16_NO3",
                                  "MOOS_storm4_08_16_fDOM",
                                  "MOOS_storm4_08_16_SPC",
                                  "MOOS_storm4_08_16_turb",
                                  "MOOS_storm4_08_16_abs",
                                  
                                  "MOOS_storm5_08_25_fDOM",
                                  
                                  "MOOS_storm5_08_25_turb",
                                  
                                  "MOOS_storm6_09_14_NO3",
                                  "MOOS_storm6_09_14_fDOM",
                                  "MOOS_storm6_09_14_SPC",
                                  "MOOS_storm6_09_14_turb",
                                  "MOOS_storm6_09_14_abs")
                                  


MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, here("Output_from_analysis", "03_HI_FI", "2015", "MOOS", "MOOS.hyst.results.csv"))


# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(rep("MOOS_storm1_07_01_NO3", 50),
                        rep("MOOS_storm1_07_01_fDOM", 50),
                        rep("MOOS_storm1_07_01_SPC", 50),
                        rep("MOOS_storm1_07_01_turb", 50),
                        rep("MOOS_storm1_07_01_abs", 50),
                        rep("MOOS_storm2_07_18_NO3", 49),
                        rep("MOOS_storm2_07_18_fDOM", 50),
                        rep("MOOS_storm2_07_18_SPC", 50),
                        rep("MOOS_storm2_07_18_turb", 50),
                        
                        rep("MOOS_storm3a_07_27_NO3", 50),
                        
                        
                        
                        rep("MOOS_storm3a_07_27_abs", 50),
                        
                        
                        
                        
                        
                        rep("MOOS_storm4_08_16_NO3", 50),
                        rep("MOOS_storm4_08_16_fDOM", 50),
                        rep("MOOS_storm4_08_16_SPC", 50),
                        rep("MOOS_storm4_08_16_turb", 50),
                        rep("MOOS_storm4_08_16_abs", 50),
                        
                        rep("MOOS_storm5_08_25_fDOM", 50),
                        
                        rep("MOOS_storm5_08_25_turb", 50),
                        
                        rep("MOOS_storm6_09_14_NO3", 50),
                        rep("MOOS_storm6_09_14_fDOM", 50),
                        rep("MOOS_storm6_09_14_SPC", 50),
                        rep("MOOS_storm6_09_14_turb", 50),
                        rep("MOOS_storm6_09_14_abs", 50))
                        
                        
                        

MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2015", "MOOS", "MOOS.HI.median.boot.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(MOOS.HI.df, here("Output_from_analysis", "03_HI_FI", "2015", "MOOS", "MOOS.HI.df.csv"))



MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2015", "MOOS", "MOOS.HI.median.boot.doy.pdf"), plot = g2,
       width = 8, height = 6, units = "in")


write.csv(MOOS.HI.df, here("Output_from_analysis", "03_HI_FI", "2015", "MOOS", "MOOS.HI.df.doy.csv"))

```


### Load data to pandas 2018
```{python}
# FRCH #
FRCH_storm1_06_21_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm1_06_21_Q.csv'))
FRCH_storm1_06_21_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm1_06_21_NO3.csv'))
FRCH_storm1_06_21_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm1_06_21_fDOM.csv'))
FRCH_storm1_06_21_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm1_06_21_SPC.csv'))
FRCH_storm1_06_21_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm1_06_21_turb.csv'))
FRCH_storm1_06_21_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm1_06_21_abs.csv'))

FRCH_storm2a_06_30_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm2a_06_30_Q.csv'))
FRCH_storm2a_06_30_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm2a_06_30_NO3.csv'))
FRCH_storm2a_06_30_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm2a_06_30_fDOM.csv'))
FRCH_storm2a_06_30_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm2a_06_30_SPC.csv'))
FRCH_storm2a_06_30_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm2a_06_30_turb.csv'))
FRCH_storm2a_06_30_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm2a_06_30_abs.csv'))

FRCH_storm3_07_11_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm3_07_11_Q.csv'))
FRCH_storm3_07_11_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm3_07_11_NO3.csv'))
FRCH_storm3_07_11_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm3_07_11_fDOM.csv'))
FRCH_storm3_07_11_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm3_07_11_SPC.csv'))
FRCH_storm3_07_11_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm3_07_11_turb.csv'))
FRCH_storm3_07_11_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm3_07_11_abs.csv'))

FRCH_storm4a_07_15_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4a_07_15_Q.csv'))
FRCH_storm4a_07_15_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4a_07_15_NO3.csv'))
FRCH_storm4a_07_15_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4a_07_15_fDOM.csv'))
FRCH_storm4a_07_15_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4a_07_15_SPC.csv'))
FRCH_storm4a_07_15_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4a_07_15_turb.csv'))
FRCH_storm4a_07_15_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4a_07_15_abs.csv'))

FRCH_storm4b_07_17_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4b_07_17_Q.csv'))
FRCH_storm4b_07_17_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4b_07_17_NO3.csv'))
FRCH_storm4b_07_17_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4b_07_17_fDOM.csv'))
FRCH_storm4b_07_17_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4b_07_17_SPC.csv'))
FRCH_storm4b_07_17_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4b_07_17_turb.csv'))
FRCH_storm4b_07_17_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm4b_07_17_abs.csv'))

FRCH_storm5_08_05_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm5_08_05_Q.csv'))
FRCH_storm5_08_05_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm5_08_05_NO3.csv'))
FRCH_storm5_08_05_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm5_08_05_fDOM.csv'))
FRCH_storm5_08_05_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm5_08_05_SPC.csv'))
FRCH_storm5_08_05_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm5_08_05_turb.csv'))
FRCH_storm5_08_05_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm5_08_05_abs.csv'))

FRCH_storm6_08_13_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm6_08_13_Q.csv'))
FRCH_storm6_08_13_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm6_08_13_NO3.csv'))
FRCH_storm6_08_13_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm6_08_13_fDOM.csv'))
FRCH_storm6_08_13_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm6_08_13_SPC.csv'))
FRCH_storm6_08_13_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm6_08_13_turb.csv'))
FRCH_storm6_08_13_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm6_08_13_abs.csv'))

FRCH_storm7_08_24_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm7_08_24_Q.csv'))
FRCH_storm7_08_24_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm7_08_24_NO3.csv'))
FRCH_storm7_08_24_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm7_08_24_fDOM.csv'))
FRCH_storm7_08_24_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm7_08_24_SPC.csv'))
FRCH_storm7_08_24_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm7_08_24_turb.csv'))
FRCH_storm7_08_24_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm7_08_24_abs.csv'))

FRCH_storm8a_08_26_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm8a_08_26_Q.csv'))
FRCH_storm8a_08_26_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm8a_08_26_NO3.csv'))
FRCH_storm8a_08_26_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm8a_08_26_fDOM.csv'))
FRCH_storm8a_08_26_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm8a_08_26_SPC.csv'))
FRCH_storm8a_08_26_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm8a_08_26_turb.csv'))
FRCH_storm8a_08_26_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm8a_08_26_abs.csv'))

FRCH_storm9_08_30_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm9_08_30_Q.csv'))
FRCH_storm9_08_30_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm9_08_30_NO3.csv'))
FRCH_storm9_08_30_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm9_08_30_fDOM.csv'))
FRCH_storm9_08_30_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm9_08_30_SPC.csv'))
FRCH_storm9_08_30_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm9_08_30_turb.csv'))
FRCH_storm9_08_30_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm9_08_30_abs.csv'))

FRCH_storm10_09_01_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm10_09_01_Q.csv'))
FRCH_storm10_09_01_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm10_09_01_NO3.csv'))
FRCH_storm10_09_01_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm10_09_01_fDOM.csv'))
FRCH_storm10_09_01_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm10_09_01_SPC.csv'))
FRCH_storm10_09_01_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm10_09_01_turb.csv'))
FRCH_storm10_09_01_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm10_09_01_abs.csv'))

FRCH_storm11a_09_22_Q = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm11a_09_22_Q.csv'))
FRCH_storm11a_09_22_NO3 = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm11a_09_22_NO3.csv'))
FRCH_storm11a_09_22_fDOM = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm11a_09_22_fDOM.csv'))
FRCH_storm11a_09_22_SPC = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm11a_09_22_SPC.csv'))
FRCH_storm11a_09_22_turb = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm11a_09_22_turb.csv'))
FRCH_storm11a_09_22_abs = pd.read_csv(here('Storm_events/2018/FRCH/FRCH_storm11a_09_22_abs.csv'))


```




FRCH_storms
```{python}
## NO3 ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_NO3 = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_30_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_30_NO3 = hysteresisMetrics(FRCH_storm2a_06_30_Q, FRCH_storm2a_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_11_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_11_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_11_NO3 = hysteresisMetrics(FRCH_storm3_07_11_Q, FRCH_storm3_07_11_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_NO3 = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_17_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_17_NO3 = hysteresisMetrics(FRCH_storm4b_07_17_Q, FRCH_storm4b_07_17_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_05_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_05_NO3 = hysteresisMetrics(FRCH_storm5_08_05_Q, FRCH_storm5_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_NO3 = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_24_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_24_NO3 = hysteresisMetrics(FRCH_storm7_08_24_Q, FRCH_storm7_08_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_NO3 = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_NO3 = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_NO3 = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_NO3 = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_fDOM = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_30_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_30_fDOM = hysteresisMetrics(FRCH_storm2a_06_30_Q, FRCH_storm2a_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_11_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_11_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_11_fDOM = hysteresisMetrics(FRCH_storm3_07_11_Q, FRCH_storm3_07_11_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_fDOM = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_17_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_17_fDOM = hysteresisMetrics(FRCH_storm4b_07_17_Q, FRCH_storm4b_07_17_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_05_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_05_fDOM = hysteresisMetrics(FRCH_storm5_08_05_Q, FRCH_storm5_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_fDOM = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_24_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_24_fDOM = hysteresisMetrics(FRCH_storm7_08_24_Q, FRCH_storm7_08_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_fDOM = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_fDOM = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_fDOM = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_fDOM = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


# SPC ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_SPC = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_30_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_30_SPC = hysteresisMetrics(FRCH_storm2a_06_30_Q, FRCH_storm2a_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_07_11_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_11_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_11_SPC = hysteresisMetrics(FRCH_storm3_07_11_Q, FRCH_storm3_07_11_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_SPC = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_17_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_17_SPC = hysteresisMetrics(FRCH_storm4b_07_17_Q, FRCH_storm4b_07_17_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_05_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_05_SPC = hysteresisMetrics(FRCH_storm5_08_05_Q, FRCH_storm5_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_SPC = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_24_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_24_SPC = hysteresisMetrics(FRCH_storm7_08_24_Q, FRCH_storm7_08_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_SPC = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_SPC = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_SPC = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_SPC = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


# turb ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_turb = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_30_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_30_turb = hysteresisMetrics(FRCH_storm2a_06_30_Q, FRCH_storm2a_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm3_07_11_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_11_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_11_turb = hysteresisMetrics(FRCH_storm3_07_11_Q, FRCH_storm3_07_11_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_turb = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_17_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_17_turb = hysteresisMetrics(FRCH_storm4b_07_17_Q, FRCH_storm4b_07_17_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_05_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_05_turb = hysteresisMetrics(FRCH_storm5_08_05_Q, FRCH_storm5_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_turb = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_24_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_24_turb = hysteresisMetrics(FRCH_storm7_08_24_Q, FRCH_storm7_08_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_turb = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_turb = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_turb = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_turb = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## ABS ##
FRCH_storm1_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_21_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_21_abs = hysteresisMetrics(FRCH_storm1_06_21_Q, FRCH_storm1_06_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2a_06_30_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm2a_06_30_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2a_06_30_abs = hysteresisMetrics(FRCH_storm2a_06_30_Q, FRCH_storm2a_06_30_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm3_07_11_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_07_11_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3_07_11_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_07_11_abs = hysteresisMetrics(FRCH_storm3_07_11_Q, FRCH_storm3_07_11_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_15_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_15_abs = hysteresisMetrics(FRCH_storm4a_07_15_Q, FRCH_storm4a_07_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_17_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_17_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_17_abs = hysteresisMetrics(FRCH_storm4b_07_17_Q, FRCH_storm4b_07_17_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_08_05_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm5_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_08_05_abs = hysteresisMetrics(FRCH_storm5_08_05_Q, FRCH_storm5_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_08_13_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm6_08_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_08_13_abs = hysteresisMetrics(FRCH_storm6_08_13_Q, FRCH_storm6_08_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_24_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_24_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_24_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_24_abs = hysteresisMetrics(FRCH_storm7_08_24_Q, FRCH_storm7_08_24_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8a_08_26_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm8a_08_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8a_08_26_abs = hysteresisMetrics(FRCH_storm8a_08_26_Q, FRCH_storm8a_08_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9_08_30_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm9_08_30_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9_08_30_abs = hysteresisMetrics(FRCH_storm9_08_30_Q, FRCH_storm9_08_30_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10_09_01_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm10_09_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10_09_01_abs = hysteresisMetrics(FRCH_storm10_09_01_Q, FRCH_storm10_09_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11a_09_22_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm11a_09_22_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11a_09_22_abs = hysteresisMetrics(FRCH_storm11a_09_22_Q, FRCH_storm11a_09_22_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


```


FRCH results
```{r}
FRCH.hyst.results.list = list(py$hysdict_FRCH_storm1_06_21_NO3,
                              py$hysdict_FRCH_storm1_06_21_fDOM,
                              py$hysdict_FRCH_storm1_06_21_SPC,
                              py$hysdict_FRCH_storm1_06_21_turb,
                              py$hysdict_FRCH_storm1_06_21_abs,
                              py$hysdict_FRCH_storm2a_06_30_NO3,
                              py$hysdict_FRCH_storm2a_06_30_abs,
                              
                              py$hysdict_FRCH_storm3_07_11_NO3,
                              py$hysdict_FRCH_storm3_07_11_abs,
                              py$hysdict_FRCH_storm4a_07_15_NO3,
                              py$hysdict_FRCH_storm4a_07_15_abs,
                              py$hysdict_FRCH_storm4b_07_17_NO3,
                              py$hysdict_FRCH_storm4b_07_17_abs,
                             
                              
                              py$hysdict_FRCH_storm5_08_05_NO3,
                              py$hysdict_FRCH_storm5_08_05_fDOM,
                              py$hysdict_FRCH_storm5_08_05_SPC,
                              py$hysdict_FRCH_storm5_08_05_turb,
                              py$hysdict_FRCH_storm5_08_05_abs,
                              py$hysdict_FRCH_storm6_08_13_fDOM,
                              py$hysdict_FRCH_storm6_08_13_SPC,
                              py$hysdict_FRCH_storm6_08_13_turb,
                             
                              py$hysdict_FRCH_storm7_08_24_fDOM,
                              py$hysdict_FRCH_storm7_08_24_SPC,
                              py$hysdict_FRCH_storm7_08_24_turb,
                              
                              py$hysdict_FRCH_storm8a_08_26_fDOM,
                              py$hysdict_FRCH_storm8a_08_26_SPC,
                              py$hysdict_FRCH_storm8a_08_26_turb,
                              
                             
                              
                              py$hysdict_FRCH_storm9_08_30_fDOM,
                              py$hysdict_FRCH_storm9_08_30_SPC,
                              py$hysdict_FRCH_storm9_08_30_turb,
                              
                              py$hysdict_FRCH_storm10_09_01_fDOM,
                              py$hysdict_FRCH_storm10_09_01_SPC,
                              py$hysdict_FRCH_storm10_09_01_turb)
                        
FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm1_06_21_NO3",
                                  "FRCH_storm1_06_21_fDOM",
                                  "FRCH_storm1_06_21_SPC",
                                  "FRCH_storm1_06_21_turb",
                                  "FRCH_storm1_06_21_abs",
                                  "FRCH_storm2a_06_30_NO3",
                                  "FRCH_storm2a_06_30_abs",
                                  
                                  "FRCH_storm3_07_11_NO3",
                                  "FRCH_storm3_07_11_abs",
                                  "FRCH_storm4a_07_15_NO3",
                                  "FRCH_storm4a_07_15_abs",
                                  "FRCH_storm4b_07_17_NO3",
                                  "FRCH_storm4b_07_17_abs",
                                  "FRCH_storm5_08_05_NO3",
                                  "FRCH_storm5_08_05_fDOM",
                                  "FRCH_storm5_08_05_SPC",
                                  "FRCH_storm5_08_05_turb",
                                  "FRCH_storm5_08_05_abs",
                                  "FRCH_storm6_08_13_fDOM",
                                  "FRCH_storm6_08_13_SPC",
                                  "FRCH_storm6_08_13_turb",
                                  "FRCH_storm7_08_24_fDOM",
                                  "FRCH_storm7_08_24_SPC",
                                  "FRCH_storm7_08_24_turb",
                                  "FRCH_storm8a_08_26_fDOM",
                                  "FRCH_storm8a_08_26_SPC",
                                  "FRCH_storm8a_08_26_turb",
                                  
                                  "FRCH_storm9_08_30_fDOM",
                                  "FRCH_storm9_08_30_SPC",
                                  "FRCH_storm9_08_30_turb",
                                  "FRCH_storm10_09_01_fDOM",
                                  "FRCH_storm10_09_01_SPC",
                                  "FRCH_storm10_09_01_turb")
                                  
                                  


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, here("Output_from_analysis", "03_HI_FI", "2018", "FRCH", "FRCH.hyst.results.csv"))

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
# pdf("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(rep("FRCH_storm1_06_21_NO3", 50),
                        rep("FRCH_storm1_06_21_fDOM", 50),
                        rep("FRCH_storm1_06_21_SPC", 50),
                        rep("FRCH_storm1_06_21_turb", 50),
                        rep("FRCH_storm1_06_21_abs", 50),
                        rep("FRCH_storm2a_06_30_NO3", 50),
                        rep("FRCH_storm2a_06_30_abs", 50),
                        
                        rep("FRCH_storm3_07_11_NO3", 50),
                        rep("FRCH_storm3_07_11_abs", 50),
                        rep("FRCH_storm4a_07_15_NO3", 50),
                        rep("FRCH_storm4a_07_15_abs", 50),
                        rep("FRCH_storm4b_07_17_NO3", 50),
                        rep("FRCH_storm4b_07_17_abs", 50),
                        rep("FRCH_storm5_08_05_NO3", 50),
                        rep("FRCH_storm5_08_05_fDOM", 50),
                        rep("FRCH_storm5_08_05_SPC", 50),
                        rep("FRCH_storm5_08_05_turb", 50),
                        rep("FRCH_storm5_08_05_abs", 50),
                        rep("FRCH_storm6_08_13_fDOM", 50),
                        rep("FRCH_storm6_08_13_SPC", 50),
                        rep("FRCH_storm6_08_13_turb", 50),
                        rep("FRCH_storm7_08_24_fDOM", 50),
                        rep("FRCH_storm7_08_24_SPC", 50),
                        rep("FRCH_storm7_08_24_turb", 50),
                        rep("FRCH_storm8a_08_26_fDOM", 50),
                        rep("FRCH_storm8a_08_26_SPC", 50),
                        rep("FRCH_storm8a_08_26_turb", 50),
                        
                        rep("FRCH_storm9_08_30_fDOM", 50),
                        rep("FRCH_storm9_08_30_SPC", 50),
                        rep("FRCH_storm9_08_30_turb", 50),
                        rep("FRCH_storm10_09_01_fDOM", 50),
                        rep("FRCH_storm10_09_01_SPC", 50),
                        rep("FRCH_storm10_09_01_turb", 50))

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2018", "FRCH", "FRCH.HI.median.boot.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(FRCH.HI.df, here("Output_from_analysis", "03_HI_FI", "2018", "FRCH", "FRCH.HI.df.csv"))


FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2018", "FRCH", "FRCH.HI.median.boot.doy.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(FRCH.HI.df, here("Output_from_analysis", "03_HI_FI", "2018", "FRCH", "FRCH.HI.df.doy.csv"))


```

```{python}
# MOOS #
MOOS_storm2a_06_30_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm2a_06_30_Q.csv'))
MOOS_storm2a_06_30_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm2a_06_30_NO3.csv'))
MOOS_storm2a_06_30_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm2a_06_30_fDOM.csv'))
MOOS_storm2a_06_30_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm2a_06_30_SPC.csv'))
MOOS_storm2a_06_30_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm2a_06_30_Turb.csv'))
MOOS_storm2a_06_30_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm2a_06_30_abs.csv'))

MOOS_storm3_07_10_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm3_07_10_Q.csv'))
MOOS_storm3_07_10_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm3_07_10_NO3.csv'))
MOOS_storm3_07_10_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm3_07_10_fDOM.csv'))
MOOS_storm3_07_10_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm3_07_10_SPC.csv'))
MOOS_storm3_07_10_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm3_07_10_Turb.csv'))
MOOS_storm3_07_10_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm3_07_10_abs.csv'))

MOOS_storm5_08_05_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm5_08_05_Q.csv'))
MOOS_storm5_08_05_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm5_08_05_NO3.csv'))
MOOS_storm5_08_05_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm5_08_05_fDOM.csv'))
MOOS_storm5_08_05_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm5_08_05_SPC.csv'))
MOOS_storm5_08_05_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm5_08_05_Turb.csv'))
MOOS_storm5_08_05_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm5_08_05_abs.csv'))

MOOS_storm6_08_13_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm6_08_13_Q.csv'))
MOOS_storm6_08_13_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm6_08_13_NO3.csv'))
MOOS_storm6_08_13_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm6_08_13_fDOM.csv'))
MOOS_storm6_08_13_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm6_08_13_SPC.csv'))
MOOS_storm6_08_13_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm6_08_13_Turb.csv'))
MOOS_storm6_08_13_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm6_08_13_abs.csv'))

MOOS_storm7_08_23_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm7_08_23_Q.csv'))
MOOS_storm7_08_23_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm7_08_23_NO3.csv'))
MOOS_storm7_08_23_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm7_08_23_fDOM.csv'))
MOOS_storm7_08_23_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm7_08_23_SPC.csv'))
MOOS_storm7_08_23_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm7_08_23_Turb.csv'))
MOOS_storm7_08_23_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm7_08_23_abs.csv'))

MOOS_storm8a_08_26_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm8a_08_26_Q.csv'))
MOOS_storm8a_08_26_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm8a_08_26_NO3.csv'))
MOOS_storm8a_08_26_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm8a_08_26_fDOM.csv'))
MOOS_storm8a_08_26_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm8a_08_26_SPC.csv'))
MOOS_storm8a_08_26_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm8a_08_26_Turb.csv'))
MOOS_storm8a_08_26_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm8a_08_26_abs.csv'))

MOOS_storm9_08_30_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm9_08_30_Q.csv'))
MOOS_storm9_08_30_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm9_08_30_NO3.csv'))
MOOS_storm9_08_30_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm9_08_30_fDOM.csv'))
MOOS_storm9_08_30_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm9_08_30_SPC.csv'))
MOOS_storm9_08_30_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm9_08_30_Turb.csv'))
MOOS_storm9_08_30_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm9_08_30_abs.csv'))

MOOS_storm10_09_01_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm10_09_01_Q.csv'))
MOOS_storm10_09_01_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm10_09_01_NO3.csv'))
MOOS_storm10_09_01_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm10_09_01_fDOM.csv'))
MOOS_storm10_09_01_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm10_09_01_SPC.csv'))
MOOS_storm10_09_01_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm10_09_01_Turb.csv'))
MOOS_storm10_09_01_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm10_09_01_abs.csv'))

MOOS_storm11a_09_22_Q = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm11a_09_22_Q.csv'))
MOOS_storm11a_09_22_NO3 = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm11a_09_22_NO3.csv'))
MOOS_storm11a_09_22_fDOM = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm11a_09_22_fDOM.csv'))
MOOS_storm11a_09_22_SPC = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm11a_09_22_SPC.csv'))
MOOS_storm11a_09_22_turb = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm11a_09_22_Turb.csv'))
MOOS_storm11a_09_22_abs = pd.read_csv(here('Storm_events/2018/MOOS/MOOS_storm11a_09_22_abs.csv'))

```

MOOS_storms
```{python}
## NO3 ##

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_NO3 = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_10_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_10_NO3 = hysteresisMetrics(MOOS_storm3_07_10_Q, MOOS_storm3_07_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_05_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_05_NO3 = hysteresisMetrics(MOOS_storm5_08_05_Q, MOOS_storm5_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_NO3 = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_NO3 = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_NO3 = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_NO3 = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_NO3 = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_NO3 = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_fDOM = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_10_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_10_fDOM = hysteresisMetrics(MOOS_storm3_07_10_Q, MOOS_storm3_07_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_05_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_05_fDOM = hysteresisMetrics(MOOS_storm5_08_05_Q, MOOS_storm5_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_fDOM = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_fDOM = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_fDOM = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_fDOM = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_fDOM = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_fDOM = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_SPC = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_10_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_10_SPC = hysteresisMetrics(MOOS_storm3_07_10_Q, MOOS_storm3_07_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_05_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_05_SPC = hysteresisMetrics(MOOS_storm5_08_05_Q, MOOS_storm5_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_SPC = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_SPC = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_SPC = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_SPC = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_SPC = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_SPC = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_turb = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_10_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_10_turb = hysteresisMetrics(MOOS_storm3_07_10_Q, MOOS_storm3_07_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_05_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_05_turb = hysteresisMetrics(MOOS_storm5_08_05_Q, MOOS_storm5_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_turb = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_turb = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_turb = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_turb = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_turb = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_turb = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## ABS ##

MOOS_storm2a_06_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_06_30_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_06_30_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_06_30_abs = hysteresisMetrics(MOOS_storm2a_06_30_Q, MOOS_storm2a_06_30_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_10_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_10_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_10_abs = hysteresisMetrics(MOOS_storm3_07_10_Q, MOOS_storm3_07_10_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


MOOS_storm5_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_08_05_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm5_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_08_05_abs = hysteresisMetrics(MOOS_storm5_08_05_Q, MOOS_storm5_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_13_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_13_abs = hysteresisMetrics(MOOS_storm6_08_13_Q, MOOS_storm6_08_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_23_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_23_abs = hysteresisMetrics(MOOS_storm7_08_23_Q, MOOS_storm7_08_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8a_08_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8a_08_26_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm8a_08_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8a_08_26_abs = hysteresisMetrics(MOOS_storm8a_08_26_Q, MOOS_storm8a_08_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_08_30_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_08_30_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm9_08_30_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_08_30_abs = hysteresisMetrics(MOOS_storm9_08_30_Q, MOOS_storm9_08_30_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm10_09_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm10_09_01_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm10_09_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm10_09_01_abs = hysteresisMetrics(MOOS_storm10_09_01_Q, MOOS_storm10_09_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm11a_09_22_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm11a_09_22_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm11a_09_22_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm11a_09_22_abs = hysteresisMetrics(MOOS_storm11a_09_22_Q, MOOS_storm11a_09_22_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


MOOS results
```{r}
MOOS.hyst.results.list = list(
                              
                              py$hysdict_MOOS_storm3_07_10_NO3,
                              
                              py$hysdict_MOOS_storm3_07_10_abs,
                              py$hysdict_MOOS_storm5_08_05_NO3,
                              py$hysdict_MOOS_storm5_08_05_fDOM,
                              py$hysdict_MOOS_storm5_08_05_SPC,
                              py$hysdict_MOOS_storm5_08_05_turb,
                              py$hysdict_MOOS_storm5_08_05_abs,
                              py$hysdict_MOOS_storm6_08_13_NO3,
                              py$hysdict_MOOS_storm6_08_13_fDOM,
                              py$hysdict_MOOS_storm6_08_13_SPC,
                              py$hysdict_MOOS_storm6_08_13_turb,
                              py$hysdict_MOOS_storm6_08_13_abs,
                              py$hysdict_MOOS_storm7_08_23_NO3,
                              py$hysdict_MOOS_storm7_08_23_fDOM,
                              py$hysdict_MOOS_storm7_08_23_SPC,
                              py$hysdict_MOOS_storm7_08_23_turb,
                              py$hysdict_MOOS_storm7_08_23_abs,
                              py$hysdict_MOOS_storm8a_08_26_NO3,
                              py$hysdict_MOOS_storm8a_08_26_fDOM,
                              py$hysdict_MOOS_storm8a_08_26_SPC,
                              py$hysdict_MOOS_storm8a_08_26_turb,
                              py$hysdict_MOOS_storm8a_08_26_abs,
                              
                              
                              py$hysdict_MOOS_storm9_08_30_NO3,
                              py$hysdict_MOOS_storm9_08_30_fDOM,
                              py$hysdict_MOOS_storm9_08_30_SPC,
                              py$hysdict_MOOS_storm9_08_30_turb,
                              py$hysdict_MOOS_storm9_08_30_abs,
                              py$hysdict_MOOS_storm10_09_01_NO3,
                              py$hysdict_MOOS_storm10_09_01_fDOM,
                              py$hysdict_MOOS_storm10_09_01_SPC,
                              py$hysdict_MOOS_storm10_09_01_turb,
                              py$hysdict_MOOS_storm10_09_01_abs,
                              py$hysdict_MOOS_storm11a_09_22_NO3,
                              py$hysdict_MOOS_storm11a_09_22_fDOM,
                              py$hysdict_MOOS_storm11a_09_22_SPC,
                              py$hysdict_MOOS_storm11a_09_22_turb,
                              py$hysdict_MOOS_storm11a_09_22_abs)
                              
                              


MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c(
                                  
                                  "MOOS_storm3_07_09_NO3",
                                  "MOOS_storm3_07_09_abs",
                                  
                              
                                  "MOOS_storm5_08_05_NO3",
                                  "MOOS_storm5_08_05_fDOM",
                                  "MOOS_storm5_08_05_SPC",
                                  "MOOS_storm5_08_05_turb",
                                  "MOOS_storm5_08_05_abs",
                                  "MOOS_storm6_08_13_NO3",
                                  "MOOS_storm6_08_13_fDOM",
                                  "MOOS_storm6_08_13_SPC",
                                  "MOOS_storm6_08_13_turb",
                                  "MOOS_storm6_08_13_abs",
                                  "MOOS_storm7_08_23_NO3",
                                  "MOOS_storm7_08_23_fDOM",
                                  "MOOS_storm7_08_23_SPC",
                                  "MOOS_storm7_08_23_turb",
                                  "MOOS_storm7_08_23_abs",
                                  "MOOS_storm8a_08_26_NO3",
                                  "MOOS_storm8a_08_26_fDOM",
                                  "MOOS_storm8a_08_26_SPC",
                                  "MOOS_storm8a_08_26_turb",
                                  "MOOS_storm8a_08_26_abs",
                                  
                                  
                                  "MOOS_storm9_08_30_NO3",
                                  "MOOS_storm9_08_30_fDOM",
                                  "MOOS_storm9_08_30_SPC",
                                  "MOOS_storm9_08_30_turb",
                                  "MOOS_storm9_08_30_abs",
                                  "MOOS_storm10_09_01_NO3",
                                  "MOOS_storm10_09_01_fDOM",
                                  "MOOS_storm10_09_01_SPC",
                                  "MOOS_storm10_09_01_turb",
                                  "MOOS_storm10_09_01_abs",
                                  "MOOS_storm11a_09_22_NO3",
                                  "MOOS_storm11a_09_22_fDOM",
                                  "MOOS_storm11a_09_22_SPC",
                                  "MOOS_storm11a_09_22_turb",
                                  "MOOS_storm11a_09_22_abs")
                                  
                                  
                                  
                                 


MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, here("Output_from_analysis", "03_HI_FI", "2018", "MOOS", "MOOS.hyst.results.csv"))

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2018/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(
                        rep("MOOS_storm3_07_10_NO3", 50),
                        rep("MOOS_storm3_07_10_abs", 50),
                        rep("MOOS_storm5_08_05_NO3", 50),
                        rep("MOOS_storm5_08_05_fDOM", 50),
                        rep("MOOS_storm5_08_05_SPC", 50),
                        rep("MOOS_storm5_08_05_turb", 50),
                        rep("MOOS_storm5_08_05_abs", 50),
                        rep("MOOS_storm6_08_13_NO3", 50),
                        rep("MOOS_storm6_08_13_fDOM", 50),
                        rep("MOOS_storm6_08_13_SPC", 50),
                        rep("MOOS_storm6_08_13_turb", 50),
                        rep("MOOS_storm6_08_13_abs", 50),
                        rep("MOOS_storm7_08_23_NO3", 50),
                        rep("MOOS_storm7_08_23_fDOM", 50),
                        rep("MOOS_storm7_08_23_SPC", 50),
                        rep("MOOS_storm7_08_23_turb", 50),
                        rep("MOOS_storm7_08_23_abs", 50),
                        rep("MOOS_storm8a_08_26_NO3", 50),
                        rep("MOOS_storm8a_08_26_fDOM", 50),
                        rep("MOOS_storm8a_08_26_SPC", 50),
                        rep("MOOS_storm8a_08_26_turb", 50),
                        rep("MOOS_storm8a_08_26_abs", 50),
                        
                        rep("MOOS_storm9_08_30_NO3", 50),
                        rep("MOOS_storm9_08_30_fDOM", 50),
                        rep("MOOS_storm9_08_30_SPC", 50),
                        rep("MOOS_storm9_08_30_turb", 50),
                        rep("MOOS_storm9_08_30_abs", 50),
                        rep("MOOS_storm10_09_01_NO3", 50),
                        rep("MOOS_storm10_09_01_fDOM", 50),
                        rep("MOOS_storm10_09_01_SPC", 50),
                        rep("MOOS_storm10_09_01_turb", 50),
                        rep("MOOS_storm10_09_01_abs", 50),
                        rep("MOOS_storm11a_09_22_NO3", 50),
                        rep("MOOS_storm11a_09_22_fDOM", 50),
                        rep("MOOS_storm11a_09_22_SPC", 50),
                        rep("MOOS_storm11a_09_22_turb", 50),
                        rep("MOOS_storm11a_09_22_abs", 50))
                        
                        
                        

MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2018", "MOOS", "MOOS.HI.median.boot.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(MOOS.HI.df, here("Output_from_analysis", "03_HI_FI", "2018", "MOOS", "MOOS.HI.df.csv"))

MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2018", "MOOS", "MOOS.HI.median.boot.doy.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(MOOS.HI.df, here("Output_from_analysis", "03_HI_FI", "2018", "MOOS", "MOOS.HI.df.doy.csv"))



```


### CARI ### 
```{python}
# CARI #
# MOOS #
CARI_storm1_06_10_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm1_06_10_Q.csv'))
CARI_storm1_06_10_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm1_06_10_NO3.csv'))
CARI_storm1_06_10_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm1_06_10_fDOM.csv'))
CARI_storm1_06_10_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm1_06_10_SPC.csv'))
CARI_storm1_06_10_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm1_06_10_Turb.csv'))

CARI_storm2_06_21_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm2_06_21_Q.csv'))
CARI_storm2_06_21_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm2_06_21_NO3.csv'))
CARI_storm2_06_21_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm2_06_21_fDOM.csv'))
CARI_storm2_06_21_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm2_06_21_SPC.csv'))
CARI_storm2_06_21_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm2_06_21_Turb.csv'))

CARI_storm3_06_29_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm3_06_29_Q.csv'))
CARI_storm3_06_29_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm3_06_29_NO3.csv'))
CARI_storm3_06_29_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm3_06_29_fDOM.csv'))
CARI_storm3_06_29_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm3_06_29_SPC.csv'))
CARI_storm3_06_29_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm3_06_29_Turb.csv'))

CARI_storm4a_06_30_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm4a_06_30_Q.csv'))
CARI_storm4a_06_30_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm4a_06_30_NO3.csv'))
CARI_storm4a_06_30_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm4a_06_30_fDOM.csv'))
CARI_storm4a_06_30_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm4a_06_30_SPC.csv'))
CARI_storm4a_06_30_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm4a_06_30_Turb.csv'))

CARI_storm5a_08_04_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm5a_08_04_Q.csv'))
CARI_storm5a_08_04_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm5a_08_04_NO3.csv'))
CARI_storm5a_08_04_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm5a_08_04_fDOM.csv'))
CARI_storm5a_08_04_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm5a_08_04_SPC.csv'))
CARI_storm5a_08_04_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm5a_08_04_Turb.csv'))

CARI_storm6_08_13_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm6_08_13_Q.csv'))
CARI_storm6_08_13_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm6_08_13_NO3.csv'))
CARI_storm6_08_13_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm6_08_13_fDOM.csv'))
CARI_storm6_08_13_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm6_08_13_SPC.csv'))
CARI_storm6_08_13_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm6_08_13_Turb.csv'))

CARI_storm7_08_21_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm7_08_21_Q.csv'))
CARI_storm7_08_21_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm7_08_21_NO3.csv'))
CARI_storm7_08_21_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm7_08_21_fDOM.csv'))
CARI_storm7_08_21_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm7_08_21_SPC.csv'))
CARI_storm7_08_21_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm7_08_21_Turb.csv'))

CARI_storm8_08_24_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm8_08_24_Q.csv'))
CARI_storm8_08_24_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm8_08_24_NO3.csv'))
CARI_storm8_08_24_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm8_08_24_fDOM.csv'))
CARI_storm8_08_24_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm8_08_24_SPC.csv'))
CARI_storm8_08_24_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm8_08_24_Turb.csv'))

CARI_storm9_08_26_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm9_08_26_Q.csv'))
CARI_storm9_08_26_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm9_08_26_NO3.csv'))
CARI_storm9_08_26_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm9_08_26_fDOM.csv'))
CARI_storm9_08_26_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm9_08_26_SPC.csv'))
CARI_storm9_08_26_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm9_08_26_Turb.csv'))

CARI_storm10_08_30_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm10_08_30_Q.csv'))
CARI_storm10_08_30_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm10_08_30_NO3.csv'))
CARI_storm10_08_30_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm10_08_30_fDOM.csv'))
CARI_storm10_08_30_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm10_08_30_SPC.csv'))
CARI_storm10_08_30_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm10_08_30_Turb.csv'))

CARI_storm11_09_01_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm11_09_01_Q.csv'))
CARI_storm11_09_01_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm11_09_01_NO3.csv'))
CARI_storm11_09_01_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm11_09_01_fDOM.csv'))
CARI_storm11_09_01_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm11_09_01_SPC.csv'))
CARI_storm11_09_01_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm11_09_01_Turb.csv'))

CARI_storm12a_09_20_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12a_09_20_Q.csv'))
CARI_storm12a_09_20_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12a_09_20_NO3.csv'))
CARI_storm12a_09_20_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12a_09_20_fDOM.csv'))
CARI_storm12a_09_20_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12a_09_20_SPC.csv'))
CARI_storm12a_09_20_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12a_09_20_Turb.csv'))

CARI_storm12b_09_25_Q = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12b_09_25_Q.csv'))
CARI_storm12b_09_25_NO3 = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12b_09_25_NO3.csv'))
CARI_storm12b_09_25_fDOM = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12b_09_25_fDOM.csv'))
CARI_storm12b_09_25_SPC = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12b_09_25_SPC.csv'))
CARI_storm12b_09_25_turb = pd.read_csv(here('Storm_events/2018/CARI/CARI_storm12b_09_25_Turb.csv'))

```


CARI_storms
```{python}
## NO3 ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_NO3 = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_21_NO3 = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_NO3 = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_NO3 = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5a_08_04_NO3 = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_NO3 = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_NO3 = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm8_08_24_NO3 = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_NO3 = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_NO3 = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_01_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_01_NO3 = hysteresisMetrics(CARI_storm11_09_01_Q, CARI_storm11_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 1 minutes between records
hysdict_CARI_storm12a_09_20_NO3 = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_NO3 = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_fDOM = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_21_fDOM = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_fDOM = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_fDOM = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5a_08_04_fDOM = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_fDOM = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_fDOM = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_24_fDOM = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_fDOM = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_fDOM = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_01_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_01_fDOM = hysteresisMetrics(CARI_storm11_09_01_Q, CARI_storm11_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12a_09_20_fDOM = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_fDOM = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_SPC = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_21_SPC = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_SPC = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_SPC = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5a_08_04_SPC = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_SPC = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_SPC = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_24_SPC = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_SPC = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_SPC = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_01_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_01_SPC = hysteresisMetrics(CARI_storm11_09_01_Q, CARI_storm11_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12a_09_20_SPC = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_SPC = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
CARI_storm1_06_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_10_turb['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_10_turb = hysteresisMetrics(CARI_storm1_06_10_Q, CARI_storm1_06_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_21_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm2_06_21_turb = hysteresisMetrics(CARI_storm2_06_21_Q, CARI_storm2_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_29_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_29_turb['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_29_turb = hysteresisMetrics(CARI_storm3_06_29_Q, CARI_storm3_06_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_06_30_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4a_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_06_30_turb = hysteresisMetrics(CARI_storm4a_06_30_Q, CARI_storm4a_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5a_08_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5a_08_04_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5a_08_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm5a_08_04_turb = hysteresisMetrics(CARI_storm5a_08_04_Q, CARI_storm5a_08_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_13_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_13_turb = hysteresisMetrics(CARI_storm6_08_13_Q, CARI_storm6_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_21_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_21_turb = hysteresisMetrics(CARI_storm7_08_21_Q, CARI_storm7_08_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_24_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_24_turb = hysteresisMetrics(CARI_storm8_08_24_Q, CARI_storm8_08_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_26_turb['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_26_turb = hysteresisMetrics(CARI_storm9_08_26_Q, CARI_storm9_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_30_turb['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_30_turb = hysteresisMetrics(CARI_storm10_08_30_Q, CARI_storm10_08_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm11_09_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm11_09_01_turb['valuedatetime'] =  pd.to_datetime(CARI_storm11_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm11_09_01_turb = hysteresisMetrics(CARI_storm11_09_01_Q, CARI_storm11_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12a_09_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12a_09_20_turb['valuedatetime'] =  pd.to_datetime(CARI_storm12a_09_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12a_09_20_turb = hysteresisMetrics(CARI_storm12a_09_20_Q, CARI_storm12a_09_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm12b_09_25_Q['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm12b_09_25_turb['valuedatetime'] =  pd.to_datetime(CARI_storm12b_09_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm12b_09_25_turb = hysteresisMetrics(CARI_storm12b_09_25_Q, CARI_storm12b_09_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')
```


CARI results
```{r}




CARI.hyst.results.list = list(
                              py$hysdict_CARI_storm5a_08_04_NO3,
                              py$hysdict_CARI_storm5a_08_04_fDOM,
                              py$hysdict_CARI_storm5a_08_04_SPC,
                              py$hysdict_CARI_storm5a_08_04_turb,
                             
                              py$hysdict_CARI_storm6_08_13_NO3,
                              py$hysdict_CARI_storm6_08_13_fDOM,
                              py$hysdict_CARI_storm6_08_13_SPC,
                              py$hysdict_CARI_storm6_08_13_turb,
                              py$hysdict_CARI_storm8_08_24_NO3,
                              py$hysdict_CARI_storm8_08_24_fDOM,
                              py$hysdict_CARI_storm8_08_24_SPC,
                              py$hysdict_CARI_storm9_08_26_NO3,
                              py$hysdict_CARI_storm9_08_26_fDOM,
                              py$hysdict_CARI_storm9_08_26_SPC,
                              py$hysdict_CARI_storm10_08_30_NO3,
                              py$hysdict_CARI_storm10_08_30_fDOM,
                              py$hysdict_CARI_storm10_08_30_SPC,
                              py$hysdict_CARI_storm10_08_30_turb,
                              py$hysdict_CARI_storm11_09_01_NO3,
                              py$hysdict_CARI_storm11_09_01_fDOM,
                              py$hysdict_CARI_storm11_09_01_SPC,
                              py$hysdict_CARI_storm11_09_01_turb,
                              py$hysdict_CARI_storm12a_09_20_NO3,
                              py$hysdict_CARI_storm12a_09_20_fDOM,
                              py$hysdict_CARI_storm12a_09_20_SPC,
                              py$hysdict_CARI_storm12a_09_20_turb,
                              py$hysdict_CARI_storm12b_09_25_NO3,
                              py$hysdict_CARI_storm12b_09_25_fDOM,
                              py$hysdict_CARI_storm12b_09_25_SPC,
                              py$hysdict_CARI_storm12b_09_25_turb)
                              

CARI.hyst.results.list.2 = list()
for (i in 1:length(CARI.hyst.results.list)){
CARI.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
CARI.hyst.results.list[[i]][["HI_mean_with_Interp"]],
CARI.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
CARI.hyst.results.list[[i]][["Normalized slope of response"]],
CARI.hyst.results.list[[i]][["interpolated Max width of response"]],
CARI.hyst.results.list[[i]][["Min response"]],
CARI.hyst.results.list[[i]][["Max response"]],
CARI.hyst.results.list[[i]][["Peak Q"]]
))))
names(CARI.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(CARI.hyst.results.list)){
  HIs.list[[i]] = unlist(CARI.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

CARI.hyst.results.list.3 =list()
for (i in 1:length(CARI.hyst.results.list)){
  CARI.hyst.results.list.3[[i]] = cbind(CARI.hyst.results.list.2[[i]], HIs.tests[[i]])
}

CARI.hyst.results.df = bind_rows(CARI.hyst.results.list.3, .id = "column_label")



CARI.hyst.results.df$storm.ID = c("CARI_storm5a_08_04_NO3",
                                  "CARI_storm5a_08_04_fDOM",
                                  "CARI_storm5a_08_04_SPC",
                                  "CARI_storm5a_08_04_turb",
                                  
                                  "CARI_storm6_08_13_NO3",
                                  "CARI_storm6_08_13_fDOM",
                                  "CARI_storm6_08_13_SPC",
                                  "CARI_storm6_08_13_turb",
                                  
                                  
                                  "CARI_storm8_08_24_NO3",
                                  "CARI_storm8_08_24_fDOM",
                                  "CARI_storm8_08_24_SPC",
                                  
                                  "CARI_storm9_08_26_NO3",
                                  "CARI_storm9_08_26_fDOM",
                                  "CARI_storm9_08_26_SPC",
                                  
                                  "CARI_storm10_08_30_NO3",
                                  "CARI_storm10_08_30_fDOM",
                                  "CARI_storm10_08_30_SPC",
                                  "CARI_storm10_08_30_turb",
                                  "CARI_storm11_09_01_NO3",
                                  "CARI_storm11_09_01_fDOM",
                                  "CARI_storm11_09_01_SPC",
                                  "CARI_storm11_09_01_turb",
                                  "CARI_storm12a_09_20_NO3",
                                  "CARI_storm12a_09_20_fDOM",
                                  "CARI_storm12a_09_20_SPC",
                                  "CARI_storm12a_09_20_turb",
                                  "CARI_storm12b_09_25_NO3",
                                  "CARI_storm12b_09_25_fDOM",
                                  "CARI_storm12b_09_25_SPC",
                                  "CARI_storm12b_09_25_turb"
                                  )
                                  
                                 


CARI.hyst.results.df$site.ID = "CARI"

write.csv(CARI.hyst.results.df, here("Output_from_analysis", "03_HI_FI", "2018", "CARI", "CARI.hyst.results.csv"))

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2018/CARI/CARI.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= CARI.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

CARI.HI.df = bind_rows(HIs.df.list, .id = "column_label")
CARI.HI.df$storm.ID = c(

                        rep("CARI_storm5a_08_04_NO3", 50),
                        rep("CARI_storm5a_08_04_fDOM", 50),
                        rep("CARI_storm5a_08_04_SPC", 50),
                        rep("CARI_storm5a_08_04_turb", 50),
                       
                        rep("CARI_storm6_08_13_NO3", 50),
                        rep("CARI_storm6_08_13_fDOM", 50),
                        rep("CARI_storm6_08_13_SPC", 50),
                        rep("CARI_storm6_08_13_turb", 50),
                        
                        rep("CARI_storm8_08_24_NO3", 50),
                        rep("CARI_storm8_08_24_fDOM", 50),
                        rep("CARI_storm8_08_24_SPC", 50),
                       
                        rep("CARI_storm9_08_26_NO3", 50),
                        rep("CARI_storm9_08_26_fDOM", 50),
                        rep("CARI_storm9_08_26_SPC", 50),
                        
                        rep("CARI_storm10_08_30_NO3", 50),
                        rep("CARI_storm10_08_30_fDOM", 50),
                        rep("CARI_storm10_08_30_SPC", 50),
                        rep("CARI_storm10_08_30_turb", 50),
                        rep("CARI_storm11_09_02_NO3", 50),
                        rep("CARI_storm11_09_02_fDOM", 50),
                        rep("CARI_storm11_09_02_SPC", 50),
                        rep("CARI_storm11_09_02_turb", 50),
                        rep("CARI_storm12a_09_20_NO3", 50),
                        rep("CARI_storm12a_09_20_fDOM", 50),
                        rep("CARI_storm12a_09_20_SPC", 50),
                        rep("CARI_storm12a_09_20_turb", 50),
                        rep("CARI_storm12b_09_25_NO3", 50),
                        rep("CARI_storm12b_09_25_fDOM", 50),
                        rep("CARI_storm12b_09_25_SPC", 50),
                        rep("CARI_storm12b_09_25_turb", 50))

CARI.HI.df$storm.ID = as.factor(CARI.HI.df$storm.ID)
CARI.HI.df = separate(data=CARI.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(CARI.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2018", "CARI", "CARI.HI.median.boot.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(CARI.HI.df, here("Output_from_analysis", "03_HI_FI", "2018", "CARI", "CARI.HI.df.csv"))

CARI.HI.df$date <- as.Date(with(CARI.HI.df, paste(month, day, sep = "-")), "%m-%d")
CARI.HI.df$doy <- yday(CARI.HI.df$date) 

g0 <- ggplot(CARI.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2018", "CARI", "CARI.HI.median.boot.doy.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(CARI.HI.df, here("Output_from_analysis", "03_HI_FI", "2018", "CARI", "CARI.HI.df.doy.csv"))

```


# ALL results

```{r}
FRCH.HI.2018 <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/FRCH/FRCH.hyst.results.csv")
MOOS.HI.2018 <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/MOOS/MOOS.hyst.results.csv")
CARI.HI.2018 <- read.csv("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2018/CARI/CARI.hyst.results.csv")

HI.2018 <- rbind(FRCH.HI.2018, MOOS.HI.2018, CARI.HI.2018)

HI.2018$year <- "2018"


all.results <- rbind(HI.2018)

all.results$date <- as.Date(with(all.results, paste(year, month, day,sep="-")), "%Y-%m-%d")
   

all.results$storm.ID = as.factor(all.results$storm.ID)
all.results = separate(data=all.results, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

all.results.sig = filter(all.results, all.results$wilcox.test.p<0.01)

all.results.sig$site.ID <- factor(all.results.sig$site.ID, levels = c('FRCH','MOOS', 'CARI'))
all.results$site.ID <- factor(all.results$site.ID, levels = c('FRCH','MOOS','CARI'))

show_col(brewer_pal(palette="RdBu",-1)(4))
ggplot(all.results.sig) +
  geom_boxplot(aes(site.ID, HI_mean_Interp, colour=site.ID)) +
  #scale_color_brewer(palette="RdBu", direction = -1, name="site.ID") +
  scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
  facet_wrap(~ response) +
  theme_bw()


ggplot(all.results.sig) +
  geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
  scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
  facet_wrap(~ response) +
  theme_bw() +
  geom_errorbar(aes(x=storm.ID, 
                    ymin=HI_mean_Interp-(HI_sd_with_Interp*2), 
                    ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
  geom_hline(yintercept=0)

all.HI.p = ggplot(all.results) +
  geom_point(aes(storm.ID, HI_mean_Interp, colour=site.ID, shape = year)) +
  scale_color_manual(values = c("#0571B0", "#92C5DE", "#F4A582", "#CA0020", "brown"))+
  facet_wrap(~ response, scales = "free_x") +
  theme_bw() +
  geom_errorbar(aes(x=storm.ID, 
                    ymin=HI_mean_Interp-(HI_sd_with_Interp*2), 
                    ymax=HI_mean_Interp+(HI_sd_with_Interp*2)), colour="black", alpha=0.5, size=.5) +
  geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1))

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2018/all.HI.p.pdf", plot=all.HI.p, width = 20, height = 10, units ="in")



```







########################################################################################################
############################################## 2019 ####################################################
########################################################################################################


### Load data to pandas 2019 
```{python}
# VAUL #
VAUL_storm1_07_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm1_07_13_Q.csv")
VAUL_storm1_07_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm1_07_13_NO3.csv")
VAUL_storm1_07_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm1_07_13_fDOM.csv")
VAUL_storm1_07_13_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm1_07_13_SPC.csv")
VAUL_storm1_07_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm1_07_13_turb.csv")
VAUL_storm1_07_13_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm1_07_13_abs.csv")


VAUL_storm2_07_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm2_07_26_Q.csv")
VAUL_storm2_07_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm2_07_26_NO3.csv")
VAUL_storm2_07_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm2_07_26_fDOM.csv")
VAUL_storm2_07_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm2_07_26_SPC.csv")
VAUL_storm2_07_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm2_07_26_turb.csv")
VAUL_storm2_07_26_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm2_07_26_abs.csv")

VAUL_storm3_07_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm3_07_29_Q.csv")
VAUL_storm3_07_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm3_07_29_NO3.csv")
VAUL_storm3_07_29_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm3_07_29_fDOM.csv")
VAUL_storm3_07_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm3_07_29_SPC.csv")
VAUL_storm3_07_29_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm3_07_29_turb.csv")
VAUL_storm3_07_29_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm3_07_29_abs.csv")

VAUL_storm4a_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4a_08_02_Q.csv")
VAUL_storm4a_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4a_08_02_NO3.csv")
VAUL_storm4a_08_02_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4a_08_02_fDOM.csv")
VAUL_storm4a_08_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4a_08_02_SPC.csv")
VAUL_storm4a_08_02_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4a_08_02_turb.csv")
VAUL_storm4a_08_02_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4a_08_02_abs.csv")

VAUL_storm4b_08_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4b_08_03_Q.csv")
VAUL_storm4b_08_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4b_08_03_NO3.csv")
VAUL_storm4b_08_03_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4b_08_03_fDOM.csv")
VAUL_storm4b_08_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4b_08_03_SPC.csv")
VAUL_storm4b_08_03_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4b_08_03_turb.csv")
VAUL_storm4b_08_03_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4b_08_03_abs.csv")

VAUL_storm4c_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4c_08_05_Q.csv")
VAUL_storm4c_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4c_08_05_NO3.csv")
VAUL_storm4c_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4c_08_05_fDOM.csv")
VAUL_storm4c_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4c_08_05_SPC.csv")
VAUL_storm4c_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4c_08_05_turb.csv")
VAUL_storm4c_08_05_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm4c_08_05_abs.csv")

VAUL_storm5_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm5_08_12_Q.csv")
VAUL_storm5_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm5_08_12_NO3.csv")
VAUL_storm5_08_12_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm5_08_12_fDOM.csv")
VAUL_storm5_08_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm5_08_12_SPC.csv")
VAUL_storm5_08_12_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm5_08_12_turb.csv")
VAUL_storm5_08_12_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm5_08_12_abs.csv")

VAUL_storm6_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm6_08_15_Q.csv")
VAUL_storm6_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm6_08_15_NO3.csv")
VAUL_storm6_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm6_08_15_fDOM.csv")
VAUL_storm6_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm6_08_15_SPC.csv")
VAUL_storm6_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm6_08_15_turb.csv")
VAUL_storm6_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm6_08_15_abs.csv")

VAUL_storm7_09_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm7_09_19_Q.csv")
VAUL_storm7_09_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm7_09_19_NO3.csv")
VAUL_storm7_09_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm7_09_19_fDOM.csv")
VAUL_storm7_09_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm7_09_19_SPC.csv")
VAUL_storm7_09_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm7_09_19_turb.csv")
VAUL_storm7_09_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm7_09_19_abs.csv")

VAUL_storm8a_09_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8a_09_29_Q.csv")
VAUL_storm8a_09_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8a_09_29_NO3.csv")
VAUL_storm8a_09_29_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8a_09_29_fDOM.csv")
VAUL_storm8a_09_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8a_09_29_SPC.csv")
VAUL_storm8a_09_29_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8a_09_29_turb.csv")
VAUL_storm8a_09_29_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8a_09_29_abs.csv")

VAUL_storm8b_10_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8b_10_01_Q.csv")
VAUL_storm8b_10_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8b_10_01_NO3.csv")
VAUL_storm8b_10_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8b_10_01_fDOM.csv")
VAUL_storm8b_10_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8b_10_01_SPC.csv")
VAUL_storm8b_10_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8b_10_01_turb.csv")
VAUL_storm8b_10_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8b_10_01_abs.csv")

VAUL_storm8c_10_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8c_10_04_Q.csv")
VAUL_storm8c_10_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8c_10_04_NO3.csv")
VAUL_storm8c_10_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8c_10_04_fDOM.csv")
VAUL_storm8c_10_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8c_10_04_SPC.csv")
VAUL_storm8c_10_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8c_10_04_turb.csv")
VAUL_storm8c_10_04_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/VAUL/VAUL_storm8c_10_04_abs.csv")

```


VAUL_storms
```{python}
## NO3 ##
VAUL_storm1_07_13_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_07_13_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_07_13_NO3 = hysteresisMetrics(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_07_26_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_07_26_NO3 = hysteresisMetrics(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_29_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_29_NO3 = hysteresisMetrics(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_02_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_02_NO3 = hysteresisMetrics(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_03_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_03_NO3 = hysteresisMetrics(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4c_08_05_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4c_08_05_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4c_08_05_NO3 = hysteresisMetrics(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_08_12_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_08_12_NO3 = hysteresisMetrics(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6_08_15_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6_08_15_NO3 = hysteresisMetrics(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_09_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_09_19_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_09_19_NO3 = hysteresisMetrics(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8a_09_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8a_09_29_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8a_09_29_NO3 = hysteresisMetrics(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8b_10_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8b_10_01_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8b_10_01_NO3 = hysteresisMetrics(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8c_10_04_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8c_10_04_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8c_10_04_NO3 = hysteresisMetrics(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
VAUL_storm1_07_13_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_07_13_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_07_13_fDOM = hysteresisMetrics(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_07_26_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_07_26_fDOM = hysteresisMetrics(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_29_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_29_fDOM = hysteresisMetrics(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_02_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_02_fDOM = hysteresisMetrics(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_03_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_03_fDOM = hysteresisMetrics(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4c_08_05_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4c_08_05_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4c_08_05_fDOM = hysteresisMetrics(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_08_12_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_08_12_fDOM = hysteresisMetrics(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6_08_15_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6_08_15_fDOM = hysteresisMetrics(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_09_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_09_19_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_09_19_fDOM = hysteresisMetrics(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8a_09_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8a_09_29_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8a_09_29_fDOM = hysteresisMetrics(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8b_10_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8b_10_01_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8b_10_01_fDOM = hysteresisMetrics(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8c_10_04_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8c_10_04_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8c_10_04_fDOM = hysteresisMetrics(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
VAUL_storm1_07_13_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_07_13_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_07_13_SPC = hysteresisMetrics(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_07_26_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_07_26_SPC = hysteresisMetrics(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_29_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_29_SPC = hysteresisMetrics(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_02_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_02_SPC = hysteresisMetrics(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_03_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_03_SPC = hysteresisMetrics(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4c_08_05_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4c_08_05_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4c_08_05_SPC = hysteresisMetrics(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_08_12_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_08_12_SPC = hysteresisMetrics(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6_08_15_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6_08_15_SPC = hysteresisMetrics(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_09_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_09_19_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_09_19_SPC = hysteresisMetrics(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8a_09_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8a_09_29_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8a_09_29_SPC = hysteresisMetrics(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8b_10_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8b_10_01_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8b_10_01_SPC = hysteresisMetrics(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8c_10_04_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8c_10_04_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8c_10_04_SPC = hysteresisMetrics(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## turb ##
VAUL_storm1_07_13_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_07_13_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_07_13_turb = hysteresisMetrics(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_07_26_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_07_26_turb = hysteresisMetrics(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_29_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_29_turb = hysteresisMetrics(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_02_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_02_turb = hysteresisMetrics(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_03_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_03_turb = hysteresisMetrics(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4c_08_05_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4c_08_05_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4c_08_05_turb = hysteresisMetrics(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_08_12_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_08_12_turb = hysteresisMetrics(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6_08_15_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6_08_15_turb = hysteresisMetrics(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_09_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_09_19_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_09_19_turb = hysteresisMetrics(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8a_09_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8a_09_29_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8a_09_29_turb = hysteresisMetrics(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8b_10_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8b_10_01_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8b_10_01_turb = hysteresisMetrics(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8c_10_04_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8c_10_04_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8c_10_04_turb = hysteresisMetrics(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
VAUL_storm1_07_13_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_07_13_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm1_07_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_07_13_abs = hysteresisMetrics(VAUL_storm1_07_13_Q, VAUL_storm1_07_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_07_26_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm2_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_07_26_abs = hysteresisMetrics(VAUL_storm2_07_26_Q, VAUL_storm2_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_29_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_29_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_29_abs = hysteresisMetrics(VAUL_storm3_07_29_Q, VAUL_storm3_07_29_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_02_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_02_abs = hysteresisMetrics(VAUL_storm4a_08_02_Q, VAUL_storm4a_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_03_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_03_abs = hysteresisMetrics(VAUL_storm4b_08_03_Q, VAUL_storm4b_08_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4c_08_05_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4c_08_05_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm4c_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4c_08_05_abs = hysteresisMetrics(VAUL_storm4c_08_05_Q, VAUL_storm4c_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_08_12_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm5_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_08_12_abs = hysteresisMetrics(VAUL_storm5_08_12_Q, VAUL_storm5_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6_08_15_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm6_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6_08_15_abs = hysteresisMetrics(VAUL_storm6_08_15_Q, VAUL_storm6_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_09_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_09_19_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm7_09_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_09_19_abs = hysteresisMetrics(VAUL_storm7_09_19_Q, VAUL_storm7_09_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8a_09_29_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8a_09_29_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm8a_09_29_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8a_09_29_abs = hysteresisMetrics(VAUL_storm8a_09_29_Q, VAUL_storm8a_09_29_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8b_10_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8b_10_01_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm8b_10_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8b_10_01_abs = hysteresisMetrics(VAUL_storm8b_10_01_Q, VAUL_storm8b_10_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8c_10_04_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8c_10_04_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm8c_10_04_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8c_10_04_abs = hysteresisMetrics(VAUL_storm8c_10_04_Q, VAUL_storm8c_10_04_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```
VAUL results
```{r}

VAUL.hyst.results.list = list(py$hysdict_VAUL_storm1_07_13_NO3,
                              py$hysdict_VAUL_storm1_07_13_fDOM,
                              py$hysdict_VAUL_storm1_07_13_SPC,
                              py$hysdict_VAUL_storm1_07_13_turb,
                              py$hysdict_VAUL_storm1_07_13_abs,
                              py$hysdict_VAUL_storm2_07_26_NO3,
                              py$hysdict_VAUL_storm2_07_26_fDOM,
                              py$hysdict_VAUL_storm2_07_26_SPC,
                              py$hysdict_VAUL_storm2_07_26_turb,
                              py$hysdict_VAUL_storm2_07_26_abs,
                              py$hysdict_VAUL_storm3_07_29_NO3,
                              py$hysdict_VAUL_storm3_07_29_fDOM,
                              py$hysdict_VAUL_storm3_07_29_SPC,
                              py$hysdict_VAUL_storm3_07_29_turb,
                              py$hysdict_VAUL_storm3_07_29_abs,
                              py$hysdict_VAUL_storm4a_08_02_fDOM,
                              py$hysdict_VAUL_storm4a_08_02_SPC,
                              py$hysdict_VAUL_storm4b_08_03_fDOM,
                              py$hysdict_VAUL_storm4b_08_03_SPC,
                              py$hysdict_VAUL_storm4c_08_05_NO3,
                              py$hysdict_VAUL_storm4c_08_05_fDOM,
                              py$hysdict_VAUL_storm4c_08_05_SPC,
                              py$hysdict_VAUL_storm4c_08_05_turb,
                              py$hysdict_VAUL_storm5_08_12_NO3,
                              py$hysdict_VAUL_storm5_08_12_fDOM,
                              py$hysdict_VAUL_storm5_08_12_SPC,
                              py$hysdict_VAUL_storm5_08_12_turb,
                              py$hysdict_VAUL_storm5_08_12_abs,
                              py$hysdict_VAUL_storm6_08_15_NO3,
                              py$hysdict_VAUL_storm6_08_15_fDOM,
                              py$hysdict_VAUL_storm6_08_15_SPC,
                              py$hysdict_VAUL_storm6_08_15_turb,
                              py$hysdict_VAUL_storm6_08_15_abs,
                              py$hysdict_VAUL_storm7_09_19_NO3,
                              py$hysdict_VAUL_storm7_09_19_fDOM,
                              py$hysdict_VAUL_storm7_09_19_SPC,
                              py$hysdict_VAUL_storm7_09_19_turb,
                              py$hysdict_VAUL_storm7_09_19_abs,
                              py$hysdict_VAUL_storm8a_09_29_NO3,
                              py$hysdict_VAUL_storm8a_09_29_fDOM,
                              py$hysdict_VAUL_storm8a_09_29_SPC,
                              py$hysdict_VAUL_storm8a_09_29_turb,
                              py$hysdict_VAUL_storm8a_09_29_abs,
                              py$hysdict_VAUL_storm8b_10_01_NO3,
                              py$hysdict_VAUL_storm8b_10_01_fDOM,
                              py$hysdict_VAUL_storm8b_10_01_SPC,
                              py$hysdict_VAUL_storm8b_10_01_turb,
                              py$hysdict_VAUL_storm8b_10_01_abs,
                              py$hysdict_VAUL_storm8c_10_04_NO3,
                              py$hysdict_VAUL_storm8c_10_04_fDOM,
                              py$hysdict_VAUL_storm8c_10_04_SPC,
                              py$hysdict_VAUL_storm8c_10_04_turb,
                              py$hysdict_VAUL_storm8c_10_04_abs)
                              
VAUL.hyst.results.list.2 = list()
for (i in 1:length(VAUL.hyst.results.list)){
VAUL.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
VAUL.hyst.results.list[[i]][["HI_mean_with_Interp"]],
VAUL.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
VAUL.hyst.results.list[[i]][["Normalized slope of response"]],
VAUL.hyst.results.list[[i]][["interpolated Max width of response"]],
VAUL.hyst.results.list[[i]][["Min response"]],
VAUL.hyst.results.list[[i]][["Max response"]],
VAUL.hyst.results.list[[i]][["Peak Q"]]
))))
names(VAUL.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(VAUL.hyst.results.list)){
  HIs.list[[i]] = unlist(VAUL.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

VAUL.hyst.results.list.3 =list()
for (i in 1:length(VAUL.hyst.results.list)){
  VAUL.hyst.results.list.3[[i]] = cbind(VAUL.hyst.results.list.2[[i]], HIs.tests[[i]])
}

VAUL.hyst.results.df = bind_rows(VAUL.hyst.results.list.3, .id = "column_label")

VAUL.hyst.results.df$storm.ID = c("VAUL_storm1_07_13_NO3",
                                  "VAUL_storm1_07_13_fDOM",
                                  "VAUL_storm1_07_13_SPC",
                                  "VAUL_storm1_07_13_turb",
                                  "VAUL_storm1_07_13_abs",
                                  "VAUL_storm2_07_26_NO3",
                                  "VAUL_storm2_07_26_fDOM",
                                  "VAUL_storm2_07_26_SPC",
                                  "VAUL_storm2_07_26_turb",
                                  "VAUL_storm2_07_26_abs",
                                  "VAUL_storm3_07_29_NO3",
                                  "VAUL_storm3_07_29_fDOM",
                                  "VAUL_storm3_07_29_SPC",
                                  "VAUL_storm3_07_29_turb",
                                  "VAUL_storm3_07_29_abs",
                                  "VAUL_storm4a_08_02_fDOM",
                                  "VAUL_storm4a_08_02_SPC",
                                  
                                  "VAUL_storm4b_08_03_fDOM",
                                  "VAUL_storm4b_08_03_SPC",
                                  
                                  "VAUL_storm4c_08_05_NO3",
                                  "VAUL_storm4c_08_05_fDOM",
                                  "VAUL_storm4c_08_05_SPC",
                                  "VAUL_storm4c_08_05_turb",
                                  
                                  "VAUL_storm5_08_12_NO3",
                                  "VAUL_storm5_08_12_fDOM",
                                  "VAUL_storm5_08_12_SPC",
                                  "VAUL_storm5_08_12_turb",
                                  "VAUL_storm5_08_12_abs",
                                  "VAUL_storm6_08_15_NO3",
                                  "VAUL_storm6_08_15_fDOM",
                                  "VAUL_storm6_08_15_SPC",
                                  "VAUL_storm6_08_15_turb",
                                  "VAUL_storm6_08_15_abs",
                                  "VAUL_storm7_09_19_NO3",
                                  "VAUL_storm7_09_19_fDOM",
                                  "VAUL_storm7_09_19_SPC",
                                  "VAUL_storm7_09_19_turb",
                                  "VAUL_storm7_09_19_abs",
                                  "VAUL_storm8a_09_29_NO3",
                                  "VAUL_storm8a_09_29_fDOM",
                                  "VAUL_storm8a_09_29_SPC",
                                  "VAUL_storm8a_09_29_turb",
                                  "VAUL_storm8a_09_29_abs",
                                  "VAUL_storm8b_10_01_NO3",
                                  "VAUL_storm8b_10_01_fDOM",
                                  "VAUL_storm8b_10_01_SPC",
                                  "VAUL_storm8b_10_01_turb",
                                  "VAUL_storm8b_10_01_abs",
                                  "VAUL_storm8c_10_04_NO3",
                                  "VAUL_storm8c_10_04_fDOM",
                                  "VAUL_storm8c_10_04_SPC",
                                  "VAUL_storm8c_10_04_turb",
                                  "VAUL_storm8c_10_04_abs")


VAUL.hyst.results.df$site.ID = "VAUL"

write.csv(VAUL.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/VAUL/VAUL.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2019/VAUL/VAUL.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= VAUL.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

VAUL.HI.df = bind_rows(HIs.df.list, .id = "column_label")
VAUL.HI.df$storm.ID = c(rep("VAUL_storm1_07_13_NO3", 50),
                        rep("VAUL_storm1_07_13_fDOM", 50),
                        rep("VAUL_storm1_07_13_SPC", 50),
                        rep("VAUL_storm1_07_13_turb", 50),
                        rep("VAUL_storm1_07_13_abs", 50),
                        rep("VAUL_storm2_07_26_NO3", 50),
                        rep("VAUL_storm2_07_26_fDOM", 50),
                        rep("VAUL_storm2_07_26_SPC", 50),
                        rep("VAUL_storm2_07_26_turb", 50),
                        rep("VAUL_storm2_07_26_abs", 50),
                        rep("VAUL_storm3_07_29_NO3", 50),
                        rep("VAUL_storm3_07_29_fDOM", 50),
                        rep("VAUL_storm3_07_29_SPC", 50),
                        rep("VAUL_storm3_07_29_turb", 50),
                        rep("VAUL_storm3_07_29_abs", 49),
                        rep("VAUL_storm4a_08_02_fDOM", 50),
                        rep("VAUL_storm4a_08_02_SPC", 50),
                        rep("VAUL_storm4b_08_03_fDOM", 50),
                        rep("VAUL_storm4b_08_03_SPC", 49),
                        rep("VAUL_storm4c_08_05_NO3", 50),
                        rep("VAUL_storm4c_08_05_fDOM", 50),
                        rep("VAUL_storm4c_08_05_SPC", 50),
                        rep("VAUL_storm4c_08_05_turb", 50),
                        
                        rep("VAUL_storm5_08_12_NO3", 50),
                        rep("VAUL_storm5_08_12_fDOM", 50),
                        rep("VAUL_storm5_08_12_SPC", 50),
                        rep("VAUL_storm5_08_12_turb", 50),
                        rep("VAUL_storm5_08_12_abs", 50),
                        rep("VAUL_storm6_08_15_NO3", 50),
                        rep("VAUL_storm6_08_15_fDOM", 50),
                        rep("VAUL_storm6_08_15_SPC", 50),
                        rep("VAUL_storm6_08_15_turb", 50),
                        rep("VAUL_storm6_08_15_abs", 50),
                        rep("VAUL_storm7_09_19_NO3", 50),
                        rep("VAUL_storm7_09_19_fDOM", 50),
                        rep("VAUL_storm7_09_19_SPC", 50),
                        rep("VAUL_storm7_09_19_turb", 50),
                        rep("VAUL_storm7_09_19_abs", 50),
                        rep("VAUL_storm8a_09_29_NO3", 50),
                        rep("VAUL_storm8a_09_29_fDOM", 50),
                        rep("VAUL_storm8a_09_29_SPC", 50),
                        rep("VAUL_storm8a_09_29_turb", 50),
                        rep("VAUL_storm8a_09_29_abs", 50),
                        rep("VAUL_storm8b_10_01_NO3", 50),
                        rep("VAUL_storm8b_10_01_fDOM", 50),
                        rep("VAUL_storm8b_10_01_SPC", 50),
                        rep("VAUL_storm8b_10_01_turb", 50),
                        rep("VAUL_storm8b_10_01_abs", 50),
                        rep("VAUL_storm8c_10_04_NO3", 50),
                        rep("VAUL_storm8c_10_04_fDOM", 50),
                        rep("VAUL_storm8c_10_04_SPC", 49),
                        rep("VAUL_storm8c_10_04_turb", 50),
                        rep("VAUL_storm8c_10_04_abs", 49))

VAUL.HI.df$storm.ID = as.factor(VAUL.HI.df$storm.ID)
VAUL.HI.df = separate(data=VAUL.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(VAUL.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/VAUL/VAUL.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/VAUL/VAUL.HI.df.csv")

VAUL.HI.df$date <- as.Date(with(VAUL.HI.df, paste(month, day, sep = "-")), "%m-%d")
VAUL.HI.df$doy <- yday(VAUL.HI.df$date) 

g0 <- ggplot(VAUL.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/VAUL/VAUL.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/VAUL/VAUL.HI.df.doy.csv")

```

### FRCH ###
```{python}
# FRCH #
FRCH_storm1_05_31_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm1_05_31_Q.csv'))
FRCH_storm1_05_31_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm1_05_31_NO3.csv'))
FRCH_storm1_05_31_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm1_05_31_fDOM.csv'))
FRCH_storm1_05_31_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm1_05_31_SPC.csv'))
FRCH_storm1_05_31_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm1_05_31_turb.csv'))
FRCH_storm1_05_31_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm1_05_31_abs.csv'))

FRCH_storm2_06_15_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm2_06_15_Q.csv'))
FRCH_storm2_06_15_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm2_06_15_NO3.csv'))
FRCH_storm2_06_15_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm2_06_15_fDOM.csv'))
FRCH_storm2_06_15_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm2_06_15_SPC.csv'))
FRCH_storm2_06_15_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm2_06_15_turb.csv'))
FRCH_storm2_06_15_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm2_06_15_abs.csv'))

FRCH_storm3_06_18_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm3_06_18_Q.csv'))
FRCH_storm3_06_18_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm3_06_18_NO3.csv'))
FRCH_storm3_06_18_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm3_06_18_fDOM.csv'))
FRCH_storm3_06_18_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm3_06_18_SPC.csv'))
FRCH_storm3_06_18_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm3_06_18_turb.csv'))
FRCH_storm3_06_18_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm3_06_18_abs.csv'))

FRCH_storm4_06_20_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm4_06_20_Q.csv'))
FRCH_storm4_06_20_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm4_06_20_NO3.csv'))
FRCH_storm4_06_20_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm4_06_20_fDOM.csv'))
FRCH_storm4_06_20_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm4_06_20_SPC.csv'))
FRCH_storm4_06_20_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm4_06_20_turb.csv'))
FRCH_storm4_06_20_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm4_06_20_abs.csv'))

FRCH_storm5_06_22_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm5_06_22_Q.csv'))
FRCH_storm5_06_22_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm5_06_22_NO3.csv'))
FRCH_storm5_06_22_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm5_06_22_fDOM.csv'))
FRCH_storm5_06_22_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm5_06_22_SPC.csv'))
FRCH_storm5_06_22_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm5_06_22_turb.csv'))
FRCH_storm5_06_22_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm5_06_22_abs.csv'))

FRCH_storm6_07_12_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm6_07_12_Q.csv'))
FRCH_storm6_07_12_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm6_07_12_NO3.csv'))
FRCH_storm6_07_12_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm6_07_12_fDOM.csv'))
FRCH_storm6_07_12_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm6_07_12_SPC.csv'))
FRCH_storm6_07_12_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm6_07_12_turb.csv'))
FRCH_storm6_07_12_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm6_07_12_abs.csv'))

FRCH_storm10a_08_01_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm10a_08_01_Q.csv'))
FRCH_storm10a_08_01_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm10a_08_01_NO3.csv'))
FRCH_storm10a_08_01_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm10a_08_01_fDOM.csv'))
FRCH_storm10a_08_01_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm10a_08_01_SPC.csv'))
FRCH_storm10a_08_01_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm10a_08_01_turb.csv'))
FRCH_storm10a_08_01_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm10a_08_01_abs.csv'))

FRCH_storm11_08_05_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm11_08_05_Q.csv'))
FRCH_storm11_08_05_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm11_08_05_NO3.csv'))
FRCH_storm11_08_05_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm11_08_05_fDOM.csv'))
FRCH_storm11_08_05_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm11_08_05_SPC.csv'))
FRCH_storm11_08_05_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm11_08_05_turb.csv'))
FRCH_storm11_08_05_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm11_08_05_abs.csv'))

FRCH_storm12a_08_12_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12a_08_12_Q.csv'))
FRCH_storm12a_08_12_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12a_08_12_NO3.csv'))
FRCH_storm12a_08_12_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12a_08_12_fDOM.csv'))
FRCH_storm12a_08_12_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12a_08_12_SPC.csv'))
FRCH_storm12a_08_12_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12a_08_12_turb.csv'))
FRCH_storm12a_08_12_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12a_08_12_abs.csv'))

FRCH_storm12c_08_15_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12c_08_15_Q.csv'))
FRCH_storm12c_08_15_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12c_08_15_NO3.csv'))
FRCH_storm12c_08_15_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12c_08_15_fDOM.csv'))
FRCH_storm12c_08_15_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12c_08_15_SPC.csv'))
FRCH_storm12c_08_15_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12c_08_15_turb.csv'))
FRCH_storm12c_08_15_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm12c_08_15_abs.csv'))

FRCH_storm13_09_20_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm13_09_20_Q.csv'))
FRCH_storm13_09_20_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm13_09_20_NO3.csv'))
FRCH_storm13_09_20_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm13_09_20_fDOM.csv'))
FRCH_storm13_09_20_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm13_09_20_SPC.csv'))
FRCH_storm13_09_20_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm13_09_20_turb.csv'))
FRCH_storm13_09_20_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm13_09_20_abs.csv'))

FRCH_storm14_10_01_Q = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm14_10_01_Q.csv'))
FRCH_storm14_10_01_NO3 = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm14_10_01_NO3.csv'))
FRCH_storm14_10_01_fDOM = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm14_10_01_fDOM.csv'))
FRCH_storm14_10_01_SPC = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm14_10_01_SPC.csv'))
FRCH_storm14_10_01_turb = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm14_10_01_turb.csv'))
FRCH_storm14_10_01_abs = pd.read_csv(here('Storm_events/2019/FRCH/FRCH_storm14_10_01_abs.csv'))

```

```{python}
## NO3 ##
FRCH_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_05_31_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_05_31_NO3 = hysteresisMetrics(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_15_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_15_NO3 = hysteresisMetrics(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_06_18_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_06_18_NO3 = hysteresisMetrics(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_06_20_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_06_20_NO3 = hysteresisMetrics(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_06_22_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_06_22_NO3 = hysteresisMetrics(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_12_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_12_NO3 = hysteresisMetrics(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_01_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_01_NO3 = hysteresisMetrics(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_05_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_05_NO3 = hysteresisMetrics(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12a_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12a_08_12_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12a_08_12_NO3 = hysteresisMetrics(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12c_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12c_08_15_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12c_08_15_NO3 = hysteresisMetrics(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_20_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_20_NO3 = hysteresisMetrics(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm14_10_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm14_10_01_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm14_10_01_NO3 = hysteresisMetrics(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

#### FDOM ##########
FRCH_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_05_31_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_05_31_fDOM = hysteresisMetrics(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_15_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_15_fDOM = hysteresisMetrics(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_06_18_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_06_18_fDOM = hysteresisMetrics(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_06_20_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_06_20_fDOM = hysteresisMetrics(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_06_22_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_06_22_fDOM = hysteresisMetrics(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_12_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_12_fDOM = hysteresisMetrics(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_01_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_01_fDOM = hysteresisMetrics(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_05_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_05_fDOM = hysteresisMetrics(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12a_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12a_08_12_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12a_08_12_fDOM = hysteresisMetrics(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12c_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12c_08_15_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12c_08_15_fDOM = hysteresisMetrics(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm13_09_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_20_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_20_fDOM = hysteresisMetrics(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm14_10_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm14_10_01_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm14_10_01_fDOM = hysteresisMetrics(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

############### SPC ###################
FRCH_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_05_31_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_05_31_SPC = hysteresisMetrics(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_15_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_15_SPC = hysteresisMetrics(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_06_18_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_06_18_SPC = hysteresisMetrics(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_06_20_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_06_20_SPC = hysteresisMetrics(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_06_22_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_06_22_SPC = hysteresisMetrics(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_12_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_12_SPC = hysteresisMetrics(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_01_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_01_SPC = hysteresisMetrics(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm11_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_05_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_05_SPC = hysteresisMetrics(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12a_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12a_08_12_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12a_08_12_SPC = hysteresisMetrics(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm12c_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12c_08_15_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12c_08_15_SPC = hysteresisMetrics(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_20_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_20_SPC = hysteresisMetrics(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm14_10_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm14_10_01_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm14_10_01_SPC = hysteresisMetrics(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

############ turb ############
FRCH_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_05_31_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_05_31_turb = hysteresisMetrics(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_15_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_15_turb = hysteresisMetrics(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_06_18_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_06_18_turb = hysteresisMetrics(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_06_20_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_06_20_turb = hysteresisMetrics(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_06_22_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_06_22_turb = hysteresisMetrics(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_12_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_12_turb = hysteresisMetrics(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_01_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_01_turb = hysteresisMetrics(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_05_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_05_turb = hysteresisMetrics(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12a_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12a_08_12_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12a_08_12_turb = hysteresisMetrics(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12c_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12c_08_15_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12c_08_15_turb = hysteresisMetrics(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_20_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_20_turb = hysteresisMetrics(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm14_10_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm14_10_01_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm14_10_01_turb = hysteresisMetrics(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
FRCH_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_05_31_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm1_05_31_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_05_31_abs = hysteresisMetrics(FRCH_storm1_05_31_Q, FRCH_storm1_05_31_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_15_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_15_abs = hysteresisMetrics(FRCH_storm2_06_15_Q, FRCH_storm2_06_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_06_18_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3_06_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_06_18_abs = hysteresisMetrics(FRCH_storm3_06_18_Q, FRCH_storm3_06_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_06_20_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4_06_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_06_20_abs = hysteresisMetrics(FRCH_storm4_06_20_Q, FRCH_storm4_06_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_06_22_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm5_06_22_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_06_22_abs = hysteresisMetrics(FRCH_storm5_06_22_Q, FRCH_storm5_06_22_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_12_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_12_abs = hysteresisMetrics(FRCH_storm6_07_12_Q, FRCH_storm6_07_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


FRCH_storm10a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_01_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_01_abs = hysteresisMetrics(FRCH_storm10a_08_01_Q, FRCH_storm10a_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_05_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_05_abs = hysteresisMetrics(FRCH_storm11_08_05_Q, FRCH_storm11_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12a_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12a_08_12_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm12a_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12a_08_12_abs = hysteresisMetrics(FRCH_storm12a_08_12_Q, FRCH_storm12a_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12c_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12c_08_15_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm12c_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12c_08_15_abs = hysteresisMetrics(FRCH_storm12c_08_15_Q, FRCH_storm12c_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_20_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_20_abs = hysteresisMetrics(FRCH_storm13_09_20_Q, FRCH_storm13_09_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm14_10_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm14_10_01_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm14_10_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm14_10_01_abs = hysteresisMetrics(FRCH_storm14_10_01_Q, FRCH_storm14_10_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')
```


```{r}
FRCH.hyst.results.list = list(py$hysdict_FRCH_storm1_05_31_NO3,
                              py$hysdict_FRCH_storm1_05_31_fDOM,
                              py$hysdict_FRCH_storm1_05_31_SPC,
                              py$hysdict_FRCH_storm1_05_31_turb,
                              py$hysdict_FRCH_storm1_05_31_abs,
                              py$hysdict_FRCH_storm2_06_15_NO3,
                              py$hysdict_FRCH_storm2_06_15_fDOM,
                              py$hysdict_FRCH_storm2_06_15_SPC,
                              py$hysdict_FRCH_storm2_06_15_turb,
                              py$hysdict_FRCH_storm2_06_15_abs,
                              py$hysdict_FRCH_storm3_06_18_NO3,
                              py$hysdict_FRCH_storm3_06_18_fDOM,
                              py$hysdict_FRCH_storm3_06_18_SPC,
                              py$hysdict_FRCH_storm3_06_18_turb,
                              py$hysdict_FRCH_storm3_06_18_abs,
                              py$hysdict_FRCH_storm4_06_20_NO3,
                              py$hysdict_FRCH_storm4_06_20_fDOM,
                              py$hysdict_FRCH_storm4_06_20_SPC,
                              py$hysdict_FRCH_storm4_06_20_turb,
                              py$hysdict_FRCH_storm4_06_20_abs,
                              py$hysdict_FRCH_storm5_06_22_NO3,
                              py$hysdict_FRCH_storm5_06_22_fDOM,
                              py$hysdict_FRCH_storm5_06_22_SPC,
                              py$hysdict_FRCH_storm5_06_22_turb,
                              py$hysdict_FRCH_storm5_06_22_abs,
                              py$hysdict_FRCH_storm6_07_12_NO3,
                              py$hysdict_FRCH_storm6_07_12_fDOM,
                              py$hysdict_FRCH_storm6_07_12_SPC,
                              py$hysdict_FRCH_storm6_07_12_turb,
                              py$hysdict_FRCH_storm6_07_12_abs,
                             
                      
                              py$hysdict_FRCH_storm10a_08_01_fDOM,
                              py$hysdict_FRCH_storm10a_08_01_SPC,
                              py$hysdict_FRCH_storm10a_08_01_turb,
                              py$hysdict_FRCH_storm10a_08_01_abs,
                             
                              
                              py$hysdict_FRCH_storm11_08_05_fDOM,
                              py$hysdict_FRCH_storm11_08_05_SPC,
                              py$hysdict_FRCH_storm11_08_05_turb,
                              py$hysdict_FRCH_storm11_08_05_abs,
                              py$hysdict_FRCH_storm12a_08_12_fDOM,
                              py$hysdict_FRCH_storm12a_08_12_SPC,
                              py$hysdict_FRCH_storm12a_08_12_turb,
                              
                             
                              py$hysdict_FRCH_storm12c_08_15_fDOM,
                              py$hysdict_FRCH_storm12c_08_15_SPC,
                              py$hysdict_FRCH_storm12c_08_15_turb,
                              py$hysdict_FRCH_storm12c_08_15_abs,
                             
                              py$hysdict_FRCH_storm13_09_20_NO3,
                              py$hysdict_FRCH_storm13_09_20_fDOM,
                              py$hysdict_FRCH_storm13_09_20_SPC,
                              py$hysdict_FRCH_storm13_09_20_turb,
                              py$hysdict_FRCH_storm13_09_20_abs,
                              py$hysdict_FRCH_storm14_10_01_NO3,
                              py$hysdict_FRCH_storm14_10_01_fDOM,
                              py$hysdict_FRCH_storm14_10_01_SPC,
                              py$hysdict_FRCH_storm14_10_01_turb,
                              py$hysdict_FRCH_storm14_10_01_abs)


                       
FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm1_05_31_NO3",
                                  "FRCH_storm1_05_31_fDOM",
                                  "FRCH_storm1_05_31_SPC",
                                  "FRCH_storm1_05_31_turb",
                                  "FRCH_storm1_05_31_abs",
                                  "FRCH_storm2_06_15_NO3",
                                  "FRCH_storm2_06_15_fDOM",
                                  "FRCH_storm2_06_15_SPC",
                                  "FRCH_storm2_06_15_turb",
                                  "FRCH_storm2_06_15_abs",
                                  "FRCH_storm3_06_18_NO3",
                                  "FRCH_storm3_06_18_fDOM",
                                  "FRCH_storm3_06_18_SPC",
                                  "FRCH_storm3_06_18_turb",
                                  "FRCH_storm3_06_18_abs",
                                  "FRCH_storm4_06_20_NO3",
                                  "FRCH_storm4_06_20_fDOM",
                                  "FRCH_storm4_06_20_SPC",
                                  "FRCH_storm4_06_20_turb",
                                  "FRCH_storm4_06_20_abs",
                                  "FRCH_storm5_06_22_NO3",
                                  "FRCH_storm5_06_22_fDOM",
                                  "FRCH_storm5_06_22_SPC",
                                  "FRCH_storm5_06_22_turb",
                                  "FRCH_storm5_06_22_abs",
                                  "FRCH_storm6_07_12_NO3",
                                  "FRCH_storm6_07_12_fDOM",
                                  "FRCH_storm6_07_12_SPC",
                                  "FRCH_storm6_07_12_turb",
                                  "FRCH_storm6_07_12_abs",
                                  
                                  
                                  "FRCH_storm10a_08_01_fDOM",
                                  "FRCH_storm10a_08_01_SPC",
                                  "FRCH_storm10a_08_01_turb",
                                  "FRCH_storm10a_08_01_abs",
                                  
                                  
                                  
                                  "FRCH_storm11_08_05_fDOM",
                                  "FRCH_storm11_08_05_SPC",
                                  "FRCH_storm11_08_05_turb",
                                  "FRCH_storm11_08_05_abs",
                                  
                                  "FRCH_storm12a_08_12_fDOM",
                                  "FRCH_storm12a_08_12_SPC",
                                  "FRCH_storm12a_08_12_turb",
                                 
                                
                                  
                                  "FRCH_storm12c_08_15_fDOM",
                                  "FRCH_storm12c_08_15_SPC",
                                  "FRCH_storm12c_08_15_turb",
                                  "FRCH_storm12c_08_15_abs",
                                  
                                  "FRCH_storm13_09_20_NO3",
                                  "FRCH_storm13_09_20_fDOM",
                                  "FRCH_storm13_09_20_SPC",
                                  "FRCH_storm13_09_20_turb",
                                  "FRCH_storm13_09_20_abs",
                                  "FRCH_storm14_10_01_NO3",
                                  "FRCH_storm14_10_01_fDOM",
                                  "FRCH_storm14_10_01_SPC",
                                  "FRCH_storm14_10_01_turb",
                                  "FRCH_storm14_10_01_abs"
                                  )


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, here("Output_from_analysis", "03_HI_FI", "2019", "FRCH", "FRCH.hyst.results.csv"))

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2019/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(rep("FRCH_storm1_05_31_NO3", 50),
                        rep("FRCH_storm1_05_31_fDOM", 50),
                        rep("FRCH_storm1_05_31_SPC", 50),
                        rep("FRCH_storm1_05_31_turb", 50),
                        rep("FRCH_storm1_05_31_abs", 50),
                        rep("FRCH_storm2_06_15_NO3", 50),
                        rep("FRCH_storm2_06_15_fDOM", 50),
                        rep("FRCH_storm2_06_15_SPC", 50),
                        rep("FRCH_storm2_06_15_turb", 50),
                        rep("FRCH_storm2_06_15_abs", 50),
                        rep("FRCH_storm3_06_18_NO3", 50),
                        rep("FRCH_storm3_06_18_fDOM", 50),
                        rep("FRCH_storm3_06_18_SPC", 50),
                        rep("FRCH_storm3_06_18_turb", 50),
                        rep("FRCH_storm3_06_18_abs", 50),
                        rep("FRCH_storm4_06_20_NO3", 50),
                        rep("FRCH_storm4_06_20_fDOM", 50),
                        rep("FRCH_storm4_06_20_SPC", 50),
                        rep("FRCH_storm4_06_20_turb", 50),
                        rep("FRCH_storm4_06_20_abs", 50),
                        rep("FRCH_storm5_06_22_NO3", 50),
                        rep("FRCH_storm5_06_22_fDOM", 50),
                        rep("FRCH_storm5_06_22_SPC", 50),
                        rep("FRCH_storm5_06_22_turb", 50),
                        rep("FRCH_storm5_06_22_abs", 50),
                        rep("FRCH_storm6_07_12_NO3", 50),
                        rep("FRCH_storm6_07_12_fDOM", 50),
                        rep("FRCH_storm6_07_12_SPC", 50),
                        rep("FRCH_storm6_07_12_turb", 50),
                        rep("FRCH_storm6_07_12_abs", 50),
                        
                        
                        rep("FRCH_storm10a_08_01_fDOM", 50),
                        rep("FRCH_storm10a_08_01_SPC", 50),
                        rep("FRCH_storm10a_08_01_turb", 50),
                        rep("FRCH_storm10a_08_01_abs", 50),
                        
                        
                  
                        
                        rep("FRCH_storm11_08_05_fDOM", 50),
                        rep("FRCH_storm11_08_05_SPC", 50),
                        rep("FRCH_storm11_08_05_turb", 50),
                        rep("FRCH_storm11_08_05_abs", 50),
                        
                        rep("FRCH_storm12a_08_12_fDOM", 50),
                        rep("FRCH_storm12a_08_12_SPC", 50),
                        rep("FRCH_storm12a_08_12_turb", 50),
                       
                      
                        
                        rep("FRCH_storm12c_08_15_fDOM", 50),
                        rep("FRCH_storm12c_08_15_SPC", 50),
                        rep("FRCH_storm12c_08_15_turb", 50),
                        rep("FRCH_storm12c_08_15_abs", 50),
                        
                        rep("FRCH_storm13_09_20_NO3", 50),
                        rep("FRCH_storm13_09_20_fDOM", 50),
                        rep("FRCH_storm13_09_20_SPC", 50),
                        rep("FRCH_storm13_09_20_turb", 50),
                        rep("FRCH_storm13_09_20_abs", 50),
                        rep("FRCH_storm14_10_01_NO3", 50),
                        rep("FRCH_storm14_10_01_fDOM", 50),
                        rep("FRCH_storm14_10_01_SPC", 50),
                        rep("FRCH_storm14_10_01_turb", 50),
                        rep("FRCH_storm14_10_01_abs", 50))
                   
                   

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2019", "FRCH", "FRCH.HI.median.boot.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(FRCH.HI.df, here("Output_from_analysis", "03_HI_FI", "2019", "FRCH", "FRCH.HI.df.csv"))


FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)


ggsave(here("plots", "HI_plots", "2019", "FRCH", "FRCH.HI.median.boot.doy.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(FRCH.HI.df, here("Output_from_analysis", "03_HI_FI", "2019", "FRCH", "FRCH.HI.df.doy.csv"))

```




```{python}
# STRT #
STRT_storm1_05_31_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm1_05_31_Q.csv'))
STRT_storm1_05_31_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm1_05_31_NO3.csv'))
STRT_storm1_05_31_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm1_05_31_fDOM.csv'))
STRT_storm1_05_31_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm1_05_31_SPC.csv'))
STRT_storm1_05_31_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm1_05_31_turb.csv'))
STRT_storm1_05_31_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm1_05_31_abs.csv'))

STRT_storm2_07_12_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm2_07_12_Q.csv'))
STRT_storm2_07_12_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm2_07_12_NO3.csv'))
STRT_storm2_07_12_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm2_07_12_fDOM.csv'))
STRT_storm2_07_12_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm2_07_12_SPC.csv'))
STRT_storm2_07_12_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm2_07_12_turb.csv'))
STRT_storm2_07_12_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm2_07_12_abs.csv'))

STRT_storm3a_07_25_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3a_07_25_Q.csv'))
STRT_storm3a_07_25_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3a_07_25_NO3.csv'))
STRT_storm3a_07_25_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3a_07_25_fDOM.csv'))
STRT_storm3a_07_25_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3a_07_25_SPC.csv'))
STRT_storm3a_07_25_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3a_07_25_turb.csv'))
STRT_storm3a_07_25_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3a_07_25_abs.csv'))

STRT_storm3b_08_05_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3b_08_05_Q.csv'))
STRT_storm3b_08_05_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3b_08_05_NO3.csv'))
STRT_storm3b_08_05_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3b_08_05_fDOM.csv'))
STRT_storm3b_08_05_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3b_08_05_SPC.csv'))
STRT_storm3b_08_05_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3b_08_05_turb.csv'))
STRT_storm3b_08_05_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3b_08_05_abs.csv'))

STRT_storm3c_08_12_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3c_08_12_Q.csv'))
STRT_storm3c_08_12_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3c_08_12_NO3.csv'))
STRT_storm3c_08_12_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3c_08_12_fDOM.csv'))
STRT_storm3c_08_12_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3c_08_12_SPC.csv'))
STRT_storm3c_08_12_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3c_08_12_turb.csv'))
STRT_storm3c_08_12_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm3c_08_12_abs.csv'))

STRT_storm4_08_15_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm4_08_15_Q.csv'))
STRT_storm4_08_15_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm4_08_15_NO3.csv'))
STRT_storm4_08_15_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm4_08_15_fDOM.csv'))
STRT_storm4_08_15_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm4_08_15_SPC.csv'))
STRT_storm4_08_15_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm4_08_15_turb.csv'))
STRT_storm4_08_15_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm4_08_15_abs.csv'))

STRT_storm5_08_20_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm5_08_20_Q.csv'))
STRT_storm5_08_20_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm5_08_20_NO3.csv'))
STRT_storm5_08_20_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm5_08_20_fDOM.csv'))
STRT_storm5_08_20_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm5_08_20_SPC.csv'))
STRT_storm5_08_20_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm5_08_20_turb.csv'))
STRT_storm5_08_20_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm5_08_20_abs.csv'))

STRT_storm6_09_20_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm6_09_20_Q.csv'))
STRT_storm6_09_20_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm6_09_20_NO3.csv'))
STRT_storm6_09_20_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm6_09_20_fDOM.csv'))
STRT_storm6_09_20_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm6_09_20_SPC.csv'))
STRT_storm6_09_20_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm6_09_20_turb.csv'))
STRT_storm6_09_20_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm6_09_20_abs.csv'))

STRT_storm7a_10_01_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7a_10_01_Q.csv'))
STRT_storm7a_10_01_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7a_10_01_NO3.csv'))
STRT_storm7a_10_01_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7a_10_01_fDOM.csv'))
STRT_storm7a_10_01_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7a_10_01_SPC.csv'))
STRT_storm7a_10_01_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7a_10_01_turb.csv'))
STRT_storm7a_10_01_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7a_10_01_abs.csv'))

STRT_storm7b_10_04_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7b_10_04_Q.csv'))
STRT_storm7b_10_04_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7b_10_04_NO3.csv'))
STRT_storm7b_10_04_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7b_10_04_fDOM.csv'))
STRT_storm7b_10_04_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7b_10_04_SPC.csv'))
STRT_storm7b_10_04_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7b_10_04_turb.csv'))
STRT_storm7b_10_04_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7b_10_04_abs.csv'))

STRT_storm7c_10_09_Q = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7c_10_09_Q.csv'))
STRT_storm7c_10_09_NO3 = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7c_10_09_NO3.csv'))
STRT_storm7c_10_09_fDOM = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7c_10_09_fDOM.csv'))
STRT_storm7c_10_09_SPC = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7c_10_09_SPC.csv'))
STRT_storm7c_10_09_turb = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7c_10_09_turb.csv'))
STRT_storm7c_10_09_abs = pd.read_csv(here('Storm_events/2019/STRT/STRT_storm7c_10_09_abs.csv'))

```

```{python}
## NO3 ##
STRT_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_05_31_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1_05_31_NO3 = hysteresisMetrics(STRT_storm1_05_31_Q, STRT_storm1_05_31_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_12_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_12_NO3 = hysteresisMetrics(STRT_storm2_07_12_Q, STRT_storm2_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3a_07_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3a_07_25_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3a_07_25_NO3 = hysteresisMetrics(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3b_08_05_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3b_08_05_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3b_08_05_NO3 = hysteresisMetrics(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3c_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3c_08_12_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3c_08_12_NO3 = hysteresisMetrics(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4_08_15_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4_08_15_NO3 = hysteresisMetrics(STRT_storm4_08_15_Q, STRT_storm4_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_20_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_20_NO3 = hysteresisMetrics(STRT_storm5_08_20_Q, STRT_storm5_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_09_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_09_20_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_09_20_NO3 = hysteresisMetrics(STRT_storm6_09_20_Q, STRT_storm6_09_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_10_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_10_01_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_10_01_NO3 = hysteresisMetrics(STRT_storm7a_10_01_Q, STRT_storm7a_10_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_10_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_10_04_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_10_04_NO3 = hysteresisMetrics(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7c_10_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7c_10_09_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7c_10_09_NO3 = hysteresisMetrics(STRT_storm7c_10_09_Q, STRT_storm7c_10_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
STRT_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_05_31_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1_05_31_fDOM = hysteresisMetrics(STRT_storm1_05_31_Q, STRT_storm1_05_31_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_12_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_12_fDOM = hysteresisMetrics(STRT_storm2_07_12_Q, STRT_storm2_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3a_07_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3a_07_25_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3a_07_25_fDOM = hysteresisMetrics(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3b_08_05_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3b_08_05_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3b_08_05_fDOM = hysteresisMetrics(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3c_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3c_08_12_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3c_08_12_fDOM = hysteresisMetrics(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4_08_15_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4_08_15_fDOM = hysteresisMetrics(STRT_storm4_08_15_Q, STRT_storm4_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_20_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_20_fDOM = hysteresisMetrics(STRT_storm5_08_20_Q, STRT_storm5_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_09_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_09_20_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_09_20_fDOM = hysteresisMetrics(STRT_storm6_09_20_Q, STRT_storm6_09_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_10_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_10_01_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_10_01_fDOM = hysteresisMetrics(STRT_storm7a_10_01_Q, STRT_storm7a_10_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_10_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_10_04_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_10_04_fDOM = hysteresisMetrics(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7c_10_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7c_10_09_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7c_10_09_fDOM = hysteresisMetrics(STRT_storm7c_10_09_Q, STRT_storm7c_10_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## SPC ##
STRT_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_05_31_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1_05_31_SPC = hysteresisMetrics(STRT_storm1_05_31_Q, STRT_storm1_05_31_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_12_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_12_SPC = hysteresisMetrics(STRT_storm2_07_12_Q, STRT_storm2_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3a_07_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3a_07_25_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3a_07_25_SPC = hysteresisMetrics(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3b_08_05_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3b_08_05_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3b_08_05_SPC = hysteresisMetrics(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3c_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3c_08_12_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3c_08_12_SPC = hysteresisMetrics(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4_08_15_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4_08_15_SPC = hysteresisMetrics(STRT_storm4_08_15_Q, STRT_storm4_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_20_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_20_SPC = hysteresisMetrics(STRT_storm5_08_20_Q, STRT_storm5_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_09_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_09_20_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_09_20_SPC = hysteresisMetrics(STRT_storm6_09_20_Q, STRT_storm6_09_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_10_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_10_01_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_10_01_SPC = hysteresisMetrics(STRT_storm7a_10_01_Q, STRT_storm7a_10_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_10_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_10_04_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_10_04_SPC = hysteresisMetrics(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7c_10_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7c_10_09_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7c_10_09_SPC = hysteresisMetrics(STRT_storm7c_10_09_Q, STRT_storm7c_10_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## turb ##
STRT_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_05_31_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1_05_31_turb = hysteresisMetrics(STRT_storm1_05_31_Q, STRT_storm1_05_31_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_12_turb['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_12_turb = hysteresisMetrics(STRT_storm2_07_12_Q, STRT_storm2_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3a_07_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3a_07_25_turb['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3a_07_25_turb = hysteresisMetrics(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3b_08_05_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3b_08_05_turb['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3b_08_05_turb = hysteresisMetrics(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3c_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3c_08_12_turb['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3c_08_12_turb = hysteresisMetrics(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4_08_15_turb['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4_08_15_turb = hysteresisMetrics(STRT_storm4_08_15_Q, STRT_storm4_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_20_turb['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_20_turb = hysteresisMetrics(STRT_storm5_08_20_Q, STRT_storm5_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_09_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_09_20_turb['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_09_20_turb = hysteresisMetrics(STRT_storm6_09_20_Q, STRT_storm6_09_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_10_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_10_01_turb['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_10_01_turb = hysteresisMetrics(STRT_storm7a_10_01_Q, STRT_storm7a_10_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_10_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_10_04_turb['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_10_04_turb = hysteresisMetrics(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7c_10_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7c_10_09_turb['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7c_10_09_turb = hysteresisMetrics(STRT_storm7c_10_09_Q, STRT_storm7c_10_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
STRT_storm1_05_31_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_05_31_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1_05_31_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1_05_31_abs = hysteresisMetrics(STRT_storm1_05_31_Q, STRT_storm1_05_31_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_12_abs['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_12_abs = hysteresisMetrics(STRT_storm2_07_12_Q, STRT_storm2_07_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3a_07_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3a_07_25_abs['valuedatetime'] =  pd.to_datetime(STRT_storm3a_07_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3a_07_25_abs = hysteresisMetrics(STRT_storm3a_07_25_Q, STRT_storm3a_07_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3b_08_05_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3b_08_05_abs['valuedatetime'] =  pd.to_datetime(STRT_storm3b_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3b_08_05_abs = hysteresisMetrics(STRT_storm3b_08_05_Q, STRT_storm3b_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3c_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3c_08_12_abs['valuedatetime'] =  pd.to_datetime(STRT_storm3c_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3c_08_12_abs = hysteresisMetrics(STRT_storm3c_08_12_Q, STRT_storm3c_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4_08_15_abs['valuedatetime'] =  pd.to_datetime(STRT_storm4_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4_08_15_abs = hysteresisMetrics(STRT_storm4_08_15_Q, STRT_storm4_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_20_abs['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_20_abs = hysteresisMetrics(STRT_storm5_08_20_Q, STRT_storm5_08_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_09_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_09_20_abs['valuedatetime'] =  pd.to_datetime(STRT_storm6_09_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_09_20_abs = hysteresisMetrics(STRT_storm6_09_20_Q, STRT_storm6_09_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_10_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_10_01_abs['valuedatetime'] =  pd.to_datetime(STRT_storm7a_10_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_10_01_abs = hysteresisMetrics(STRT_storm7a_10_01_Q, STRT_storm7a_10_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_10_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_10_04_abs['valuedatetime'] =  pd.to_datetime(STRT_storm7b_10_04_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_10_04_abs = hysteresisMetrics(STRT_storm7b_10_04_Q, STRT_storm7b_10_04_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7c_10_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7c_10_09_abs['valuedatetime'] =  pd.to_datetime(STRT_storm7c_10_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7c_10_09_abs = hysteresisMetrics(STRT_storm7c_10_09_Q, STRT_storm7c_10_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')
``` 

```{r}

STRT.hyst.results.list = list(py$hysdict_STRT_storm1_05_31_NO3,
                              py$hysdict_STRT_storm1_05_31_abs,
                              py$hysdict_STRT_storm2_07_12_NO3,
                              py$hysdict_STRT_storm2_07_12_fDOM,
                              py$hysdict_STRT_storm2_07_12_SPC,
                              py$hysdict_STRT_storm2_07_12_turb,
                              py$hysdict_STRT_storm2_07_12_abs,
                              py$hysdict_STRT_storm3a_07_25_fDOM,
                              py$hysdict_STRT_storm3a_07_25_SPC,
                              py$hysdict_STRT_storm3a_07_25_turb,
                              
                              py$hysdict_STRT_storm3b_08_05_NO3,
                              py$hysdict_STRT_storm3b_08_05_fDOM,
                              py$hysdict_STRT_storm3b_08_05_SPC,
                              py$hysdict_STRT_storm3b_08_05_turb,
                              py$hysdict_STRT_storm3b_08_05_abs,
                              py$hysdict_STRT_storm3c_08_12_NO3,
                              py$hysdict_STRT_storm3c_08_12_fDOM,
                              py$hysdict_STRT_storm3c_08_12_SPC,
                              py$hysdict_STRT_storm3c_08_12_turb,
                              py$hysdict_STRT_storm3c_08_12_abs,
                              py$hysdict_STRT_storm4_08_15_NO3,
                              py$hysdict_STRT_storm4_08_15_fDOM,
                              py$hysdict_STRT_storm4_08_15_SPC,
                              py$hysdict_STRT_storm4_08_15_turb,
                              py$hysdict_STRT_storm4_08_15_abs,
                              py$hysdict_STRT_storm5_08_20_NO3,
                              py$hysdict_STRT_storm5_08_20_fDOM,
                              py$hysdict_STRT_storm5_08_20_SPC,
                              py$hysdict_STRT_storm5_08_20_turb,
                              py$hysdict_STRT_storm5_08_20_abs,
                              py$hysdict_STRT_storm6_09_20_NO3,
                              py$hysdict_STRT_storm6_09_20_fDOM,
                              py$hysdict_STRT_storm6_09_20_SPC,
                              py$hysdict_STRT_storm6_09_20_turb,
                              py$hysdict_STRT_storm6_09_20_abs,
                              py$hysdict_STRT_storm7a_10_01_NO3,
                              py$hysdict_STRT_storm7a_10_01_fDOM,
                              py$hysdict_STRT_storm7a_10_01_SPC,
                              py$hysdict_STRT_storm7a_10_01_turb,
                              py$hysdict_STRT_storm7a_10_01_abs,
                              py$hysdict_STRT_storm7b_10_04_NO3,
                              py$hysdict_STRT_storm7b_10_04_fDOM,
                              py$hysdict_STRT_storm7b_10_04_SPC,
                              py$hysdict_STRT_storm7b_10_04_turb,
                              py$hysdict_STRT_storm7b_10_04_abs,
                              py$hysdict_STRT_storm7c_10_09_NO3,
                              py$hysdict_STRT_storm7c_10_09_fDOM,
                              py$hysdict_STRT_storm7c_10_09_SPC,
                              py$hysdict_STRT_storm7c_10_09_turb,
                              py$hysdict_STRT_storm7c_10_09_abs
                              )



STRT.hyst.results.list.2 = list()
for (i in 1:length(STRT.hyst.results.list)){
STRT.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
STRT.hyst.results.list[[i]][["HI_mean_with_Interp"]],
STRT.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
STRT.hyst.results.list[[i]][["Normalized slope of response"]],
STRT.hyst.results.list[[i]][["interpolated Max width of response"]],
STRT.hyst.results.list[[i]][["Min response"]],
STRT.hyst.results.list[[i]][["Max response"]],
STRT.hyst.results.list[[i]][["Peak Q"]]
))))
names(STRT.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(STRT.hyst.results.list)){
  HIs.list[[i]] = unlist(STRT.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

STRT.hyst.results.list.3 =list()
for (i in 1:length(STRT.hyst.results.list)){
  STRT.hyst.results.list.3[[i]] = cbind(STRT.hyst.results.list.2[[i]], HIs.tests[[i]])
}

STRT.hyst.results.df = bind_rows(STRT.hyst.results.list.3, .id = "column_label")

STRT.hyst.results.df$storm.ID = c("STRT_storm1_05_31_NO3",
                                  "STRT_storm1_05_31_abs",
                                  "STRT_storm2_07_12_NO3",
                                  "STRT_storm2_07_12_fDOM",
                                  "STRT_storm2_07_12_SPC",
                                  "STRT_storm2_07_12_turb",
                                  "STRT_storm2_07_12_abs",
                                  "STRT_storm3a_07_25_fDOM",
                                  "STRT_storm3a_07_25_SPC",
                                  "STRT_storm3a_07_25_turb",
                                  "STRT_storm3b_08_05_NO3",
                                  "STRT_storm3b_08_05_fDOM",
                                  "STRT_storm3b_08_05_SPC",
                                  "STRT_storm3b_08_05_turb",
                                  "STRT_storm3b_08_05_abs",
                                  "STRT_storm3c_08_12_NO3",
                                  "STRT_storm3c_08_12_fDOM",
                                  "STRT_storm3c_08_12_SPC",
                                  "STRT_storm3c_08_12_turb",
                                  "STRT_storm3c_08_12_abs",
                                  "STRT_storm4_08_15_NO3",
                                  "STRT_storm4_08_15_fDOM",
                                  "STRT_storm4_08_15_SPC",
                                  "STRT_storm4_08_15_turb",
                                  "STRT_storm4_08_15_abs",
                                  "STRT_storm5_08_20_NO3",
                                  "STRT_storm5_08_20_fDOM",
                                  "STRT_storm5_08_20_SPC",
                                  "STRT_storm5_08_20_turb",
                                  "STRT_storm5_08_20_abs",
                                  "STRT_storm6_09_20_NO3",
                                  "STRT_storm6_09_20_fDOM",
                                  "STRT_storm6_09_20_SPC",
                                  "STRT_storm6_09_20_turb",
                                  "STRT_storm6_09_20_abs",
                                  "STRT_storm7a_10_01_NO3",
                                  "STRT_storm7a_10_01_fDOM",
                                  "STRT_storm7a_10_01_SPC",
                                  "STRT_storm7a_10_01_turb",
                                  "STRT_storm7a_10_01_abs",
                                  "STRT_storm7b_10_04_NO3",
                                  "STRT_storm7b_10_04_fDOM",
                                  "STRT_storm7b_10_04_SPC",
                                  "STRT_storm7b_10_04_turb",
                                  "STRT_storm7b_10_04_abs",
                                  "STRT_storm7c_10_09_NO3",
                                  "STRT_storm7c_10_09_fDOM",
                                  "STRT_storm7c_10_09_SPC",
                                  "STRT_storm7c_10_09_turb",
                                  "STRT_storm7c_10_09_abs"
                                  )


              

STRT.hyst.results.df$site.ID = "STRT"

write.csv(STRT.hyst.results.df, here("Output_from_analysis", "03_HI_FI", "2019", "STRT", "STRT.hyst.results.csv"))

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2019/STRT/STRT.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= STRT.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

STRT.HI.df = bind_rows(HIs.df.list, .id = "column_label")
STRT.HI.df$storm.ID = c(rep("STRT_storm1_05_31_NO3", 50),
                        rep("STRT_storm1_05_31_abs", 50),
                        rep("STRT_storm2_07_12_NO3", 50),
                        rep("STRT_storm2_07_12_fDOM", 50),
                        rep("STRT_storm2_07_12_SPC", 50),
                        rep("STRT_storm2_07_12_turb", 50),
                        rep("STRT_storm2_07_12_abs", 50),
                        rep("STRT_storm3a_07_25_fDOM", 50),
                        rep("STRT_storm3a_07_25_SPC", 50),
                        rep("STRT_storm3a_07_25_turb", 50),
                        rep("STRT_storm3b_08_05_NO3", 50),
                        rep("STRT_storm3b_08_05_fDOM", 50),
                        rep("STRT_storm3b_08_05_SPC", 50),
                        rep("STRT_storm3b_08_05_turb", 50),
                        rep("STRT_storm3b_08_05_abs", 50),
                        rep("STRT_storm3c_08_12_NO3", 50),
                        rep("STRT_storm3c_08_12_fDOM", 50),
                        rep("STRT_storm3c_08_12_SPC", 50),
                        rep("STRT_storm3c_08_12_turb", 50),
                        rep("STRT_storm3c_08_12_abs", 50),
                        rep("STRT_storm4_08_15_NO3", 50),
                        rep("STRT_storm4_08_15_fDOM", 50),
                        rep("STRT_storm4_08_15_SPC", 50),
                        rep("STRT_storm4_08_15_turb", 50),
                        rep("STRT_storm4_08_15_abs", 50),
                        rep("STRT_storm5_08_20_NO3", 50),
                        rep("STRT_storm5_08_20_fDOM", 50),
                        rep("STRT_storm5_08_20_SPC", 50),
                        rep("STRT_storm5_08_20_turb", 50),
                        rep("STRT_storm5_08_20_abs", 50),
                        rep("STRT_storm6_09_20_NO3", 50),
                        rep("STRT_storm6_09_20_fDOM", 50),
                        rep("STRT_storm6_09_20_SPC", 50),
                        rep("STRT_storm6_09_20_turb", 50),
                        rep("STRT_storm6_09_20_abs", 50),
                        rep("STRT_storm7a_10_01_NO3", 50),
                        rep("STRT_storm7a_10_01_fDOM", 50),
                        rep("STRT_storm7a_10_01_SPC", 50),
                        rep("STRT_storm7a_10_01_turb", 50),
                        rep("STRT_storm7a_10_01_abs", 50),
                        rep("STRT_storm7b_10_04_NO3", 50),
                        rep("STRT_storm7b_10_04_fDOM", 50),
                        rep("STRT_storm7b_10_04_SPC", 50),
                        rep("STRT_storm7b_10_04_turb", 50),
                        rep("STRT_storm7b_10_04_abs", 50),
                        rep("STRT_storm7c_10_09_NO3", 50),
                        rep("STRT_storm7c_10_09_fDOM", 50),
                        rep("STRT_storm7c_10_09_SPC", 50),
                        rep("STRT_storm7c_10_09_turb", 50),
                        rep("STRT_storm7c_10_09_abs", 50))


STRT.HI.df$storm.ID = as.factor(STRT.HI.df$storm.ID)
STRT.HI.df = separate(data=STRT.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(STRT.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2019", "STRT", "STRT.HI.median.boot.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(STRT.HI.df, here("Output_from_analysis", "03_HI_FI", "2019", "STRT", "STRT.HI.df.csv"))

STRT.HI.df$date <- as.Date(with(STRT.HI.df, paste(month, day, sep = "-")), "%m-%d")
STRT.HI.df$doy <- yday(STRT.HI.df$date) 

g0 <- ggplot(STRT.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave(here("plots", "HI_plots", "2019", "STRT", "STRT.HI.median.boot.doy.pdf"), plot = g2,
       width = 8, height = 6, units = "in")

write.csv(STRT.HI.df, here("Output_from_analysis", "03_HI_FI", "2019", "STRT", "STRT.HI.df.doy.csv"))


```


```{python}
# POKE #
POKE_storm1_06_30_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm1_06_30_Q.csv")
POKE_storm1_06_30_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm1_06_30_NO3.csv")
POKE_storm1_06_30_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm1_06_30_fDOM.csv")
POKE_storm1_06_30_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm1_06_30_SPC.csv")
POKE_storm1_06_30_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm1_06_30_Turb.csv")
POKE_storm1_06_30_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm1_06_30_abs.csv")

POKE_storm2_07_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm2_07_12_Q.csv")
POKE_storm2_07_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm2_07_12_NO3.csv")
POKE_storm2_07_12_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm2_07_12_fDOM.csv")
POKE_storm2_07_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm2_07_12_SPC.csv")
POKE_storm2_07_12_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm2_07_12_Turb.csv")
POKE_storm2_07_12_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm2_07_12_abs.csv")


POKE_storm3_07_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm3_07_26_Q.csv")
POKE_storm3_07_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm3_07_26_NO3.csv")
POKE_storm3_07_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm3_07_26_fDOM.csv")
POKE_storm3_07_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm3_07_26_SPC.csv")
POKE_storm3_07_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm3_07_26_Turb.csv")
POKE_storm3_07_26_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm3_07_26_abs.csv")

POKE_storm4_07_31_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm4_07_31_Q.csv")
POKE_storm4_07_31_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm4_07_31_NO3.csv")
POKE_storm4_07_31_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm4_07_31_fDOM.csv")
POKE_storm4_07_31_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm4_07_31_SPC.csv")
POKE_storm4_07_31_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm4_07_31_Turb.csv")
POKE_storm4_07_31_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm4_07_31_abs.csv")

POKE_storm5a_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5a_08_02_Q.csv")
POKE_storm5a_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5a_08_02_NO3.csv")
POKE_storm5a_08_02_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5a_08_02_fDOM.csv")
POKE_storm5a_08_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5a_08_02_SPC.csv")
POKE_storm5a_08_02_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5a_08_02_Turb.csv")
POKE_storm5a_08_02_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5a_08_02_abs.csv")

POKE_storm5b_08_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5b_08_03_Q.csv")
POKE_storm5b_08_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5b_08_03_NO3.csv")
POKE_storm5b_08_03_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5b_08_03_fDOM.csv")
POKE_storm5b_08_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5b_08_03_SPC.csv")
POKE_storm5b_08_03_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5b_08_03_Turb.csv")
POKE_storm5b_08_03_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5b_08_03_abs.csv")

POKE_storm5c_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5c_08_05_Q.csv")
POKE_storm5c_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5c_08_05_NO3.csv")
POKE_storm5c_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5c_08_05_fDOM.csv")
POKE_storm5c_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5c_08_05_SPC.csv")
POKE_storm5c_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5c_08_05_Turb.csv")
POKE_storm5c_08_05_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5c_08_05_abs.csv")

POKE_storm5d_08_10_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5d_08_10_Q.csv")
POKE_storm5d_08_10_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5d_08_10_NO3.csv")
POKE_storm5d_08_10_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5d_08_10_fDOM.csv")
POKE_storm5d_08_10_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5d_08_10_SPC.csv")
POKE_storm5d_08_10_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5d_08_10_Turb.csv")
POKE_storm5d_08_10_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm5d_08_10_abs.csv")

POKE_storm6a_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6a_08_12_Q.csv")
POKE_storm6a_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6a_08_12_NO3.csv")
POKE_storm6a_08_12_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6a_08_12_fDOM.csv")
POKE_storm6a_08_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6a_08_12_SPC.csv")
POKE_storm6a_08_12_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6a_08_12_Turb.csv")
POKE_storm6a_08_12_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6a_08_12_abs.csv")

POKE_storm6b_08_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6b_08_13_Q.csv")
POKE_storm6b_08_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6b_08_13_NO3.csv")
POKE_storm6b_08_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6b_08_13_fDOM.csv")
POKE_storm6b_08_13_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6b_08_13_SPC.csv")
POKE_storm6b_08_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6b_08_13_Turb.csv")
POKE_storm6b_08_13_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm6b_08_13_abs.csv")

POKE_storm7_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm7_08_15_Q.csv")
POKE_storm7_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm7_08_15_NO3.csv")
POKE_storm7_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm7_08_15_fDOM.csv")
POKE_storm7_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm7_08_15_SPC.csv")
POKE_storm7_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm7_08_15_Turb.csv")
POKE_storm7_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm7_08_15_abs.csv")

POKE_storm8_09_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm8_09_29_Q.csv")
POKE_storm8_09_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm8_09_29_NO3.csv")
POKE_storm8_09_29_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm8_09_29_fDOM.csv")
POKE_storm8_09_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm8_09_29_SPC.csv")
POKE_storm8_09_29_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm8_09_29_Turb.csv")
POKE_storm8_09_29_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm8_09_29_abs.csv")

POKE_storm9_10_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm9_10_04_Q.csv")
POKE_storm9_10_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm9_10_04_NO3.csv")
POKE_storm9_10_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm9_10_04_fDOM.csv")
POKE_storm9_10_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm9_10_04_SPC.csv")
POKE_storm9_10_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm9_10_04_Turb.csv")
POKE_storm9_10_04_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/POKE/POKE_storm9_10_04_abs.csv")

```

```{python}
## NO3 ##
POKE_storm1_06_30_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_30_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_30_NO3 = hysteresisMetrics(POKE_storm1_06_30_Q, POKE_storm1_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_07_12_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_07_12_NO3 = hysteresisMetrics(POKE_storm2_07_12_Q, POKE_storm2_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_07_26_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_07_26_NO3 = hysteresisMetrics(POKE_storm3_07_26_Q, POKE_storm3_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_31_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_31_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_07_31_NO3 = hysteresisMetrics(POKE_storm4_07_31_Q, POKE_storm4_07_31_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5a_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5a_08_02_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5a_08_02_NO3 = hysteresisMetrics(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5b_08_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5b_08_03_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5b_08_03_NO3 = hysteresisMetrics(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5c_08_05_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5c_08_05_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5c_08_05_NO3 = hysteresisMetrics(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5d_08_10_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5d_08_10_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5d_08_10_NO3 = hysteresisMetrics(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6a_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6a_08_12_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6a_08_12_NO3 = hysteresisMetrics(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6b_08_13_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6b_08_13_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6b_08_13_NO3 = hysteresisMetrics(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_08_15_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_08_15_NO3 = hysteresisMetrics(POKE_storm7_08_15_Q, POKE_storm7_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_09_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_09_29_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_09_29_NO3 = hysteresisMetrics(POKE_storm8_09_29_Q, POKE_storm8_09_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_10_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_10_04_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_10_04_NO3 = hysteresisMetrics(POKE_storm9_10_04_Q, POKE_storm9_10_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
POKE_storm1_06_30_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_30_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_30_fDOM = hysteresisMetrics(POKE_storm1_06_30_Q, POKE_storm1_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_07_12_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_07_12_fDOM = hysteresisMetrics(POKE_storm2_07_12_Q, POKE_storm2_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_07_26_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_07_26_fDOM = hysteresisMetrics(POKE_storm3_07_26_Q, POKE_storm3_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_31_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_31_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_07_31_fDOM = hysteresisMetrics(POKE_storm4_07_31_Q, POKE_storm4_07_31_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5a_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5a_08_02_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5a_08_02_fDOM = hysteresisMetrics(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5b_08_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5b_08_03_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5b_08_03_fDOM = hysteresisMetrics(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5c_08_05_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5c_08_05_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5c_08_05_fDOM = hysteresisMetrics(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5d_08_10_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5d_08_10_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5d_08_10_fDOM = hysteresisMetrics(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6a_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6a_08_12_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6a_08_12_fDOM = hysteresisMetrics(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6b_08_13_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6b_08_13_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6b_08_13_fDOM = hysteresisMetrics(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_08_15_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_08_15_fDOM = hysteresisMetrics(POKE_storm7_08_15_Q, POKE_storm7_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_09_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_09_29_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_09_29_fDOM = hysteresisMetrics(POKE_storm8_09_29_Q, POKE_storm8_09_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_10_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_10_04_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_10_04_fDOM = hysteresisMetrics(POKE_storm9_10_04_Q, POKE_storm9_10_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')



## SPC ##
POKE_storm1_06_30_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_30_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_30_SPC = hysteresisMetrics(POKE_storm1_06_30_Q, POKE_storm1_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')
 
POKE_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_07_12_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_07_12_SPC = hysteresisMetrics(POKE_storm2_07_12_Q, POKE_storm2_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_07_26_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_07_26_SPC = hysteresisMetrics(POKE_storm3_07_26_Q, POKE_storm3_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_31_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_31_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_07_31_SPC = hysteresisMetrics(POKE_storm4_07_31_Q, POKE_storm4_07_31_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5a_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5a_08_02_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5a_08_02_SPC = hysteresisMetrics(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5b_08_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5b_08_03_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5b_08_03_SPC = hysteresisMetrics(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5c_08_05_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5c_08_05_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5c_08_05_SPC = hysteresisMetrics(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5d_08_10_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5d_08_10_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5d_08_10_SPC = hysteresisMetrics(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6a_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6a_08_12_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6a_08_12_SPC = hysteresisMetrics(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6b_08_13_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6b_08_13_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6b_08_13_SPC = hysteresisMetrics(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_08_15_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_08_15_SPC = hysteresisMetrics(POKE_storm7_08_15_Q, POKE_storm7_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_09_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_09_29_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_09_29_SPC = hysteresisMetrics(POKE_storm8_09_29_Q, POKE_storm8_09_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_10_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_10_04_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_10_04_SPC = hysteresisMetrics(POKE_storm9_10_04_Q, POKE_storm9_10_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
POKE_storm1_06_30_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_30_turb['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_30_turb = hysteresisMetrics(POKE_storm1_06_30_Q, POKE_storm1_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_07_12_turb['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_07_12_turb = hysteresisMetrics(POKE_storm2_07_12_Q, POKE_storm2_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_07_26_turb['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_07_26_turb = hysteresisMetrics(POKE_storm3_07_26_Q, POKE_storm3_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_31_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_31_turb['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_07_31_turb = hysteresisMetrics(POKE_storm4_07_31_Q, POKE_storm4_07_31_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5a_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5a_08_02_turb['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5a_08_02_turb = hysteresisMetrics(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5b_08_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5b_08_03_turb['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5b_08_03_turb = hysteresisMetrics(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5c_08_05_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5c_08_05_turb['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5c_08_05_turb = hysteresisMetrics(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5d_08_10_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5d_08_10_turb['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5d_08_10_turb = hysteresisMetrics(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6a_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6a_08_12_turb['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6a_08_12_turb = hysteresisMetrics(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6b_08_13_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6b_08_13_turb['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6b_08_13_turb = hysteresisMetrics(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_08_15_turb['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_08_15_turb = hysteresisMetrics(POKE_storm7_08_15_Q, POKE_storm7_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_09_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_09_29_turb['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_09_29_turb = hysteresisMetrics(POKE_storm8_09_29_Q, POKE_storm8_09_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_10_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_10_04_turb['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_10_04_turb = hysteresisMetrics(POKE_storm9_10_04_Q, POKE_storm9_10_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
POKE_storm1_06_30_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_30_abs['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_30_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_30_abs = hysteresisMetrics(POKE_storm1_06_30_Q, POKE_storm1_06_30_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_07_12_abs['valuedatetime'] =  pd.to_datetime(POKE_storm2_07_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_07_12_abs = hysteresisMetrics(POKE_storm2_07_12_Q, POKE_storm2_07_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_07_26_abs['valuedatetime'] =  pd.to_datetime(POKE_storm3_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_07_26_abs = hysteresisMetrics(POKE_storm3_07_26_Q, POKE_storm3_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_31_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_31_abs['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_31_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_07_31_abs = hysteresisMetrics(POKE_storm4_07_31_Q, POKE_storm4_07_31_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5a_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5a_08_02_abs['valuedatetime'] =  pd.to_datetime(POKE_storm5a_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5a_08_02_abs = hysteresisMetrics(POKE_storm5a_08_02_Q, POKE_storm5a_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5b_08_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5b_08_03_abs['valuedatetime'] =  pd.to_datetime(POKE_storm5b_08_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5b_08_03_abs = hysteresisMetrics(POKE_storm5b_08_03_Q, POKE_storm5b_08_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5c_08_05_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5c_08_05_abs['valuedatetime'] =  pd.to_datetime(POKE_storm5c_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5c_08_05_abs = hysteresisMetrics(POKE_storm5c_08_05_Q, POKE_storm5c_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5d_08_10_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5d_08_10_abs['valuedatetime'] =  pd.to_datetime(POKE_storm5d_08_10_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5d_08_10_abs = hysteresisMetrics(POKE_storm5d_08_10_Q, POKE_storm5d_08_10_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6a_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6a_08_12_abs['valuedatetime'] =  pd.to_datetime(POKE_storm6a_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6a_08_12_abs = hysteresisMetrics(POKE_storm6a_08_12_Q, POKE_storm6a_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6b_08_13_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6b_08_13_abs['valuedatetime'] =  pd.to_datetime(POKE_storm6b_08_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6b_08_13_abs = hysteresisMetrics(POKE_storm6b_08_13_Q, POKE_storm6b_08_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_08_15_abs['valuedatetime'] =  pd.to_datetime(POKE_storm7_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_08_15_abs = hysteresisMetrics(POKE_storm7_08_15_Q, POKE_storm7_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_09_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_09_29_abs['valuedatetime'] =  pd.to_datetime(POKE_storm8_09_29_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_09_29_abs = hysteresisMetrics(POKE_storm8_09_29_Q, POKE_storm8_09_29_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_10_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_10_04_abs['valuedatetime'] =  pd.to_datetime(POKE_storm9_10_04_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_10_04_abs = hysteresisMetrics(POKE_storm9_10_04_Q, POKE_storm9_10_04_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

POKE results
```{r}

POKE.hyst.results.list = list(py$hysdict_POKE_storm1_06_30_NO3,
                              py$hysdict_POKE_storm1_06_30_fDOM,
                              py$hysdict_POKE_storm1_06_30_SPC,
                              py$hysdict_POKE_storm1_06_30_turb,
                              py$hysdict_POKE_storm1_06_30_abs,
                              py$hysdict_POKE_storm2_07_12_NO3,
                              py$hysdict_POKE_storm2_07_12_fDOM,
                              py$hysdict_POKE_storm2_07_12_SPC,
                              py$hysdict_POKE_storm2_07_12_turb,
                              py$hysdict_POKE_storm2_07_12_abs,
                              py$hysdict_POKE_storm3_07_26_NO3,
                              py$hysdict_POKE_storm3_07_26_fDOM,
                              py$hysdict_POKE_storm3_07_26_SPC,
                              py$hysdict_POKE_storm3_07_26_turb,
                              py$hysdict_POKE_storm3_07_26_abs,
                              py$hysdict_POKE_storm4_07_31_NO3,
                              py$hysdict_POKE_storm4_07_31_fDOM,
                              py$hysdict_POKE_storm4_07_31_SPC,
                              py$hysdict_POKE_storm4_07_31_turb,
                              py$hysdict_POKE_storm4_07_31_abs,
                              py$hysdict_POKE_storm5a_08_02_NO3,
                              py$hysdict_POKE_storm5a_08_02_fDOM,
                              py$hysdict_POKE_storm5a_08_02_SPC,
                              py$hysdict_POKE_storm5a_08_02_turb,
                              py$hysdict_POKE_storm5a_08_02_abs,
                              py$hysdict_POKE_storm5b_08_03_NO3,
                              py$hysdict_POKE_storm5b_08_03_fDOM,
                              py$hysdict_POKE_storm5b_08_03_SPC,
                              py$hysdict_POKE_storm5b_08_03_turb,
                              py$hysdict_POKE_storm5b_08_03_abs,
                              py$hysdict_POKE_storm5c_08_05_NO3,
                              py$hysdict_POKE_storm5c_08_05_fDOM,
                              py$hysdict_POKE_storm5c_08_05_SPC,
                              py$hysdict_POKE_storm5c_08_05_turb,
                              py$hysdict_POKE_storm5c_08_05_abs,
                              py$hysdict_POKE_storm5d_08_10_NO3,
                              py$hysdict_POKE_storm5d_08_10_fDOM,
                              py$hysdict_POKE_storm5d_08_10_SPC,
                              py$hysdict_POKE_storm5d_08_10_turb,
                              py$hysdict_POKE_storm5d_08_10_abs,
                              
                              py$hysdict_POKE_storm6b_08_13_NO3,
                              py$hysdict_POKE_storm6b_08_13_fDOM,
                              py$hysdict_POKE_storm6b_08_13_SPC,
                              py$hysdict_POKE_storm6b_08_13_turb,
                              py$hysdict_POKE_storm6b_08_13_abs,
                              py$hysdict_POKE_storm7_08_15_NO3,
                              py$hysdict_POKE_storm7_08_15_fDOM,
                              py$hysdict_POKE_storm7_08_15_SPC,
                              py$hysdict_POKE_storm7_08_15_turb,
                              py$hysdict_POKE_storm7_08_15_abs,
                              py$hysdict_POKE_storm8_09_29_NO3,
                              py$hysdict_POKE_storm8_09_29_fDOM,
                              py$hysdict_POKE_storm8_09_29_SPC,
                              py$hysdict_POKE_storm8_09_29_turb,
                              py$hysdict_POKE_storm8_09_29_abs,
                              py$hysdict_POKE_storm9_10_04_NO3,
                              py$hysdict_POKE_storm9_10_04_fDOM,
                              py$hysdict_POKE_storm9_10_04_SPC,
                              py$hysdict_POKE_storm9_10_04_turb,
                              py$hysdict_POKE_storm9_10_04_abs)
                              

POKE.hyst.results.list.2 = list()
for (i in 1:length(POKE.hyst.results.list)){
POKE.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
POKE.hyst.results.list[[i]][["HI_mean_with_Interp"]],
POKE.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
POKE.hyst.results.list[[i]][["Normalized slope of response"]],
POKE.hyst.results.list[[i]][["interpolated Max width of response"]],
POKE.hyst.results.list[[i]][["Min response"]],
POKE.hyst.results.list[[i]][["Max response"]],
POKE.hyst.results.list[[i]][["Peak Q"]]
))))
names(POKE.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(POKE.hyst.results.list)){
  HIs.list[[i]] = unlist(POKE.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

POKE.hyst.results.list.3 =list()
for (i in 1:length(POKE.hyst.results.list)){
  POKE.hyst.results.list.3[[i]] = cbind(POKE.hyst.results.list.2[[i]], HIs.tests[[i]])
}

POKE.hyst.results.df = bind_rows(POKE.hyst.results.list.3, .id = "column_label")

POKE.hyst.results.df$storm.ID = c("POKE_storm1_06_30_NO3",
                                  "POKE_storm1_06_30_fDOM",
                                  "POKE_storm1_06_30_SPC",
                                  "POKE_storm1_06_30_turb",
                                  "POKE_storm1_06_30_abs",
                                  "POKE_storm2_07_12_NO3",
                                  "POKE_storm2_07_12_fDOM",
                                  "POKE_storm2_07_12_SPC",
                                  "POKE_storm2_07_12_turb",
                                  "POKE_storm2_07_12_abs",
                                  "POKE_storm3_07_26_NO3",
                                  "POKE_storm3_07_26_fDOM",
                                  "POKE_storm3_07_26_SPC",
                                  "POKE_storm3_07_26_turb",
                                  "POKE_storm3_07_26_abs",
                                  "POKE_storm4_07_31_NO3",
                                  "POKE_storm4_07_31_fDOM",
                                  "POKE_storm4_07_31_SPC",
                                  "POKE_storm4_07_31_turb",
                                  "POKE_storm4_07_31_abs",
                                  "POKE_storm5a_08_02_NO3",
                                  "POKE_storm5a_08_02_fDOM",
                                  "POKE_storm5a_08_02_SPC",
                                  "POKE_storm5a_08_02_turb",
                                  "POKE_storm5a_08_02_abs",
                                  "POKE_storm5b_08_03_NO3",
                                  "POKE_storm5b_08_03_fDOM",
                                  "POKE_storm5b_08_03_SPC",
                                  "POKE_storm5b_08_03_turb",
                                  "POKE_storm5b_08_03_abs",
                                  "POKE_storm5c_08_05_NO3",
                                  "POKE_storm5c_08_05_fDOM",
                                  "POKE_storm5c_08_05_SPC",
                                  "POKE_storm5c_08_05_turb",
                                  "POKE_storm5c_08_05_abs",
                                  "POKE_storm5d_08_10_NO3",
                                  "POKE_storm5d_08_10_fDOM",
                                  "POKE_storm5d_08_10_SPC",
                                  "POKE_storm5d_08_10_turb",
                                  "POKE_storm5d_08_10_abs",
                                  
                                  "POKE_storm6b_08_13_NO3",
                                  "POKE_storm6b_08_13_fDOM",
                                  "POKE_storm6b_08_13_SPC",
                                  "POKE_storm6b_08_13_turb",
                                  "POKE_storm6b_08_13_abs",
                                  "POKE_storm7_08_15_NO3",
                                  "POKE_storm7_08_15_fDOM",
                                  "POKE_storm7_08_15_SPC",
                                  "POKE_storm7_08_15_turb",
                                  "POKE_storm7_08_15_abs",
                                  "POKE_storm8_09_29_NO3",
                                  "POKE_storm8_09_29_fDOM",
                                  "POKE_storm8_09_29_SPC",
                                  "POKE_storm8_09_29_turb",
                                  "POKE_storm8_09_29_abs",
                                  "POKE_storm9_10_04_NO3",
                                  "POKE_storm9_10_04_fDOM",
                                  "POKE_storm9_10_04_SPC",
                                  "POKE_storm9_10_04_turb",
                                  "POKE_storm9_10_04_abs")


              

POKE.hyst.results.df$site.ID = "POKE"

write.csv(POKE.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/POKE/POKE.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2019/POKE/POKE.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= POKE.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

POKE.HI.df = bind_rows(HIs.df.list, .id = "column_label")
POKE.HI.df$storm.ID = c(rep("POKE_storm1_06_30_NO3", 50),
                        rep("POKE_storm1_06_30_fDOM", 50),
                        rep("POKE_storm1_06_30_SPC", 50),
                        rep("POKE_storm1_06_30_turb", 50),
                        rep("POKE_storm1_06_30_abs", 50),
                        rep("POKE_storm2_07_12_NO3", 50),
                        rep("POKE_storm2_07_12_fDOM", 50),
                        rep("POKE_storm2_07_12_SPC", 50),
                        rep("POKE_storm2_07_12_turb", 50),
                        rep("POKE_storm2_07_12_abs", 50),
                        rep("POKE_storm3_07_12_NO3", 50),
                        rep("POKE_storm3_07_12_fDOM", 50),
                        rep("POKE_storm3_07_12_SPC", 50),
                        rep("POKE_storm3_07_12_turb", 50),
                        rep("POKE_storm3_07_12_abs", 50),
                        rep("POKE_storm4_07_31_NO3", 50),
                        rep("POKE_storm4_07_31_fDOM", 50),
                        rep("POKE_storm4_07_31_SPC", 50),
                        rep("POKE_storm4_07_31_turb", 50),
                        rep("POKE_storm4_07_31_abs", 50),
                        rep("POKE_storm5a_08_02_NO3", 50),
                        rep("POKE_storm5a_08_02_fDOM", 50),
                        rep("POKE_storm5a_08_02_SPC", 49),
                        rep("POKE_storm5a_08_02_turb", 50),
                        rep("POKE_storm5a_08_02_abs", 50),
                        rep("POKE_storm5b_08_03_NO3", 50),
                        rep("POKE_storm5b_08_03_fDOM", 50),
                        rep("POKE_storm5b_08_03_SPC", 50),
                        rep("POKE_storm5b_08_03_turb", 50),
                        rep("POKE_storm5b_08_03_abs", 50),
                        rep("POKE_storm5c_08_05_NO3", 50),
                        rep("POKE_storm5c_08_05_fDOM", 50),
                        rep("POKE_storm5c_08_05_SPC", 50),
                        rep("POKE_storm5c_08_05_turb", 50),
                        rep("POKE_storm5c_08_05_abs", 50),
                        rep("POKE_storm5d_08_10_NO3", 50),
                        rep("POKE_storm5d_08_10_fDOM", 50),
                        rep("POKE_storm5d_08_10_SPC", 50),
                        rep("POKE_storm5d_08_10_turb", 50),
                        rep("POKE_storm5d_08_10_abs", 50),
                        rep("POKE_storm6b_08_13_NO3", 50),
                        rep("POKE_storm6b_08_13_fDOM", 50),
                        rep("POKE_storm6b_08_13_SPC", 50),
                        rep("POKE_storm6b_08_13_turb", 50),
                        rep("POKE_storm6b_08_13_abs", 50),
                        rep("POKE_storm7_08_15_NO3", 50),
                        rep("POKE_storm7_08_15_fDOM", 50),
                        rep("POKE_storm7_08_15_SPC", 50),
                        rep("POKE_storm7_08_15_turb", 50),
                        rep("POKE_storm7_08_15_abs", 50),
                        rep("POKE_storm8_09_29_NO3", 50),
                        rep("POKE_storm8_09_29_fDOM", 50),
                        rep("POKE_storm8_09_29_SPC", 50),
                        rep("POKE_storm8_09_29_turb", 50),
                        rep("POKE_storm8_09_29_abs", 50),
                        rep("POKE_storm9_10_04_NO3", 50),
                        rep("POKE_storm9_10_04_fDOM", 50),
                        rep("POKE_storm9_10_04_SPC", 50),
                        rep("POKE_storm9_10_04_turb", 50),
                        rep("POKE_storm9_10_04_abs", 50))


POKE.HI.df$storm.ID = as.factor(POKE.HI.df$storm.ID)
POKE.HI.df = separate(data=POKE.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}

g0 <- ggplot(POKE.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/POKE/POKE.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/POKE/POKE.HI.df.csv")

POKE.HI.df$date <- as.Date(with(POKE.HI.df, paste(month, day, sep = "-")), "%m-%d")
POKE.HI.df$doy <- yday(POKE.HI.df$date) 

g0 <- ggplot(POKE.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/POKE/POKE.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/POKE/POKE.HI.df.doy.csv")

```

### MOOS ### 
```{python}
# MOOS #
MOOS_storm1_06_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm1_06_01_Q.csv")
MOOS_storm1_06_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm1_06_01_NO3.csv")
MOOS_storm1_06_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm1_06_01_fDOM.csv")
MOOS_storm1_06_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm1_06_01_SPC.csv")
MOOS_storm1_06_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm1_06_01_Turb.csv")
MOOS_storm1_06_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm1_06_01_abs.csv")

MOOS_storm3_07_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm3_07_12_Q.csv")
MOOS_storm3_07_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm3_07_12_NO3.csv")
MOOS_storm3_07_12_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm3_07_12_fDOM.csv")
MOOS_storm3_07_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm3_07_12_SPC.csv")
MOOS_storm3_07_12_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm3_07_12_Turb.csv")
MOOS_storm3_07_12_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm3_07_12_abs.csv")

MOOS_storm4_07_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm4_07_25_Q.csv")
MOOS_storm4_07_25_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm4_07_25_NO3.csv")
MOOS_storm4_07_25_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm4_07_25_fDOM.csv")
MOOS_storm4_07_25_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm4_07_25_SPC.csv")
MOOS_storm4_07_25_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm4_07_25_Turb.csv")
MOOS_storm4_07_25_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm4_07_25_abs.csv")

MOOS_storm5_07_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm5_07_29_Q.csv")
MOOS_storm5_07_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm5_07_29_NO3.csv")
MOOS_storm5_07_29_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm5_07_29_fDOM.csv")
MOOS_storm5_07_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm5_07_29_SPC.csv")
MOOS_storm5_07_29_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm5_07_29_Turb.csv")
MOOS_storm5_07_29_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm5_07_29_abs.csv")

MOOS_storm6a_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6a_08_01_Q.csv")
MOOS_storm6a_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6a_08_01_NO3.csv")
MOOS_storm6a_08_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6a_08_01_fDOM.csv")
MOOS_storm6a_08_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6a_08_01_SPC.csv")
MOOS_storm6a_08_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6a_08_01_Turb.csv")
MOOS_storm6a_08_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6a_08_01_abs.csv")

MOOS_storm6b_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6b_08_02_Q.csv")
MOOS_storm6b_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6b_08_02_NO3.csv")
MOOS_storm6b_08_02_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6b_08_02_fDOM.csv")
MOOS_storm6b_08_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6b_08_02_SPC.csv")
MOOS_storm6b_08_02_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6b_08_02_Turb.csv")
MOOS_storm6b_08_02_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6b_08_02_abs.csv")

MOOS_storm6c_08_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6c_08_03_Q.csv")
MOOS_storm6c_08_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6c_08_03_NO3.csv")
MOOS_storm6c_08_03_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6c_08_03_fDOM.csv")
MOOS_storm6c_08_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6c_08_03_SPC.csv")
MOOS_storm6c_08_03_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6c_08_03_Turb.csv")
MOOS_storm6c_08_03_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6c_08_03_abs.csv")

MOOS_storm6d_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6d_08_05_Q.csv")
MOOS_storm6d_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6d_08_05_NO3.csv")
MOOS_storm6d_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6d_08_05_fDOM.csv")
MOOS_storm6d_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6d_08_05_SPC.csv")
MOOS_storm6d_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6d_08_05_Turb.csv")
MOOS_storm6d_08_05_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm6d_08_05_abs.csv")

MOOS_storm7a_08_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7a_08_13_Q.csv")
MOOS_storm7a_08_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7a_08_13_NO3.csv")
MOOS_storm7a_08_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7a_08_13_fDOM.csv")
MOOS_storm7a_08_13_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7a_08_13_SPC.csv")
MOOS_storm7a_08_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7a_08_13_Turb.csv")
MOOS_storm7a_08_13_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7a_08_13_abs.csv")

MOOS_storm7b_08_14_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7b_08_14_Q.csv")
MOOS_storm7b_08_14_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7b_08_14_NO3.csv")
MOOS_storm7b_08_14_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7b_08_14_fDOM.csv")
MOOS_storm7b_08_14_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7b_08_14_SPC.csv")
MOOS_storm7b_08_14_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7b_08_14_Turb.csv")
MOOS_storm7b_08_14_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7b_08_14_abs.csv")

MOOS_storm7c_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7c_08_15_Q.csv")
MOOS_storm7c_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7c_08_15_NO3.csv")
MOOS_storm7c_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7c_08_15_fDOM.csv")
MOOS_storm7c_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7c_08_15_SPC.csv")
MOOS_storm7c_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7c_08_15_Turb.csv")
MOOS_storm7c_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm7c_08_15_abs.csv")

MOOS_storm8_09_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm8_09_21_Q.csv")
MOOS_storm8_09_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm8_09_21_NO3.csv")
MOOS_storm8_09_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm8_09_21_fDOM.csv")
MOOS_storm8_09_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm8_09_21_SPC.csv")
MOOS_storm8_09_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm8_09_21_Turb.csv")
MOOS_storm8_09_21_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm8_09_21_abs.csv")

MOOS_storm9_10_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm9_10_02_Q.csv")
MOOS_storm9_10_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm9_10_02_NO3.csv")
MOOS_storm9_10_02_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm9_10_02_fDOM.csv")
MOOS_storm9_10_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm9_10_02_SPC.csv")
MOOS_storm9_10_02_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm9_10_02_Turb.csv")
MOOS_storm9_10_02_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2019/MOOS/MOOS_storm9_10_02_abs.csv")

```

```{python}
## NO3 ##
MOOS_storm1_06_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_01_NO3 = hysteresisMetrics(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_12_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_12_NO3 = hysteresisMetrics(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_25_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_25_NO3 = hysteresisMetrics(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_29_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_29_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_29_NO3 = hysteresisMetrics(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_NO3 = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_NO3 = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6c_08_03_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6c_08_03_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6c_08_03_NO3 = hysteresisMetrics(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6d_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6d_08_05_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6d_08_05_NO3 = hysteresisMetrics(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_13_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_13_NO3 = hysteresisMetrics(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_14_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_14_NO3 = hysteresisMetrics(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7c_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7c_08_15_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7c_08_15_NO3 = hysteresisMetrics(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_21_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_21_NO3 = hysteresisMetrics(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_10_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_10_02_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_10_02_NO3 = hysteresisMetrics(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

# fDOM #
MOOS_storm1_06_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_01_fDOM = hysteresisMetrics(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_12_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_12_fDOM = hysteresisMetrics(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_25_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_25_fDOM = hysteresisMetrics(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_29_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_29_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_29_fDOM = hysteresisMetrics(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_fDOM = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_fDOM = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6c_08_03_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6c_08_03_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6c_08_03_fDOM = hysteresisMetrics(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6d_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6d_08_05_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6d_08_05_fDOM = hysteresisMetrics(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_13_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_13_fDOM = hysteresisMetrics(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_14_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_14_fDOM = hysteresisMetrics(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7c_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7c_08_15_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7c_08_15_fDOM = hysteresisMetrics(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_21_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_21_fDOM = hysteresisMetrics(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_10_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_10_02_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_10_02_fDOM = hysteresisMetrics(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

# SPC #
MOOS_storm1_06_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_01_SPC = hysteresisMetrics(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_12_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_12_SPC = hysteresisMetrics(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_25_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_25_SPC = hysteresisMetrics(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_29_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_29_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_29_SPC = hysteresisMetrics(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_SPC = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_SPC = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6c_08_03_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6c_08_03_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6c_08_03_SPC = hysteresisMetrics(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6d_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6d_08_05_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6d_08_05_SPC = hysteresisMetrics(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_13_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_13_SPC = hysteresisMetrics(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_14_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_14_SPC = hysteresisMetrics(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7c_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7c_08_15_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7c_08_15_SPC = hysteresisMetrics(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_21_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_21_SPC = hysteresisMetrics(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_10_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_10_02_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_10_02_SPC = hysteresisMetrics(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

# turb #
MOOS_storm1_06_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_01_turb = hysteresisMetrics(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_12_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_12_turb = hysteresisMetrics(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_25_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_25_turb = hysteresisMetrics(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_29_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_29_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_29_turb = hysteresisMetrics(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_turb = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_turb = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6c_08_03_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6c_08_03_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6c_08_03_turb = hysteresisMetrics(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6d_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6d_08_05_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6d_08_05_turb = hysteresisMetrics(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_13_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_13_turb = hysteresisMetrics(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_14_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_14_turb = hysteresisMetrics(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7c_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7c_08_15_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7c_08_15_turb = hysteresisMetrics(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_21_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_21_turb = hysteresisMetrics(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_10_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_10_02_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_10_02_turb = hysteresisMetrics(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
MOOS_storm1_06_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_01_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_01_abs = hysteresisMetrics(MOOS_storm1_06_01_Q, MOOS_storm1_06_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_12_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_12_abs = hysteresisMetrics(MOOS_storm3_07_12_Q, MOOS_storm3_07_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_25_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_25_abs = hysteresisMetrics(MOOS_storm4_07_25_Q, MOOS_storm4_07_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_29_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_29_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_29_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_29_abs = hysteresisMetrics(MOOS_storm5_07_29_Q, MOOS_storm5_07_29_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_abs = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_abs = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6c_08_03_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6c_08_03_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6c_08_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6c_08_03_abs = hysteresisMetrics(MOOS_storm6c_08_03_Q, MOOS_storm6c_08_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6d_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6d_08_05_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6d_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6d_08_05_abs = hysteresisMetrics(MOOS_storm6d_08_05_Q, MOOS_storm6d_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_13_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_13_abs = hysteresisMetrics(MOOS_storm7a_08_13_Q, MOOS_storm7a_08_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_14_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_14_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_14_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_14_abs = hysteresisMetrics(MOOS_storm7b_08_14_Q, MOOS_storm7b_08_14_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7c_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7c_08_15_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7c_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7c_08_15_abs = hysteresisMetrics(MOOS_storm7c_08_15_Q, MOOS_storm7c_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_21_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_21_abs = hysteresisMetrics(MOOS_storm8_09_21_Q, MOOS_storm8_09_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_10_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_10_02_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm9_10_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_10_02_abs = hysteresisMetrics(MOOS_storm9_10_02_Q, MOOS_storm9_10_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

```{r}
MOOS.hyst.results.list = list(py$hysdict_MOOS_storm1_06_01_NO3,
                              py$hysdict_MOOS_storm1_06_01_fDOM,
                              py$hysdict_MOOS_storm1_06_01_SPC,
                              py$hysdict_MOOS_storm1_06_01_turb,
                              py$hysdict_MOOS_storm1_06_01_abs,
                              py$hysdict_MOOS_storm3_07_12_NO3,
                              py$hysdict_MOOS_storm3_07_12_fDOM,
                              py$hysdict_MOOS_storm3_07_12_SPC,
                              py$hysdict_MOOS_storm3_07_12_turb,
                              py$hysdict_MOOS_storm3_07_12_abs,
                              py$hysdict_MOOS_storm4_07_25_fDOM,
                              py$hysdict_MOOS_storm4_07_25_SPC,
                              py$hysdict_MOOS_storm4_07_25_turb,
                             
                              py$hysdict_MOOS_storm5_07_29_NO3,
                              py$hysdict_MOOS_storm5_07_29_fDOM,
                              py$hysdict_MOOS_storm5_07_29_SPC,
                              py$hysdict_MOOS_storm5_07_29_turb,
                              py$hysdict_MOOS_storm5_07_29_abs,
                              py$hysdict_MOOS_storm6a_08_01_NO3,
                              py$hysdict_MOOS_storm6a_08_01_fDOM,
                              py$hysdict_MOOS_storm6a_08_01_SPC,
                              py$hysdict_MOOS_storm6a_08_01_turb,
                              py$hysdict_MOOS_storm6a_08_01_abs,
                              py$hysdict_MOOS_storm6b_08_02_fDOM,
                              py$hysdict_MOOS_storm6b_08_02_SPC,
                              py$hysdict_MOOS_storm6b_08_02_turb,
                              
                              py$hysdict_MOOS_storm6c_08_03_fDOM,
                              py$hysdict_MOOS_storm6c_08_03_SPC,
                              py$hysdict_MOOS_storm6c_08_03_turb,
                              
                              
                              py$hysdict_MOOS_storm6d_08_05_fDOM,
                              py$hysdict_MOOS_storm6d_08_05_SPC,
                              py$hysdict_MOOS_storm6d_08_05_turb,
                              
                              py$hysdict_MOOS_storm7a_08_13_fDOM,
                              
                              py$hysdict_MOOS_storm7a_08_13_turb,
                              py$hysdict_MOOS_storm7b_08_14_fDOM,
                              py$hysdict_MOOS_storm7b_08_14_SPC,
                              py$hysdict_MOOS_storm7b_08_14_turb,
                              
                              py$hysdict_MOOS_storm7c_08_15_fDOM,
                              py$hysdict_MOOS_storm7c_08_15_SPC,
                              py$hysdict_MOOS_storm7c_08_15_turb,
                              py$hysdict_MOOS_storm8_09_21_fDOM,
                              py$hysdict_MOOS_storm8_09_21_SPC,
                              py$hysdict_MOOS_storm8_09_21_turb,
                              py$hysdict_MOOS_storm8_09_21_abs,
                              py$hysdict_MOOS_storm9_10_02_NO3,
                              py$hysdict_MOOS_storm9_10_02_fDOM,
                              py$hysdict_MOOS_storm9_10_02_SPC,
                              py$hysdict_MOOS_storm9_10_02_turb,
                              py$hysdict_MOOS_storm9_10_02_abs)
                              

                              
                              
MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c("MOOS_storm1_06_01_NO3",
                                  "MOOS_storm1_06_01_fDOM",
                                  "MOOS_storm1_06_01_SPC",
                                  "MOOS_storm1_06_01_turb",
                                  "MOOS_storm1_06_01_abs",
                                  "MOOS_storm3_07_12_NO3",
                                  "MOOS_storm3_07_12_fDOM",
                                  "MOOS_storm3_07_12_SPC",
                                  "MOOS_storm3_07_12_turb",
                                  "MOOS_storm3_07_12_abs",
                                  "MOOS_storm4_07_25_fDOM",
                                  "MOOS_storm4_07_25_SPC",
                                  "MOOS_storm4_07_25_turb",
                                  "MOOS_storm5_07_29_NO3",
                                  "MOOS_storm5_07_29_fDOM",
                                  "MOOS_storm5_07_29_SPC",
                                  "MOOS_storm5_07_29_turb",
                                  "MOOS_storm5_07_29_abs",
                                  "MOOS_storm6a_08_01_NO3",
                                  "MOOS_storm6a_08_01_fDOM",
                                  "MOOS_storm6a_08_01_SPC",
                                  "MOOS_storm6a_08_01_turb",
                                  "MOOS_storm6a_08_01_abs",
                                  "MOOS_storm6b_08_02_fDOM",
                                  "MOOS_storm6b_08_02_SPC",
                                  "MOOS_storm6b_08_02_turb",
                                  "MOOS_storm6c_08_03_fDOM",
                                  "MOOS_storm6c_08_03_SPC",
                                  "MOOS_storm6c_08_03_turb",
                                  "MOOS_storm6d_08_05_fDOM",
                                  "MOOS_storm6d_08_05_SPC",
                                  "MOOS_storm6d_08_05_turb",
                                  "MOOS_storm7a_08_13_fDOM",
                                  "MOOS_storm7a_08_13_turb",
                                  "MOOS_storm7b_08_14_fDOM",
                                  "MOOS_storm7b_08_14_SPC",
                                  "MOOS_storm7b_08_14_turb",
                                  "MOOS_storm7c_08_15_fDOM",
                                  "MOOS_storm7c_08_15_SPC",
                                  "MOOS_storm7c_08_15_turb",
                                  "MOOS_storm8_09_21_fDOM",
                                  "MOOS_storm8_09_21_SPC",
                                  "MOOS_storm8_09_21_turb",
                                  "MOOS_storm8_09_21_abs",
                                  "MOOS_storm9_10_02_NO3",
                                  "MOOS_storm9_10_02_fDOM",
                                  "MOOS_storm9_10_02_SPC",
                                  "MOOS_storm9_10_02_turb",
                                  "MOOS_storm9_10_02_abs")


MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/MOOS/MOOS.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2019/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(rep("MOOS_storm1_06_01_NO3", 50),
                        rep("MOOS_storm1_06_01_fDOM", 50),
                        rep("MOOS_storm1_06_01_SPC", 50),
                        rep("MOOS_storm1_06_01_turb", 50),
                        rep("MOOS_storm1_06_01_abs", 50),
                        rep("MOOS_storm3_07_12_NO3", 50),
                        rep("MOOS_storm3_07_12_fDOM", 50),
                        rep("MOOS_storm3_07_12_SPC", 50),
                        rep("MOOS_storm3_07_12_turb", 50),
                        rep("MOOS_storm3_07_12_abs", 50),
                        rep("MOOS_storm4_07_25_fDOM", 50),
                        rep("MOOS_storm4_07_25_SPC", 50),
                        rep("MOOS_storm4_07_25_turb", 50),
                        rep("MOOS_storm5_07_29_NO3", 50),
                        rep("MOOS_storm5_07_29_fDOM", 50),
                        rep("MOOS_storm5_07_29_SPC", 50),
                        rep("MOOS_storm5_07_29_turb", 50),
                        rep("MOOS_storm5_07_29_abs", 50),
                        rep("MOOS_storm6a_08_01_NO3", 50),
                        rep("MOOS_storm6a_08_01_fDOM", 50),
                        rep("MOOS_storm6a_08_01_SPC", 50),
                        rep("MOOS_storm6a_08_01_turb", 50),
                        rep("MOOS_storm6a_08_01_abs", 50),
                        rep("MOOS_storm6b_08_02_fDOM", 50),
                        rep("MOOS_storm6b_08_02_SPC", 50),
                        rep("MOOS_storm6b_08_02_turb", 50),
                        rep("MOOS_storm6c_08_03_fDOM", 50),
                        rep("MOOS_storm6c_08_03_SPC", 50),
                        rep("MOOS_storm6c_08_03_turb", 50),
                        
                        rep("MOOS_storm6d_08_05_fDOM", 50),
                        rep("MOOS_storm6d_08_05_SPC", 50),
                        rep("MOOS_storm6d_08_05_turb", 50),
                        
                        rep("MOOS_storm7a_08_13_fDOM", 50),
                        
                        rep("MOOS_storm7a_08_13_turb", 50),
                        
                        rep("MOOS_storm7b_08_14_fDOM", 50),
                        rep("MOOS_storm7b_08_14_SPC", 50),
                        rep("MOOS_storm7b_08_14_turb", 50),
                        
                        rep("MOOS_storm7c_08_15_fDOM", 50),
                        rep("MOOS_storm7c_08_15_SPC", 50),
                        rep("MOOS_storm7c_08_15_turb", 50),
                        
                        rep("MOOS_storm8_09_21_fDOM", 50),
                        rep("MOOS_storm8_09_21_SPC", 50),
                        rep("MOOS_storm8_09_21_turb", 50),
                        rep("MOOS_storm8_09_21_abs", 50),
                        rep("MOOS_storm9_10_02_NO3", 50),
                        rep("MOOS_storm9_10_02_fDOM", 50),
                        rep("MOOS_storm9_10_02_SPC", 50),
                        rep("MOOS_storm9_10_02_turb", 50),
                        rep("MOOS_storm9_10_02_abs", 50))
                        

MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}

g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/MOOS/MOOS.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/MOOS/MOOS.HI.df.csv")

MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/MOOS/MOOS.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/MOOS/MOOS.HI.df.doy.csv")

```

### CARI ### 
```{python}
# CARI #

CARI_storm1_05_08_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm1_05_08_Q.csv")
CARI_storm1_05_08_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm1_05_08_NO3.csv")
CARI_storm1_05_08_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm1_05_08_fDOM.csv")
CARI_storm1_05_08_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm1_05_08_SPC.csv")
CARI_storm1_05_08_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm1_05_08_Turb.csv")

CARI_storm2_06_30_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm2_06_30_Q.csv")
CARI_storm2_06_30_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm2_06_30_NO3.csv")
CARI_storm2_06_30_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm2_06_30_fDOM.csv")
CARI_storm2_06_30_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm2_06_30_SPC.csv")
CARI_storm2_06_30_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm2_06_30_Turb.csv")

CARI_storm3_07_12_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm3_07_12_Q.csv")
CARI_storm3_07_12_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm3_07_12_NO3.csv")
CARI_storm3_07_12_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm3_07_12_fDOM.csv")
CARI_storm3_07_12_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm3_07_12_SPC.csv")
CARI_storm3_07_12_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm3_07_12_Turb.csv")

CARI_storm4_07_26_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm4_07_26_Q.csv")
CARI_storm4_07_26_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm4_07_26_NO3.csv")
CARI_storm4_07_26_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm4_07_26_fDOM.csv")
CARI_storm4_07_26_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm4_07_26_SPC.csv")
CARI_storm4_07_26_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm4_07_26_Turb.csv")

CARI_storm5_07_31_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm5_07_31_Q.csv")
CARI_storm5_07_31_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm5_07_31_NO3.csv")
CARI_storm5_07_31_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm5_07_31_fDOM.csv")
CARI_storm5_07_31_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm5_07_31_SPC.csv")
CARI_storm5_07_31_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm5_07_31_Turb.csv")

CARI_storm6a_08_02_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6a_08_02_Q.csv")
CARI_storm6a_08_02_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6a_08_02_NO3.csv")
CARI_storm6a_08_02_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6a_08_02_fDOM.csv")
CARI_storm6a_08_02_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6a_08_02_SPC.csv")
CARI_storm6a_08_02_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6a_08_02_Turb.csv")

CARI_storm6b_08_03_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6b_08_03_Q.csv")
CARI_storm6b_08_03_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6b_08_03_NO3.csv")
CARI_storm6b_08_03_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6b_08_03_fDOM.csv")
CARI_storm6b_08_03_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6b_08_03_SPC.csv")
CARI_storm6b_08_03_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6b_08_03_Turb.csv")

CARI_storm6c_08_05_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6c_08_05_Q.csv")
CARI_storm6c_08_05_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6c_08_05_NO3.csv")
CARI_storm6c_08_05_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6c_08_05_fDOM.csv")
CARI_storm6c_08_05_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6c_08_05_SPC.csv")
CARI_storm6c_08_05_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6c_08_05_Turb.csv")

CARI_storm6d_08_10_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6d_08_10_Q.csv")
CARI_storm6d_08_10_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6d_08_10_NO3.csv")
CARI_storm6d_08_10_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6d_08_10_fDOM.csv")
CARI_storm6d_08_10_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6d_08_10_SPC.csv")
CARI_storm6d_08_10_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm6d_08_10_Turb.csv")

CARI_storm7a_08_13_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7a_08_13_Q.csv")
CARI_storm7a_08_13_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7a_08_13_NO3.csv")
CARI_storm7a_08_13_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7a_08_13_fDOM.csv")
CARI_storm7a_08_13_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7a_08_13_SPC.csv")
CARI_storm7a_08_13_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7a_08_13_Turb.csv")

CARI_storm7b_08_13_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7b_08_13_Q.csv")
CARI_storm7b_08_13_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7b_08_13_NO3.csv")
CARI_storm7b_08_13_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7b_08_13_fDOM.csv")
CARI_storm7b_08_13_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7b_08_13_SPC.csv")
CARI_storm7b_08_13_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm7b_08_13_Turb.csv")

CARI_storm8_08_16_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm8_08_16_Q.csv")
CARI_storm8_08_16_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm8_08_16_NO3.csv")
CARI_storm8_08_16_fDOM = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm8_08_16_fDOM.csv")
CARI_storm8_08_16_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm8_08_16_SPC.csv")
CARI_storm8_08_16_turb = pd.read_csv("~/Documents/Storms/Storm_Events/2019/CARI/CARI_storm8_08_16_Turb.csv")

```

```{python}
## NO3 ##
CARI_storm1_05_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_08_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_08_NO3 = hysteresisMetrics(CARI_storm1_05_08_Q, CARI_storm1_05_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_30_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_30_NO3 = hysteresisMetrics(CARI_storm2_06_30_Q, CARI_storm2_06_30_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_07_12_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_07_12_NO3 = hysteresisMetrics(CARI_storm3_07_12_Q, CARI_storm3_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_26_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_26_NO3 = hysteresisMetrics(CARI_storm4_07_26_Q, CARI_storm4_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_31_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_31_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_31_NO3 = hysteresisMetrics(CARI_storm5_07_31_Q, CARI_storm5_07_31_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6a_08_02_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6a_08_02_NO3 = hysteresisMetrics(CARI_storm6a_08_02_Q, CARI_storm6a_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6b_08_03_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6b_08_03_NO3 = hysteresisMetrics(CARI_storm6b_08_03_Q, CARI_storm6b_08_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6c_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6c_08_05_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6c_08_05_NO3 = hysteresisMetrics(CARI_storm6c_08_05_Q, CARI_storm6c_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6d_08_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6d_08_10_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6d_08_10_NO3 = hysteresisMetrics(CARI_storm6d_08_10_Q, CARI_storm6d_08_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7a_08_13_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7a_08_13_NO3 = hysteresisMetrics(CARI_storm7a_08_13_Q, CARI_storm7a_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7b_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7b_08_13_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7b_08_13_NO3 = hysteresisMetrics(CARI_storm7b_08_13_Q, CARI_storm7b_08_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_16_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_16_NO3 = hysteresisMetrics(CARI_storm8_08_16_Q, CARI_storm8_08_16_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
CARI_storm1_05_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_08_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_08_fDOM = hysteresisMetrics(CARI_storm1_05_08_Q, CARI_storm1_05_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_30_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_30_fDOM = hysteresisMetrics(CARI_storm2_06_30_Q, CARI_storm2_06_30_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_07_12_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_07_12_fDOM = hysteresisMetrics(CARI_storm3_07_12_Q, CARI_storm3_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_26_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_26_fDOM = hysteresisMetrics(CARI_storm4_07_26_Q, CARI_storm4_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_31_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_31_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_31_fDOM = hysteresisMetrics(CARI_storm5_07_31_Q, CARI_storm5_07_31_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6a_08_02_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6a_08_02_fDOM = hysteresisMetrics(CARI_storm6a_08_02_Q, CARI_storm6a_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6b_08_03_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6b_08_03_fDOM = hysteresisMetrics(CARI_storm6b_08_03_Q, CARI_storm6b_08_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6c_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6c_08_05_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6c_08_05_fDOM = hysteresisMetrics(CARI_storm6c_08_05_Q, CARI_storm6c_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6d_08_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6d_08_10_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6d_08_10_fDOM = hysteresisMetrics(CARI_storm6d_08_10_Q, CARI_storm6d_08_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7a_08_13_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7a_08_13_fDOM = hysteresisMetrics(CARI_storm7a_08_13_Q, CARI_storm7a_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7b_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7b_08_13_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7b_08_13_fDOM = hysteresisMetrics(CARI_storm7b_08_13_Q, CARI_storm7b_08_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_16_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_16_fDOM = hysteresisMetrics(CARI_storm8_08_16_Q, CARI_storm8_08_16_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
CARI_storm1_05_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_08_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_08_SPC = hysteresisMetrics(CARI_storm1_05_08_Q, CARI_storm1_05_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_30_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_30_SPC = hysteresisMetrics(CARI_storm2_06_30_Q, CARI_storm2_06_30_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_07_12_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_07_12_SPC = hysteresisMetrics(CARI_storm3_07_12_Q, CARI_storm3_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_26_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_26_SPC = hysteresisMetrics(CARI_storm4_07_26_Q, CARI_storm4_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_31_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_31_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_31_SPC = hysteresisMetrics(CARI_storm5_07_31_Q, CARI_storm5_07_31_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6a_08_02_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6a_08_02_SPC = hysteresisMetrics(CARI_storm6a_08_02_Q, CARI_storm6a_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6b_08_03_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6b_08_03_SPC = hysteresisMetrics(CARI_storm6b_08_03_Q, CARI_storm6b_08_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6c_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6c_08_05_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6c_08_05_SPC = hysteresisMetrics(CARI_storm6c_08_05_Q, CARI_storm6c_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6d_08_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6d_08_10_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6d_08_10_SPC = hysteresisMetrics(CARI_storm6d_08_10_Q, CARI_storm6d_08_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7a_08_13_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7a_08_13_SPC = hysteresisMetrics(CARI_storm7a_08_13_Q, CARI_storm7a_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7b_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7b_08_13_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7b_08_13_SPC = hysteresisMetrics(CARI_storm7b_08_13_Q, CARI_storm7b_08_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_16_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_16_SPC = hysteresisMetrics(CARI_storm8_08_16_Q, CARI_storm8_08_16_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
CARI_storm1_05_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_08_turb['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_08_turb = hysteresisMetrics(CARI_storm1_05_08_Q, CARI_storm1_05_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_30_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_30_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_30_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_30_turb = hysteresisMetrics(CARI_storm2_06_30_Q, CARI_storm2_06_30_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_07_12_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_07_12_turb['valuedatetime'] =  pd.to_datetime(CARI_storm3_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_07_12_turb = hysteresisMetrics(CARI_storm3_07_12_Q, CARI_storm3_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_26_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_26_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_26_turb = hysteresisMetrics(CARI_storm4_07_26_Q, CARI_storm4_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_31_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_31_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_31_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_31_turb = hysteresisMetrics(CARI_storm5_07_31_Q, CARI_storm5_07_31_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6a_08_02_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6a_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6a_08_02_turb = hysteresisMetrics(CARI_storm6a_08_02_Q, CARI_storm6a_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6b_08_03_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6b_08_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6b_08_03_turb = hysteresisMetrics(CARI_storm6b_08_03_Q, CARI_storm6b_08_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6c_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6c_08_05_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6c_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6c_08_05_turb = hysteresisMetrics(CARI_storm6c_08_05_Q, CARI_storm6c_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6d_08_10_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6d_08_10_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6d_08_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6d_08_10_turb = hysteresisMetrics(CARI_storm6d_08_10_Q, CARI_storm6d_08_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7a_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7a_08_13_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7a_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7a_08_13_turb = hysteresisMetrics(CARI_storm7a_08_13_Q, CARI_storm7a_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7b_08_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7b_08_13_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7b_08_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7b_08_13_turb = hysteresisMetrics(CARI_storm7b_08_13_Q, CARI_storm7b_08_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_16_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_16_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_16_turb = hysteresisMetrics(CARI_storm8_08_16_Q, CARI_storm8_08_16_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```



```{r}

CARI.hyst.results.list = list(py$hysdict_CARI_storm1_05_08_NO3,
                              py$hysdict_CARI_storm1_05_08_fDOM,
                              py$hysdict_CARI_storm1_05_08_SPC,
                              py$hysdict_CARI_storm1_05_08_turb,
                              py$hysdict_CARI_storm2_06_30_NO3,
                              py$hysdict_CARI_storm2_06_30_fDOM,
                              py$hysdict_CARI_storm2_06_30_SPC,
                              py$hysdict_CARI_storm2_06_30_turb,
                              py$hysdict_CARI_storm3_07_12_NO3,
                              py$hysdict_CARI_storm3_07_12_fDOM,
                              py$hysdict_CARI_storm3_07_12_SPC,
                              py$hysdict_CARI_storm3_07_12_turb,
                             
                              py$hysdict_CARI_storm5_07_31_NO3,
                              py$hysdict_CARI_storm5_07_31_fDOM,
                              py$hysdict_CARI_storm5_07_31_SPC,
                              py$hysdict_CARI_storm5_07_31_turb,
                              py$hysdict_CARI_storm6a_08_02_NO3,
                              py$hysdict_CARI_storm6a_08_02_fDOM,
                              py$hysdict_CARI_storm6a_08_02_SPC,
                              py$hysdict_CARI_storm6a_08_02_turb,
                              py$hysdict_CARI_storm6b_08_03_NO3,
                              py$hysdict_CARI_storm6b_08_03_fDOM,
                              py$hysdict_CARI_storm6b_08_03_SPC,
                              py$hysdict_CARI_storm6b_08_03_turb,
                              py$hysdict_CARI_storm6c_08_05_NO3,
                              py$hysdict_CARI_storm6c_08_05_fDOM,
                              py$hysdict_CARI_storm6c_08_05_SPC,
                              py$hysdict_CARI_storm6c_08_05_turb,
                              py$hysdict_CARI_storm6d_08_10_NO3,
                              py$hysdict_CARI_storm6d_08_10_fDOM,
                              py$hysdict_CARI_storm6d_08_10_SPC,
                              py$hysdict_CARI_storm6d_08_10_turb,
                              
                              py$hysdict_CARI_storm7b_08_13_NO3,
                              py$hysdict_CARI_storm7b_08_13_fDOM,
                              py$hysdict_CARI_storm7b_08_13_SPC,
                              py$hysdict_CARI_storm7b_08_13_turb,
                              py$hysdict_CARI_storm8_08_16_NO3,
                              py$hysdict_CARI_storm8_08_16_fDOM,
                              py$hysdict_CARI_storm8_08_16_SPC,
                              py$hysdict_CARI_storm8_08_16_turb)
       
 
CARI.hyst.results.list.2 = list()
for (i in 1:length(CARI.hyst.results.list)){
CARI.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
CARI.hyst.results.list[[i]][["HI_mean_with_Interp"]],
CARI.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
CARI.hyst.results.list[[i]][["Normalized slope of response"]],
CARI.hyst.results.list[[i]][["interpolated Max width of response"]],
CARI.hyst.results.list[[i]][["Min response"]],
CARI.hyst.results.list[[i]][["Max response"]],
CARI.hyst.results.list[[i]][["Peak Q"]]
))))
names(CARI.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(CARI.hyst.results.list)){
  HIs.list[[i]] = unlist(CARI.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

CARI.hyst.results.list.3 =list()
for (i in 1:length(CARI.hyst.results.list)){
  CARI.hyst.results.list.3[[i]] = cbind(CARI.hyst.results.list.2[[i]], HIs.tests[[i]])
}

CARI.hyst.results.df = bind_rows(CARI.hyst.results.list.3, .id = "column_label")


CARI.hyst.results.df$storm.ID = c("CARI_storm1_05_08_NO3",
                                  "CARI_storm1_05_08_fDOM",
                                  "CARI_storm1_05_08_SPC",
                                  "CARI_storm1_05_08_turb",
                                  "CARI_storm2_06_30_NO3",
                                  "CARI_storm2_06_30_fDOM",
                                  "CARI_storm2_06_30_SPC",
                                  "CARI_storm2_06_30_turb",
                                  "CARI_storm3_07_12_NO3",
                                  "CARI_storm3_07_12_fDOM",
                                  "CARI_storm3_07_12_SPC",
                                  "CARI_storm3_07_12_turb",
                                  
                                  "CARI_storm5_07_31_NO3",
                                  "CARI_storm5_07_31_fDOM",
                                  "CARI_storm5_07_31_SPC",
                                  "CARI_storm5_07_31_turb",
                                  "CARI_storm6a_08_02_NO3",
                                  "CARI_storm6a_08_02_fDOM",
                                  "CARI_storm6a_08_02_SPC",
                                  "CARI_storm6a_08_02_turb",
                                  "CARI_storm6b_08_03_NO3",
                                  "CARI_storm6b_08_03_fDOM",
                                  "CARI_storm6b_08_03_SPC",
                                  "CARI_storm6b_08_03_turb",
                                  "CARI_storm6c_08_05_NO3",
                                  "CARI_storm6c_08_05_fDOM",
                                  "CARI_storm6c_08_05_SPC",
                                  "CARI_storm6c_08_05_turb",
                                  "CARI_storm6d_08_10_NO3",
                                  "CARI_storm6d_08_10_fDOM",
                                  "CARI_storm6d_08_10_SPC",
                                  "CARI_storm6d_08_10_turb",
                                  
                                  "CARI_storm7b_08_13_NO3",
                                  "CARI_storm7b_08_13_fDOM",
                                  "CARI_storm7b_08_13_SPC",
                                  "CARI_storm7b_08_13_turb",
                                  "CARI_storm8_08_16_NO3",
                                  "CARI_storm8_08_16_fDOM",
                                  "CARI_storm8_08_16_SPC",
                                  "CARI_storm8_08_16_turb")
                                  
                                  

CARI.hyst.results.df$site.ID = "CARI"

write.csv(CARI.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/CARI/CARI.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2019/CARI/CARI.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= CARI.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

CARI.HI.df = bind_rows(HIs.df.list, .id = "column_label")

test <- CARI.HI.df %>%
    group_by(column_label) %>%
    mutate(Diff = Q_interval - lag(Q_interval))

CARI.HI.df$storm.ID = c(rep("CARI_storm1_05_08_NO3", 50),
                        rep("CARI_storm1_05_08_fDOM", 50),
                        rep("CARI_storm1_05_08_SPC", 50),
                        rep("CARI_storm1_05_08_turb", 50),
                        rep("CARI_storm2_06_30_NO3", 50),
                        rep("CARI_storm2_06_30_fDOM", 50),
                        rep("CARI_storm2_06_30_SPC", 50),
                        rep("CARI_storm2_06_30_turb", 50),
                        rep("CARI_storm3_07_12_NO3", 50),
                        rep("CARI_storm3_07_12_fDOM", 50),
                        rep("CARI_storm3_07_12_SPC", 50),
                        rep("CARI_storm3_07_12_turb", 50),
                        
                        rep("CARI_storm5_07_31_NO3", 50),
                        rep("CARI_storm5_07_31_fDOM", 50),
                        rep("CARI_storm5_07_31_SPC", 50),
                        rep("CARI_storm5_07_31_turb", 50),
                        rep("CARI_storm6a_08_02_NO3", 50),
                        rep("CARI_storm6a_08_02_fDOM", 50),
                        rep("CARI_storm6a_08_02_SPC", 50),
                        rep("CARI_storm6a_08_02_turb", 50),
                        rep("CARI_storm6b_08_03_NO3", 50),
                        rep("CARI_storm6b_08_03_fDOM", 50),
                        rep("CARI_storm6b_08_03_SPC", 50),
                        rep("CARI_storm6b_08_03_turb", 50),
                        rep("CARI_storm6c_08_05_NO3", 49),
                        rep("CARI_storm6c_08_05_fDOM", 50),
                        rep("CARI_storm6c_08_05_SPC", 50),
                        rep("CARI_storm6c_08_05_turb", 50),
                        rep("CARI_storm6d_08_10_NO3", 48),
                        rep("CARI_storm6d_08_10_fDOM", 50),
                        rep("CARI_storm6d_08_10_SPC", 50),
                        rep("CARI_storm6d_08_10_turb", 50),
                        
                        rep("CARI_storm7b_08_13_NO3", 50),
                        rep("CARI_storm7b_08_13_fDOM", 50),
                        rep("CARI_storm7b_08_13_SPC", 50),
                        rep("CARI_storm7b_08_13_turb", 50),
                        rep("CARI_storm8_08_16_NO3", 49),
                        rep("CARI_storm8_08_16_fDOM", 50),
                        rep("CARI_storm8_08_16_SPC", 50),
                        rep("CARI_storm8_08_16_turb", 50))
                        

CARI.HI.df$storm.ID = as.factor(CARI.HI.df$storm.ID)
CARI.HI.df = separate(data=CARI.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}

g0 <- ggplot(CARI.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/CARI/CARI.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/CARI/CARI.HI.df.csv")

CARI.HI.df$date <- as.Date(with(CARI.HI.df, paste(month, day, sep = "-")), "%m-%d")
CARI.HI.df$doy <- yday(CARI.HI.df$date) 

g0 <- ggplot(CARI.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2019/CARI/CARI.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2019/CARI/CARI.HI.df.doy.csv")

```




###################################################################################################################################################### 2020 ####################################################
########################################################################################################

#### load data to pandas 2020
```{python}
# FRCH #
FRCH_storm1_06_13_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm1_06_13_Q.csv")
FRCH_storm1_06_13_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm1_06_13_NO3.csv")
FRCH_storm1_06_13_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm1_06_13_fDOM.csv")
FRCH_storm1_06_13_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm1_06_13_SPC.csv")
FRCH_storm1_06_13_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm1_06_13_Turb.csv")
FRCH_storm1_06_13_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm1_06_13_abs.csv")

# FRCH_storm1_06_13_Q = FRCH_storm1_06_13_Q.dropna(subset=['datavalue'])
# FRCH_storm1_06_13_NO3 = FRCH_storm1_06_13_NO3.dropna(subset=['datavalue'])
# FRCH_storm1_06_13_fDOM = FRCH_storm1_06_13_fDOM.dropna(subset=['datavalue'])
# FRCH_storm1_06_13_SPC = FRCH_storm1_06_13_SPC.dropna(subset=['datavalue'])
# FRCH_storm1_06_13_turb = FRCH_storm1_06_13_turb.dropna(subset=['datavalue'])

FRCH_storm2_06_18_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm2_06_18_Q.csv")
FRCH_storm2_06_18_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm2_06_18_NO3.csv")
FRCH_storm2_06_18_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm2_06_18_fDOM.csv")
FRCH_storm2_06_18_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm2_06_18_SPC.csv")
FRCH_storm2_06_18_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm2_06_18_Turb.csv")
FRCH_storm2_06_18_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm2_06_18_abs.csv")

FRCH_storm3a_06_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3a_06_20_Q.csv")
FRCH_storm3a_06_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3a_06_20_NO3.csv")
FRCH_storm3a_06_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3a_06_20_fDOM.csv")
FRCH_storm3a_06_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3a_06_20_SPC.csv")
FRCH_storm3a_06_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3a_06_20_Turb.csv")
FRCH_storm3a_06_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3a_06_20_abs.csv")


FRCH_storm3b_06_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3b_06_21_Q.csv")
FRCH_storm3b_06_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3b_06_21_NO3.csv")
FRCH_storm3b_06_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3b_06_21_fDOM.csv")
FRCH_storm3b_06_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3b_06_21_SPC.csv")
FRCH_storm3b_06_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3b_06_21_Turb.csv")
FRCH_storm3b_06_21_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3b_06_21_abs.csv")


FRCH_storm3c_06_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3c_06_26_Q.csv")
FRCH_storm3c_06_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3c_06_26_NO3.csv")
FRCH_storm3c_06_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3c_06_26_fDOM.csv")
FRCH_storm3c_06_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3c_06_26_SPC.csv")
FRCH_storm3c_06_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3c_06_26_Turb.csv")
FRCH_storm3c_06_26_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm3c_06_26_abs.csv")

FRCH_storm4a_07_07_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4a_07_07_Q.csv")
FRCH_storm4a_07_07_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4a_07_07_NO3.csv")
FRCH_storm4a_07_07_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4a_07_07_fDOM.csv")
FRCH_storm4a_07_07_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4a_07_07_SPC.csv")
FRCH_storm4a_07_07_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4a_07_07_Turb.csv")
FRCH_storm4a_07_07_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4a_07_07_abs.csv")

FRCH_storm4b_07_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4b_07_09_Q.csv")
FRCH_storm4b_07_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4b_07_09_NO3.csv")
FRCH_storm4b_07_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4b_07_09_fDOM.csv")
FRCH_storm4b_07_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4b_07_09_SPC.csv")
FRCH_storm4b_07_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4b_07_09_Turb.csv")
FRCH_storm4b_07_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm4b_07_09_abs.csv")

FRCH_storm5_07_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm5_07_15_Q.csv")
FRCH_storm5_07_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm5_07_15_NO3.csv")
FRCH_storm5_07_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm5_07_15_fDOM.csv")
FRCH_storm5_07_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm5_07_15_SPC.csv")
FRCH_storm5_07_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm5_07_15_Turb.csv")
FRCH_storm5_07_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm5_07_15_abs.csv")

FRCH_storm6_07_18_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm6_07_18_Q.csv")
FRCH_storm6_07_18_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm6_07_18_NO3.csv")
FRCH_storm6_07_18_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm6_07_18_fDOM.csv")
FRCH_storm6_07_18_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm6_07_18_SPC.csv")
FRCH_storm6_07_18_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm6_07_18_Turb.csv")
FRCH_storm6_07_18_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm6_07_18_abs.csv")

FRCH_storm7_07_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm7_07_20_Q.csv")
FRCH_storm7_07_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm7_07_20_NO3.csv")
FRCH_storm7_07_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm7_07_20_fDOM.csv")
FRCH_storm7_07_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm7_07_20_SPC.csv")
FRCH_storm7_07_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm7_07_20_Turb.csv")
FRCH_storm7_07_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm7_07_20_abs.csv")

FRCH_storm8_07_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm8_07_26_Q.csv")
FRCH_storm8_07_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm8_07_26_NO3.csv")
FRCH_storm8_07_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm8_07_26_fDOM.csv")
FRCH_storm8_07_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm8_07_26_SPC.csv")
FRCH_storm8_07_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm8_07_26_Turb.csv")
FRCH_storm8_07_26_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm8_07_26_abs.csv")

FRCH_storm9a_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9a_08_01_Q.csv")
FRCH_storm9a_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9a_08_01_NO3.csv")
FRCH_storm9a_08_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9a_08_01_fDOM.csv")
FRCH_storm9a_08_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9a_08_01_SPC.csv")
FRCH_storm9a_08_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9a_08_01_Turb.csv")
FRCH_storm9a_08_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9a_08_01_abs.csv")

FRCH_storm9b_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9b_08_02_Q.csv")
FRCH_storm9b_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9b_08_02_NO3.csv")
FRCH_storm9b_08_02_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9b_08_02_fDOM.csv")
FRCH_storm9b_08_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9b_08_02_SPC.csv")
FRCH_storm9b_08_02_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9b_08_02_Turb.csv")
FRCH_storm9b_08_02_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm9b_08_02_abs.csv")

FRCH_storm10a_08_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10a_08_09_Q.csv")
FRCH_storm10a_08_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10a_08_09_NO3.csv")
FRCH_storm10a_08_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10a_08_09_fDOM.csv")
FRCH_storm10a_08_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10a_08_09_SPC.csv")
FRCH_storm10a_08_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10a_08_09_Turb.csv")
FRCH_storm10a_08_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10a_08_09_abs.csv")

FRCH_storm10b_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10b_08_12_Q.csv")
FRCH_storm10b_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10b_08_12_NO3.csv")
FRCH_storm10b_08_12_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10b_08_12_fDOM.csv")
FRCH_storm10b_08_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10b_08_12_SPC.csv")
FRCH_storm10b_08_12_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10b_08_12_Turb.csv")
FRCH_storm10b_08_12_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm10b_08_12_abs.csv")

FRCH_storm11_08_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm11_08_20_Q.csv")
FRCH_storm11_08_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm11_08_20_NO3.csv")
FRCH_storm11_08_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm11_08_20_fDOM.csv")
FRCH_storm11_08_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm11_08_20_SPC.csv")
FRCH_storm11_08_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm11_08_20_Turb.csv")
FRCH_storm11_08_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm11_08_20_abs.csv")

# FRCH_storm11_08_20_Q = FRCH_storm11_08_20_Q.dropna(subset=['datavalue'])
# FRCH_storm11_08_20_NO3 = FRCH_storm11_08_20_NO3.dropna(subset=['datavalue'])
# FRCH_storm11_08_20_fDOM = FRCH_storm11_08_20_fDOM.dropna(subset=['datavalue'])

FRCH_storm12_09_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm12_09_06_Q.csv")
FRCH_storm12_09_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm12_09_06_NO3.csv")
FRCH_storm12_09_06_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm12_09_06_fDOM.csv")
FRCH_storm12_09_06_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm12_09_06_SPC.csv")
FRCH_storm12_09_06_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm12_09_06_Turb.csv")
FRCH_storm12_09_06_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm12_09_06_abs.csv")

# FRCH_storm12_09_06_Q = FRCH_storm12_09_06_Q.dropna(subset=['datavalue'])
# FRCH_storm12_09_06_NO3 = FRCH_storm12_09_06_NO3.dropna(subset=['datavalue'])
# FRCH_storm12_09_06_fDOM = FRCH_storm12_09_06_fDOM.dropna(subset=['datavalue'])

FRCH_storm13_09_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm13_09_09_Q.csv")
FRCH_storm13_09_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm13_09_09_NO3.csv")
FRCH_storm13_09_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm13_09_09_fDOM.csv")
FRCH_storm13_09_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm13_09_09_SPC.csv")
FRCH_storm13_09_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm13_09_09_Turb.csv")
FRCH_storm13_09_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/FRCH/FRCH_storm13_09_09_abs.csv")

# FRCH_storm13_09_09_Q = FRCH_storm13_09_09_Q.dropna(subset=['datavalue'])
# FRCH_storm13_09_09_NO3 = FRCH_storm13_09_09_NO3.dropna(subset=['datavalue'])
# FRCH_storm13_09_09_fDOM = FRCH_storm13_09_09_fDOM.dropna(subset=['datavalue'])


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```


FRCH_storms
```{python}
## NO3 ##
FRCH_storm1_06_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_13_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_13_NO3 = hysteresisMetrics(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_18_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_18_NO3 = hysteresisMetrics(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3a_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3a_06_20_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3a_06_20_NO3 = hysteresisMetrics(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3b_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3b_06_21_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3b_06_21_NO3 = hysteresisMetrics(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3c_06_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3c_06_26_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3c_06_26_NO3 = hysteresisMetrics(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_07_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_07_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_07_NO3 = hysteresisMetrics(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_09_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_09_NO3 = hysteresisMetrics(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_07_15_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_07_15_NO3 = hysteresisMetrics(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_18_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_18_NO3 = hysteresisMetrics(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_07_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_07_20_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_07_20_NO3 = hysteresisMetrics(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_07_26_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_07_26_NO3 = hysteresisMetrics(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9a_08_01_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9a_08_01_NO3 = hysteresisMetrics(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9b_08_02_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9b_08_02_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9b_08_02_NO3 = hysteresisMetrics(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_09_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_09_NO3 = hysteresisMetrics(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10b_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10b_08_12_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10b_08_12_NO3 = hysteresisMetrics(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_20_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_20_NO3 = hysteresisMetrics(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12_09_06_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12_09_06_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12_09_06_NO3 = hysteresisMetrics(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_09_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_09_NO3 = hysteresisMetrics(FRCH_storm13_09_09_Q, FRCH_storm13_09_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
FRCH_storm1_06_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_13_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_13_fDOM = hysteresisMetrics(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_18_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_18_fDOM = hysteresisMetrics(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3a_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3a_06_20_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3a_06_20_fDOM = hysteresisMetrics(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3b_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3b_06_21_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3b_06_21_fDOM = hysteresisMetrics(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3c_06_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3c_06_26_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3c_06_26_fDOM = hysteresisMetrics(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_07_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_07_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_07_fDOM = hysteresisMetrics(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_09_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_09_fDOM = hysteresisMetrics(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_07_15_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_07_15_fDOM = hysteresisMetrics(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_18_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_18_fDOM = hysteresisMetrics(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_07_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_07_20_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_07_20_fDOM = hysteresisMetrics(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_07_26_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_07_26_fDOM = hysteresisMetrics(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9a_08_01_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9a_08_01_fDOM = hysteresisMetrics(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9b_08_02_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9b_08_02_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9b_08_02_fDOM = hysteresisMetrics(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_09_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_09_fDOM = hysteresisMetrics(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10b_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10b_08_12_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10b_08_12_fDOM = hysteresisMetrics(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_20_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_20_fDOM = hysteresisMetrics(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12_09_06_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12_09_06_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12_09_06_fDOM = hysteresisMetrics(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_09_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_09_fDOM = hysteresisMetrics(FRCH_storm13_09_09_Q, FRCH_storm13_09_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
FRCH_storm1_06_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_13_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_13_SPC = hysteresisMetrics(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_18_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_18_SPC = hysteresisMetrics(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3a_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3a_06_20_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3a_06_20_SPC = hysteresisMetrics(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3b_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3b_06_21_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3b_06_21_SPC = hysteresisMetrics(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3c_06_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3c_06_26_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3c_06_26_SPC = hysteresisMetrics(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_07_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_07_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_07_SPC = hysteresisMetrics(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_09_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_09_SPC = hysteresisMetrics(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_07_15_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_07_15_SPC = hysteresisMetrics(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_18_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_18_SPC = hysteresisMetrics(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_07_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_07_20_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_07_20_SPC = hysteresisMetrics(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_07_26_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_07_26_SPC = hysteresisMetrics(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9a_08_01_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9a_08_01_SPC = hysteresisMetrics(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9b_08_02_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9b_08_02_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9b_08_02_SPC = hysteresisMetrics(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_09_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_09_SPC = hysteresisMetrics(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10b_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10b_08_12_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10b_08_12_SPC = hysteresisMetrics(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_20_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_20_SPC = hysteresisMetrics(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12_09_06_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12_09_06_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12_09_06_SPC = hysteresisMetrics(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_09_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_09_SPC = hysteresisMetrics(FRCH_storm13_09_09_Q, FRCH_storm13_09_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
FRCH_storm1_06_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_13_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_13_turb = hysteresisMetrics(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_18_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_18_turb = hysteresisMetrics(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3a_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3a_06_20_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3a_06_20_turb = hysteresisMetrics(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3b_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3b_06_21_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3b_06_21_turb = hysteresisMetrics(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3c_06_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3c_06_26_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3c_06_26_turb = hysteresisMetrics(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_07_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_07_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_07_turb = hysteresisMetrics(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_09_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_09_turb = hysteresisMetrics(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_07_15_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_07_15_turb = hysteresisMetrics(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_18_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_18_turb = hysteresisMetrics(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_07_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_07_20_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_07_20_turb = hysteresisMetrics(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_07_26_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_07_26_turb = hysteresisMetrics(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9a_08_01_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9a_08_01_turb = hysteresisMetrics(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9b_08_02_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9b_08_02_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9b_08_02_turb = hysteresisMetrics(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_09_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_09_turb = hysteresisMetrics(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10b_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10b_08_12_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10b_08_12_turb = hysteresisMetrics(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_20_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_20_turb = hysteresisMetrics(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12_09_06_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12_09_06_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12_09_06_turb = hysteresisMetrics(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_09_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_09_turb = hysteresisMetrics(FRCH_storm13_09_09_Q, FRCH_storm13_09_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
FRCH_storm1_06_13_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_06_13_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm1_06_13_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_06_13_abs = hysteresisMetrics(FRCH_storm1_06_13_Q, FRCH_storm1_06_13_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_06_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_06_18_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm2_06_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_06_18_abs = hysteresisMetrics(FRCH_storm2_06_18_Q, FRCH_storm2_06_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3a_06_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3a_06_20_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3a_06_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3a_06_20_abs = hysteresisMetrics(FRCH_storm3a_06_20_Q, FRCH_storm3a_06_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3b_06_21_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3b_06_21_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3b_06_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3b_06_21_abs = hysteresisMetrics(FRCH_storm3b_06_21_Q, FRCH_storm3b_06_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3c_06_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3c_06_26_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3c_06_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3c_06_26_abs = hysteresisMetrics(FRCH_storm3c_06_26_Q, FRCH_storm3c_06_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4a_07_07_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4a_07_07_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4a_07_07_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4a_07_07_abs = hysteresisMetrics(FRCH_storm4a_07_07_Q, FRCH_storm4a_07_07_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4b_07_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4b_07_09_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4b_07_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4b_07_09_abs = hysteresisMetrics(FRCH_storm4b_07_09_Q, FRCH_storm4b_07_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5_07_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5_07_15_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm5_07_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5_07_15_abs = hysteresisMetrics(FRCH_storm5_07_15_Q, FRCH_storm5_07_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6_07_18_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6_07_18_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm6_07_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6_07_18_abs = hysteresisMetrics(FRCH_storm6_07_18_Q, FRCH_storm6_07_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_07_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_07_20_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm7_07_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_07_20_abs = hysteresisMetrics(FRCH_storm7_07_20_Q, FRCH_storm7_07_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_07_26_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_07_26_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm8_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_07_26_abs = hysteresisMetrics(FRCH_storm8_07_26_Q, FRCH_storm8_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9a_08_01_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9a_08_01_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm9a_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9a_08_01_abs = hysteresisMetrics(FRCH_storm9a_08_01_Q, FRCH_storm9a_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm9b_08_02_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm9b_08_02_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm9b_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm9b_08_02_abs = hysteresisMetrics(FRCH_storm9b_08_02_Q, FRCH_storm9b_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10a_08_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10a_08_09_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm10a_08_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10a_08_09_abs = hysteresisMetrics(FRCH_storm10a_08_09_Q, FRCH_storm10a_08_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm10b_08_12_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm10b_08_12_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm10b_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm10b_08_12_abs = hysteresisMetrics(FRCH_storm10b_08_12_Q, FRCH_storm10b_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm11_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm11_08_20_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm11_08_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm11_08_20_abs = hysteresisMetrics(FRCH_storm11_08_20_Q, FRCH_storm11_08_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm12_09_06_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm12_09_06_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm12_09_06_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm12_09_06_abs = hysteresisMetrics(FRCH_storm12_09_06_Q, FRCH_storm12_09_06_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm13_09_09_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm13_09_09_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm13_09_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm13_09_09_abs = hysteresisMetrics(FRCH_storm13_09_09_Q, FRCH_storm13_09_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

 FRCH  results
```{r}

FRCH.hyst.results.list = list(py$hysdict_FRCH_storm1_06_13_NO3,
                              py$hysdict_FRCH_storm1_06_13_fDOM,
                              py$hysdict_FRCH_storm1_06_13_SPC,
                              py$hysdict_FRCH_storm1_06_13_turb,
                              py$hysdict_FRCH_storm1_06_13_abs,
                              py$hysdict_FRCH_storm2_06_18_NO3,
                              py$hysdict_FRCH_storm2_06_18_fDOM,
                              py$hysdict_FRCH_storm2_06_18_SPC,
                              py$hysdict_FRCH_storm2_06_18_turb,
                              py$hysdict_FRCH_storm2_06_18_abs,
                              py$hysdict_FRCH_storm3a_06_20_NO3,
                              py$hysdict_FRCH_storm3a_06_20_fDOM,
                              py$hysdict_FRCH_storm3a_06_20_SPC,
                              py$hysdict_FRCH_storm3a_06_20_turb,
                              py$hysdict_FRCH_storm3b_06_21_NO3,
                              py$hysdict_FRCH_storm3b_06_21_fDOM,
                              py$hysdict_FRCH_storm3b_06_21_SPC,
                              py$hysdict_FRCH_storm3b_06_21_turb,
                              py$hysdict_FRCH_storm3c_06_26_NO3,
                              py$hysdict_FRCH_storm3c_06_26_fDOM,
                              py$hysdict_FRCH_storm3c_06_26_SPC,
                              py$hysdict_FRCH_storm3c_06_26_turb,
                              py$hysdict_FRCH_storm3c_06_26_abs,
                              py$hysdict_FRCH_storm4a_07_07_NO3,
                              py$hysdict_FRCH_storm4a_07_07_fDOM,
                              py$hysdict_FRCH_storm4a_07_07_SPC,
                              py$hysdict_FRCH_storm4a_07_07_turb,
                              py$hysdict_FRCH_storm4a_07_07_abs,
                              py$hysdict_FRCH_storm4b_07_09_NO3,
                              py$hysdict_FRCH_storm4b_07_09_fDOM,
                              py$hysdict_FRCH_storm4b_07_09_SPC,
                              py$hysdict_FRCH_storm4b_07_09_turb,
                              py$hysdict_FRCH_storm4b_07_09_abs,
                              py$hysdict_FRCH_storm5_07_15_NO3,
                              py$hysdict_FRCH_storm5_07_15_fDOM,
                              py$hysdict_FRCH_storm5_07_15_SPC,
                              py$hysdict_FRCH_storm5_07_15_turb,
                              py$hysdict_FRCH_storm5_07_15_abs,
                              py$hysdict_FRCH_storm6_07_18_NO3,
                              py$hysdict_FRCH_storm6_07_18_fDOM,
                              py$hysdict_FRCH_storm6_07_18_SPC,
                              py$hysdict_FRCH_storm6_07_18_turb,
                              py$hysdict_FRCH_storm6_07_18_abs,
                              py$hysdict_FRCH_storm7_07_20_NO3,
                              py$hysdict_FRCH_storm7_07_20_fDOM,
                              py$hysdict_FRCH_storm7_07_20_SPC,
                              py$hysdict_FRCH_storm7_07_20_turb,
                              py$hysdict_FRCH_storm7_07_20_abs,
                              py$hysdict_FRCH_storm8_07_26_NO3,
                              py$hysdict_FRCH_storm8_07_26_fDOM,
                              py$hysdict_FRCH_storm8_07_26_SPC,
                              py$hysdict_FRCH_storm8_07_26_turb,
                              py$hysdict_FRCH_storm7_07_20_abs,
                              py$hysdict_FRCH_storm9a_08_01_NO3,
                              py$hysdict_FRCH_storm9a_08_01_fDOM,
                              py$hysdict_FRCH_storm9a_08_01_SPC,
                              py$hysdict_FRCH_storm9a_08_01_turb,
                              py$hysdict_FRCH_storm9a_08_01_abs,
                              py$hysdict_FRCH_storm9b_08_02_NO3,
                              py$hysdict_FRCH_storm9b_08_02_fDOM,
                              py$hysdict_FRCH_storm9b_08_02_SPC,
                              py$hysdict_FRCH_storm9b_08_02_turb,
                              py$hysdict_FRCH_storm9b_08_02_abs,
                              py$hysdict_FRCH_storm10a_08_09_NO3,
                              py$hysdict_FRCH_storm10a_08_09_fDOM,
                              py$hysdict_FRCH_storm10a_08_09_SPC,
                              py$hysdict_FRCH_storm10a_08_09_turb,
                              py$hysdict_FRCH_storm10a_08_09_abs,
                              py$hysdict_FRCH_storm10b_08_12_NO3,
                              py$hysdict_FRCH_storm10b_08_12_fDOM,
                              py$hysdict_FRCH_storm10b_08_12_SPC,
                              py$hysdict_FRCH_storm10b_08_12_turb,
                              py$hysdict_FRCH_storm10b_08_12_abs,
                              py$hysdict_FRCH_storm11_08_20_NO3,
                              py$hysdict_FRCH_storm11_08_20_fDOM,
                              py$hysdict_FRCH_storm11_08_20_SPC,
                              py$hysdict_FRCH_storm11_08_20_turb,
                              py$hysdict_FRCH_storm11_08_20_abs,
                              py$hysdict_FRCH_storm12_09_06_NO3,
                              py$hysdict_FRCH_storm12_09_06_fDOM,
                              py$hysdict_FRCH_storm12_09_06_SPC,
                              py$hysdict_FRCH_storm12_09_06_turb,
                              py$hysdict_FRCH_storm12_09_06_abs,
                              py$hysdict_FRCH_storm13_09_09_NO3,
                              py$hysdict_FRCH_storm13_09_09_fDOM,
                              py$hysdict_FRCH_storm13_09_09_SPC,
                              py$hysdict_FRCH_storm13_09_09_turb,
                              py$hysdict_FRCH_storm13_09_09_abs)


FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm1_06_13_NO3",
                                  "FRCH_storm1_06_13_fDOM",
                                  "FRCH_storm1_06_13_SPC",
                                  "FRCH_storm1_06_13_turb",
                                  "FRCH_storm1_06_13_abs",
                                  "FRCH_storm2_06_18_NO3",
                                  "FRCH_storm2_06_18_fDOM",
                                  "FRCH_storm2_06_18_SPC",
                                  "FRCH_storm2_06_18_turb",
                                  "FRCH_storm2_06_18_abs",
                                  "FRCH_storm3a_06_20_NO3",
                                  "FRCH_storm3a_06_20_fDOM",
                                  "FRCH_storm3a_06_20_SPC",
                                  "FRCH_storm3a_06_20_turb",
                                  "FRCH_storm3b_06_21_NO3",
                                  "FRCH_storm3b_06_21_fDOM",
                                  "FRCH_storm3b_06_21_SPC",
                                  "FRCH_storm3b_06_21_turb",
                                  "FRCH_storm3c_06_26_NO3",
                                  "FRCH_storm3c_06_26_fDOM",
                                  "FRCH_storm3c_06_26_SPC",
                                  "FRCH_storm3c_06_26_turb",
                                  "FRCH_storm3c_06_26_abs",
                                  "FRCH_storm4a_07_07_NO3",
                                  "FRCH_storm4a_07_07_fDOM",
                                  "FRCH_storm4a_07_07_SPC",
                                  "FRCH_storm4a_07_07_turb",
                                  "FRCH_storm4a_07_07_abs",
                                  "FRCH_storm4b_07_09_NO3",
                                  "FRCH_storm4b_07_09_fDOM",
                                  "FRCH_storm4b_07_09_SPC",
                                  "FRCH_storm4b_07_09_turb",
                                  "FRCH_storm4b_07_09_abs",
                                  "FRCH_storm5_07_15_NO3",
                                  "FRCH_storm5_07_15_fDOM",
                                  "FRCH_storm5_07_15_SPC",
                                  "FRCH_storm5_07_15_turb",
                                  "FRCH_storm5_07_15_abs",
                                  "FRCH_storm6_07_18_NO3",
                                  "FRCH_storm6_07_18_fDOM",
                                  "FRCH_storm6_07_18_SPC",
                                  "FRCH_storm6_07_18_turb",
                                  "FRCH_storm6_07_18_abs",
                                  "FRCH_storm7_07_20_NO3",
                                  "FRCH_storm7_07_20_fDOM",
                                  "FRCH_storm7_07_20_SPC",
                                  "FRCH_storm7_07_20_turb",
                                  "FRCH_storm7_07_20_abs",
                                  "FRCH_storm8_07_26_NO3",
                                  "FRCH_storm8_07_26_fDOM",
                                  "FRCH_storm8_07_26_SPC",
                                  "FRCH_storm8_07_26_turb",
                                  "FRCH_storm8_07_26_abs",
                                  "FRCH_storm9a_08_01_NO3",
                                  "FRCH_storm9a_08_01_fDOM",
                                  "FRCH_storm9a_08_01_SPC",
                                  "FRCH_storm9a_08_01_turb",
                                  "FRCH_storm9a_08_01_abs",
                                  "FRCH_storm9b_08_02_NO3",
                                  "FRCH_storm9b_08_02_fDOM",
                                  "FRCH_storm9b_08_02_SPC",
                                  "FRCH_storm9b_08_02_turb",
                                  "FRCH_storm9b_08_02_abs",
                                  "FRCH_storm10a_08_09_NO3",
                                  "FRCH_storm10a_08_09_fDOM",
                                  "FRCH_storm10a_08_09_SPC",
                                  "FRCH_storm10a_08_09_turb",
                                  "FRCH_storm10a_08_09_abs",
                                  "FRCH_storm10b_08_12_NO3",
                                  "FRCH_storm10b_08_12_fDOM",
                                  "FRCH_storm10b_08_12_SPC",
                                  "FRCH_storm10b_08_12_turb",
                                  "FRCH_storm10b_08_12_abs",
                                  "FRCH_storm11_08_20_NO3",
                                  "FRCH_storm11_08_20_fDOM",
                                  "FRCH_storm11_08_20_SPC",
                                  "FRCH_storm11_08_20_turb",
                                  "FRCH_storm11_08_20_abs",
                                  "FRCH_storm12_09_06_NO3",
                                  "FRCH_storm12_09_06_fDOM",
                                  "FRCH_storm12_09_06_SPC",
                                  "FRCH_storm12_09_06_turb",
                                  "FRCH_storm12_09_06_abs",
                                  "FRCH_storm13_09_09_NO3",
                                  "FRCH_storm13_09_09_fDOM",
                                  "FRCH_storm13_09_09_SPC",
                                  "FRCH_storm13_09_09_turb",
                                  "FRCH_storm13_09_09_abs")


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/FRCH/FRCH.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(rep("FRCH_storm1_06_13_NO3", 50),
                        rep("FRCH_storm1_06_13_fDOM", 50),
                        rep("FRCH_storm1_06_13_SPC", 50),
                        rep("FRCH_storm1_06_13_turb", 50),
                        rep("FRCH_storm1_06_13_abs", 50),
                        rep("FRCH_storm2_06_18_NO3", 50),
                        rep("FRCH_storm2_06_18_fDOM", 50),
                        rep("FRCH_storm2_06_18_SPC", 50),
                        rep("FRCH_storm2_06_18_turb", 50),
                        rep("FRCH_storm2_06_18_abs", 49),
                        rep("FRCH_storm3a_06_20_NO3", 50),
                        rep("FRCH_storm3a_06_20_fDOM", 50),
                        rep("FRCH_storm3a_06_20_SPC", 50),
                        rep("FRCH_storm3a_06_20_turb", 50),
                        rep("FRCH_storm3b_06_21_NO3", 50),
                        rep("FRCH_storm3b_06_21_fDOM", 50),
                        rep("FRCH_storm3b_06_21_SPC", 50),
                        rep("FRCH_storm3b_06_21_turb", 50),
                        rep("FRCH_storm3c_06_26_NO3", 50),
                        rep("FRCH_storm3c_06_26_fDOM", 50),
                        rep("FRCH_storm3c_06_26_SPC", 50),
                        rep("FRCH_storm3c_06_26_turb", 50),
                        rep("FRCH_storm3c_06_26_abs", 50),
                        rep("FRCH_storm4a_07_07_NO3", 50),
                        rep("FRCH_storm4a_07_07_fDOM", 50),
                        rep("FRCH_storm4a_07_07_SPC", 50),
                        rep("FRCH_storm4a_07_07_turb", 50),
                        rep("FRCH_storm4a_07_07_abs", 50),
                        rep("FRCH_storm4b_07_09_NO3", 50),
                        rep("FRCH_storm4b_07_09_fDOM", 50),
                        rep("FRCH_storm4b_07_09_SPC", 50),
                        rep("FRCH_storm4b_07_09_turb", 50),
                        rep("FRCH_storm4b_07_09_abs", 50),
                        rep("FRCH_storm5_07_15_NO3", 50),
                        rep("FRCH_storm5_07_15_fDOM", 50),
                        rep("FRCH_storm5_07_15_SPC", 50),
                        rep("FRCH_storm5_07_15_turb", 50),
                        rep("FRCH_storm5_07_15_abs", 50),
                        rep("FRCH_storm6_07_18_NO3", 50),
                        rep("FRCH_storm6_07_18_fDOM", 50),
                        rep("FRCH_storm6_07_18_SPC", 50),
                        rep("FRCH_storm6_07_18_turb", 50),
                        rep("FRCH_storm6_07_18_abs", 50),
                        rep("FRCH_storm7_07_20_NO3", 50),
                        rep("FRCH_storm7_07_20_fDOM", 50),
                        rep("FRCH_storm7_07_20_SPC", 50),
                        rep("FRCH_storm7_07_20_turb", 50),
                        rep("FRCH_storm7_07_20_abs", 50),
                        rep("FRCH_storm8_07_26_NO3", 50),
                        rep("FRCH_storm8_07_26_fDOM", 50),
                        rep("FRCH_storm8_07_26_SPC", 50),
                        rep("FRCH_storm8_07_26_turb", 50),
                        rep("FRCH_storm8_07_26_abs", 50),
                        rep("FRCH_storm9a_08_01_NO3", 50),
                        rep("FRCH_storm9a_08_01_fDOM", 50),
                        rep("FRCH_storm9a_08_01_SPC", 50),
                        rep("FRCH_storm9a_08_01_turb", 50),
                        rep("FRCH_storm9a_08_01_abs", 50),
                        rep("FRCH_storm9b_08_02_NO3", 50),
                        rep("FRCH_storm9b_08_02_fDOM", 50),
                        rep("FRCH_storm9b_08_02_SPC", 50),
                        rep("FRCH_storm9b_08_02_turb", 50),
                        rep("FRCH_storm9b_08_02_abs", 50),
                        rep("FRCH_storm10a_08_09_NO3", 50),
                        rep("FRCH_storm10a_08_09_fDOM", 50),
                        rep("FRCH_storm10a_08_09_SPC", 50),
                        rep("FRCH_storm10a_08_09_turb", 50),
                        rep("FRCH_storm10a_08_09_abs", 50),
                        rep("FRCH_storm10b_08_12_NO3", 50),
                        rep("FRCH_storm10b_08_12_fDOM", 50),
                        rep("FRCH_storm10b_08_12_SPC", 50),
                        rep("FRCH_storm10b_08_12_turb", 50),
                        rep("FRCH_storm10b_08_12_abs", 50),
                        rep("FRCH_storm11_08_20_NO3", 50),
                        rep("FRCH_storm11_08_20_fDOM", 50),
                        rep("FRCH_storm11_08_20_SPC", 50),
                        rep("FRCH_storm11_08_20_turb", 50),
                        rep("FRCH_storm11_08_20_abs", 50),
                        rep("FRCH_storm12_09_06_NO3", 50),
                        rep("FRCH_storm12_09_06_fDOM", 50),
                        rep("FRCH_storm12_09_06_SPC", 50),
                        rep("FRCH_storm12_09_06_turb", 50),
                        rep("FRCH_storm12_09_06_abs", 50),
                        rep("FRCH_storm13_09_09_NO3", 50),
                        rep("FRCH_storm13_09_09_fDOM", 50),
                        rep("FRCH_storm13_09_09_SPC", 50),
                        rep("FRCH_storm13_09_09_turb", 50),
                        rep("FRCH_storm13_09_09_abs", 50))

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/FRCH/FRCH.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/FRCH/FRCH.HI.df.csv")

FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/FRCH/FRCH.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/FRCH/FRCH.HI.df.doy.csv")

```



load data to pandas
```{python}
# STRT #
STRT_storm1a_06_18_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1a_06_18_Q.csv")
STRT_storm1a_06_18_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1a_06_18_NO3.csv")
STRT_storm1a_06_18_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1a_06_18_fDOM.csv")
STRT_storm1a_06_18_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1a_06_18_SPC.csv")
STRT_storm1a_06_18_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1a_06_18_Turb.csv")
STRT_storm1a_06_18_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1a_06_18_abs.csv")

# STRT_storm1a_06_18_Q = STRT_storm1a_06_18_Q.dropna(subset=['datavalue'])
# STRT_storm1a_06_18_NO3 = STRT_storm1a_06_18_NO3.dropna(subset=['datavalue'])
# STRT_storm1a_06_18_fDOM = STRT_storm1a_06_18_fDOM.dropna(subset=['datavalue'])
# STRT_storm1a_06_18_SPC = STRT_storm1a_06_18_SPC.dropna(subset=['datavalue'])
# STRT_storm1a_06_18_turb = STRT_storm1a_06_18_turb.dropna(subset=['datavalue'])

STRT_storm1b_06_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1b_06_20_Q.csv")
STRT_storm1b_06_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1b_06_20_NO3.csv")
STRT_storm1b_06_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1b_06_20_fDOM.csv")
STRT_storm1b_06_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1b_06_20_SPC.csv")
STRT_storm1b_06_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1b_06_20_Turb.csv")
STRT_storm1b_06_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1b_06_20_abs.csv")

# STRT_storm1b_06_20_Q = STRT_storm1b_06_20_Q.dropna(subset=['datavalue'])
# STRT_storm1b_06_20_NO3 = STRT_storm1b_06_20_NO3.dropna(subset=['datavalue'])
# STRT_storm1b_06_20_fDOM = STRT_storm1b_06_20_fDOM.dropna(subset=['fDOM.QSU'])
# STRT_storm1b_06_20_SPC = STRT_storm1b_06_20_SPC.dropna(subset=['datavalue'])
# STRT_storm1b_06_20_turb = STRT_storm1b_06_20_turb.dropna(subset=['datavalue'])


STRT_storm1c_06_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1c_06_21_Q.csv")
STRT_storm1c_06_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1c_06_21_NO3.csv")
STRT_storm1c_06_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1c_06_21_fDOM.csv")
STRT_storm1c_06_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1c_06_21_SPC.csv")
STRT_storm1c_06_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1c_06_21_Turb.csv")
STRT_storm1c_06_21_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1c_06_21_abs.csv")

# STRT_storm1c_06_21_Q = STRT_storm1c_06_21_Q.dropna(subset=['datavalue'])
# STRT_storm1c_06_21_NO3 = STRT_storm1c_06_21_NO3.dropna(subset=['datavalue'])
# STRT_storm1c_06_21_fDOM = STRT_storm1c_06_21_fDOM.dropna(subset=['datavalue'])
# STRT_storm1c_06_21_SPC = STRT_storm1c_06_21_SPC.dropna(subset=['datavalue'])
# STRT_storm1c_06_21_turb = STRT_storm1c_06_21_turb.dropna(subset=['datavalue'])

STRT_storm1d_06_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1d_06_23_Q.csv")
STRT_storm1d_06_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1d_06_23_NO3.csv")
STRT_storm1d_06_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1d_06_23_fDOM.csv")
STRT_storm1d_06_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1d_06_23_SPC.csv")
STRT_storm1d_06_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1d_06_23_Turb.csv")
STRT_storm1d_06_23_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1d_06_23_abs.csv")

# STRT_storm1d_06_23_Q = STRT_storm1d_06_23_Q.dropna(subset=['datavalue'])
# STRT_storm1d_06_23_NO3 = STRT_storm1d_06_23_NO3.dropna(subset=['datavalue'])
# STRT_storm1d_06_23_fDOM = STRT_storm1d_06_23_fDOM.dropna(subset=['datavalue'])
# STRT_storm1d_06_23_SPC = STRT_storm1d_06_23_SPC.dropna(subset=['datavalue'])
# STRT_storm1d_06_23_turb = STRT_storm1d_06_23_turb.dropna(subset=['datavalue'])

STRT_storm1e_06_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1e_06_24_Q.csv")
STRT_storm1e_06_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1e_06_24_NO3.csv")
STRT_storm1e_06_24_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1e_06_24_fDOM.csv")
STRT_storm1e_06_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1e_06_24_SPC.csv")
STRT_storm1e_06_24_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1e_06_24_Turb.csv")
STRT_storm1e_06_24_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm1e_06_24_abs.csv")

# STRT_storm1e_06_24_Q = STRT_storm1e_06_24_Q.dropna(subset=['datavalue'])
# STRT_storm1e_06_24_NO3 = STRT_storm1e_06_24_NO3.dropna(subset=['datavalue'])
# STRT_storm1e_06_24_fDOM = STRT_storm1e_06_24_fDOM.dropna(subset=['datavalue'])
# STRT_storm1e_06_24_SPC = STRT_storm1e_06_24_SPC.dropna(subset=['datavalue'])
# STRT_storm1e_06_24_turb = STRT_storm1e_06_24_turb.dropna(subset=['datavalue'])

STRT_storm2_07_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm2_07_09_Q.csv")
STRT_storm2_07_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm2_07_09_NO3.csv")
STRT_storm2_07_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm2_07_09_fDOM.csv")
STRT_storm2_07_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm2_07_09_SPC.csv")
STRT_storm2_07_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm2_07_09_Turb.csv")
STRT_storm2_07_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm2_07_09_abs.csv")

# STRT_storm2_07_09_Q = STRT_storm2_07_09_Q.dropna(subset=['datavalue'])
# STRT_storm2_07_09_NO3 = STRT_storm2_07_09_NO3.dropna(subset=['datavalue'])
# STRT_storm2_07_09_fDOM = STRT_storm2_07_09_fDOM.dropna(subset=['datavalue'])
# STRT_storm2_07_09_SPC = STRT_storm2_07_09_SPC.dropna(subset=['datavalue'])
# STRT_storm2_07_09_turb = STRT_storm2_07_09_turb.dropna(subset=['datavalue'])

STRT_storm3_07_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm3_07_20_Q.csv")
STRT_storm3_07_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm3_07_20_NO3.csv")
STRT_storm3_07_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm3_07_20_fDOM.csv")
STRT_storm3_07_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm3_07_20_SPC.csv")
STRT_storm3_07_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm3_07_20_Turb.csv")
STRT_storm3_07_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm3_07_20_abs.csv")

# STRT_storm3_07_20_Q = STRT_storm3_07_20_Q.dropna(subset=['datavalue'])
# STRT_storm3_07_20_NO3 = STRT_storm3_07_20_NO3.dropna(subset=['datavalue'])
# STRT_storm3_07_20_fDOM = STRT_storm3_07_20_fDOM.dropna(subset=['datavalue'])
# STRT_storm3_07_20_SPC = STRT_storm3_07_20_SPC.dropna(subset=['datavalue'])
# STRT_storm3_07_20_turb = STRT_storm3_07_20_turb.dropna(subset=['datavalue'])

STRT_storm4a_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4a_08_01_Q.csv")
STRT_storm4a_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4a_08_01_NO3.csv")
STRT_storm4a_08_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4a_08_01_fDOM.csv")
STRT_storm4a_08_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4a_08_01_SPC.csv")
STRT_storm4a_08_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4a_08_01_Turb.csv")
STRT_storm4a_08_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4a_08_01_abs.csv")

# STRT_storm4a_08_01_Q = STRT_storm4a_08_01_Q.dropna(subset=['datavalue'])
# STRT_storm4a_08_01_NO3 = STRT_storm4a_08_01_NO3.dropna(subset=['datavalue'])
# STRT_storm4a_08_01_fDOM = STRT_storm4a_08_01_fDOM.dropna(subset=['datavalue'])
# STRT_storm4a_08_01_SPC = STRT_storm4a_08_01_SPC.dropna(subset=['datavalue'])
# STRT_storm4a_08_01_turb = STRT_storm4a_08_01_turb.dropna(subset=['datavalue'])

STRT_storm4b_08_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4b_08_03_Q.csv")
STRT_storm4b_08_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4b_08_03_NO3.csv")
STRT_storm4b_08_03_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4b_08_03_fDOM.csv")
STRT_storm4b_08_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4b_08_03_SPC.csv")
STRT_storm4b_08_03_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4b_08_03_Turb.csv")
STRT_storm4b_08_03_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm4b_08_03_abs.csv")

# STRT_storm4b_08_03_Q = STRT_storm4b_08_03_Q.dropna(subset=['datavalue'])
# STRT_storm4b_08_03_NO3 = STRT_storm4b_08_03_NO3.dropna(subset=['datavalue'])
# STRT_storm4b_08_03_fDOM = STRT_storm4b_08_03_fDOM.dropna(subset=['datavalue'])
# STRT_storm4b_08_03_SPC = STRT_storm4b_08_03_SPC.dropna(subset=['datavalue'])
# STRT_storm4b_08_03_turb = STRT_storm4b_08_03_turb.dropna(subset=['datavalue'])

STRT_storm5_08_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm5_08_09_Q.csv")
STRT_storm5_08_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm5_08_09_NO3.csv")
STRT_storm5_08_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm5_08_09_fDOM.csv")
STRT_storm5_08_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm5_08_09_SPC.csv")
STRT_storm5_08_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm5_08_09_Turb.csv")
STRT_storm5_08_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm5_08_09_abs.csv")

# STRT_storm5_08_09_Q = STRT_storm5_08_09_Q.dropna(subset=['datavalue'])
# STRT_storm5_08_09_NO3 = STRT_storm5_08_09_NO3.dropna(subset=['datavalue'])
# STRT_storm5_08_09_fDOM = STRT_storm5_08_09_fDOM.dropna(subset=['datavalue'])
# STRT_storm5_08_09_SPC = STRT_storm5_08_09_SPC.dropna(subset=['datavalue'])
# STRT_storm5_08_09_turb = STRT_storm5_08_09_turb.dropna(subset=['datavalue'])

STRT_storm6_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm6_08_12_Q.csv")
STRT_storm6_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm6_08_12_NO3.csv")
STRT_storm6_08_12_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm6_08_12_fDOM.csv")
STRT_storm6_08_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm6_08_12_SPC.csv")
STRT_storm6_08_12_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm6_08_12_Turb.csv")
STRT_storm6_08_12_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm6_08_12_abs.csv")

# STRT_storm6_08_12_Q = STRT_storm6_08_12_Q.dropna(subset=['datavalue'])
# STRT_storm6_08_12_NO3 = STRT_storm6_08_12_NO3.dropna(subset=['datavalue'])
# STRT_storm6_08_12_fDOM = STRT_storm6_08_12_fDOM.dropna(subset=['datavalue'])
# STRT_storm6_08_12_SPC = STRT_storm6_08_12_SPC.dropna(subset=['datavalue'])
# STRT_storm6_08_12_turb = STRT_storm6_08_12_turb.dropna(subset=['datavalue'])

STRT_storm7a_08_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7a_08_20_Q.csv")
STRT_storm7a_08_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7a_08_20_NO3.csv")
STRT_storm7a_08_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7a_08_20_fDOM.csv")
STRT_storm7a_08_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7a_08_20_SPC.csv")
STRT_storm7a_08_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7a_08_20_Turb.csv")
STRT_storm7a_08_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7a_08_20_abs.csv")

# STRT_storm7a_08_20_Q = STRT_storm7a_08_20_Q.dropna(subset=['datavalue'])
# STRT_storm7a_08_20_NO3 = STRT_storm7a_08_20_NO3.dropna(subset=['datavalue'])
# STRT_storm7a_08_20_fDOM = STRT_storm7a_08_20_fDOM.dropna(subset=['datavalue'])
# STRT_storm7a_08_20_SPC = STRT_storm7a_08_20_SPC.dropna(subset=['datavalue'])
# STRT_storm7a_08_20_turb = STRT_storm7a_08_20_turb.dropna(subset=['datavalue'])

STRT_storm7b_08_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7b_08_21_Q.csv")
STRT_storm7b_08_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7b_08_21_NO3.csv")
STRT_storm7b_08_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7b_08_21_fDOM.csv")
STRT_storm7b_08_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7b_08_21_SPC.csv")
STRT_storm7b_08_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7b_08_21_Turb.csv")
STRT_storm7b_08_21_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm7b_08_21_abs.csv")

# STRT_storm7b_08_21_Q = STRT_storm7b_08_21_Q.dropna(subset=['datavalue'])
# STRT_storm7b_08_21_NO3 = STRT_storm7b_08_21_NO3.dropna(subset=['datavalue'])
# STRT_storm7b_08_21_fDOM = STRT_storm7b_08_21_fDOM.dropna(subset=['datavalue'])
# STRT_storm7b_08_21_SPC = STRT_storm7b_08_21_SPC.dropna(subset=['datavalue'])
# STRT_storm7b_08_21_turb = STRT_storm7b_08_21_turb.dropna(subset=['datavalue'])

STRT_storm8_08_28_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm8_08_28_Q.csv")
STRT_storm8_08_28_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm8_08_28_NO3.csv")
STRT_storm8_08_28_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm8_08_28_fDOM.csv")
STRT_storm8_08_28_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm8_08_28_SPC.csv")
STRT_storm8_08_28_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm8_08_28_Turb.csv")
STRT_storm8_08_28_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm8_08_28_abs.csv")

# STRT_storm8_08_28_Q = STRT_storm8_08_28_Q.dropna(subset=['datavalue'])
# STRT_storm8_08_28_NO3 = STRT_storm8_08_28_NO3.dropna(subset=['datavalue'])
# STRT_storm8_08_28_fDOM = STRT_storm8_08_28_fDOM.dropna(subset=['datavalue'])
# STRT_storm8_08_28_SPC = STRT_storm8_08_28_SPC.dropna(subset=['datavalue'])
# STRT_storm8_08_28_turb = STRT_storm8_08_28_turb.dropna(subset=['datavalue'])

STRT_storm9a_09_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9a_09_03_Q.csv")
STRT_storm9a_09_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9a_09_03_NO3.csv")
STRT_storm9a_09_03_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9a_09_03_fDOM.csv")
STRT_storm9a_09_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9a_09_03_SPC.csv")
STRT_storm9a_09_03_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9a_09_03_Turb.csv")
STRT_storm9a_09_03_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9a_09_03_abs.csv")

# STRT_storm9a_09_03_Q = STRT_storm9a_09_03_Q.dropna(subset=['datavalue'])
# STRT_storm9a_09_03_NO3 = STRT_storm9a_09_03_NO3.dropna(subset=['datavalue'])
# STRT_storm9a_09_03_fDOM = STRT_storm9a_09_03_fDOM.dropna(subset=['datavalue'])
# STRT_storm9a_09_03_SPC = STRT_storm9a_09_03_SPC.dropna(subset=['datavalue'])
# STRT_storm9a_09_03_turb = STRT_storm9a_09_03_turb.dropna(subset=['datavalue'])

STRT_storm9b_09_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9b_09_06_Q.csv")
STRT_storm9b_09_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9b_09_06_NO3.csv")
STRT_storm9b_09_06_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9b_09_06_fDOM.csv")
STRT_storm9b_09_06_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9b_09_06_SPC.csv")
STRT_storm9b_09_06_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9b_09_06_Turb.csv")
STRT_storm9b_09_06_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9b_09_06_abs.csv")

# STRT_storm9b_09_06_Q = STRT_storm9b_09_06_Q.dropna(subset=['datavalue'])
# STRT_storm9b_09_06_NO3 = STRT_storm9b_09_06_NO3.dropna(subset=['datavalue'])
# STRT_storm9b_09_06_fDOM = STRT_storm9b_09_06_fDOM.dropna(subset=['datavalue'])
# STRT_storm9b_09_06_SPC = STRT_storm9b_09_06_turb.dropna(subset=['datavalue'])
# STRT_storm9b_09_06_turb = STRT_storm9b_09_06_turb.dropna(subset=['datavalue'])

STRT_storm9c_09_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9c_09_09_Q.csv")
STRT_storm9c_09_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9c_09_09_NO3.csv")
STRT_storm9c_09_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9c_09_09_fDOM.csv")
STRT_storm9c_09_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9c_09_09_SPC.csv")
STRT_storm9c_09_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9c_09_09_Turb.csv")
STRT_storm9c_09_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm9c_09_09_abs.csv")

# STRT_storm9c_09_09_Q = STRT_storm9c_09_09_Q.dropna(subset=['datavalue'])
# STRT_storm9c_09_09_NO3 = STRT_storm9c_09_09_NO3.dropna(subset=['datavalue'])
# STRT_storm9c_09_09_fDOM = STRT_storm9c_09_09_fDOM.dropna(subset=['datavalue'])
# STRT_storm9c_09_09_SPC = STRT_storm9c_09_09_SPC.dropna(subset=['datavalue'])
# STRT_storm9c_09_09_turb = STRT_storm9c_09_09_turb.dropna(subset=['datavalue'])

STRT_storm10_09_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm10_09_23_Q.csv")
STRT_storm10_09_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm10_09_23_NO3.csv")
STRT_storm10_09_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm10_09_23_fDOM.csv")
STRT_storm10_09_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm10_09_23_SPC.csv")
STRT_storm10_09_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm10_09_23_Turb.csv")
STRT_storm10_09_23_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/STRT/STRT_storm10_09_23_abs.csv")

# STRT_storm10_09_23_Q = STRT_storm10_09_23_Q.dropna(subset=['datavalue'])
# STRT_storm10_09_23_NO3 = STRT_storm10_09_23_NO3.dropna(subset=['datavalue'])
# STRT_storm10_09_23_fDOM = STRT_storm10_09_23_fDOM.dropna(subset=['datavalue'])
# STRT_storm10_09_23_SPC = STRT_storm10_09_23_SPC.dropna(subset=['datavalue'])
# STRT_storm10_09_23_turb = STRT_storm10_09_23_turb.dropna(subset=['datavalue'])


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```



 STRT_storms
```{python}

## NO3 ##
STRT_storm1a_06_18_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_06_18_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1a_06_18_NO3 = hysteresisMetrics(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_06_20_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1b_06_20_NO3 = hysteresisMetrics(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1c_06_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1c_06_21_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1c_06_21_NO3 = hysteresisMetrics(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1d_06_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1d_06_23_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1d_06_23_NO3 = hysteresisMetrics(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1e_06_24_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1e_06_24_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1e_06_24_NO3 = hysteresisMetrics(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_09_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_09_NO3 = hysteresisMetrics(STRT_storm2_07_09_Q, STRT_storm2_07_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_07_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_07_20_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3_07_20_NO3 = hysteresisMetrics(STRT_storm3_07_20_Q, STRT_storm3_07_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4a_08_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4a_08_01_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4a_08_01_NO3 = hysteresisMetrics(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4b_08_03_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4b_08_03_NO3 = hysteresisMetrics(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_09_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_09_NO3 = hysteresisMetrics(STRT_storm5_08_09_Q, STRT_storm5_08_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_08_12_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_08_12_NO3 = hysteresisMetrics(STRT_storm6_08_12_Q, STRT_storm6_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_08_20_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_08_20_NO3 = hysteresisMetrics(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_08_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_08_21_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_08_21_NO3 = hysteresisMetrics(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm8_08_28_Q['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm8_08_28_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm8_08_28_NO3 = hysteresisMetrics(STRT_storm8_08_28_Q, STRT_storm8_08_28_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9a_09_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9a_09_03_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9a_09_03_NO3 = hysteresisMetrics(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9b_09_06_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9b_09_06_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9b_09_06_NO3 = hysteresisMetrics(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9c_09_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9c_09_09_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9c_09_09_NO3 = hysteresisMetrics(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm10_09_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm10_09_23_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm10_09_23_NO3 = hysteresisMetrics(STRT_storm10_09_23_Q, STRT_storm10_09_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## fDOM ##
STRT_storm1a_06_18_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_06_18_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1a_06_18_fDOM = hysteresisMetrics(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_06_20_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1b_06_20_fDOM = hysteresisMetrics(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1c_06_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1c_06_21_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1c_06_21_fDOM = hysteresisMetrics(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1d_06_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1d_06_23_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1d_06_23_fDOM = hysteresisMetrics(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1e_06_24_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1e_06_24_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1e_06_24_fDOM = hysteresisMetrics(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_09_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_09_fDOM = hysteresisMetrics(STRT_storm2_07_09_Q, STRT_storm2_07_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_07_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_07_20_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3_07_20_fDOM = hysteresisMetrics(STRT_storm3_07_20_Q, STRT_storm3_07_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4a_08_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4a_08_01_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4a_08_01_fDOM = hysteresisMetrics(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4b_08_03_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4b_08_03_fDOM = hysteresisMetrics(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_09_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_09_fDOM = hysteresisMetrics(STRT_storm5_08_09_Q, STRT_storm5_08_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_08_12_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_08_12_fDOM = hysteresisMetrics(STRT_storm6_08_12_Q, STRT_storm6_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_08_20_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_08_20_fDOM = hysteresisMetrics(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_08_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_08_21_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_08_21_fDOM = hysteresisMetrics(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm8_08_28_Q['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm8_08_28_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm8_08_28_fDOM = hysteresisMetrics(STRT_storm8_08_28_Q, STRT_storm8_08_28_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9a_09_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9a_09_03_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9a_09_03_fDOM = hysteresisMetrics(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9b_09_06_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9b_09_06_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9b_09_06_fDOM = hysteresisMetrics(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9c_09_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9c_09_09_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9c_09_09_fDOM = hysteresisMetrics(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm10_09_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm10_09_23_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm10_09_23_fDOM = hysteresisMetrics(STRT_storm10_09_23_Q, STRT_storm10_09_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
STRT_storm1a_06_18_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_06_18_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1a_06_18_SPC = hysteresisMetrics(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_06_20_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1b_06_20_SPC = hysteresisMetrics(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1c_06_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1c_06_21_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1c_06_21_SPC = hysteresisMetrics(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1d_06_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1d_06_23_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1d_06_23_SPC = hysteresisMetrics(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1e_06_24_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1e_06_24_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1e_06_24_SPC = hysteresisMetrics(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_09_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_09_SPC = hysteresisMetrics(STRT_storm2_07_09_Q, STRT_storm2_07_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_07_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_07_20_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3_07_20_SPC = hysteresisMetrics(STRT_storm3_07_20_Q, STRT_storm3_07_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4a_08_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4a_08_01_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4a_08_01_SPC = hysteresisMetrics(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4b_08_03_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4b_08_03_SPC = hysteresisMetrics(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_09_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_09_SPC = hysteresisMetrics(STRT_storm5_08_09_Q, STRT_storm5_08_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_08_12_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_08_12_SPC = hysteresisMetrics(STRT_storm6_08_12_Q, STRT_storm6_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_08_20_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_08_20_SPC = hysteresisMetrics(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_08_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_08_21_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_08_21_SPC = hysteresisMetrics(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm8_08_28_Q['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm8_08_28_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm8_08_28_SPC = hysteresisMetrics(STRT_storm8_08_28_Q, STRT_storm8_08_28_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9a_09_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9a_09_03_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9a_09_03_SPC = hysteresisMetrics(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9b_09_06_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9b_09_06_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9b_09_06_SPC = hysteresisMetrics(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9c_09_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9c_09_09_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9c_09_09_SPC = hysteresisMetrics(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm10_09_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm10_09_23_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm10_09_23_SPC = hysteresisMetrics(STRT_storm10_09_23_Q, STRT_storm10_09_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
STRT_storm1a_06_18_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_06_18_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1a_06_18_turb = hysteresisMetrics(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_06_20_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1b_06_20_turb = hysteresisMetrics(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1c_06_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1c_06_21_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1c_06_21_turb = hysteresisMetrics(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1d_06_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1d_06_23_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1d_06_23_turb = hysteresisMetrics(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1e_06_24_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1e_06_24_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1e_06_24_turb = hysteresisMetrics(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_09_turb['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_09_turb = hysteresisMetrics(STRT_storm2_07_09_Q, STRT_storm2_07_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_07_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_07_20_turb['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3_07_20_turb = hysteresisMetrics(STRT_storm3_07_20_Q, STRT_storm3_07_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4a_08_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4a_08_01_turb['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4a_08_01_turb = hysteresisMetrics(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4b_08_03_turb['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4b_08_03_turb = hysteresisMetrics(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_09_turb['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_09_turb = hysteresisMetrics(STRT_storm5_08_09_Q, STRT_storm5_08_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_08_12_turb['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_08_12_turb = hysteresisMetrics(STRT_storm6_08_12_Q, STRT_storm6_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_08_20_turb['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_08_20_turb = hysteresisMetrics(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_08_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_08_21_turb['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_08_21_turb = hysteresisMetrics(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm8_08_28_Q['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm8_08_28_turb['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm8_08_28_turb = hysteresisMetrics(STRT_storm8_08_28_Q, STRT_storm8_08_28_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9a_09_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9a_09_03_turb['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9a_09_03_turb = hysteresisMetrics(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9b_09_06_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9b_09_06_turb['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9b_09_06_turb = hysteresisMetrics(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9c_09_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9c_09_09_turb['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9c_09_09_turb = hysteresisMetrics(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm10_09_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm10_09_23_turb['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm10_09_23_turb = hysteresisMetrics(STRT_storm10_09_23_Q, STRT_storm10_09_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
STRT_storm1a_06_18_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_06_18_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1a_06_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1a_06_18_abs = hysteresisMetrics(STRT_storm1a_06_18_Q, STRT_storm1a_06_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_06_20_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1b_06_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1b_06_20_abs = hysteresisMetrics(STRT_storm1b_06_20_Q, STRT_storm1b_06_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1c_06_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1c_06_21_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1c_06_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1c_06_21_abs = hysteresisMetrics(STRT_storm1c_06_21_Q, STRT_storm1c_06_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1d_06_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1d_06_23_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1d_06_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1d_06_23_abs = hysteresisMetrics(STRT_storm1d_06_23_Q, STRT_storm1d_06_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1e_06_24_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1e_06_24_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1e_06_24_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm1e_06_24_abs = hysteresisMetrics(STRT_storm1e_06_24_Q, STRT_storm1e_06_24_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_07_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_07_09_abs['valuedatetime'] =  pd.to_datetime(STRT_storm2_07_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm2_07_09_abs = hysteresisMetrics(STRT_storm2_07_09_Q, STRT_storm2_07_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_07_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_07_20_abs['valuedatetime'] =  pd.to_datetime(STRT_storm3_07_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm3_07_20_abs = hysteresisMetrics(STRT_storm3_07_20_Q, STRT_storm3_07_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4a_08_01_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4a_08_01_abs['valuedatetime'] =  pd.to_datetime(STRT_storm4a_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4a_08_01_abs = hysteresisMetrics(STRT_storm4a_08_01_Q, STRT_storm4a_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm4b_08_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm4b_08_03_abs['valuedatetime'] =  pd.to_datetime(STRT_storm4b_08_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm4b_08_03_abs = hysteresisMetrics(STRT_storm4b_08_03_Q, STRT_storm4b_08_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm5_08_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm5_08_09_abs['valuedatetime'] =  pd.to_datetime(STRT_storm5_08_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm5_08_09_abs = hysteresisMetrics(STRT_storm5_08_09_Q, STRT_storm5_08_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm6_08_12_Q['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm6_08_12_abs['valuedatetime'] =  pd.to_datetime(STRT_storm6_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm6_08_12_abs = hysteresisMetrics(STRT_storm6_08_12_Q, STRT_storm6_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7a_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7a_08_20_abs['valuedatetime'] =  pd.to_datetime(STRT_storm7a_08_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7a_08_20_abs = hysteresisMetrics(STRT_storm7a_08_20_Q, STRT_storm7a_08_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm7b_08_21_Q['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm7b_08_21_abs['valuedatetime'] =  pd.to_datetime(STRT_storm7b_08_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm7b_08_21_abs = hysteresisMetrics(STRT_storm7b_08_21_Q, STRT_storm7b_08_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm8_08_28_Q['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm8_08_28_abs['valuedatetime'] =  pd.to_datetime(STRT_storm8_08_28_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm8_08_28_abs = hysteresisMetrics(STRT_storm8_08_28_Q, STRT_storm8_08_28_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9a_09_03_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9a_09_03_abs['valuedatetime'] =  pd.to_datetime(STRT_storm9a_09_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9a_09_03_abs = hysteresisMetrics(STRT_storm9a_09_03_Q, STRT_storm9a_09_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9b_09_06_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9b_09_06_abs['valuedatetime'] =  pd.to_datetime(STRT_storm9b_09_06_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9b_09_06_abs = hysteresisMetrics(STRT_storm9b_09_06_Q, STRT_storm9b_09_06_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm9c_09_09_Q['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm9c_09_09_abs['valuedatetime'] =  pd.to_datetime(STRT_storm9c_09_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm9c_09_09_abs = hysteresisMetrics(STRT_storm9c_09_09_Q, STRT_storm9c_09_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm10_09_23_Q['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm10_09_23_abs['valuedatetime'] =  pd.to_datetime(STRT_storm10_09_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_STRT_storm10_09_23_abs = hysteresisMetrics(STRT_storm10_09_23_Q, STRT_storm10_09_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```




 STRT results
```{r}

# STRT.hyst.results.list = list(py$hysdict_STRT_storm7b_08_21_NO3,
#                               py$hysdict_STRT_storm7b_08_21_fDOM,
#                               py$hysdict_STRT_storm7b_08_21_SPC,
#                               py$hysdict_STRT_storm7b_08_21_turb
#                               )

STRT.hyst.results.list = list(py$hysdict_STRT_storm1a_06_18_NO3,
                              py$hysdict_STRT_storm1a_06_18_fDOM,
                              py$hysdict_STRT_storm1a_06_18_SPC,
                              py$hysdict_STRT_storm1a_06_18_turb,
                              py$hysdict_STRT_storm1a_06_18_abs,
                              py$hysdict_STRT_storm1b_06_20_NO3,
                              
                              py$hysdict_STRT_storm1b_06_20_SPC,
                              py$hysdict_STRT_storm1b_06_20_turb,
                              py$hysdict_STRT_storm1b_06_20_abs,
                              py$hysdict_STRT_storm1c_06_21_NO3,
                              py$hysdict_STRT_storm1c_06_21_fDOM,
                              py$hysdict_STRT_storm1c_06_21_SPC,
                              py$hysdict_STRT_storm1c_06_21_turb,
                              py$hysdict_STRT_storm1c_06_21_abs,
                              py$hysdict_STRT_storm1d_06_23_NO3,
                              py$hysdict_STRT_storm1d_06_23_fDOM,
                              py$hysdict_STRT_storm1d_06_23_SPC,
                              py$hysdict_STRT_storm1d_06_23_turb,
                              py$hysdict_STRT_storm1d_06_23_abs,
                              py$hysdict_STRT_storm1e_06_24_NO3,
                              py$hysdict_STRT_storm1e_06_24_fDOM,
                              py$hysdict_STRT_storm1e_06_24_SPC,
                              py$hysdict_STRT_storm1e_06_24_turb,
                              py$hysdict_STRT_storm1e_06_24_abs,
                              py$hysdict_STRT_storm2_07_09_NO3,
                              py$hysdict_STRT_storm2_07_09_fDOM,
                              py$hysdict_STRT_storm2_07_09_SPC,
                              py$hysdict_STRT_storm2_07_09_turb,
                              py$hysdict_STRT_storm2_07_09_abs,
                              py$hysdict_STRT_storm3_07_20_NO3,
                              py$hysdict_STRT_storm3_07_20_fDOM,
                              py$hysdict_STRT_storm3_07_20_SPC,
                              py$hysdict_STRT_storm3_07_20_turb,
                              py$hysdict_STRT_storm3_07_20_abs,
                              
                              
                              py$hysdict_STRT_storm4a_08_01_NO3,
                              py$hysdict_STRT_storm4a_08_01_fDOM,
                              py$hysdict_STRT_storm4a_08_01_SPC,
                              py$hysdict_STRT_storm4a_08_01_turb,
                              py$hysdict_STRT_storm4a_08_01_abs,
                              py$hysdict_STRT_storm4b_08_03_NO3,
                              py$hysdict_STRT_storm4b_08_03_fDOM,
                              py$hysdict_STRT_storm4b_08_03_SPC,
                              py$hysdict_STRT_storm4b_08_03_turb,
                              py$hysdict_STRT_storm4b_08_03_abs,
                              py$hysdict_STRT_storm5_08_09_NO3,
                              py$hysdict_STRT_storm5_08_09_fDOM,
                              py$hysdict_STRT_storm5_08_09_SPC,
                              py$hysdict_STRT_storm5_08_09_turb,
                              py$hysdict_STRT_storm5_08_09_abs,
                              py$hysdict_STRT_storm6_08_12_NO3,
                              py$hysdict_STRT_storm6_08_12_fDOM,
                              py$hysdict_STRT_storm6_08_12_SPC,
                              py$hysdict_STRT_storm6_08_12_turb,
                              py$hysdict_STRT_storm6_08_12_abs,
                              py$hysdict_STRT_storm7a_08_20_NO3,
                              py$hysdict_STRT_storm7a_08_20_fDOM,
                              py$hysdict_STRT_storm7a_08_20_SPC,
                              py$hysdict_STRT_storm7a_08_20_turb,
                              py$hysdict_STRT_storm7a_08_20_abs,
                              py$hysdict_STRT_storm7b_08_21_NO3,
                              py$hysdict_STRT_storm7b_08_21_fDOM,
                              py$hysdict_STRT_storm7b_08_21_SPC,
                              py$hysdict_STRT_storm7b_08_21_turb,
                              py$hysdict_STRT_storm7b_08_21_abs,
                              py$hysdict_STRT_storm8_08_28_NO3,
                              py$hysdict_STRT_storm8_08_28_fDOM,
                              py$hysdict_STRT_storm8_08_28_SPC,
                              py$hysdict_STRT_storm8_08_28_turb,
                              py$hysdict_STRT_storm8_08_28_abs,
                              py$hysdict_STRT_storm9a_09_03_NO3,
                              py$hysdict_STRT_storm9a_09_03_fDOM,
                              py$hysdict_STRT_storm9a_09_03_SPC,
                              py$hysdict_STRT_storm9a_09_03_turb,
                              py$hysdict_STRT_storm9a_09_03_abs,
                              py$hysdict_STRT_storm9b_09_06_NO3,
                              py$hysdict_STRT_storm9b_09_06_fDOM,
                              py$hysdict_STRT_storm9b_09_06_SPC,
                              py$hysdict_STRT_storm9b_09_06_turb,
                              py$hysdict_STRT_storm9b_09_06_abs,
                              py$hysdict_STRT_storm9c_09_09_NO3,
                              py$hysdict_STRT_storm9c_09_09_fDOM,
                              py$hysdict_STRT_storm9c_09_09_SPC,
                              py$hysdict_STRT_storm9c_09_09_turb,
                              py$hysdict_STRT_storm9c_09_09_abs,
                              py$hysdict_STRT_storm10_09_23_NO3,
                              py$hysdict_STRT_storm10_09_23_fDOM,
                              py$hysdict_STRT_storm10_09_23_SPC,
                              py$hysdict_STRT_storm10_09_23_turb,
                              py$hysdict_STRT_storm10_09_23_abs
                              
                              )



STRT.hyst.results.list.2 = list()
for (i in 1:length(STRT.hyst.results.list)){
STRT.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
STRT.hyst.results.list[[i]][["HI_mean_with_Interp"]],
STRT.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
STRT.hyst.results.list[[i]][["Normalized slope of response"]],
STRT.hyst.results.list[[i]][["interpolated Max width of response"]],
STRT.hyst.results.list[[i]][["Min response"]],
STRT.hyst.results.list[[i]][["Max response"]],
STRT.hyst.results.list[[i]][["Peak Q"]]
))))
names(STRT.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(STRT.hyst.results.list)){
  HIs.list[[i]] = unlist(STRT.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

STRT.hyst.results.list.3 =list()
for (i in 1:length(STRT.hyst.results.list)){
  STRT.hyst.results.list.3[[i]] = cbind(STRT.hyst.results.list.2[[i]], HIs.tests[[i]])
}

STRT.hyst.results.df = bind_rows(STRT.hyst.results.list.3, .id = "column_label")

STRT.hyst.results.df$storm.ID = c("STRT_storm1a_06_18_NO3",
                                  "STRT_storm1a_06_18_fDOM",
                                  "STRT_storm1a_06_18_SPC",
                                  "STRT_storm1a_06_18_turb",
                                  "STRT_storm1a_06_18_abs",
                                  "STRT_storm1b_06_20_NO3",
                                  
                                  "STRT_storm1b_06_20_SPC",
                                  "STRT_storm1b_06_20_turb",
                                  "STRT_storm1b_06_20_abs",
                                  "STRT_storm1c_06_21_NO3",
                                  "STRT_storm1c_06_21_fDOM",
                                  "STRT_storm1c_06_21_SPC",
                                  "STRT_storm1c_06_21_turb",
                                  "STRT_storm1c_06_21_abs",
                                  "STRT_storm1d_06_23_NO3",
                                  "STRT_storm1d_06_23_fDOM",
                                  "STRT_storm1d_06_23_SPC",
                                  "STRT_storm1d_06_23_turb",
                                  "STRT_storm1d_06_23_abs",
                                  "STRT_storm1e_06_24_NO3",
                                  "STRT_storm1e_06_24_fDOM",
                                  "STRT_storm1e_06_24_SPC",
                                  "STRT_storm1e_06_24_turb",
                                  "STRT_storm1e_06_24_abs",
                                  "STRT_storm2_07_09_NO3",
                                  "STRT_storm2_07_09_fDOM",
                                  "STRT_storm2_07_09_SPC",
                                  "STRT_storm2_07_09_turb",
                                  "STRT_storm2_07_09_abs",
                                  "STRT_storm3_07_20_NO3",
                                  "STRT_storm3_07_20_fDOM",
                                  "STRT_storm3_07_20_SPC",
                                  "STRT_storm3_07_20_turb",
                                  "STRT_storm3_07_20_abs",
                                  "STRT_storm4a_08_01_NO3",
                                  "STRT_storm4a_08_01_fDOM",
                                  "STRT_storm4a_08_01_SPC",
                                  "STRT_storm4a_08_01_turb",
                                  "STRT_storm4a_08_01_abs",
                                  "STRT_storm4b_08_03_NO3",
                                  "STRT_storm4b_08_03_fDOM",
                                  "STRT_storm4b_08_03_SPC",
                                  "STRT_storm4b_08_03_turb",
                                  "STRT_storm4b_08_03_abs",
                                  "STRT_storm5_08_09_NO3",
                                  "STRT_storm5_08_09_fDOM",
                                  "STRT_storm5_08_09_SPC",
                                  "STRT_storm5_08_09_turb",
                                  "STRT_storm5_08_09_abs",
                                  "STRT_storm6_08_12_NO3",
                                  "STRT_storm6_08_12_fDOM",
                                  "STRT_storm6_08_12_SPC",
                                  "STRT_storm6_08_12_turb",
                                  "STRT_storm6_08_12_abs",
                                  "STRT_storm7a_08_20_NO3",
                                  "STRT_storm7a_08_20_fDOM",
                                  "STRT_storm7a_08_20_SPC",
                                  "STRT_storm7a_08_20_turb",
                                  "STRT_storm7a_08_20_abs",
                                  "STRT_storm7b_08_21_NO3",
                                  "STRT_storm7b_08_21_fDOM",
                                  "STRT_storm7b_08_21_SPC",
                                  "STRT_storm7b_08_21_turb",
                                  "STRT_storm7b_08_21_abs",  
                                  "STRT_storm8_08_28_NO3",
                                  "STRT_storm8_08_28_fDOM",
                                  "STRT_storm8_08_28_SPC",
                                  "STRT_storm8_08_28_turb",
                                  "STRT_storm8_08_28_abs",
                                  "STRT_storm9a_09_03_NO3",
                                  "STRT_storm9a_09_03_fDOM",
                                  "STRT_storm9a_09_03_SPC",
                                  "STRT_storm9a_09_03_turb",
                                  "STRT_storm9a_09_03_abs",
                                  "STRT_storm9b_09_06_NO3",
                                  "STRT_storm9b_09_06_fDOM",
                                  "STRT_storm9b_09_06_SPC",
                                  "STRT_storm9b_09_06_turb",
                                  "STRT_storm9b_09_06_abs",
                                  "STRT_storm9c_09_09_NO3",
                                  "STRT_storm9c_09_09_fDOM",
                                  "STRT_storm9c_09_09_SPC",
                                  "STRT_storm9c_09_09_turb",
                                  "STRT_storm9c_09_09_abs",
                                  "STRT_storm10_09_23_NO3",
                                  "STRT_storm10_09_23_fDOM",
                                  "STRT_storm10_09_23_SPC",
                                  "STRT_storm10_09_23_turb",
                                  "STRT_storm10_09_23_abs"
                                  )


              

STRT.hyst.results.df$site.ID = "STRT"

write.csv(STRT.hyst.results.df,"~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/STRT/STRT.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/STRT/STRT.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= STRT.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

STRT.HI.df = bind_rows(HIs.df.list, .id = "column_label")
STRT.HI.df$storm.ID = c(rep("STRT_storm1a_06_18_NO3", 50),
                        rep("STRT_storm1a_06_18_fDOM", 50),
                        rep("STRT_storm1a_06_18_SPC", 50),
                        rep("STRT_storm1a_06_18_turb", 50),
                        rep("STRT_storm1a_06_18_abs", 50),
                        rep("STRT_storm1b_06_20_NO3", 50),
                        
                        rep("STRT_storm1b_06_20_SPC", 50),
                        rep("STRT_storm1b_06_20_turb", 50),
                        rep("STRT_storm1b_06_20_abs", 50),
                        rep("STRT_storm1c_06_21_NO3", 50),
                        rep("STRT_storm1c_06_21_fDOM", 50),
                        rep("STRT_storm1c_06_21_SPC", 50),
                        rep("STRT_storm1c_06_21_turb", 50),
                        rep("STRT_storm1c_06_21_abs", 50),
                        rep("STRT_storm1d_06_23_NO3", 50),
                        rep("STRT_storm1d_06_23_fDOM", 50),
                        rep("STRT_storm1d_06_23_SPC", 50),
                        rep("STRT_storm1d_06_23_turb", 50),
                        rep("STRT_storm1d_06_23_abs", 50),
                        rep("STRT_storm1e_06_24_NO3", 50),
                        rep("STRT_storm1e_06_24_fDOM", 50),
                        rep("STRT_storm1e_06_24_SPC", 50),
                        rep("STRT_storm1e_06_24_turb", 50),
                        rep("STRT_storm1e_06_24_abs", 50),
                        rep("STRT_storm2_07_09_NO3", 50),
                        rep("STRT_storm2_07_09_fDOM", 50),
                        rep("STRT_storm2_07_09_SPC", 50),
                        rep("STRT_storm2_07_09_turb", 50),
                        rep("STRT_storm2_07_09_abs", 50),
                        rep("STRT_storm3_07_20_NO3", 50),
                        rep("STRT_storm3_07_20_fDOM", 50),
                        rep("STRT_storm3_07_20_SPC", 50),
                        rep("STRT_storm3_07_20_turb", 50),
                        rep("STRT_storm3_07_20_abs", 50),
                        rep("STRT_storm4a_08_01_NO3", 50),
                        rep("STRT_storm4a_08_01_fDOM", 50),
                        rep("STRT_storm4a_08_01_SPC", 50),
                        rep("STRT_storm4a_08_01_turb", 50),
                        rep("STRT_storm4a_08_01_abs", 50),
                        rep("STRT_storm4b_08_03_NO3", 50),
                        rep("STRT_storm4b_08_03_fDOM", 50),
                        rep("STRT_storm4b_08_03_SPC", 50),
                        rep("STRT_storm4b_08_03_turb", 50),
                        rep("STRT_storm4b_08_03_abs", 50),
                        rep("STRT_storm5_08_09_NO3", 50),
                        rep("STRT_storm5_08_09_fDOM", 50),
                        rep("STRT_storm5_08_09_SPC", 50),
                        rep("STRT_storm5_08_09_turb", 50),
                        rep("STRT_storm5_08_09_abs", 50),
                        rep("STRT_storm6_08_12_NO3", 50),
                        rep("STRT_storm6_08_12_fDOM", 50),
                        rep("STRT_storm6_08_12_SPC", 50),
                        rep("STRT_storm6_08_12_turb", 50),
                        rep("STRT_storm6_08_12_abs", 50),
                        rep("STRT_storm7a_08_20_NO3", 50),
                        rep("STRT_storm7a_08_20_fDOM", 50),
                        rep("STRT_storm7a_08_20_SPC", 50),
                        rep("STRT_storm7a_08_20_turb", 50),
                        rep("STRT_storm7a_08_20_abs", 50),
                        rep("STRT_storm7b_08_21_NO3", 50),
                        rep("STRT_storm7b_08_21_fDOM", 50),
                        rep("STRT_storm7b_08_21_SPC", 50),
                        rep("STRT_storm7b_08_21_turb", 50),
                        rep("STRT_storm7b_08_21_abs", 50),
                        rep("STRT_storm8_08_28_NO3", 50),
                        rep("STRT_storm8_08_28_fDOM", 50),
                        rep("STRT_storm8_08_28_SPC", 50),
                        rep("STRT_storm8_08_28_turb", 50),
                        rep("STRT_storm8_08_28_abs", 50),
                        rep("STRT_storm9a_09_03_NO3", 50),
                        rep("STRT_storm9a_09_03_fDOM", 50),
                        rep("STRT_storm9a_09_03_SPC", 50),
                        rep("STRT_storm9a_09_03_turb", 50),
                        rep("STRT_storm9a_09_03_abs", 50),
                        rep("STRT_storm9b_09_06_NO3", 50),
                        rep("STRT_storm9b_09_06_fDOM", 50),
                        rep("STRT_storm9b_09_06_SPC", 50),
                        rep("STRT_storm9b_09_06_turb", 50),
                        rep("STRT_storm9b_09_06_abs", 50),
                        rep("STRT_storm9c_09_09_NO3", 50),
                        rep("STRT_storm9c_09_09_fDOM", 50),
                        rep("STRT_storm9c_09_09_SPC", 50),
                        rep("STRT_storm9c_09_09_turb", 50),
                        rep("STRT_storm9c_09_09_abs", 50),
                        rep("STRT_storm10_09_23_NO3", 50),
                        rep("STRT_storm10_09_23_fDOM", 50),
                        rep("STRT_storm10_09_23_SPC", 50),
                        rep("STRT_storm10_09_23_turb", 50),
                        rep("STRT_storm10_09_23_abs", 50))
                      


STRT.HI.df$storm.ID = as.factor(STRT.HI.df$storm.ID)
STRT.HI.df = separate(data=STRT.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(STRT.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/STRT/STRT.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(STRT.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/STRT/STRT.HI.df.csv")

STRT.HI.df$date <- as.Date(with(STRT.HI.df, paste(month, day, sep = "-")), "%m-%d")
STRT.HI.df$doy <- yday(STRT.HI.df$date) 

g0 <- ggplot(STRT.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/STRT/STRT.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(STRT.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/STRT/STRT.HI.df.doy.csv")

```

 load data to pandas
```{python}
# VAUL #
VAUL_storm1a_06_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1a_06_19_Q.csv")
VAUL_storm1a_06_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1a_06_19_NO3.csv")
VAUL_storm1a_06_19_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1a_06_19_fDOM.csv")
VAUL_storm1a_06_19_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1a_06_19_SPC.csv")
VAUL_storm1a_06_19_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1a_06_19_Turb.csv")
VAUL_storm1a_06_19_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1a_06_19_abs.csv")

VAUL_storm1b_06_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1b_06_20_Q.csv")
VAUL_storm1b_06_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1b_06_20_NO3.csv")
VAUL_storm1b_06_20_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1b_06_20_fDOM.csv")
VAUL_storm1b_06_20_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1b_06_20_SPC.csv")
VAUL_storm1b_06_20_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1b_06_20_Turb.csv")
VAUL_storm1b_06_20_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1b_06_20_abs.csv")

VAUL_storm1c_06_22_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1c_06_22_Q.csv")
VAUL_storm1c_06_22_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1c_06_22_NO3.csv")
VAUL_storm1c_06_22_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1c_06_22_fDOM.csv")
VAUL_storm1c_06_22_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1c_06_22_SPC.csv")
VAUL_storm1c_06_22_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1c_06_22_Turb.csv")
VAUL_storm1c_06_22_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm1c_06_22_abs.csv")

# VAUL_storm1c_06_22_Q = VAUL_storm1c_06_22_Q.dropna(subset=['datavalue'])
# VAUL_storm1c_06_22_NO3 = VAUL_storm1c_06_22_NO3.dropna(subset=['datavalue'])
# VAUL_storm1c_06_22_fDOM = VAUL_storm1c_06_22_fDOM.dropna(subset=['datavalue'])
# VAUL_storm1c_06_22_SPC = VAUL_storm1c_06_22_SPC.dropna(subset=['datavalue'])
# VAUL_storm1c_06_22_turb = VAUL_storm1c_06_22_turb.dropna(subset=['datavalue'])

VAUL_storm2_06_28_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm2_06_28_Q.csv")
VAUL_storm2_06_28_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm2_06_28_NO3.csv")
VAUL_storm2_06_28_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm2_06_28_fDOM.csv")
VAUL_storm2_06_28_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm2_06_28_SPC.csv")
VAUL_storm2_06_28_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm2_06_28_Turb.csv")
VAUL_storm2_06_28_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm2_06_28_abs.csv")

# VAUL_storm2_06_28_Q = VAUL_storm2_06_28_Q.dropna(subset=['datavalue'])
# VAUL_storm2_06_28_NO3 = VAUL_storm2_06_28_NO3.dropna(subset=['datavalue'])
# VAUL_storm2_06_28_fDOM = VAUL_storm2_06_28_fDOM.dropna(subset=['datavalue'])
# VAUL_storm2_06_28_SPC = VAUL_storm2_06_28_SPC.dropna(subset=['datavalue'])
# VAUL_storm2_06_28_turb = VAUL_storm2_06_28_turb.dropna(subset=['datavalue'])

VAUL_storm3_07_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm3_07_09_Q.csv")
VAUL_storm3_07_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm3_07_09_NO3.csv")
VAUL_storm3_07_09_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm3_07_09_fDOM.csv")
VAUL_storm3_07_09_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm3_07_09_SPC.csv")
VAUL_storm3_07_09_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm3_07_09_Turb.csv")
VAUL_storm3_07_09_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm3_07_09_abs.csv")

VAUL_storm4_07_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm4_07_12_Q.csv")
VAUL_storm4_07_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm4_07_12_NO3.csv")
VAUL_storm4_07_12_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm4_07_12_fDOM.csv")
VAUL_storm4_07_12_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm4_07_12_SPC.csv")
VAUL_storm4_07_12_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm4_07_12_Turb.csv")
VAUL_storm4_07_12_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm4_07_12_abs.csv")

VAUL_storm5_07_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm5_07_26_Q.csv")
VAUL_storm5_07_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm5_07_26_NO3.csv")
VAUL_storm5_07_26_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm5_07_26_fDOM.csv")
VAUL_storm5_07_26_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm5_07_26_SPC.csv")
VAUL_storm5_07_26_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm5_07_26_Turb.csv")
VAUL_storm5_07_26_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm5_07_26_abs.csv")

VAUL_storm6a_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6a_08_01_Q.csv")
VAUL_storm6a_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6a_08_01_NO3.csv")
VAUL_storm6a_08_01_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6a_08_01_fDOM.csv")
VAUL_storm6a_08_01_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6a_08_01_SPC.csv")
VAUL_storm6a_08_01_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6a_08_01_Turb.csv")
VAUL_storm6a_08_01_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6a_08_01_abs.csv")

VAUL_storm6b_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6b_08_02_Q.csv")
VAUL_storm6b_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6b_08_02_NO3.csv")
VAUL_storm6b_08_02_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6b_08_02_fDOM.csv")
VAUL_storm6b_08_02_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6b_08_02_SPC.csv")
VAUL_storm6b_08_02_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6b_08_02_Turb.csv")
VAUL_storm6b_08_02_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm6b_08_02_abs.csv")

VAUL_storm7_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm7_08_08_Q.csv")
VAUL_storm7_08_08_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm7_08_08_NO3.csv")
VAUL_storm7_08_08_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm7_08_08_fDOM.csv")
VAUL_storm7_08_08_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm7_08_08_SPC.csv")
VAUL_storm7_08_08_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm7_08_08_Turb.csv")
VAUL_storm7_08_08_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm7_08_08_abs.csv")

VAUL_storm8_08_11_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm8_08_11_Q.csv")
VAUL_storm8_08_11_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm8_08_11_NO3.csv")
VAUL_storm8_08_11_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm8_08_11_fDOM.csv")
VAUL_storm8_08_11_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm8_08_11_SPC.csv")
VAUL_storm8_08_11_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm8_08_11_turb.csv")
VAUL_storm8_08_11_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm8_08_11_abs.csv")

VAUL_storm9_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm9_08_12_Q.csv")
VAUL_storm9_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm9_08_12_NO3.csv")
VAUL_storm9_08_12_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm9_08_12_fDOM.csv")
VAUL_storm9_08_12_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm9_08_12_SPC.csv")
VAUL_storm9_08_12_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm9_08_12_Turb.csv")
VAUL_storm9_08_12_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm9_08_12_abs.csv")

VAUL_storm10_08_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm10_08_25_Q.csv")
VAUL_storm10_08_25_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm10_08_25_NO3.csv")
VAUL_storm10_08_25_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm10_08_25_fDOM.csv")
VAUL_storm10_08_25_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm10_08_25_SPC.csv")
VAUL_storm10_08_25_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm10_08_25_turb.csv")
VAUL_storm10_08_25_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm10_08_25_abs.csv")

VAUL_storm11_08_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm11_08_27_Q.csv")
VAUL_storm11_08_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm11_08_27_NO3.csv")
VAUL_storm11_08_27_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm11_08_27_fDOM.csv")
VAUL_storm11_08_27_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm11_08_27_SPC.csv")
VAUL_storm11_08_27_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm11_08_27_Turb.csv")
VAUL_storm11_08_27_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm11_08_27_abs.csv")

VAUL_storm12_09_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm12_09_01_Q.csv")
VAUL_storm12_09_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm12_09_01_NO3.csv")
VAUL_storm12_09_01_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm12_09_01_fDOM.csv")
VAUL_storm12_09_01_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm12_09_01_SPC.csv")
VAUL_storm12_09_01_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm12_09_01_Turb.csv")
VAUL_storm12_09_01_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm12_09_01_abs.csv")

VAUL_storm13_09_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm13_09_03_Q.csv")
VAUL_storm13_09_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm13_09_03_NO3.csv")
VAUL_storm13_09_03_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm13_09_03_fDOM.csv")
VAUL_storm13_09_03_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm13_09_03_SPC.csv")
VAUL_storm13_09_03_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm13_09_03_Turb.csv")
VAUL_storm13_09_03_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm13_09_03_abs.csv")

VAUL_storm14_09_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm14_09_06_Q.csv")
VAUL_storm14_09_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm14_09_06_NO3.csv")
VAUL_storm14_09_06_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm14_09_06_fDOM.csv")
VAUL_storm14_09_06_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm14_09_06_SPC.csv")
VAUL_storm14_09_06_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm14_09_06_Turb.csv")
VAUL_storm14_09_06_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/VAUL/VAUL_storm14_09_06_abs.csv")


```



 VAUL_storms
```{python}

## NO3 ##
VAUL_storm1a_06_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1a_06_19_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1a_06_19_NO3 = hysteresisMetrics(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_06_20_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_06_20_NO3 = hysteresisMetrics(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1c_06_22_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1c_06_22_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1c_06_22_NO3 = hysteresisMetrics(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_06_28_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_06_28_NO3 = hysteresisMetrics(VAUL_storm2_06_28_Q, VAUL_storm2_06_28_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_09_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_09_NO3 = hysteresisMetrics(VAUL_storm3_07_09_Q, VAUL_storm3_07_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4_07_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4_07_12_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4_07_12_NO3 = hysteresisMetrics(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_07_26_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_07_26_NO3 = hysteresisMetrics(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6a_08_01_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6a_08_01_NO3 = hysteresisMetrics(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6b_08_02_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6b_08_02_NO3 = hysteresisMetrics(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_08_08_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_08_08_NO3 = hysteresisMetrics(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8_08_11_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8_08_11_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8_08_11_NO3 = hysteresisMetrics(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm9_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm9_08_12_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm9_08_12_NO3 = hysteresisMetrics(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm10_08_25_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm10_08_25_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm10_08_25_NO3 = hysteresisMetrics(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm11_08_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm11_08_27_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm11_08_27_NO3 = hysteresisMetrics(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm12_09_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm12_09_01_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm12_09_01_NO3 = hysteresisMetrics(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm13_09_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm13_09_03_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm13_09_03_NO3 = hysteresisMetrics(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm14_09_06_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm14_09_06_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm14_09_06_NO3 = hysteresisMetrics(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## fDOM ##
VAUL_storm1a_06_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1a_06_19_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1a_06_19_fDOM = hysteresisMetrics(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_06_20_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_06_20_fDOM = hysteresisMetrics(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1c_06_22_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1c_06_22_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1c_06_22_fDOM = hysteresisMetrics(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_06_28_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_06_28_fDOM = hysteresisMetrics(VAUL_storm2_06_28_Q, VAUL_storm2_06_28_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_09_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_09_fDOM = hysteresisMetrics(VAUL_storm3_07_09_Q, VAUL_storm3_07_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4_07_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4_07_12_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4_07_12_fDOM = hysteresisMetrics(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_07_26_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_07_26_fDOM = hysteresisMetrics(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6a_08_01_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6a_08_01_fDOM = hysteresisMetrics(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6b_08_02_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6b_08_02_fDOM = hysteresisMetrics(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_08_08_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_08_08_fDOM = hysteresisMetrics(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8_08_11_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8_08_11_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8_08_11_fDOM = hysteresisMetrics(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm9_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm9_08_12_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm9_08_12_fDOM = hysteresisMetrics(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm10_08_25_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm10_08_25_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm10_08_25_fDOM = hysteresisMetrics(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm11_08_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm11_08_27_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm11_08_27_fDOM = hysteresisMetrics(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm12_09_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm12_09_01_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm12_09_01_fDOM = hysteresisMetrics(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm13_09_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm13_09_03_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm13_09_03_fDOM = hysteresisMetrics(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm14_09_06_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm14_09_06_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm14_09_06_fDOM = hysteresisMetrics(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
VAUL_storm1a_06_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1a_06_19_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1a_06_19_SPC = hysteresisMetrics(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_06_20_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_06_20_SPC = hysteresisMetrics(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1c_06_22_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1c_06_22_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1c_06_22_SPC = hysteresisMetrics(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_06_28_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_06_28_SPC = hysteresisMetrics(VAUL_storm2_06_28_Q, VAUL_storm2_06_28_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_09_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_09_SPC = hysteresisMetrics(VAUL_storm3_07_09_Q, VAUL_storm3_07_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4_07_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4_07_12_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4_07_12_SPC = hysteresisMetrics(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_07_26_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_07_26_SPC = hysteresisMetrics(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6a_08_01_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6a_08_01_SPC = hysteresisMetrics(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6b_08_02_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6b_08_02_SPC = hysteresisMetrics(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_08_08_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_08_08_SPC = hysteresisMetrics(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8_08_11_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8_08_11_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8_08_11_SPC = hysteresisMetrics(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm9_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm9_08_12_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm9_08_12_SPC = hysteresisMetrics(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm10_08_25_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm10_08_25_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm10_08_25_SPC = hysteresisMetrics(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm11_08_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm11_08_27_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm11_08_27_SPC = hysteresisMetrics(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm12_09_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm12_09_01_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm12_09_01_SPC = hysteresisMetrics(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm13_09_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm13_09_03_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm13_09_03_SPC = hysteresisMetrics(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm14_09_06_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm14_09_06_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm14_09_06_SPC = hysteresisMetrics(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
VAUL_storm1a_06_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1a_06_19_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1a_06_19_turb = hysteresisMetrics(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_06_20_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_06_20_turb = hysteresisMetrics(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1c_06_22_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1c_06_22_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1c_06_22_turb = hysteresisMetrics(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_06_28_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_06_28_turb = hysteresisMetrics(VAUL_storm2_06_28_Q, VAUL_storm2_06_28_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_09_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_09_turb = hysteresisMetrics(VAUL_storm3_07_09_Q, VAUL_storm3_07_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4_07_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4_07_12_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4_07_12_turb = hysteresisMetrics(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_07_26_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_07_26_turb = hysteresisMetrics(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6a_08_01_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6a_08_01_turb = hysteresisMetrics(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6b_08_02_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6b_08_02_turb = hysteresisMetrics(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_08_08_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_08_08_turb = hysteresisMetrics(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8_08_11_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8_08_11_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8_08_11_turb = hysteresisMetrics(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm9_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm9_08_12_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm9_08_12_turb = hysteresisMetrics(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm10_08_25_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm10_08_25_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm10_08_25_turb = hysteresisMetrics(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm11_08_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm11_08_27_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm11_08_27_turb = hysteresisMetrics(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm12_09_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm12_09_01_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm12_09_01_turb = hysteresisMetrics(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm13_09_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm13_09_03_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm13_09_03_turb = hysteresisMetrics(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm14_09_06_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm14_09_06_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm14_09_06_turb = hysteresisMetrics(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABD ##
VAUL_storm1a_06_19_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1a_06_19_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm1a_06_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1a_06_19_abs = hysteresisMetrics(VAUL_storm1a_06_19_Q, VAUL_storm1a_06_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1b_06_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_06_20_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_06_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_06_20_abs = hysteresisMetrics(VAUL_storm1b_06_20_Q, VAUL_storm1b_06_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm1c_06_22_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1c_06_22_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_22_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1c_06_22_abs = hysteresisMetrics(VAUL_storm1c_06_22_Q, VAUL_storm1c_06_22_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1c_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_06_28_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm2_06_28_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_06_28_abs = hysteresisMetrics(VAUL_storm2_06_28_Q, VAUL_storm2_06_28_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_07_09_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_07_09_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm3_07_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_07_09_abs = hysteresisMetrics(VAUL_storm3_07_09_Q, VAUL_storm3_07_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4_07_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4_07_12_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm4_07_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4_07_12_abs = hysteresisMetrics(VAUL_storm4_07_12_Q, VAUL_storm4_07_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5_07_26_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm5_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5_07_26_abs = hysteresisMetrics(VAUL_storm5_07_26_Q, VAUL_storm5_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6a_08_01_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm6a_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6a_08_01_abs = hysteresisMetrics(VAUL_storm6a_08_01_Q, VAUL_storm6a_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm6b_08_02_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm6b_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm6b_08_02_abs = hysteresisMetrics(VAUL_storm6b_08_02_Q, VAUL_storm6b_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm7_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm7_08_08_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm7_08_08_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm7_08_08_abs = hysteresisMetrics(VAUL_storm7_08_08_Q, VAUL_storm7_08_08_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm8_08_11_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm8_08_11_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm8_08_11_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm8_08_11_abs = hysteresisMetrics(VAUL_storm8_08_11_Q, VAUL_storm8_08_11_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm9_08_12_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm9_08_12_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm9_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm9_08_12_abs = hysteresisMetrics(VAUL_storm9_08_12_Q, VAUL_storm9_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm10_08_25_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm10_08_25_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm10_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm10_08_25_abs = hysteresisMetrics(VAUL_storm10_08_25_Q, VAUL_storm10_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm11_08_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm11_08_27_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm11_08_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm11_08_27_abs = hysteresisMetrics(VAUL_storm11_08_27_Q, VAUL_storm11_08_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm12_09_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm12_09_01_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm12_09_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm12_09_01_abs = hysteresisMetrics(VAUL_storm12_09_01_Q, VAUL_storm12_09_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm13_09_03_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm13_09_03_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm13_09_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm13_09_03_abs = hysteresisMetrics(VAUL_storm13_09_03_Q, VAUL_storm13_09_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm14_09_06_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm14_09_06_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm14_09_06_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm14_09_06_abs = hysteresisMetrics(VAUL_storm14_09_06_Q, VAUL_storm14_09_06_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

 VAUL results
```{r}

VAUL.hyst.results.list = list(py$hysdict_VAUL_storm1a_06_19_NO3,
                              py$hysdict_VAUL_storm1a_06_19_fDOM,
                              py$hysdict_VAUL_storm1a_06_19_SPC,
                              py$hysdict_VAUL_storm1a_06_19_turb,
                              py$hysdict_VAUL_storm1a_06_19_abs,
                              py$hysdict_VAUL_storm1b_06_20_NO3,
                              py$hysdict_VAUL_storm1b_06_20_fDOM,
                              py$hysdict_VAUL_storm1b_06_20_SPC,
                              py$hysdict_VAUL_storm1b_06_20_turb,
                              py$hysdict_VAUL_storm1b_06_20_abs,
                              py$hysdict_VAUL_storm1c_06_22_NO3,
                              py$hysdict_VAUL_storm1c_06_22_fDOM,
                              py$hysdict_VAUL_storm1c_06_22_SPC,
                              py$hysdict_VAUL_storm1c_06_22_turb,
                              py$hysdict_VAUL_storm1c_06_22_abs,
                              py$hysdict_VAUL_storm2_06_28_NO3,
                              py$hysdict_VAUL_storm2_06_28_fDOM,
                              py$hysdict_VAUL_storm2_06_28_SPC,
                              py$hysdict_VAUL_storm2_06_28_turb,
                              py$hysdict_VAUL_storm2_06_28_abs,
                              py$hysdict_VAUL_storm3_07_09_NO3,
                              py$hysdict_VAUL_storm3_07_09_fDOM,
                              py$hysdict_VAUL_storm3_07_09_SPC,
                              py$hysdict_VAUL_storm3_07_09_turb,
                              py$hysdict_VAUL_storm3_07_09_abs,
                              py$hysdict_VAUL_storm4_07_12_NO3,
                              py$hysdict_VAUL_storm4_07_12_fDOM,
                              py$hysdict_VAUL_storm4_07_12_SPC,
                              py$hysdict_VAUL_storm4_07_12_turb,
                              py$hysdict_VAUL_storm4_07_12_abs,
                              py$hysdict_VAUL_storm5_07_26_NO3,
                              py$hysdict_VAUL_storm5_07_26_fDOM,
                              py$hysdict_VAUL_storm5_07_26_SPC,
                              py$hysdict_VAUL_storm5_07_26_turb,
                              py$hysdict_VAUL_storm5_07_26_abs,
                              py$hysdict_VAUL_storm6a_08_01_NO3,
                              py$hysdict_VAUL_storm6a_08_01_fDOM,
                              py$hysdict_VAUL_storm6a_08_01_SPC,
                              py$hysdict_VAUL_storm6a_08_01_turb,
                              py$hysdict_VAUL_storm6a_08_01_abs,
                              py$hysdict_VAUL_storm6b_08_02_NO3,
                              py$hysdict_VAUL_storm6b_08_02_fDOM,
                              py$hysdict_VAUL_storm6b_08_02_SPC,
                              py$hysdict_VAUL_storm6b_08_02_turb,
                              py$hysdict_VAUL_storm6b_08_02_abs,
                              py$hysdict_VAUL_storm7_08_08_NO3,
                             
                              py$hysdict_VAUL_storm8_08_11_NO3,
                              py$hysdict_VAUL_storm8_08_11_fDOM,
                              py$hysdict_VAUL_storm8_08_11_SPC,
                              py$hysdict_VAUL_storm8_08_11_turb,
                              py$hysdict_VAUL_storm8_08_11_abs,
                              py$hysdict_VAUL_storm9_08_12_NO3,
                              py$hysdict_VAUL_storm9_08_12_fDOM,
                              py$hysdict_VAUL_storm9_08_12_SPC,
                              py$hysdict_VAUL_storm9_08_12_turb,
                              py$hysdict_VAUL_storm9_08_12_abs,
                              py$hysdict_VAUL_storm10_08_25_NO3,
                              py$hysdict_VAUL_storm10_08_25_fDOM,
                              py$hysdict_VAUL_storm10_08_25_SPC,
                              py$hysdict_VAUL_storm10_08_25_turb,
                              py$hysdict_VAUL_storm10_08_25_abs,
                              py$hysdict_VAUL_storm11_08_27_NO3,
                              py$hysdict_VAUL_storm11_08_27_fDOM,
                              py$hysdict_VAUL_storm11_08_27_SPC,
                              py$hysdict_VAUL_storm11_08_27_turb,
                              py$hysdict_VAUL_storm11_08_27_abs,
                              py$hysdict_VAUL_storm12_09_01_NO3,
                              py$hysdict_VAUL_storm12_09_01_fDOM,
                              py$hysdict_VAUL_storm12_09_01_SPC,
                              py$hysdict_VAUL_storm12_09_01_turb,
                              py$hysdict_VAUL_storm12_09_01_abs,
                              py$hysdict_VAUL_storm13_09_03_NO3,
                              py$hysdict_VAUL_storm13_09_03_fDOM,
                              py$hysdict_VAUL_storm13_09_03_SPC,
                              py$hysdict_VAUL_storm13_09_03_turb,
                              py$hysdict_VAUL_storm13_09_03_abs,
                              py$hysdict_VAUL_storm14_09_06_NO3,
                              py$hysdict_VAUL_storm14_09_06_fDOM,
                              py$hysdict_VAUL_storm14_09_06_SPC,
                              py$hysdict_VAUL_storm14_09_06_turb,
                              py$hysdict_VAUL_storm14_09_06_abs)


                              
VAUL.hyst.results.list.2 = list()
for (i in 1:length(VAUL.hyst.results.list)){
VAUL.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
VAUL.hyst.results.list[[i]][["HI_mean_with_Interp"]],
VAUL.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
VAUL.hyst.results.list[[i]][["Normalized slope of response"]],
VAUL.hyst.results.list[[i]][["interpolated Max width of response"]],
VAUL.hyst.results.list[[i]][["Min response"]],
VAUL.hyst.results.list[[i]][["Max response"]],
VAUL.hyst.results.list[[i]][["Peak Q"]]
))))
names(VAUL.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(VAUL.hyst.results.list)){
  HIs.list[[i]] = unlist(VAUL.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

VAUL.hyst.results.list.3 =list()
for (i in 1:length(VAUL.hyst.results.list)){
  VAUL.hyst.results.list.3[[i]] = cbind(VAUL.hyst.results.list.2[[i]], HIs.tests[[i]])
}

VAUL.hyst.results.df = bind_rows(VAUL.hyst.results.list.3, .id = "column_label")

VAUL.hyst.results.df$storm.ID = c("VAUL_storm1a_06_19_NO3",
                                  "VAUL_storm1a_06_19_fDOM",
                                  "VAUL_storm1a_06_19_SPC",
                                  "VAUL_storm1a_06_19_turb",
                                  "VAUL_storm1a_06_19_abs",
                                  "VAUL_storm1b_06_20_NO3",
                                  "VAUL_storm1b_06_20_fDOM",
                                  "VAUL_storm1b_06_20_SPC",
                                  "VAUL_storm1b_06_20_turb",
                                  "VAUL_storm1b_06_20_abs",
                                  "VAUL_storm1c_06_22_NO3",
                                  "VAUL_storm1c_06_22_fDOM",
                                  "VAUL_storm1c_06_22_SPC",
                                  "VAUL_storm1c_06_22_turb",
                                  "VAUL_storm1c_06_22_abs",
                                  "VAUL_storm2_06_28_NO3",
                                  "VAUL_storm2_06_28_fDOM",
                                  "VAUL_storm2_06_28_SPC",
                                  "VAUL_storm2_06_28_turb",
                                  "VAUL_storm2_06_28_abs",
                                  "VAUL_storm3_07_09_NO3",
                                  "VAUL_storm3_07_09_fDOM",
                                  "VAUL_storm3_07_09_SPC",
                                  "VAUL_storm3_07_09_turb",
                                  "VAUL_storm3_07_09_abs",
                                  "VAUL_storm4_07_12_NO3",
                                  "VAUL_storm4_07_12_fDOM",
                                  "VAUL_storm4_07_12_SPC",
                                  "VAUL_storm4_07_12_turb",
                                  "VAUL_storm4_07_12_abs",
                                  "VAUL_storm5_07_26_NO3",
                                  "VAUL_storm5_07_26_fDOM",
                                  "VAUL_storm5_07_26_SPC",
                                  "VAUL_storm5_07_26_turb",
                                  "VAUL_storm5_07_26_abs",
                                  "VAUL_storm6a_08_01_NO3",
                                  "VAUL_storm6a_08_01_fDOM",
                                  "VAUL_storm6a_08_01_SPC",
                                  "VAUL_storm6a_08_01_turb",
                                  "VAUL_storm6a_08_01_abs",
                                  "VAUL_storm6b_08_02_NO3",
                                  "VAUL_storm6b_08_02_fDOM",
                                  "VAUL_storm6b_08_02_SPC",
                                  "VAUL_storm6b_08_02_turb",
                                  "VAUL_storm6b_08_02_abs",
                                  "VAUL_storm7_08_08_NO3",
                                  
                                  "VAUL_storm8_08_11_NO3",
                                  "VAUL_storm8_08_11_fDOM",
                                  "VAUL_storm8_08_11_SPC",
                                  "VAUL_storm8_08_11_turb",
                                  "VAUL_storm8_08_11_abs",
                                  "VAUL_storm9_08_12_NO3",
                                  "VAUL_storm9_08_12_fDOM",
                                  "VAUL_storm9_08_12_SPC",
                                  "VAUL_storm9_08_12_turb",
                                  "VAUL_storm9_08_12_abs",
                                  "VAUL_storm10_08_25_NO3",
                                  "VAUL_storm10_08_25_fDOM",
                                  "VAUL_storm10_08_25_SPC",
                                  "VAUL_storm10_08_25_turb",
                                  "VAUL_storm10_08_25_abs",
                                  "VAUL_storm11_08_27_NO3",
                                  "VAUL_storm11_08_27_fDOM",
                                  "VAUL_storm11_08_27_SPC",
                                  "VAUL_storm11_08_27_turb",
                                  "VAUL_storm11_08_27_abs",
                                  "VAUL_storm12_09_01_NO3",
                                  "VAUL_storm12_09_01_fDOM",
                                  "VAUL_storm12_09_01_SPC",
                                  "VAUL_storm12_09_01_turb",
                                  "VAUL_storm12_09_01_abs",
                                  "VAUL_storm13_09_03_NO3",
                                  "VAUL_storm13_09_03_fDOM",
                                  "VAUL_storm13_09_03_SPC",
                                  "VAUL_storm13_09_03_turb",
                                  "VAUL_storm13_09_03_abs",
                                  "VAUL_storm14_09_06_NO3",
                                  "VAUL_storm14_09_06_fDOM",
                                  "VAUL_storm14_09_06_SPC",
                                  "VAUL_storm14_09_06_turb",
                                  "VAUL_storm14_09_06_abs"
                                  )


              

VAUL.hyst.results.df$site.ID = "VAUL"

write.csv(VAUL.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/VAUL/VAUL.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/VAUL/VAUL.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= VAUL.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

VAUL.HI.df = bind_rows(HIs.df.list, .id = "column_label")
VAUL.HI.df$storm.ID = c(rep("VAUL_storm1a_06_19_NO3", 50),
                        rep("VAUL_storm1a_06_19_fDOM", 50),
                        rep("VAUL_storm1a_06_19_SPC", 50),
                        rep("VAUL_storm1a_06_19_turb", 50),
                        rep("VAUL_storm1a_06_19_abs", 50),
                        rep("VAUL_storm1b_06_20_NO3", 50),
                        rep("VAUL_storm1b_06_20_fDOM", 50),
                        rep("VAUL_storm1b_06_20_SPC", 50),
                        rep("VAUL_storm1b_06_20_turb", 50),
                        rep("VAUL_storm1b_06_20_abs", 50),
                        rep("VAUL_storm1c_06_22_NO3", 50),
                        rep("VAUL_storm1c_06_22_fDOM", 50),
                        rep("VAUL_storm1c_06_22_SPC", 50),
                        rep("VAUL_storm1c_06_22_turb", 50),
                        rep("VAUL_storm1c_06_22_abs", 50),
                        rep("VAUL_storm2_06_28_NO3", 50),
                        rep("VAUL_storm2_06_28_fDOM", 50),
                        rep("VAUL_storm2_06_28_SPC", 50),
                        rep("VAUL_storm2_06_28_turb", 50),
                        rep("VAUL_storm2_06_28_abs", 50),
                        rep("VAUL_storm3_07_09_NO3", 50),
                        rep("VAUL_storm3_07_09_fDOM", 50),
                        rep("VAUL_storm3_07_09_SPC", 50),
                        rep("VAUL_storm3_07_09_turb", 50),
                        rep("VAUL_storm3_07_09_abs", 50),
                        rep("VAUL_storm4_07_12_NO3", 50),
                        rep("VAUL_storm4_07_12_fDOM", 50),
                        rep("VAUL_storm4_07_12_SPC", 50),
                        rep("VAUL_storm4_07_12_turb", 50),
                        rep("VAUL_storm4_07_12_abs", 50),
                        rep("VAUL_storm5_07_26_NO3", 50),
                        rep("VAUL_storm5_07_26_fDOM", 50),
                        rep("VAUL_storm5_07_26_SPC", 50),
                        rep("VAUL_storm5_07_26_turb", 50),
                        rep("VAUL_storm5_07_26_abs", 50),
                        rep("VAUL_storm6a_08_01_NO3", 50),
                        rep("VAUL_storm6a_08_01_fDOM", 50),
                        rep("VAUL_storm6a_08_01_SPC", 50),
                        rep("VAUL_storm6a_08_01_turb", 50),
                        rep("VAUL_storm6a_08_01_abs", 50),
                        rep("VAUL_storm6b_08_02_NO3", 50),
                        rep("VAUL_storm6b_08_02_fDOM", 50),
                        rep("VAUL_storm6b_08_02_SPC", 50),
                        rep("VAUL_storm6b_08_02_turb", 50),
                        rep("VAUL_storm6b_08_02_abs", 50),
                        rep("VAUL_storm7_08_08_NO3", 50),
                        
                        rep("VAUL_storm8_08_11_NO3", 50),
                        rep("VAUL_storm8_08_11_fDOM", 50),
                        rep("VAUL_storm8_08_11_SPC", 50),
                        rep("VAUL_storm8_08_11_turb", 50),
                        rep("VAUL_storm8_08_11_abs", 50),
                        rep("VAUL_storm9_08_12_NO3", 50),
                        rep("VAUL_storm9_08_12_fDOM", 50),
                        rep("VAUL_storm9_08_12_SPC", 50),
                        rep("VAUL_storm9_08_12_turb", 50),
                        rep("VAUL_storm9_08_12_abs", 50),
                        rep("VAUL_storm10_08_25_NO3", 50),
                        rep("VAUL_storm10_08_25_fDOM", 50),
                        rep("VAUL_storm10_08_25_SPC", 50),
                        rep("VAUL_storm10_08_25_turb", 50),
                        rep("VAUL_storm10_08_25_abs", 50),
                        rep("VAUL_storm11_08_27_NO3", 50),
                        rep("VAUL_storm11_08_27_fDOM", 50),
                        rep("VAUL_storm11_08_27_SPC", 50),
                        rep("VAUL_storm11_08_27_turb", 50),
                        rep("VAUL_storm11_08_27_abs", 50),
                        rep("VAUL_storm12_09_01_NO3", 50),
                        rep("VAUL_storm12_09_01_fDOM", 50),
                        rep("VAUL_storm12_09_01_SPC", 50),
                        rep("VAUL_storm12_09_01_turb", 50),
                        rep("VAUL_storm12_09_01_abs", 50),
                        rep("VAUL_storm13_09_03_NO3", 50),
                        rep("VAUL_storm13_09_03_fDOM", 50),
                        rep("VAUL_storm13_09_03_SPC", 50),
                        rep("VAUL_storm13_09_03_turb", 50),
                        rep("VAUL_storm13_09_03_abs", 50),
                        rep("VAUL_storm14_09_06_NO3", 50),
                        rep("VAUL_storm14_09_06_fDOM", 50),
                        rep("VAUL_storm14_09_06_SPC", 50),
                        rep("VAUL_storm14_09_06_turb", 50),
                        rep("VAUL_storm14_09_06_abs", 50))
                        


VAUL.HI.df$storm.ID = as.factor(VAUL.HI.df$storm.ID)
VAUL.HI.df = separate(data=VAUL.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(VAUL.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/VAUL/VAUL.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/VAUL/VAUL.HI.df.csv")

VAUL.HI.df$date <- as.Date(with(VAUL.HI.df, paste(month, day, sep = "-")), "%m-%d")
VAUL.HI.df$doy <- yday(VAUL.HI.df$date) 

g0 <- ggplot(VAUL.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/VAUL/VAUL.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/VAUL/VAUL.HI.df.doy.csv")

```

 load data to pandas
```{python}
# MOOS #
MOOS_storm1_06_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm1_06_20_Q.csv")
MOOS_storm1_06_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm1_06_20_NO3.csv")
MOOS_storm1_06_20_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm1_06_20_fDOM.csv")
MOOS_storm1_06_20_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm1_06_20_SPC.csv")
MOOS_storm1_06_20_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm1_06_20_Turb.csv")
MOOS_storm1_06_20_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm1_06_20_abs.csv")

MOOS_storm2_06_28_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm2_06_28_Q.csv")
MOOS_storm2_06_28_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm2_06_28_NO3.csv")
MOOS_storm2_06_28_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm2_06_28_fDOM.csv")
MOOS_storm2_06_28_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm2_06_28_SPC.csv")
MOOS_storm2_06_28_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm2_06_28_Turb.csv")
MOOS_storm2_06_28_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm2_06_28_abs.csv")

MOOS_storm3_07_18_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm3_07_18_Q.csv")
MOOS_storm3_07_18_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm3_07_18_NO3.csv")
MOOS_storm3_07_18_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm3_07_18_fDOM.csv")
MOOS_storm3_07_18_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm3_07_18_SPC.csv")
MOOS_storm3_07_18_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm3_07_18_Turb.csv")
MOOS_storm3_07_18_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm3_07_18_abs.csv")

MOOS_storm4_07_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm4_07_20_Q.csv")
MOOS_storm4_07_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm4_07_20_NO3.csv")
MOOS_storm4_07_20_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm4_07_20_fDOM.csv")
MOOS_storm4_07_20_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm4_07_20_SPC.csv")
MOOS_storm4_07_20_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm4_07_20_Turb.csv")
MOOS_storm4_07_20_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm4_07_20_abs.csv")

MOOS_storm5_07_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm5_07_26_Q.csv")
MOOS_storm5_07_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm5_07_26_NO3.csv")
MOOS_storm5_07_26_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm5_07_26_fDOM.csv")
MOOS_storm5_07_26_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm5_07_26_SPC.csv")
MOOS_storm5_07_26_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm5_07_26_Turb.csv")
MOOS_storm5_07_26_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm5_07_26_abs.csv")

MOOS_storm6a_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6a_08_01_Q.csv")
MOOS_storm6a_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6a_08_01_NO3.csv")
MOOS_storm6a_08_01_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6a_08_01_fDOM.csv")
MOOS_storm6a_08_01_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6a_08_01_SPC.csv")
MOOS_storm6a_08_01_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6a_08_01_Turb.csv")
MOOS_storm6a_08_01_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6a_08_01_abs.csv")

MOOS_storm6b_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6b_08_02_Q.csv")
MOOS_storm6b_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6b_08_02_NO3.csv")
MOOS_storm6b_08_02_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6b_08_02_fDOM.csv")
MOOS_storm6b_08_02_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6b_08_02_SPC.csv")
MOOS_storm6b_08_02_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6b_08_02_Turb.csv")
MOOS_storm6b_08_02_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm6b_08_02_abs.csv")

MOOS_storm7a_08_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7a_08_09_Q.csv")
MOOS_storm7a_08_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7a_08_09_NO3.csv")
MOOS_storm7a_08_09_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7a_08_09_fDOM.csv")
MOOS_storm7a_08_09_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7a_08_09_SPC.csv")
MOOS_storm7a_08_09_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7a_08_09_Turb.csv")
MOOS_storm7a_08_09_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7a_08_09_abs.csv")

MOOS_storm7b_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7b_08_12_Q.csv")
MOOS_storm7b_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7b_08_12_NO3.csv")
MOOS_storm7b_08_12_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7b_08_12_fDOM.csv")
MOOS_storm7b_08_12_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7b_08_12_SPC.csv")
MOOS_storm7b_08_12_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7b_08_12_Turb.csv")
MOOS_storm7b_08_12_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm7b_08_12_abs.csv")

MOOS_storm8_09_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm8_09_06_Q.csv")
MOOS_storm8_09_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm8_09_06_NO3.csv")
MOOS_storm8_09_06_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm8_09_06_fDOM.csv")
MOOS_storm8_09_06_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm8_09_06_SPC.csv")
MOOS_storm8_09_06_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm8_09_06_Turb.csv")
MOOS_storm8_09_06_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm8_09_06_abs.csv")

MOOS_storm9_09_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm9_09_09_Q.csv")
MOOS_storm9_09_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm9_09_09_NO3.csv")
MOOS_storm9_09_09_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm9_09_09_fDOM.csv")
MOOS_storm9_09_09_SPC =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm9_09_09_SPC.csv")
MOOS_storm9_09_09_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm9_09_09_Turb.csv")
MOOS_storm9_09_09_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/MOOS/MOOS_storm9_09_09_abs.csv")

```



 MOOS_storms
```{python}
## NO3 ##
MOOS_storm1_06_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_20_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_20_NO3 = hysteresisMetrics(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_06_28_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_06_28_NO3 = hysteresisMetrics(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_18_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_18_NO3 = hysteresisMetrics(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_20_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_20_NO3 = hysteresisMetrics(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_26_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_26_NO3 = hysteresisMetrics(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_NO3 = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_NO3 = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_09_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_09_NO3 = hysteresisMetrics(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_12_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_12_NO3 = hysteresisMetrics(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_06_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_06_NO3 = hysteresisMetrics(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_09_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_09_09_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_09_09_NO3 = hysteresisMetrics(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## fDOM ##
MOOS_storm1_06_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_20_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_20_fDOM = hysteresisMetrics(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_06_28_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_06_28_fDOM = hysteresisMetrics(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_18_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_18_fDOM = hysteresisMetrics(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_20_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_20_fDOM = hysteresisMetrics(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_26_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_26_fDOM = hysteresisMetrics(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_fDOM = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_fDOM = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_09_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_09_fDOM = hysteresisMetrics(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_12_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_12_fDOM = hysteresisMetrics(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_06_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_06_fDOM = hysteresisMetrics(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_09_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_09_09_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_09_09_fDOM = hysteresisMetrics(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
MOOS_storm1_06_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_20_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_20_SPC = hysteresisMetrics(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_06_28_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_06_28_SPC = hysteresisMetrics(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_18_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_18_SPC = hysteresisMetrics(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_20_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_20_SPC = hysteresisMetrics(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_26_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_26_SPC = hysteresisMetrics(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_SPC = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_SPC = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_09_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_09_SPC = hysteresisMetrics(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_12_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_12_SPC = hysteresisMetrics(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_06_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_06_SPC = hysteresisMetrics(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_09_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_09_09_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_09_09_SPC = hysteresisMetrics(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
MOOS_storm1_06_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_20_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_20_turb = hysteresisMetrics(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_06_28_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_06_28_turb = hysteresisMetrics(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_18_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_18_turb = hysteresisMetrics(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_20_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_20_turb = hysteresisMetrics(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_26_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_26_turb = hysteresisMetrics(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_turb = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_turb = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_09_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_09_turb = hysteresisMetrics(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_12_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_12_turb = hysteresisMetrics(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_06_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_06_turb = hysteresisMetrics(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_09_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_09_09_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_09_09_turb = hysteresisMetrics(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
MOOS_storm1_06_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_06_20_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm1_06_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_06_20_abs = hysteresisMetrics(MOOS_storm1_06_20_Q, MOOS_storm1_06_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_06_28_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_06_28_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm2_06_28_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_06_28_abs = hysteresisMetrics(MOOS_storm2_06_28_Q, MOOS_storm2_06_28_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_07_18_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_07_18_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3_07_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_07_18_abs = hysteresisMetrics(MOOS_storm3_07_18_Q, MOOS_storm3_07_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_07_20_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_07_20_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm4_07_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_07_20_abs = hysteresisMetrics(MOOS_storm4_07_20_Q, MOOS_storm4_07_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5_07_26_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5_07_26_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm5_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5_07_26_abs = hysteresisMetrics(MOOS_storm5_07_26_Q, MOOS_storm5_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6a_08_01_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6a_08_01_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6a_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6a_08_01_abs = hysteresisMetrics(MOOS_storm6a_08_01_Q, MOOS_storm6a_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6b_08_02_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6b_08_02_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6b_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6b_08_02_abs = hysteresisMetrics(MOOS_storm6b_08_02_Q, MOOS_storm6b_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7a_08_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7a_08_09_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7a_08_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7a_08_09_abs = hysteresisMetrics(MOOS_storm7a_08_09_Q, MOOS_storm7a_08_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7b_08_12_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7b_08_12_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7b_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7b_08_12_abs = hysteresisMetrics(MOOS_storm7b_08_12_Q, MOOS_storm7b_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm8_09_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm8_09_06_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm8_09_06_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm8_09_06_abs = hysteresisMetrics(MOOS_storm8_09_06_Q, MOOS_storm8_09_06_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm9_09_09_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm9_09_09_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm9_09_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm9_09_09_abs = hysteresisMetrics(MOOS_storm9_09_09_Q, MOOS_storm9_09_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

 MOOS results
```{r}

MOOS.hyst.results.list = list(py$hysdict_MOOS_storm1_06_20_NO3,
                              py$hysdict_MOOS_storm1_06_20_fDOM,
                              py$hysdict_MOOS_storm1_06_20_SPC,
                              py$hysdict_MOOS_storm1_06_20_turb,
                              py$hysdict_MOOS_storm1_06_20_abs,
                              py$hysdict_MOOS_storm2_06_28_NO3,
                              py$hysdict_MOOS_storm2_06_28_fDOM,
                              py$hysdict_MOOS_storm2_06_28_SPC,
                              py$hysdict_MOOS_storm2_06_28_turb,
                              py$hysdict_MOOS_storm2_06_28_abs,
                              py$hysdict_MOOS_storm3_07_18_NO3,
                              py$hysdict_MOOS_storm3_07_18_fDOM,
                              py$hysdict_MOOS_storm3_07_18_SPC,
                              py$hysdict_MOOS_storm3_07_18_turb,
                              py$hysdict_MOOS_storm3_07_18_abs,
                              py$hysdict_MOOS_storm4_07_20_NO3,
                              py$hysdict_MOOS_storm4_07_20_fDOM,
                              py$hysdict_MOOS_storm4_07_20_SPC,
                              py$hysdict_MOOS_storm4_07_20_turb,
                              py$hysdict_MOOS_storm4_07_20_abs,
                              py$hysdict_MOOS_storm5_07_26_NO3,
                              py$hysdict_MOOS_storm5_07_26_fDOM,
                              py$hysdict_MOOS_storm5_07_26_SPC,
                              py$hysdict_MOOS_storm5_07_26_turb,
                              py$hysdict_MOOS_storm5_07_26_abs,
                              py$hysdict_MOOS_storm6a_08_01_NO3,
                              py$hysdict_MOOS_storm6a_08_01_fDOM,
                              py$hysdict_MOOS_storm6a_08_01_SPC,
                              py$hysdict_MOOS_storm6a_08_01_turb,
                              py$hysdict_MOOS_storm6a_08_01_abs,
                              py$hysdict_MOOS_storm6b_08_02_NO3,
                              py$hysdict_MOOS_storm6b_08_02_fDOM,
                              py$hysdict_MOOS_storm6b_08_02_SPC,
                              py$hysdict_MOOS_storm6b_08_02_turb,
                              py$hysdict_MOOS_storm6b_08_02_abs,
                              py$hysdict_MOOS_storm7a_08_09_NO3,
                              py$hysdict_MOOS_storm7a_08_09_fDOM,
                              py$hysdict_MOOS_storm7a_08_09_SPC,
                              py$hysdict_MOOS_storm7a_08_09_turb,
                              py$hysdict_MOOS_storm7a_08_09_abs,
                              py$hysdict_MOOS_storm7b_08_12_NO3,
                              py$hysdict_MOOS_storm7b_08_12_fDOM,
                              py$hysdict_MOOS_storm7b_08_12_SPC,
                              py$hysdict_MOOS_storm7b_08_12_turb,
                              py$hysdict_MOOS_storm7b_08_12_abs,
                              
                              py$hysdict_MOOS_storm9_09_09_NO3,
                              py$hysdict_MOOS_storm9_09_09_fDOM,
                              py$hysdict_MOOS_storm9_09_09_SPC,
                              py$hysdict_MOOS_storm9_09_09_turb,
                              py$hysdict_MOOS_storm9_09_09_abs)
                         
                            


MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c("MOOS_storm1_06_20_NO3",
                                  "MOOS_storm1_06_20_fDOM",
                                  "MOOS_storm1_06_20_SPC",
                                  "MOOS_storm1_06_20_turb",
                                  "MOOS_storm1_06_20_abs",
                                  "MOOS_storm2_06_28_NO3",
                                  "MOOS_storm2_06_28_fDOM",
                                  "MOOS_storm2_06_28_SPC",
                                  "MOOS_storm2_06_28_turb",
                                  "MOOS_storm2_06_28_abs",
                                  "MOOS_storm3_07_18_NO3",
                                  "MOOS_storm3_07_18_fDOM",
                                  "MOOS_storm3_07_18_SPC",
                                  "MOOS_storm3_07_18_turb",
                                  "MOOS_storm3_07_18_abs",
                                  "MOOS_storm4_07_20_NO3",
                                  "MOOS_storm4_07_20_fDOM",
                                  "MOOS_storm4_07_20_SPC",
                                  "MOOS_storm4_07_20_turb",
                                  "MOOS_storm4_07_20_abs",
                                  "MOOS_storm5_07_26_NO3",
                                  "MOOS_storm5_07_26_fDOM",
                                  "MOOS_storm5_07_26_SPC",
                                  "MOOS_storm5_07_26_turb",
                                  "MOOS_storm5_07_26_abs",
                                  "MOOS_storm6a_08_01_NO3",
                                  "MOOS_storm6a_08_01_fDOM",
                                  "MOOS_storm6a_08_01_SPC",
                                  "MOOS_storm6a_08_01_turb",
                                  "MOOS_storm6a_08_01_abs",
                                  "MOOS_storm6b_08_02_NO3",
                                  "MOOS_storm6b_08_02_fDOM",
                                  "MOOS_storm6b_08_02_SPC",
                                  "MOOS_storm6b_08_02_turb",
                                  "MOOS_storm6b_08_02_abs",
                                  "MOOS_storm7a_08_09_NO3",
                                  "MOOS_storm7a_08_09_fDOM",
                                  "MOOS_storm7a_08_09_SPC",
                                  "MOOS_storm7a_08_09_turb",
                                  "MOOS_storm7a_08_09_abs",
                                  "MOOS_storm7b_08_12_NO3",
                                  "MOOS_storm7b_08_12_fDOM",
                                  "MOOS_storm7b_08_12_SPC",
                                  "MOOS_storm7b_08_12_turb",
                                  "MOOS_storm7b_08_12_abs",
                                  "MOOS_storm9_09_09_NO3",
                                  "MOOS_storm9_09_09_fDOM",
                                  "MOOS_storm9_09_09_SPC",
                                  "MOOS_storm9_09_09_turb",
                                  "MOOS_storm9_09_09_abs")

MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/MOOS/MOOS.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(rep("MOOS_storm1_06_20_NO3", 50),
                        rep("MOOS_storm1_06_20_fDOM", 50),
                        rep("MOOS_storm1_06_20_SPC", 50),
                        rep("MOOS_storm1_06_20_turb", 50),
                        rep("MOOS_storm1_06_20_abs", 50),
                        rep("MOOS_storm2_06_28_NO3", 50),
                        rep("MOOS_storm2_06_28_fDOM", 50),
                        rep("MOOS_storm2_06_28_SPC", 50),
                        rep("MOOS_storm2_06_28_turb", 50),
                        rep("MOOS_storm2_06_28_abs", 50),
                        rep("MOOS_storm3_07_18_NO3", 50),
                        rep("MOOS_storm3_07_18_fDOM", 50),
                        rep("MOOS_storm3_07_18_SPC", 50),
                        rep("MOOS_storm3_07_18_turb", 50),
                        rep("MOOS_storm3_07_18_abs", 50),
                        rep("MOOS_storm4_07_20_NO3", 50),
                        rep("MOOS_storm4_07_20_fDOM", 50),
                        rep("MOOS_storm4_07_20_SPC", 50),
                        rep("MOOS_storm4_07_20_turb", 50),
                        rep("MOOS_storm4_07_20_abs", 50),
                        rep("MOOS_storm5_07_26_NO3", 50),
                        rep("MOOS_storm5_07_26_fDOM", 50),
                        rep("MOOS_storm5_07_26_SPC", 50),
                        rep("MOOS_storm5_07_26_turb", 50),
                        rep("MOOS_storm5_07_26_abs", 50),
                        rep("MOOS_storm6a_08_01_NO3", 50),
                        rep("MOOS_storm6a_08_01_fDOM", 50),
                        rep("MOOS_storm6a_08_01_fDOM", 50),
                        rep("MOOS_storm6a_08_01_turb", 50),
                        rep("MOOS_storm6a_08_01_abs", 50),
                        rep("MOOS_storm6b_08_02_NO3", 50),
                        rep("MOOS_storm6b_08_02_fDOM", 50),
                        rep("MOOS_storm6b_08_02_fDOM", 50),
                        rep("MOOS_storm6b_08_02_turb", 50),
                        rep("MOOS_storm6b_08_02_abs", 50),
                        rep("MOOS_storm7a_08_09_NO3", 50),
                        rep("MOOS_storm7a_08_09_fDOM", 50),
                        rep("MOOS_storm7a_08_09_fDOM", 50),
                        rep("MOOS_storm7a_08_09_turb", 50),
                        rep("MOOS_storm7a_08_09_abs", 50),
                        rep("MOOS_storm7b_08_12_NO3", 50),
                        rep("MOOS_storm7b_08_12_fDOM", 50),
                        rep("MOOS_storm7b_08_12_fDOM", 50),
                        rep("MOOS_storm7b_08_12_turb", 50),
                        rep("MOOS_storm7b_08_12_abs", 50),
                        rep("MOOS_storm9_09_09_NO3", 50),
                        rep("MOOS_storm9_09_09_fDOM", 50),
                        rep("MOOS_storm9_09_09_fDOM", 50),
                        rep("MOOS_storm9_09_09_turb", 50),
                        rep("MOOS_storm9_09_09_abs", 50))
                        


MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}

g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/MOOS/MOOS.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/MOOS/MOOS.HI.df.csv")

MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/MOOS/MOOS.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/MOOS/MOOS.HI.df.doy.csv")

```

 load data to pandas
```{python}
# POKE #
POKE_storm1_06_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm1_06_09_Q.csv")
POKE_storm1_06_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm1_06_09_NO3.csv")
POKE_storm1_06_09_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm1_06_09_fDOM.csv")
POKE_storm1_06_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm1_06_09_SPC.csv")
POKE_storm1_06_09_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm1_06_09_turb.csv")
POKE_storm1_06_09_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm1_06_09_abs.csv")

POKE_storm2_06_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm2_06_12_Q.csv")
POKE_storm2_06_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm2_06_12_NO3.csv")
POKE_storm2_06_12_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm2_06_12_fDOM.csv")
POKE_storm2_06_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm2_06_12_SPC.csv")
POKE_storm2_06_12_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm2_06_12_turb.csv")
POKE_storm2_06_12_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm2_06_12_abs.csv")

POKE_storm3_06_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm3_06_15_Q.csv")
POKE_storm3_06_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm3_06_15_NO3.csv")
POKE_storm3_06_15_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm3_06_15_fDOM.csv")
POKE_storm3_06_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm3_06_15_SPC.csv")
POKE_storm3_06_15_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm3_06_15_turb.csv")
POKE_storm3_06_15_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm3_06_15_abs.csv")

POKE_storm4a_06_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4a_06_19_Q.csv")
POKE_storm4a_06_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4a_06_19_NO3.csv")
POKE_storm4a_06_19_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4a_06_19_fDOM.csv")
POKE_storm4a_06_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4a_06_19_SPC.csv")
POKE_storm4a_06_19_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4a_06_19_turb.csv")
POKE_storm4a_06_19_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4a_06_19_abs.csv")

POKE_storm4b_06_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4b_06_20_Q.csv")
POKE_storm4b_06_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4b_06_20_NO3.csv")
POKE_storm4b_06_20_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4b_06_20_fDOM.csv")
POKE_storm4b_06_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4b_06_20_SPC.csv")
POKE_storm4b_06_20_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4b_06_20_turb.csv")
POKE_storm4b_06_20_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4b_06_20_abs.csv")

POKE_storm4c_06_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4c_06_21_Q.csv")
POKE_storm4c_06_21_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4c_06_21_NO3.csv")
POKE_storm4c_06_21_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4c_06_21_fDOM.csv")
POKE_storm4c_06_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4c_06_21_SPC.csv")
POKE_storm4c_06_21_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4c_06_21_turb.csv")
POKE_storm4c_06_21_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm4c_06_21_abs.csv")

POKE_storm5_06_22_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm5_06_22_Q.csv")
POKE_storm5_06_22_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm5_06_22_NO3.csv")
POKE_storm5_06_22_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm5_06_22_fDOM.csv")
POKE_storm5_06_22_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm5_06_22_SPC.csv")
POKE_storm5_06_22_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm5_06_22_turb.csv")
POKE_storm5_06_22_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm5_06_22_abs.csv")

POKE_storm6_06_29_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm6_06_29_Q.csv")
POKE_storm6_06_29_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm6_06_29_NO3.csv")
POKE_storm6_06_29_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm6_06_29_fDOM.csv")
POKE_storm6_06_29_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm6_06_29_SPC.csv")
POKE_storm6_06_29_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm6_06_29_turb.csv")
POKE_storm6_06_29_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm6_06_29_abs.csv")

POKE_storm7_07_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm7_07_04_Q.csv")
POKE_storm7_07_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm7_07_04_NO3.csv")
POKE_storm7_07_04_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm7_07_04_fDOM.csv")
POKE_storm7_07_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm7_07_04_SPC.csv")
POKE_storm7_07_04_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm7_07_04_turb.csv")
POKE_storm7_07_04_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm7_07_04_abs.csv")

POKE_storm8_07_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm8_07_09_Q.csv")
POKE_storm8_07_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm8_07_09_NO3.csv")
POKE_storm8_07_09_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm8_07_09_fDOM.csv")
POKE_storm8_07_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm8_07_09_SPC.csv")
POKE_storm8_07_09_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm8_07_09_turb.csv")
POKE_storm8_07_09_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm8_07_09_abs.csv")

POKE_storm9_07_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm9_07_12_Q.csv")
POKE_storm9_07_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm9_07_12_NO3.csv")
POKE_storm9_07_12_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm9_07_12_fDOM.csv")
POKE_storm9_07_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm9_07_12_SPC.csv")
POKE_storm9_07_12_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm9_07_12_turb.csv")
POKE_storm9_07_12_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm9_07_12_abs.csv")

POKE_storm10_07_16_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm10_07_16_Q.csv")
POKE_storm10_07_16_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm10_07_16_NO3.csv")
POKE_storm10_07_16_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm10_07_16_fDOM.csv")
POKE_storm10_07_16_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm10_07_16_SPC.csv")
POKE_storm10_07_16_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm10_07_16_turb.csv")
POKE_storm10_07_16_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm10_07_16_abs.csv")

POKE_storm11_07_18_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm11_07_18_Q.csv")
POKE_storm11_07_18_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm11_07_18_NO3.csv")
POKE_storm11_07_18_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm11_07_18_fDOM.csv")
POKE_storm11_07_18_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm11_07_18_SPC.csv")
POKE_storm11_07_18_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm11_07_18_turb.csv")
POKE_storm11_07_18_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm11_07_18_abs.csv")

POKE_storm12_07_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm12_07_20_Q.csv")
POKE_storm12_07_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm12_07_20_NO3.csv")
POKE_storm12_07_20_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm12_07_20_fDOM.csv")
POKE_storm12_07_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm12_07_20_SPC.csv")
POKE_storm12_07_20_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm12_07_20_turb.csv")
POKE_storm12_07_20_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm12_07_20_abs.csv")

POKE_storm13_07_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm13_07_24_Q.csv")
POKE_storm13_07_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm13_07_24_NO3.csv")
POKE_storm13_07_24_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm13_07_24_fDOM.csv")
POKE_storm13_07_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm13_07_24_SPC.csv")
POKE_storm13_07_24_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm13_07_24_turb.csv")
POKE_storm13_07_24_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm13_07_24_abs.csv")

POKE_storm14_07_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm14_07_26_Q.csv")
POKE_storm14_07_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm14_07_26_NO3.csv")
POKE_storm14_07_26_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm14_07_26_fDOM.csv")
POKE_storm14_07_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm14_07_26_SPC.csv")
POKE_storm14_07_26_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm14_07_26_turb.csv")
POKE_storm14_07_26_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm14_07_26_abs.csv")

POKE_storm15_08_02_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm15_08_02_Q.csv")
POKE_storm15_08_02_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm15_08_02_NO3.csv")
POKE_storm15_08_02_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm15_08_02_fDOM.csv")
POKE_storm15_08_02_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm15_08_02_SPC.csv")
POKE_storm15_08_02_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm15_08_02_turb.csv")
POKE_storm15_08_02_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm15_08_02_abs.csv")

POKE_storm16_08_12_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm16_08_12_Q.csv")
POKE_storm16_08_12_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm16_08_12_NO3.csv")
POKE_storm16_08_12_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm16_08_12_fDOM.csv")
POKE_storm16_08_12_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm16_08_12_SPC.csv")
POKE_storm16_08_12_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm16_08_12_turb.csv")
POKE_storm16_08_12_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm16_08_12_abs.csv")

POKE_storm17_08_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm17_08_23_Q.csv")
POKE_storm17_08_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm17_08_23_NO3.csv")
POKE_storm17_08_23_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm17_08_23_fDOM.csv")
POKE_storm17_08_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm17_08_23_SPC.csv")
POKE_storm17_08_23_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm17_08_23_turb.csv")
POKE_storm17_08_23_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm17_08_23_abs.csv")

POKE_storm18_08_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm18_08_25_Q.csv")
POKE_storm18_08_25_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm18_08_25_NO3.csv")
POKE_storm18_08_25_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm18_08_25_fDOM.csv")
POKE_storm18_08_25_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm18_08_25_SPC.csv")
POKE_storm18_08_25_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm18_08_25_turb.csv")
POKE_storm18_08_25_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm18_08_25_abs.csv")

POKE_storm19_08_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm19_08_27_Q.csv")
POKE_storm19_08_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm19_08_27_NO3.csv")
POKE_storm19_08_27_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm19_08_27_fDOM.csv")
POKE_storm19_08_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm19_08_27_SPC.csv")
POKE_storm19_08_27_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm19_08_27_turb.csv")
POKE_storm19_08_27_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm19_08_27_abs.csv")

POKE_storm20_09_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm20_09_01_Q.csv")
POKE_storm20_09_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm20_09_01_NO3.csv")
POKE_storm20_09_01_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm20_09_01_fDOM.csv")
POKE_storm20_09_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm20_09_01_SPC.csv")
POKE_storm20_09_01_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm20_09_01_turb.csv")
POKE_storm20_09_01_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm20_09_01_abs.csv")

POKE_storm21_09_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm21_09_03_Q.csv")
POKE_storm21_09_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm21_09_03_NO3.csv")
POKE_storm21_09_03_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm21_09_03_fDOM.csv")
POKE_storm21_09_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm21_09_03_SPC.csv")
POKE_storm21_09_03_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm21_09_03_turb.csv")
POKE_storm21_09_03_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm21_09_03_abs.csv")

POKE_storm22a_09_07_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22a_09_07_Q.csv")
POKE_storm22a_09_07_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22a_09_07_NO3.csv")
POKE_storm22a_09_07_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22a_09_07_fDOM.csv")
POKE_storm22a_09_07_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22a_09_07_SPC.csv")
POKE_storm22a_09_07_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22a_09_07_turb.csv")
POKE_storm22a_09_07_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22a_09_07_abs.csv")

POKE_storm22b_09_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22b_09_09_Q.csv")
POKE_storm22b_09_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22b_09_09_NO3.csv")
POKE_storm22b_09_09_fDOM =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22b_09_09_fDOM.csv")
POKE_storm22b_09_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22b_09_09_SPC.csv")
POKE_storm22b_09_09_turb =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22b_09_09_turb.csv")
POKE_storm22b_09_09_abs =pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2020/POKE/POKE_storm22b_09_09_abs.csv")


```



 POKE_storms
```{python}
## NO3 ##
POKE_storm1_06_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_09_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_09_NO3 = hysteresisMetrics(POKE_storm1_06_09_Q, POKE_storm1_06_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_12_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_12_NO3 = hysteresisMetrics(POKE_storm2_06_12_Q, POKE_storm2_06_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_15_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_15_NO3 = hysteresisMetrics(POKE_storm3_06_15_Q, POKE_storm3_06_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4a_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4a_06_19_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4a_06_19_NO3 = hysteresisMetrics(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4b_06_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4b_06_20_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4b_06_20_NO3 = hysteresisMetrics(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4c_06_21_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4c_06_21_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4c_06_21_NO3 = hysteresisMetrics(POKE_storm4c_06_21_Q, POKE_storm4c_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_06_22_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5_06_22_NO3 = hysteresisMetrics(POKE_storm5_06_22_Q, POKE_storm5_06_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_06_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_06_29_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6_06_29_NO3 = hysteresisMetrics(POKE_storm6_06_29_Q, POKE_storm6_06_29_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_07_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_07_04_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_07_04_NO3 = hysteresisMetrics(POKE_storm7_07_04_Q, POKE_storm7_07_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_07_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_07_09_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_07_09_NO3 = hysteresisMetrics(POKE_storm8_07_09_Q, POKE_storm8_07_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_07_12_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_07_12_NO3 = hysteresisMetrics(POKE_storm9_07_12_Q, POKE_storm9_07_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm10_07_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm10_07_16_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm10_07_16_NO3 = hysteresisMetrics(POKE_storm10_07_16_Q, POKE_storm10_07_16_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm11_07_18_Q['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm11_07_18_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm11_07_18_NO3 = hysteresisMetrics(POKE_storm11_07_18_Q, POKE_storm11_07_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm12_07_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm12_07_20_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm12_07_20_NO3 = hysteresisMetrics(POKE_storm12_07_20_Q, POKE_storm12_07_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm13_07_24_Q['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm13_07_24_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm13_07_24_NO3 = hysteresisMetrics(POKE_storm13_07_24_Q, POKE_storm13_07_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm14_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm14_07_26_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm14_07_26_NO3 = hysteresisMetrics(POKE_storm14_07_26_Q, POKE_storm14_07_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm15_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm15_08_02_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm15_08_02_NO3 = hysteresisMetrics(POKE_storm15_08_02_Q, POKE_storm15_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm16_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm16_08_12_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm16_08_12_NO3 = hysteresisMetrics(POKE_storm16_08_12_Q, POKE_storm16_08_12_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm17_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm17_08_23_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm17_08_23_NO3 = hysteresisMetrics(POKE_storm17_08_23_Q, POKE_storm17_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm18_08_25_Q['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm18_08_25_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm18_08_25_NO3 = hysteresisMetrics(POKE_storm18_08_25_Q, POKE_storm18_08_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm19_08_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm19_08_27_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm19_08_27_NO3 = hysteresisMetrics(POKE_storm19_08_27_Q, POKE_storm19_08_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm20_09_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm20_09_01_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm20_09_01_NO3 = hysteresisMetrics(POKE_storm20_09_01_Q, POKE_storm20_09_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm21_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm21_09_03_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm21_09_03_NO3 = hysteresisMetrics(POKE_storm21_09_03_Q, POKE_storm21_09_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22a_09_07_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22a_09_07_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22a_09_07_NO3 = hysteresisMetrics(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22b_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22b_09_09_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22b_09_09_NO3 = hysteresisMetrics(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
POKE_storm1_06_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_09_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_09_fDOM = hysteresisMetrics(POKE_storm1_06_09_Q, POKE_storm1_06_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_12_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_12_fDOM = hysteresisMetrics(POKE_storm2_06_12_Q, POKE_storm2_06_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_15_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_15_fDOM = hysteresisMetrics(POKE_storm3_06_15_Q, POKE_storm3_06_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4a_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4a_06_19_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4a_06_19_fDOM = hysteresisMetrics(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4b_06_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4b_06_20_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4b_06_20_fDOM = hysteresisMetrics(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4c_06_21_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4c_06_21_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4c_06_21_fDOM = hysteresisMetrics(POKE_storm4c_06_21_Q, POKE_storm4c_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_06_22_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5_06_22_fDOM = hysteresisMetrics(POKE_storm5_06_22_Q, POKE_storm5_06_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_06_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_06_29_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6_06_29_fDOM = hysteresisMetrics(POKE_storm6_06_29_Q, POKE_storm6_06_29_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_07_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_07_04_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_07_04_fDOM = hysteresisMetrics(POKE_storm7_07_04_Q, POKE_storm7_07_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_07_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_07_09_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_07_09_fDOM = hysteresisMetrics(POKE_storm8_07_09_Q, POKE_storm8_07_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_07_12_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_07_12_fDOM = hysteresisMetrics(POKE_storm9_07_12_Q, POKE_storm9_07_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm10_07_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm10_07_16_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm10_07_16_fDOM = hysteresisMetrics(POKE_storm10_07_16_Q, POKE_storm10_07_16_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm11_07_18_Q['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm11_07_18_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm11_07_18_fDOM = hysteresisMetrics(POKE_storm11_07_18_Q, POKE_storm11_07_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm12_07_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm12_07_20_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm12_07_20_fDOM = hysteresisMetrics(POKE_storm12_07_20_Q, POKE_storm12_07_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm13_07_24_Q['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm13_07_24_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm13_07_24_fDOM = hysteresisMetrics(POKE_storm13_07_24_Q, POKE_storm13_07_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm14_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm14_07_26_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm14_07_26_fDOM = hysteresisMetrics(POKE_storm14_07_26_Q, POKE_storm14_07_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


POKE_storm15_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm15_08_02_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm15_08_02_fDOM = hysteresisMetrics(POKE_storm15_08_02_Q, POKE_storm15_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


POKE_storm16_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm16_08_12_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm16_08_12_fDOM = hysteresisMetrics(POKE_storm16_08_12_Q, POKE_storm16_08_12_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm17_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm17_08_23_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm17_08_23_fDOM = hysteresisMetrics(POKE_storm17_08_23_Q, POKE_storm17_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm18_08_25_Q['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm18_08_25_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm18_08_25_fDOM = hysteresisMetrics(POKE_storm18_08_25_Q, POKE_storm18_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm19_08_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm19_08_27_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm19_08_27_fDOM = hysteresisMetrics(POKE_storm19_08_27_Q, POKE_storm19_08_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm20_09_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm20_09_01_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm20_09_01_fDOM = hysteresisMetrics(POKE_storm20_09_01_Q, POKE_storm20_09_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm21_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm21_09_03_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm21_09_03_fDOM = hysteresisMetrics(POKE_storm21_09_03_Q, POKE_storm21_09_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22a_09_07_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22a_09_07_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22a_09_07_fDOM = hysteresisMetrics(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22b_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22b_09_09_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22b_09_09_fDOM = hysteresisMetrics(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## SPC ##
POKE_storm1_06_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_09_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_09_SPC = hysteresisMetrics(POKE_storm1_06_09_Q, POKE_storm1_06_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_12_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_12_SPC = hysteresisMetrics(POKE_storm2_06_12_Q, POKE_storm2_06_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_15_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_15_SPC = hysteresisMetrics(POKE_storm3_06_15_Q, POKE_storm3_06_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4a_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4a_06_19_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4a_06_19_SPC = hysteresisMetrics(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4b_06_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4b_06_20_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4b_06_20_SPC = hysteresisMetrics(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4c_06_21_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4c_06_21_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4c_06_21_SPC = hysteresisMetrics(POKE_storm4c_06_21_Q, POKE_storm4c_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_06_22_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5_06_22_SPC = hysteresisMetrics(POKE_storm5_06_22_Q, POKE_storm5_06_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_06_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_06_29_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6_06_29_SPC = hysteresisMetrics(POKE_storm6_06_29_Q, POKE_storm6_06_29_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_07_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_07_04_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_07_04_SPC = hysteresisMetrics(POKE_storm7_07_04_Q, POKE_storm7_07_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_07_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_07_09_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_07_09_SPC = hysteresisMetrics(POKE_storm8_07_09_Q, POKE_storm8_07_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_07_12_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_07_12_SPC = hysteresisMetrics(POKE_storm9_07_12_Q, POKE_storm9_07_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm10_07_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm10_07_16_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm10_07_16_SPC = hysteresisMetrics(POKE_storm10_07_16_Q, POKE_storm10_07_16_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm11_07_18_Q['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm11_07_18_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm11_07_18_SPC = hysteresisMetrics(POKE_storm11_07_18_Q, POKE_storm11_07_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm12_07_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm12_07_20_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm12_07_20_SPC = hysteresisMetrics(POKE_storm12_07_20_Q, POKE_storm12_07_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm13_07_24_Q['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm13_07_24_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm13_07_24_SPC = hysteresisMetrics(POKE_storm13_07_24_Q, POKE_storm13_07_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm14_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm14_07_26_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm14_07_26_SPC = hysteresisMetrics(POKE_storm14_07_26_Q, POKE_storm14_07_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


POKE_storm15_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm15_08_02_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm15_08_02_SPC = hysteresisMetrics(POKE_storm15_08_02_Q, POKE_storm15_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm16_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm16_08_12_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm16_08_12_SPC = hysteresisMetrics(POKE_storm16_08_12_Q, POKE_storm16_08_12_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm17_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm17_08_23_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm17_08_23_SPC = hysteresisMetrics(POKE_storm17_08_23_Q, POKE_storm17_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm18_08_25_Q['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm18_08_25_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm18_08_25_SPC = hysteresisMetrics(POKE_storm18_08_25_Q, POKE_storm18_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm19_08_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm19_08_27_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm19_08_27_SPC = hysteresisMetrics(POKE_storm19_08_27_Q, POKE_storm19_08_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm20_09_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm20_09_01_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm20_09_01_SPC = hysteresisMetrics(POKE_storm20_09_01_Q, POKE_storm20_09_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm21_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm21_09_03_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm21_09_03_SPC = hysteresisMetrics(POKE_storm21_09_03_Q, POKE_storm21_09_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22a_09_07_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22a_09_07_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22a_09_07_SPC = hysteresisMetrics(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22b_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22b_09_09_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22b_09_09_SPC = hysteresisMetrics(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## turb ##
POKE_storm1_06_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_09_turb['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_09_turb = hysteresisMetrics(POKE_storm1_06_09_Q, POKE_storm1_06_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_12_turb['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_12_turb = hysteresisMetrics(POKE_storm2_06_12_Q, POKE_storm2_06_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_15_turb['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_15_turb = hysteresisMetrics(POKE_storm3_06_15_Q, POKE_storm3_06_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4a_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4a_06_19_turb['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4a_06_19_turb = hysteresisMetrics(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4b_06_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4b_06_20_turb['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4b_06_20_turb = hysteresisMetrics(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4c_06_21_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4c_06_21_turb['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4c_06_21_turb = hysteresisMetrics(POKE_storm4c_06_21_Q, POKE_storm4c_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_06_22_turb['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5_06_22_turb = hysteresisMetrics(POKE_storm5_06_22_Q, POKE_storm5_06_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_06_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_06_29_turb['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6_06_29_turb = hysteresisMetrics(POKE_storm6_06_29_Q, POKE_storm6_06_29_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_07_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_07_04_turb['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_07_04_turb = hysteresisMetrics(POKE_storm7_07_04_Q, POKE_storm7_07_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_07_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_07_09_turb['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_07_09_turb = hysteresisMetrics(POKE_storm8_07_09_Q, POKE_storm8_07_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_07_12_turb['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_07_12_turb = hysteresisMetrics(POKE_storm9_07_12_Q, POKE_storm9_07_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm10_07_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm10_07_16_turb['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm10_07_16_turb = hysteresisMetrics(POKE_storm10_07_16_Q, POKE_storm10_07_16_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm11_07_18_Q['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm11_07_18_turb['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm11_07_18_turb = hysteresisMetrics(POKE_storm11_07_18_Q, POKE_storm11_07_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm12_07_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm12_07_20_turb['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm12_07_20_turb = hysteresisMetrics(POKE_storm12_07_20_Q, POKE_storm12_07_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm13_07_24_Q['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm13_07_24_turb['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm13_07_24_turb = hysteresisMetrics(POKE_storm13_07_24_Q, POKE_storm13_07_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm14_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm14_07_26_turb['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm14_07_26_turb = hysteresisMetrics(POKE_storm14_07_26_Q, POKE_storm14_07_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


POKE_storm15_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm15_08_02_turb['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm15_08_02_turb = hysteresisMetrics(POKE_storm15_08_02_Q, POKE_storm15_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm16_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm16_08_12_turb['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm16_08_12_turb = hysteresisMetrics(POKE_storm16_08_12_Q, POKE_storm16_08_12_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm17_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm17_08_23_turb['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm17_08_23_turb = hysteresisMetrics(POKE_storm17_08_23_Q, POKE_storm17_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm18_08_25_Q['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm18_08_25_turb['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm18_08_25_turb = hysteresisMetrics(POKE_storm18_08_25_Q, POKE_storm18_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm19_08_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm19_08_27_turb['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm19_08_27_turb = hysteresisMetrics(POKE_storm19_08_27_Q, POKE_storm19_08_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm20_09_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm20_09_01_turb['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm20_09_01_turb = hysteresisMetrics(POKE_storm20_09_01_Q, POKE_storm20_09_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm21_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm21_09_03_turb['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm21_09_03_turb = hysteresisMetrics(POKE_storm21_09_03_Q, POKE_storm21_09_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22a_09_07_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22a_09_07_turb['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22a_09_07_turb = hysteresisMetrics(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22b_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22b_09_09_turb['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22b_09_09_turb = hysteresisMetrics(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
POKE_storm1_06_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_06_09_abs['valuedatetime'] =  pd.to_datetime(POKE_storm1_06_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_06_09_abs = hysteresisMetrics(POKE_storm1_06_09_Q, POKE_storm1_06_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_12_abs['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_12_abs = hysteresisMetrics(POKE_storm2_06_12_Q, POKE_storm2_06_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_15_abs['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_15_abs = hysteresisMetrics(POKE_storm3_06_15_Q, POKE_storm3_06_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4a_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4a_06_19_abs['valuedatetime'] =  pd.to_datetime(POKE_storm4a_06_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4a_06_19_abs = hysteresisMetrics(POKE_storm4a_06_19_Q, POKE_storm4a_06_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4b_06_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4b_06_20_abs['valuedatetime'] =  pd.to_datetime(POKE_storm4b_06_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4b_06_20_abs = hysteresisMetrics(POKE_storm4b_06_20_Q, POKE_storm4b_06_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4c_06_21_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4c_06_21_abs['valuedatetime'] =  pd.to_datetime(POKE_storm4c_06_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4c_06_21_abs = hysteresisMetrics(POKE_storm4c_06_21_Q, POKE_storm4c_06_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_06_22_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_06_22_abs['valuedatetime'] =  pd.to_datetime(POKE_storm5_06_22_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm5_06_22_abs = hysteresisMetrics(POKE_storm5_06_22_Q, POKE_storm5_06_22_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_06_29_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_06_29_abs['valuedatetime'] =  pd.to_datetime(POKE_storm6_06_29_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm6_06_29_abs = hysteresisMetrics(POKE_storm6_06_29_Q, POKE_storm6_06_29_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7_07_04_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7_07_04_abs['valuedatetime'] =  pd.to_datetime(POKE_storm7_07_04_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7_07_04_abs = hysteresisMetrics(POKE_storm7_07_04_Q, POKE_storm7_07_04_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm8_07_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm8_07_09_abs['valuedatetime'] =  pd.to_datetime(POKE_storm8_07_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm8_07_09_abs = hysteresisMetrics(POKE_storm8_07_09_Q, POKE_storm8_07_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm9_07_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm9_07_12_abs['valuedatetime'] =  pd.to_datetime(POKE_storm9_07_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm9_07_12_abs = hysteresisMetrics(POKE_storm9_07_12_Q, POKE_storm9_07_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm10_07_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm10_07_16_abs['valuedatetime'] =  pd.to_datetime(POKE_storm10_07_16_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm10_07_16_abs = hysteresisMetrics(POKE_storm10_07_16_Q, POKE_storm10_07_16_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm11_07_18_Q['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm11_07_18_abs['valuedatetime'] =  pd.to_datetime(POKE_storm11_07_18_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm11_07_18_abs = hysteresisMetrics(POKE_storm11_07_18_Q, POKE_storm11_07_18_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm12_07_20_Q['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm12_07_20_abs['valuedatetime'] =  pd.to_datetime(POKE_storm12_07_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm12_07_20_abs = hysteresisMetrics(POKE_storm12_07_20_Q, POKE_storm12_07_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm13_07_24_Q['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm13_07_24_abs['valuedatetime'] =  pd.to_datetime(POKE_storm13_07_24_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm13_07_24_abs = hysteresisMetrics(POKE_storm13_07_24_Q, POKE_storm13_07_24_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm14_07_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm14_07_26_abs['valuedatetime'] =  pd.to_datetime(POKE_storm14_07_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm14_07_26_abs = hysteresisMetrics(POKE_storm14_07_26_Q, POKE_storm14_07_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm15_08_02_Q['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm15_08_02_abs['valuedatetime'] =  pd.to_datetime(POKE_storm15_08_02_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm15_08_02_abs = hysteresisMetrics(POKE_storm15_08_02_Q, POKE_storm15_08_02_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm16_08_12_Q['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm16_08_12_abs['valuedatetime'] =  pd.to_datetime(POKE_storm16_08_12_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm16_08_12_abs = hysteresisMetrics(POKE_storm16_08_12_Q, POKE_storm16_08_12_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm17_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm17_08_23_abs['valuedatetime'] =  pd.to_datetime(POKE_storm17_08_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm17_08_23_abs = hysteresisMetrics(POKE_storm17_08_23_Q, POKE_storm17_08_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm18_08_25_Q['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm18_08_25_abs['valuedatetime'] =  pd.to_datetime(POKE_storm18_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm18_08_25_abs = hysteresisMetrics(POKE_storm18_08_25_Q, POKE_storm18_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm19_08_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm19_08_27_abs['valuedatetime'] =  pd.to_datetime(POKE_storm19_08_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm19_08_27_abs = hysteresisMetrics(POKE_storm19_08_27_Q, POKE_storm19_08_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm20_09_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm20_09_01_abs['valuedatetime'] =  pd.to_datetime(POKE_storm20_09_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm20_09_01_abs = hysteresisMetrics(POKE_storm20_09_01_Q, POKE_storm20_09_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm21_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm21_09_03_abs['valuedatetime'] =  pd.to_datetime(POKE_storm21_09_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm21_09_03_abs = hysteresisMetrics(POKE_storm21_09_03_Q, POKE_storm21_09_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22a_09_07_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22a_09_07_abs['valuedatetime'] =  pd.to_datetime(POKE_storm22a_09_07_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22a_09_07_abs = hysteresisMetrics(POKE_storm22a_09_07_Q, POKE_storm22a_09_07_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm22b_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm22b_09_09_abs['valuedatetime'] =  pd.to_datetime(POKE_storm22b_09_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm22b_09_09_abs = hysteresisMetrics(POKE_storm22b_09_09_Q, POKE_storm22b_09_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


POKE results
```{r}

POKE.hyst.results.list = list(py$hysdict_POKE_storm1_06_09_NO3,
                              py$hysdict_POKE_storm1_06_09_fDOM,
                              py$hysdict_POKE_storm1_06_09_SPC,
                              py$hysdict_POKE_storm1_06_09_turb,
                              py$hysdict_POKE_storm1_06_09_abs,
                              py$hysdict_POKE_storm2_06_12_NO3,
                              py$hysdict_POKE_storm2_06_12_fDOM,
                              py$hysdict_POKE_storm2_06_12_SPC,
                              py$hysdict_POKE_storm2_06_12_turb,
                              py$hysdict_POKE_storm2_06_12_abs,
                              py$hysdict_POKE_storm3_06_15_NO3,
                              py$hysdict_POKE_storm3_06_15_fDOM,
                              py$hysdict_POKE_storm3_06_15_SPC,
                              py$hysdict_POKE_storm3_06_15_turb,
                              py$hysdict_POKE_storm3_06_15_abs,
                              py$hysdict_POKE_storm4a_06_19_NO3,
                              py$hysdict_POKE_storm4a_06_19_fDOM,
                              py$hysdict_POKE_storm4a_06_19_SPC,
                              py$hysdict_POKE_storm4a_06_19_turb,
                              py$hysdict_POKE_storm4a_06_19_abs,
                              py$hysdict_POKE_storm4b_06_20_NO3,
                              py$hysdict_POKE_storm4b_06_20_fDOM,
                              py$hysdict_POKE_storm4b_06_20_SPC,
                              py$hysdict_POKE_storm4b_06_20_turb,
                              py$hysdict_POKE_storm4b_06_20_abs,
                              py$hysdict_POKE_storm4c_06_21_NO3,
                              py$hysdict_POKE_storm4c_06_21_fDOM,
                              py$hysdict_POKE_storm4c_06_21_SPC,
                              py$hysdict_POKE_storm4c_06_21_turb,
                              py$hysdict_POKE_storm4c_06_21_abs,
                              py$hysdict_POKE_storm5_06_22_NO3,
                              py$hysdict_POKE_storm5_06_22_fDOM,
                              py$hysdict_POKE_storm5_06_22_SPC,
                              py$hysdict_POKE_storm5_06_22_turb,
                              py$hysdict_POKE_storm5_06_22_abs,
                              py$hysdict_POKE_storm6_06_29_NO3,
                              py$hysdict_POKE_storm6_06_29_fDOM,
                              py$hysdict_POKE_storm6_06_29_SPC,
                              py$hysdict_POKE_storm6_06_29_turb,
                              py$hysdict_POKE_storm6_06_29_abs,
                              py$hysdict_POKE_storm7_07_04_NO3,
                              py$hysdict_POKE_storm7_07_04_fDOM,
                              py$hysdict_POKE_storm7_07_04_SPC,
                              py$hysdict_POKE_storm7_07_04_turb,
                              py$hysdict_POKE_storm7_07_04_abs,
                              py$hysdict_POKE_storm8_07_09_NO3,
                              py$hysdict_POKE_storm8_07_09_fDOM,
                              py$hysdict_POKE_storm8_07_09_SPC,
                              py$hysdict_POKE_storm8_07_09_turb,
                              py$hysdict_POKE_storm8_07_09_abs,
                              py$hysdict_POKE_storm9_07_12_NO3,
                              py$hysdict_POKE_storm9_07_12_fDOM,
                              py$hysdict_POKE_storm9_07_12_SPC,
                              py$hysdict_POKE_storm9_07_12_turb,
                              py$hysdict_POKE_storm9_07_12_abs,
                              py$hysdict_POKE_storm10_07_16_NO3,
                              py$hysdict_POKE_storm10_07_16_fDOM,
                              py$hysdict_POKE_storm10_07_16_SPC,
                              py$hysdict_POKE_storm10_07_16_turb,
                              py$hysdict_POKE_storm10_07_16_abs,
                              py$hysdict_POKE_storm11_07_18_NO3,
                              py$hysdict_POKE_storm11_07_18_fDOM,
                              py$hysdict_POKE_storm11_07_18_SPC,
                              py$hysdict_POKE_storm11_07_18_turb,
                              py$hysdict_POKE_storm11_07_18_abs,
                              py$hysdict_POKE_storm12_07_20_turb,
                              py$hysdict_POKE_storm12_07_20_abs,
                              py$hysdict_POKE_storm13_07_24_NO3,
                              py$hysdict_POKE_storm13_07_24_fDOM,
                              py$hysdict_POKE_storm13_07_24_SPC,
                              py$hysdict_POKE_storm13_07_24_turb,
                              py$hysdict_POKE_storm13_07_24_abs,
                              py$hysdict_POKE_storm14_07_26_NO3,
                              py$hysdict_POKE_storm14_07_26_fDOM,
                              py$hysdict_POKE_storm14_07_26_SPC,
                              py$hysdict_POKE_storm14_07_26_turb,
                              py$hysdict_POKE_storm14_07_26_abs,
                              py$hysdict_POKE_storm15_08_02_NO3,
                              py$hysdict_POKE_storm15_08_02_fDOM,
                              py$hysdict_POKE_storm15_08_02_SPC,
                              py$hysdict_POKE_storm15_08_02_turb,
                              py$hysdict_POKE_storm15_08_02_abs,
                              py$hysdict_POKE_storm16_08_12_NO3,
                              py$hysdict_POKE_storm16_08_12_fDOM,
                              py$hysdict_POKE_storm16_08_12_SPC,
                              py$hysdict_POKE_storm16_08_12_turb,
                              py$hysdict_POKE_storm16_08_12_abs,
                              py$hysdict_POKE_storm17_08_23_NO3,
                              py$hysdict_POKE_storm17_08_23_fDOM,
                              py$hysdict_POKE_storm17_08_23_SPC,
                              py$hysdict_POKE_storm17_08_23_turb,
                              py$hysdict_POKE_storm17_08_23_abs,
                              py$hysdict_POKE_storm18_08_25_NO3,
                              py$hysdict_POKE_storm18_08_25_fDOM,
                              py$hysdict_POKE_storm18_08_25_SPC,
                              py$hysdict_POKE_storm18_08_25_turb,
                              py$hysdict_POKE_storm18_08_25_abs,
                              py$hysdict_POKE_storm19_08_27_NO3,
                              py$hysdict_POKE_storm19_08_27_fDOM,
                              py$hysdict_POKE_storm19_08_27_SPC,
                              py$hysdict_POKE_storm19_08_27_turb,
                              py$hysdict_POKE_storm19_08_27_abs,
                              py$hysdict_POKE_storm20_09_01_NO3,
                              py$hysdict_POKE_storm20_09_01_fDOM,
  
                              py$hysdict_POKE_storm20_09_01_turb,
                              py$hysdict_POKE_storm20_09_01_abs,
                              py$hysdict_POKE_storm21_09_03_NO3,
                              py$hysdict_POKE_storm21_09_03_fDOM,
                              py$hysdict_POKE_storm21_09_03_SPC,
                              py$hysdict_POKE_storm21_09_03_turb,
                              py$hysdict_POKE_storm21_09_03_abs,
                              py$hysdict_POKE_storm22a_09_07_NO3,
                              py$hysdict_POKE_storm22a_09_07_fDOM,
                              py$hysdict_POKE_storm22a_09_07_SPC,
                              py$hysdict_POKE_storm22a_09_07_turb,
                              py$hysdict_POKE_storm22a_09_07_abs,
                              py$hysdict_POKE_storm22b_09_09_NO3,
                              py$hysdict_POKE_storm22b_09_09_fDOM,
                              py$hysdict_POKE_storm22b_09_09_SPC,
                              py$hysdict_POKE_storm22b_09_09_turb,
                              py$hysdict_POKE_storm22b_09_09_abs)
                           
POKE.hyst.results.list.2 = list()
for (i in 1:length(POKE.hyst.results.list)){
POKE.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
POKE.hyst.results.list[[i]][["HI_mean_with_Interp"]],
POKE.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
POKE.hyst.results.list[[i]][["Normalized slope of response"]],
POKE.hyst.results.list[[i]][["interpolated Max width of response"]],
POKE.hyst.results.list[[i]][["Min response"]],
POKE.hyst.results.list[[i]][["Max response"]],
POKE.hyst.results.list[[i]][["Peak Q"]]
))))
names(POKE.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(POKE.hyst.results.list)){
  HIs.list[[i]] = unlist(POKE.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

POKE.hyst.results.list.3 =list()
for (i in 1:length(POKE.hyst.results.list)){
  POKE.hyst.results.list.3[[i]] = cbind(POKE.hyst.results.list.2[[i]], HIs.tests[[i]])
}

POKE.hyst.results.df = bind_rows(POKE.hyst.results.list.3, .id = "column_label")

POKE.hyst.results.df$storm.ID = c("POKE_storm1_06_09_NO3",
                              "POKE_storm1_06_09_fDOM",
                              "POKE_storm1_06_09_SPC",
                              "POKE_storm1_06_09_turb",
                              "POKE_storm1_06_09_abs",
                              "POKE_storm2_06_12_NO3",
                              "POKE_storm2_06_12_fDOM",
                              "POKE_storm2_06_12_SPC",
                              "POKE_storm2_06_12_turb",
                              "POKE_storm2_06_12_abs",
                              "POKE_storm3_06_15_NO3",
                              "POKE_storm3_06_15_fDOM",
                              "POKE_storm3_06_15_SPC",
                              "POKE_storm3_06_15_turb",
                              "POKE_storm3_06_15_abs",
                              "POKE_storm4a_06_19_NO3",
                              "POKE_storm4a_06_19_fDOM",
                              "POKE_storm4a_06_19_SPC",
                              "POKE_storm4a_06_19_turb",
                              "POKE_storm4a_06_19_abs",
                              "POKE_storm4b_06_20_NO3",
                              "POKE_storm4b_06_20_fDOM",
                              "POKE_storm4b_06_20_SPC",
                              "POKE_storm4b_06_20_turb",
                              "POKE_storm4b_06_20_abs",
                              "POKE_storm4c_06_21_NO3",
                              "POKE_storm4c_06_21_fDOM",
                              "POKE_storm4c_06_21_SPC",
                              "POKE_storm4c_06_21_turb",
                              "POKE_storm4c_06_21_abs",
                              "POKE_storm5_06_22_NO3",
                              "POKE_storm5_06_22_fDOM",
                              "POKE_storm5_06_22_SPC",
                              "POKE_storm5_06_22_turb",
                              "POKE_storm5_06_22_abs",
                              "POKE_storm6_06_29_NO3",
                              "POKE_storm6_06_29_fDOM",
                              "POKE_storm6_06_29_SPC",
                              "POKE_storm6_06_29_turb",
                              "POKE_storm6_06_29_abs",
                              "POKE_storm7_07_04_NO3",
                              "POKE_storm7_07_04_fDOM",
                              "POKE_storm7_07_04_SPC",
                              "POKE_storm7_07_04_turb",
                              "POKE_storm7_07_04_abs",
                              "POKE_storm8_07_09_NO3",
                              "POKE_storm8_07_09_fDOM",
                              "POKE_storm8_07_09_SPC",
                              "POKE_storm8_07_09_turb",
                              "POKE_storm8_07_09_abs",
                              "POKE_storm9_07_12_NO3",
                              "POKE_storm9_07_12_fDOM",
                              "POKE_storm9_07_12_SPC",
                              "POKE_storm9_07_12_turb",
                              "POKE_storm9_07_12_abs",
                              "POKE_storm10_07_16_NO3",
                              "POKE_storm10_07_16_fDOM",
                              "POKE_storm10_07_16_SPC",
                              "POKE_storm10_07_16_turb",
                              "POKE_storm10_07_16_abs",
                              "POKE_storm11_07_18_NO3",
                              "POKE_storm11_07_18_fDOM",
                              "POKE_storm11_07_18_SPC",
                              "POKE_storm11_07_18_turb",
                              "POKE_storm11_07_18_abs",
                              
                              
                              "POKE_storm12_07_20_turb",
                              "POKE_storm12_07_20_abs",
                              "POKE_storm13_07_24_NO3",
                              "POKE_storm13_07_24_fDOM",
                              "POKE_storm13_07_24_SPC",
                              "POKE_storm13_07_24_turb",
                              "POKE_storm13_07_24_abs",
                              "POKE_storm14_07_26_NO3",
                              "POKE_storm14_07_26_fDOM",
                              "POKE_storm14_07_26_SPC",
                              "POKE_storm14_07_26_turb",
                              "POKE_storm14_07_26_abs",
                              "POKE_storm15_08_02_NO3",
                              "POKE_storm15_08_02_fDOM",
                              "POKE_storm15_08_02_SPC",
                              "POKE_storm15_08_02_turb",
                              "POKE_storm15_08_02_abs",
                              "POKE_storm16_08_12_NO3",
                              "POKE_storm16_08_12_fDOM",
                              "POKE_storm16_08_12_SPC",
                              "POKE_storm16_08_12_turb",
                              "POKE_storm16_08_12_abs",
                              "POKE_storm17_08_23_NO3",
                              "POKE_storm17_08_23_fDOM",
                              "POKE_storm17_08_23_SPC",
                              "POKE_storm17_08_23_turb",
                              "POKE_storm17_08_23_abs",
                              "POKE_storm18_08_25_NO3",
                              "POKE_storm18_08_25_fDOM",
                              "POKE_storm18_08_25_SPC",
                              "POKE_storm18_08_25_turb",
                              "POKE_storm18_08_25_abs",
                              "POKE_storm19_08_27_NO3",
                              "POKE_storm19_08_27_fDOM",
                              "POKE_storm19_08_27_SPC",
                              "POKE_storm19_08_27_turb",
                              "POKE_storm19_08_27_abs",
                              "POKE_storm20_09_01_NO3",
                              "POKE_storm20_09_01_fDOM",
                              
                              "POKE_storm20_09_01_turb",
                              "POKE_storm20_09_01_abs",
                              "POKE_storm21_09_03_NO3",
                              "POKE_storm21_09_03_fDOM",
                              "POKE_storm21_09_03_SPC",
                              "POKE_storm21_09_03_turb",
                              "POKE_storm21_09_03_abs",
                              "POKE_storm22a_09_07_NO3",
                              "POKE_storm22a_09_07_fDOM",
                              "POKE_storm22a_09_07_SPC",
                              "POKE_storm22a_09_07_turb",
                              "POKE_storm22a_09_07_abs",
                              "POKE_storm22b_09_09_NO3",
                              "POKE_storm22b_09_09_fDOM",
                              "POKE_storm22b_09_09_SPC",
                              "POKE_storm22b_09_09_turb",
                              "POKE_storm22b_09_09_abs")

POKE.hyst.results.df$site.ID = "POKE"

write.csv(POKE.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/POKE/POKE.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/POKE/POKE.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= POKE.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

POKE.HI.df = bind_rows(HIs.df.list, .id = "column_label")
POKE.HI.df$storm.ID = c(rep("POKE_storm1_06_09_NO3", 50),
                        rep("POKE_storm1_06_09_fDOM", 50),
                        rep("POKE_storm1_06_09_SPC", 50),
                        rep("POKE_storm1_06_09_turb", 50),
                        rep("POKE_storm1_06_09_abs", 50),
                        rep("POKE_storm2_06_12_NO3", 50),
                        rep("POKE_storm2_06_12_fDOM", 50),
                        rep("POKE_storm2_06_12_SPC", 50),
                        rep("POKE_storm2_06_12_turb",50),
                        rep("POKE_storm2_06_12_abs",50),
                        rep("POKE_storm3_06_15_NO3", 50),
                        rep("POKE_storm3_06_15_fDOM",50),
                        rep("POKE_storm3_06_15_SPC",50),    
                        rep("POKE_storm3_06_15_turb",50),
                        rep("POKE_storm3_06_15_abs",50),
                        rep("POKE_storm4a_06_19_NO3",50),
                        rep("POKE_storm4a_06_19_fDOM",50),
                        rep("POKE_storm4a_06_19_SPC",50),      
                        rep("POKE_storm4a_06_19_turb",50),
                        rep("POKE_storm4a_06_19_abs",50),
                        rep("POKE_storm4b_06_20_NO3",50),
                        rep("POKE_storm4b_06_20_fDOM",50),
                        rep("POKE_storm4b_06_20_SPC",50),
                        rep("POKE_storm4b_06_20_turb",50),
                        rep("POKE_storm4b_06_20_abs",50),
                        rep("POKE_storm4c_06_21_NO3",50),
                        rep("POKE_storm4c_06_21_fDOM",50),
                        rep("POKE_storm4c_06_21_SPC",50),
                        rep("POKE_storm4c_06_21_turb",50),
                        rep("POKE_storm4c_06_21_abs",50),
                        rep("POKE_storm5_06_22_NO3",50),
                        rep("POKE_storm5_06_22_fDOM",50),
                        rep("POKE_storm5_06_22_SPC",50),
                        rep("POKE_storm5_06_22_turb",50),
                        rep("POKE_storm5_06_22_abs",50),
                        rep("POKE_storm6_06_29_NO3",50),
                        rep("POKE_storm6_06_29_fDOM",50),
                        rep("POKE_storm6_06_29_SPC",50),
                        rep("POKE_storm6_06_29_turb",50),
                        rep("POKE_storm6_06_29_abs",50),
                        rep("POKE_storm7_07_04_NO3",50),
                        rep("POKE_storm7_07_04_fDOM",50),
                        rep("POKE_storm7_07_04_SPC",50),
                        rep("POKE_storm7_07_04_turb",50),
                        rep("POKE_storm7_07_04_abs",50),
                        rep("POKE_storm8_07_09_NO3",50),
                        rep("POKE_storm8_07_09_fDOM",50),
                        rep("POKE_storm8_07_09_SPC",50),
                        rep("POKE_storm8_07_09_turb",50),
                        rep("POKE_storm8_07_09_abs",50),
                        rep("POKE_storm9_07_12_NO3",50),
                        rep("POKE_storm9_07_12_fDOM",50),
                        rep("POKE_storm9_07_12_SPC",50),
                        rep("POKE_storm9_07_12_turb",50),
                        rep("POKE_storm9_07_12_abs",50),
                        rep("POKE_storm10_07_16_NO3",50),
                        rep("POKE_storm10_07_16_fDOM",50),
                        rep("POKE_storm10_07_16_SPC",50),
                        rep("POKE_storm10_07_16_turb",50),
                        rep("POKE_storm10_07_16_abs",50),
                        rep("POKE_storm11_07_18_NO3",50),
                        rep("POKE_storm11_07_18_fDOM",50),
                        rep("POKE_storm11_07_18_SPC",50),
                        rep("POKE_storm11_07_18_turb",50),
                        rep("POKE_storm11_07_18_abs",50),
                        
                        
                        rep("POKE_storm12_07_20_turb",50),
                        rep("POKE_storm12_07_20_abs",50),
                        rep("POKE_storm13_07_24_NO3",50),
                        rep("POKE_storm13_07_24_fDOM",50),
                        rep("POKE_storm13_07_24_SPC",50),
                        rep("POKE_storm13_07_24_turb",50),
                        rep("POKE_storm13_07_24_abs",50),
                        rep("POKE_storm14_07_26_NO3",50),
                        rep("POKE_storm14_07_26_fDOM",50),
                        rep("POKE_storm14_07_26_SPC",50),
                        rep("POKE_storm14_07_26_turb",50),
                        rep("POKE_storm14_07_26_abs",50),
                        rep("POKE_storm15_08_02_NO3",50),
                        rep("POKE_storm15_08_02_fDOM",50),
                        rep("POKE_storm15_08_02_SPC",50),
                        rep("POKE_storm15_08_02_turb",50),
                        rep("POKE_storm15_08_02_abs",50),
                        rep("POKE_storm16_08_12_NO3",50),
                        rep("POKE_storm16_08_12_fDOM",50),
                        rep("POKE_storm16_08_12_SPC",50),
                        rep("POKE_storm16_08_12_turb",50),
                        rep("POKE_storm16_08_12_abs",50),
                        rep("POKE_storm17_08_23_NO3",50),
                        rep("POKE_storm17_08_23_fDOM",50),
                        rep("POKE_storm17_08_23_SPC",50),
                        rep("POKE_storm17_08_23_turb",50),
                        rep("POKE_storm17_08_23_abs",50),
                        rep("POKE_storm18_08_25_NO3",50),
                        rep("POKE_storm18_08_25_fDOM",50),
                        rep("POKE_storm18_08_25_SPC",50),      
                        rep("POKE_storm18_08_25_turb",50),
                        rep("POKE_storm18_08_25_abs",50),
                        rep("POKE_storm19_08_27_NO3",50),
                        rep("POKE_storm19_08_27_fDOM",50),
                        rep("POKE_storm19_08_27_SPC",50),
                        rep("POKE_storm19_08_27_turb",50),
                        rep("POKE_storm19_08_27_abs",50),
                        rep("POKE_storm20_09_01_NO3",50),
                        rep("POKE_storm20_09_01_fDOM",50),
                        
                        rep("POKE_storm20_09_01_turb",50),
                        rep("POKE_storm20_09_01_abs",50),
                        rep("POKE_storm21_09_03_NO3",50),
                        rep("POKE_storm21_09_03_fDOM",50),
                        rep("POKE_storm21_09_03_SPC",50),
                        rep("POKE_storm21_09_03_turb",50),
                        rep("POKE_storm21_09_03_abs",50),
                        rep("POKE_storm22a_09_07_NO3",49),
                        rep("POKE_storm22a_09_07_fDOM",50),
                        rep("POKE_storm22a_09_07_SPC",50),
                        rep("POKE_storm22a_09_07_turb",50),
                        rep("POKE_storm22a_09_07_abs",50),
                        rep("POKE_storm22b_09_09_NO3",50),
                        rep("POKE_storm22b_09_09_fDOM",50),
                        rep("POKE_storm22b_09_09_SPC",50),
                        rep("POKE_storm22b_09_09_turb",50),
                        rep("POKE_storm22b_09_09_abs",50))


POKE.HI.df$storm.ID = as.factor(POKE.HI.df$storm.ID)
POKE.HI.df = separate(data=POKE.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}


g0 <- ggplot(POKE.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/POKE/POKE.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/POKE/POKE.HI.df.csv")

POKE.HI.df$date <- as.Date(with(POKE.HI.df, paste(month, day, sep = "-")), "%m-%d")
POKE.HI.df$doy <- yday(POKE.HI.df$date) 

g0 <- ggplot(POKE.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/POKE/POKE.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/POKE/POKE.HI.df.doy.csv")

```


load CARI data to pandas
```{python}
# CARI #
CARI_storm1_06_15_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm1_06_15_Q.csv")
CARI_storm1_06_15_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm1_06_15_NO3.csv")
CARI_storm1_06_15_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm1_06_15_fDOM.csv")
CARI_storm1_06_15_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm1_06_15_SPC.csv")
CARI_storm1_06_15_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm1_06_15_Turb.csv")

CARI_storm2a_06_19_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2a_06_19_Q.csv")
CARI_storm2a_06_19_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2a_06_19_NO3.csv")
CARI_storm2a_06_19_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2a_06_19_fDOM.csv")
CARI_storm2a_06_19_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2a_06_19_SPC.csv")
CARI_storm2a_06_19_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2a_06_19_Turb.csv")

CARI_storm2b_06_20_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2b_06_20_Q.csv")
CARI_storm2b_06_20_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2b_06_20_NO3.csv")
CARI_storm2b_06_20_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2b_06_20_fDOM.csv")
CARI_storm2b_06_20_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2b_06_20_SPC.csv")
CARI_storm2b_06_20_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2b_06_20_Turb.csv")

CARI_storm2c_06_21_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2c_06_21_Q.csv")
CARI_storm2c_06_21_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2c_06_21_NO3.csv")
CARI_storm2c_06_21_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2c_06_21_fDOM.csv")
CARI_storm2c_06_21_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2c_06_21_SPC.csv")
CARI_storm2c_06_21_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm2c_06_21_Turb.csv")

CARI_storm3_06_23_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm3_06_23_Q.csv")
CARI_storm3_06_23_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm3_06_23_NO3.csv")
CARI_storm3_06_23_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm3_06_23_fDOM.csv")
CARI_storm3_06_23_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm3_06_23_SPC.csv")
CARI_storm3_06_23_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm3_06_23_Turb.csv")

CARI_storm4_07_09_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm4_07_09_Q.csv")
CARI_storm4_07_09_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm4_07_09_NO3.csv")
CARI_storm4_07_09_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm4_07_09_fDOM.csv")
CARI_storm4_07_09_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm4_07_09_SPC.csv")
CARI_storm4_07_09_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm4_07_09_Turb.csv")

CARI_storm5_07_13_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm5_07_13_Q.csv")
CARI_storm5_07_13_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm5_07_13_NO3.csv")
CARI_storm5_07_13_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm5_07_13_fDOM.csv")
CARI_storm5_07_13_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm5_07_13_SPC.csv")
CARI_storm5_07_13_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm5_07_13_Turb.csv")

CARI_storm6_07_24_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm6_07_24_Q.csv")
CARI_storm6_07_24_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm6_07_24_NO3.csv")
CARI_storm6_07_24_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm6_07_24_fDOM.csv")
CARI_storm6_07_24_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm6_07_24_SPC.csv")
CARI_storm6_07_24_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm6_07_24_Turb.csv")

CARI_storm7_07_27_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm7_07_27_Q.csv")
CARI_storm7_07_27_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm7_07_27_NO3.csv")
CARI_storm7_07_27_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm7_07_27_fDOM.csv")
CARI_storm7_07_27_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm7_07_27_SPC.csv")
CARI_storm7_07_27_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm7_07_27_Turb.csv")

CARI_storm8a_08_02_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8a_08_02_Q.csv")
CARI_storm8a_08_02_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8a_08_02_NO3.csv")
CARI_storm8a_08_02_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8a_08_02_fDOM.csv")
CARI_storm8a_08_02_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8a_08_02_SPC.csv")
CARI_storm8a_08_02_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8a_08_02_Turb.csv")

CARI_storm8b_08_03_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8b_08_03_Q.csv")
CARI_storm8b_08_03_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8b_08_03_NO3.csv")
CARI_storm8b_08_03_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8b_08_03_fDOM.csv")
CARI_storm8b_08_03_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8b_08_03_SPC.csv")
CARI_storm8b_08_03_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm8b_08_03_Turb.csv")

CARI_storm9_09_07_Q = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm9_09_07_Q.csv")
CARI_storm9_09_07_NO3 = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm9_09_07_NO3.csv")
CARI_storm9_09_07_fDOM =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm9_09_07_fDOM.csv")
CARI_storm9_09_07_SPC = pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm9_09_07_SPC.csv")
CARI_storm9_09_07_turb =pd.read_csv("~/Documents/Storms/Storm_Events/2020/CARI/CARI_storm9_09_07_Turb.csv")

```


CARI_storms
```{python}

## NO3 ##
CARI_storm1_06_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_15_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_15_NO3 = hysteresisMetrics(CARI_storm1_06_15_Q, CARI_storm1_06_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2a_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2a_06_19_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2a_06_19_NO3 = hysteresisMetrics(CARI_storm2a_06_19_Q, CARI_storm2a_06_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2b_06_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2b_06_20_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2b_06_20_NO3 = hysteresisMetrics(CARI_storm2b_06_20_Q, CARI_storm2b_06_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2c_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2c_06_21_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2c_06_21_NO3 = hysteresisMetrics(CARI_storm2c_06_21_Q, CARI_storm2c_06_21_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_23_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_23_NO3 = hysteresisMetrics(CARI_storm3_06_23_Q, CARI_storm3_06_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_09_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_09_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_09_NO3 = hysteresisMetrics(CARI_storm4_07_09_Q, CARI_storm4_07_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_13_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_13_NO3 = hysteresisMetrics(CARI_storm5_07_13_Q, CARI_storm5_07_13_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_07_24_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_07_24_NO3 = hysteresisMetrics(CARI_storm6_07_24_Q, CARI_storm6_07_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_07_27_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_07_27_NO3 = hysteresisMetrics(CARI_storm7_07_27_Q, CARI_storm7_07_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8a_08_02_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8a_08_02_NO3 = hysteresisMetrics(CARI_storm8a_08_02_Q, CARI_storm8a_08_02_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8b_08_03_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8b_08_03_NO3 = hysteresisMetrics(CARI_storm8b_08_03_Q, CARI_storm8b_08_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_09_07_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_09_07_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_09_07_NO3 = hysteresisMetrics(CARI_storm9_09_07_Q, CARI_storm9_09_07_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
CARI_storm1_06_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_15_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_15_fDOM = hysteresisMetrics(CARI_storm1_06_15_Q, CARI_storm1_06_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2a_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2a_06_19_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2a_06_19_fDOM = hysteresisMetrics(CARI_storm2a_06_19_Q, CARI_storm2a_06_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2b_06_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2b_06_20_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2b_06_20_fDOM = hysteresisMetrics(CARI_storm2b_06_20_Q, CARI_storm2b_06_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2c_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2c_06_21_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm2c_06_21_fDOM = hysteresisMetrics(CARI_storm2c_06_21_Q, CARI_storm2c_06_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_23_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_23_fDOM = hysteresisMetrics(CARI_storm3_06_23_Q, CARI_storm3_06_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_09_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_09_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_09_fDOM = hysteresisMetrics(CARI_storm4_07_09_Q, CARI_storm4_07_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_13_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 1 minutes between records
hysdict_CARI_storm5_07_13_fDOM = hysteresisMetrics(CARI_storm5_07_13_Q, CARI_storm5_07_13_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_07_24_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_07_24_fDOM = hysteresisMetrics(CARI_storm6_07_24_Q, CARI_storm6_07_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_07_27_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_07_27_fDOM = hysteresisMetrics(CARI_storm7_07_27_Q, CARI_storm7_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8a_08_02_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8a_08_02_fDOM = hysteresisMetrics(CARI_storm8a_08_02_Q, CARI_storm8a_08_02_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8b_08_03_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm8b_08_03_fDOM = hysteresisMetrics(CARI_storm8b_08_03_Q, CARI_storm8b_08_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_09_07_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_09_07_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_09_07_fDOM = hysteresisMetrics(CARI_storm9_09_07_Q, CARI_storm9_09_07_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
CARI_storm1_06_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_15_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_06_15_SPC = hysteresisMetrics(CARI_storm1_06_15_Q, CARI_storm1_06_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2a_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2a_06_19_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 1 5minutes between records
hysdict_CARI_storm2a_06_19_SPC = hysteresisMetrics(CARI_storm2a_06_19_Q, CARI_storm2a_06_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2b_06_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2b_06_20_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2b_06_20_SPC = hysteresisMetrics(CARI_storm2b_06_20_Q, CARI_storm2b_06_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2c_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2c_06_21_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2c_06_21_SPC = hysteresisMetrics(CARI_storm2c_06_21_Q, CARI_storm2c_06_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_23_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_23_SPC = hysteresisMetrics(CARI_storm3_06_23_Q, CARI_storm3_06_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_09_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_09_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_09_SPC = hysteresisMetrics(CARI_storm4_07_09_Q, CARI_storm4_07_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_13_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_13_SPC = hysteresisMetrics(CARI_storm5_07_13_Q, CARI_storm5_07_13_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_07_24_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_07_24_SPC = hysteresisMetrics(CARI_storm6_07_24_Q, CARI_storm6_07_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_07_27_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_07_27_SPC = hysteresisMetrics(CARI_storm7_07_27_Q, CARI_storm7_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8a_08_02_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8a_08_02_SPC = hysteresisMetrics(CARI_storm8a_08_02_Q, CARI_storm8a_08_02_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8b_08_03_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8b_08_03_SPC = hysteresisMetrics(CARI_storm8b_08_03_Q, CARI_storm8b_08_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_09_07_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_09_07_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_09_07_SPC = hysteresisMetrics(CARI_storm9_09_07_Q, CARI_storm9_09_07_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
CARI_storm1_06_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_06_15_turb['valuedatetime'] =  pd.to_datetime(CARI_storm1_06_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15# 15 minutes between records
hysdict_CARI_storm1_06_15_turb = hysteresisMetrics(CARI_storm1_06_15_Q, CARI_storm1_06_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2a_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2a_06_19_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2a_06_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2a_06_19_turb = hysteresisMetrics(CARI_storm2a_06_19_Q, CARI_storm2a_06_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2b_06_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2b_06_20_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2b_06_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2b_06_20_turb = hysteresisMetrics(CARI_storm2b_06_20_Q, CARI_storm2b_06_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2c_06_21_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2c_06_21_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2c_06_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2c_06_21_turb = hysteresisMetrics(CARI_storm2c_06_21_Q, CARI_storm2c_06_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_23_turb['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15minutes between records
hysdict_CARI_storm3_06_23_turb = hysteresisMetrics(CARI_storm3_06_23_Q, CARI_storm3_06_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_09_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_09_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_09_turb = hysteresisMetrics(CARI_storm4_07_09_Q, CARI_storm4_07_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_13_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_13_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_13_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_13_turb = hysteresisMetrics(CARI_storm5_07_13_Q, CARI_storm5_07_13_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_07_24_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6_07_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_07_24_turb = hysteresisMetrics(CARI_storm6_07_24_Q, CARI_storm6_07_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_07_27_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_07_27_turb = hysteresisMetrics(CARI_storm7_07_27_Q, CARI_storm7_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8a_08_02_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8a_08_02_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8a_08_02_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8a_08_02_turb = hysteresisMetrics(CARI_storm8a_08_02_Q, CARI_storm8a_08_02_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8b_08_03_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8b_08_03_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8b_08_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8b_08_03_turb = hysteresisMetrics(CARI_storm8b_08_03_Q, CARI_storm8b_08_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_09_07_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_09_07_turb['valuedatetime'] =  pd.to_datetime(CARI_storm9_09_07_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_09_07_turb = hysteresisMetrics(CARI_storm9_09_07_Q, CARI_storm9_09_07_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


```



CARI results
```{r}
CARI.hyst.results.list = list(
                              
                              py$hysdict_CARI_storm2a_06_19_NO3,
                              py$hysdict_CARI_storm2a_06_19_fDOM,
                              py$hysdict_CARI_storm2a_06_19_SPC,
                              py$hysdict_CARI_storm2a_06_19_turb,
                              
                              py$hysdict_CARI_storm2b_06_20_NO3,
                              
                              py$hysdict_CARI_storm2b_06_20_SPC,
                              py$hysdict_CARI_storm2b_06_20_turb,
                              py$hysdict_CARI_storm2c_06_21_NO3,
                             
                              py$hysdict_CARI_storm2c_06_21_SPC,
                              py$hysdict_CARI_storm2c_06_21_turb,
                              py$hysdict_CARI_storm3_06_23_NO3,
                              
                              py$hysdict_CARI_storm3_06_23_SPC,
                              py$hysdict_CARI_storm3_06_23_turb,
                              py$hysdict_CARI_storm4_07_09_NO3,
                              py$hysdict_CARI_storm4_07_09_fDOM,
                              py$hysdict_CARI_storm4_07_09_SPC,
                              py$hysdict_CARI_storm4_07_09_turb,
                              py$hysdict_CARI_storm5_07_13_NO3,
                              py$hysdict_CARI_storm5_07_13_fDOM,
                              py$hysdict_CARI_storm5_07_13_SPC,
                              py$hysdict_CARI_storm5_07_13_turb,
                              py$hysdict_CARI_storm6_07_24_NO3,
                              
                              py$hysdict_CARI_storm6_07_24_SPC,
                              py$hysdict_CARI_storm6_07_24_turb,
                              py$hysdict_CARI_storm7_07_27_NO3,
                              py$hysdict_CARI_storm7_07_27_fDOM,
                              py$hysdict_CARI_storm7_07_27_SPC,
                              py$hysdict_CARI_storm7_07_27_turb,
                              py$hysdict_CARI_storm8a_08_02_NO3,
                              py$hysdict_CARI_storm8a_08_02_fDOM,
                              py$hysdict_CARI_storm8a_08_02_SPC,
                              py$hysdict_CARI_storm8a_08_02_turb,
                              py$hysdict_CARI_storm8b_08_03_NO3,
                              py$hysdict_CARI_storm8b_08_03_fDOM,
                              py$hysdict_CARI_storm8b_08_03_SPC,
                              py$hysdict_CARI_storm8b_08_03_turb,
                              py$hysdict_CARI_storm9_09_07_NO3,
                              py$hysdict_CARI_storm9_09_07_fDOM,
                              py$hysdict_CARI_storm9_09_07_SPC,
                              py$hysdict_CARI_storm9_09_07_turb)


CARI.hyst.results.list.2 = list()
for (i in 1:length(CARI.hyst.results.list)){
CARI.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
CARI.hyst.results.list[[i]][["HI_mean_with_Interp"]],
CARI.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
CARI.hyst.results.list[[i]][["Normalized slope of response"]],
CARI.hyst.results.list[[i]][["interpolated Max width of response"]],
CARI.hyst.results.list[[i]][["Min response"]],
CARI.hyst.results.list[[i]][["Max response"]],
CARI.hyst.results.list[[i]][["Peak Q"]]
))))
names(CARI.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(CARI.hyst.results.list)){
  HIs.list[[i]] = unlist(CARI.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

CARI.hyst.results.list.3 =list()
for (i in 1:length(CARI.hyst.results.list)){
  CARI.hyst.results.list.3[[i]] = cbind(CARI.hyst.results.list.2[[i]], HIs.tests[[i]])
}

CARI.hyst.results.df = bind_rows(CARI.hyst.results.list.3, .id = "column_label")


CARI.hyst.results.df$storm.ID = c(
                              
                              "CARI_storm2a_06_19_NO3",
                              "CARI_storm2a_06_19_fDOM",
                              "CARI_storm2a_06_19_SPC",
                              "CARI_storm2a_06_19_turb",
                              "CARI_storm2b_06_20_NO3",
                              
                              "CARI_storm2b_06_20_SPC",
                              "CARI_storm2b_06_20_turb",
                              "CARI_storm2c_06_21_NO3",
                              
                              "CARI_storm2c_06_21_SPC",
                              "CARI_storm2c_06_21_turb",
                              "CARI_storm3_06_23_NO3",
                              "CARI_storm3_06_23_SPC",
                              "CARI_storm3_06_23_turb",
                              "CARI_storm4_07_09_NO3",
                              "CARI_storm4_07_09_fDOM",
                              "CARI_storm4_07_09_SPC",
                              "CARI_storm4_07_09_turb",
                              "CARI_storm5_07_13_NO3",
                              "CARI_storm5_07_13_fDOM",
                              "CARI_storm5_07_13_SPC",
                              "CARI_storm5_07_13_turb",
                              "CARI_storm6_07_24_NO3",
                              
                              "CARI_storm6_07_24_SPC",
                              "CARI_storm6_07_24_turb",
                              "CARI_storm7_07_27_NO3",
                              "CARI_storm7_07_27_fDOM",
                              "CARI_storm7_07_27_SPC",
                              "CARI_storm7_07_27_turb",
                              "CARI_storm8a_08_02_NO3",
                              "CARI_storm8a_08_02_fDOM",
                              "CARI_storm8a_08_02_SPC",
                              "CARI_storm8a_08_02_turb",
                              "CARI_storm8b_08_03_NO3",
                              "CARI_storm8b_08_03_fDOM",
                              "CARI_storm8b_08_03_SPC",
                              "CARI_storm8b_08_03_turb",
                              "CARI_storm9_09_07_NO3",
                              "CARI_storm9_09_07_fDOM",
                              "CARI_storm9_09_07_SPC",
                              "CARI_storm9_09_07_turb"
                              )
                            

CARI.hyst.results.df$site.ID = "CARI"

write.csv(CARI.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/CARI/CARI.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/CARI/CARI.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= CARI.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

CARI.HI.df = bind_rows(HIs.df.list, .id = "column_label")

test <- CARI.HI.df %>%
    group_by(column_label) %>%
    mutate(Diff = Q_interval - lag(Q_interval))

CARI.HI.df$storm.ID = c(
                        
                        rep("CARI_storm2a_06_19_NO3", 50),
                        rep("CARI_storm2a_06_19_fDOM", 50),
                        rep("CARI_storm2a_06_19_SPC", 50),
                        rep("CARI_storm2a_06_19_turb", 50),
                        rep("CARI_storm2b_06_20_NO3", 50),
                       
                        rep("CARI_storm2b_06_20_SPC", 50),
                        rep("CARI_storm2b_06_20_turb", 50),
                        rep("CARI_storm2c_06_21_NO3", 50),
                        
                        rep("CARI_storm2c_06_21_SPC", 50),
                        rep("CARI_storm2c_06_21_turb", 50),
                        rep("CARI_storm3_06_23_NO3", 49),
                        rep("CARI_storm3_06_23_SPC", 50),
                        rep("CARI_storm3_06_23_turb", 50),
                        rep("CARI_storm4_07_09_NO3", 50),
                        rep("CARI_storm4_07_09_fDOM", 50),
                        rep("CARI_storm4_07_09_SPC", 50),
                        rep("CARI_storm4_07_09_turb", 50),
                        rep("CARI_storm5_07_13_NO3", 50),
                        rep("CARI_storm5_07_13_fDOM", 50),
                        rep("CARI_storm5_07_13_SPC", 50),
                        rep("CARI_storm5_07_13_turb", 50),
                        rep("CARI_storm6_07_24_NO3", 49),
                        
                        rep("CARI_storm6_07_24_SPC", 50),
                        rep("CARI_storm6_07_24_turb", 50),
                        rep("CARI_storm7_07_27_NO3", 49),
                        rep("CARI_storm7_07_27_fDOM", 50),
                        rep("CARI_storm7_07_27_SPC", 50),
                        rep("CARI_storm7_07_27_turb", 50),
                        rep("CARI_storm8a_08_02_NO3", 50),
                        rep("CARI_storm8a_08_02_fDOM", 50),
                        rep("CARI_storm8a_08_02_SPC", 50),
                        rep("CARI_storm8a_08_02_turb", 50),
                        rep("CARI_storm8b_08_03_NO3", 50),
                        rep("CARI_storm8b_08_03_fDOM", 50),
                        rep("CARI_storm8b_08_03_SPC", 50),
                        rep("CARI_storm8b_08_03_turb", 50),
                        rep("CARI_storm9_09_07_NO3", 50),
                        rep("CARI_storm9_09_07_fDOM", 50),
                        rep("CARI_storm9_09_07_SPC", 50),
                        rep("CARI_storm9_09_07_turb", 50))


CARI.HI.df$storm.ID = as.factor(CARI.HI.df$storm.ID)
CARI.HI.df = separate(data=CARI.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}


g0 <- ggplot(CARI.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/CARI/CARI.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/CARI/CARI.HI.df.csv")

CARI.HI.df$date <- as.Date(with(CARI.HI.df, paste(month, day, sep = "-")), "%m-%d")
CARI.HI.df$doy <- yday(CARI.HI.df$date) 

g0 <- ggplot(CARI.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2020/CARI/CARI.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2020/CARI/CARI.HI.df.doy.csv")

```


###################################################################################################################################################### 2021 ####################################################
########################################################################################################

### Load data to pandas 2021 
```{python}
# VAUL #
VAUL_storm1b_07_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm1b_07_27_Q.csv")
VAUL_storm1b_07_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm1b_07_27_NO3.csv")
VAUL_storm1b_07_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm1b_07_27_fDOM.csv")
VAUL_storm1b_07_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm1b_07_27_SPC.csv")
VAUL_storm1b_07_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm1b_07_27_turb.csv")
VAUL_storm1b_07_27_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm1b_07_27_abs.csv")

# VAUL_storm1b_07_27_Q = VAUL_storm1b_07_27_Q.dropna(subset=['datavalue'])
# VAUL_storm1b_07_27_NO3 = VAUL_storm1b_07_27_NO3.dropna(subset=['datavalue'])
# VAUL_storm1b_07_27_fDOM = VAUL_storm1b_07_27_fDOM.dropna(subset=['datavalue'])
# VAUL_storm1b_07_27_SPC = VAUL_storm1b_07_27_SPC.dropna(subset=['datavalue'])
# VAUL_storm1b_07_27_turb = VAUL_storm1b_07_27_turb.dropna(subset=['datavalue'])

VAUL_storm3_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm3_08_08_Q.csv")
VAUL_storm3_08_08_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm3_08_08_NO3.csv")
VAUL_storm3_08_08_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm3_08_08_fDOM.csv")
VAUL_storm3_08_08_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm3_08_08_SPC.csv")
VAUL_storm3_08_08_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm3_08_08_turb.csv")
VAUL_storm3_08_08_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm3_08_08_abs.csv")

# VAUL_storm3_08_08_Q = VAUL_storm3_08_08_Q.dropna(subset=['datavalue'])
# VAUL_storm3_08_08_NO3 = VAUL_storm3_08_08_NO3.dropna(subset=['datavalue'])
# VAUL_storm3_08_08_fDOM = VAUL_storm3_08_08_fDOM.dropna(subset=['datavalue'])
# VAUL_storm3_08_08_SPC = VAUL_storm3_08_08_SPC.dropna(subset=['datavalue'])
# VAUL_storm3_08_08_turb = VAUL_storm3_08_08_turb.dropna(subset=['datavalue'])

VAUL_storm4a_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4a_08_15_Q.csv")
VAUL_storm4a_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4a_08_15_NO3.csv")
VAUL_storm4a_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4a_08_15_fDOM.csv")
VAUL_storm4a_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4a_08_15_SPC.csv")
VAUL_storm4a_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4a_08_15_turb.csv")
VAUL_storm4a_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4a_08_15_abs.csv")

# VAUL_storm4a_08_15_Q = VAUL_storm4a_08_15_Q.dropna(subset=['datavalue'])
# VAUL_storm4a_08_15_NO3 = VAUL_storm4a_08_15_NO3.dropna(subset=['datavalue'])
# VAUL_storm4a_08_15_fDOM = VAUL_storm4a_08_15_fDOM.dropna(subset=['datavalue'])
# VAUL_storm4a_08_15_SPC = VAUL_storm4a_08_15_SPC.dropna(subset=['datavalue'])
# VAUL_storm4a_08_15_turb = VAUL_storm4a_08_15_turb.dropna(subset=['datavalue'])

VAUL_storm4b_08_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4b_08_20_Q.csv")
VAUL_storm4b_08_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4b_08_20_NO3.csv")
VAUL_storm4b_08_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4b_08_20_fDOM.csv")
VAUL_storm4b_08_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4b_08_20_SPC.csv")
VAUL_storm4b_08_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4b_08_20_turb.csv")
VAUL_storm4b_08_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm4b_08_20_abs.csv")

# VAUL_storm4b_08_20_Q = VAUL_storm4b_08_20_Q.dropna(subset=['datavalue'])
# VAUL_storm4b_08_20_NO3 = VAUL_storm4b_08_20_NO3.dropna(subset=['datavalue'])
# VAUL_storm4b_08_20_fDOM = VAUL_storm4b_08_20_fDOM.dropna(subset=['datavalue'])
# VAUL_storm4b_08_20_SPC = VAUL_storm4b_08_20_SPC.dropna(subset=['datavalue'])
# VAUL_storm4b_08_20_turb = VAUL_storm4b_08_20_turb.dropna(subset=['datavalue'])

VAUL_storm5a_08_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5a_08_23_Q.csv")
VAUL_storm5a_08_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5a_08_23_NO3.csv")
VAUL_storm5a_08_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5a_08_23_fDOM.csv")
VAUL_storm5a_08_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5a_08_23_SPC.csv")
VAUL_storm5a_08_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5a_08_23_turb.csv")
VAUL_storm5a_08_23_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5a_08_23_abs.csv")

# VAUL_storm5a_08_23_Q = VAUL_storm5a_08_23_Q.dropna(subset=['datavalue'])
# VAUL_storm5a_08_23_NO3 = VAUL_storm5a_08_23_NO3.dropna(subset=['datavalue'])
# VAUL_storm5a_08_23_fDOM = VAUL_storm5a_08_23_fDOM.dropna(subset=['datavalue'])
# VAUL_storm5a_08_23_SPC = VAUL_storm5a_08_23_SPC.dropna(subset=['datavalue'])
# VAUL_storm5a_08_23_turb = VAUL_storm5a_08_23_turb.dropna(subset=['datavalue'])

VAUL_storm5b_08_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5b_08_26_Q.csv")
VAUL_storm5b_08_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5b_08_26_NO3.csv")
VAUL_storm5b_08_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5b_08_26_fDOM.csv")
VAUL_storm5b_08_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5b_08_26_SPC.csv")
VAUL_storm5b_08_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5b_08_26_turb.csv")
VAUL_storm5b_08_26_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/VAUL/VAUL_storm5b_08_26_abs.csv")

# VAUL_storm5b_08_26_Q = VAUL_storm5b_08_26_Q.dropna(subset=['datavalue'])
# VAUL_storm5b_08_26_NO3 = VAUL_storm5b_08_26_NO3.dropna(subset=['datavalue'])
# VAUL_storm5b_08_26_fDOM = VAUL_storm5b_08_26_fDOM.dropna(subset=['datavalue'])
# VAUL_storm5b_08_26_SPC = VAUL_storm5b_08_26_SPC.dropna(subset=['datavalue'])
# VAUL_storm5b_08_26_turb = VAUL_storm5b_08_26_turb.dropna(subset=['datavalue'])

```



VAUL_storms
```{python}
## NO3 ##
VAUL_storm1b_07_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_07_27_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_07_27_NO3 = hysteresisMetrics(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_08_08_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_08_08_NO3 = hysteresisMetrics(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_15_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_15_NO3 = hysteresisMetrics(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_20_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_20_NO3 = hysteresisMetrics(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5a_08_23_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5a_08_23_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5a_08_23_NO3 = hysteresisMetrics(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5b_08_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5b_08_26_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5b_08_26_NO3 = hysteresisMetrics(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
VAUL_storm1b_07_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_07_27_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_07_27_fDOM = hysteresisMetrics(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


VAUL_storm3_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_08_08_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_08_08_fDOM = hysteresisMetrics(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_15_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_15_fDOM = hysteresisMetrics(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_20_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_20_fDOM = hysteresisMetrics(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5a_08_23_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5a_08_23_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5a_08_23_fDOM = hysteresisMetrics(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5b_08_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5b_08_26_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5b_08_26_fDOM = hysteresisMetrics(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
VAUL_storm1b_07_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_07_27_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_07_27_SPC = hysteresisMetrics(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_08_08_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_08_08_SPC = hysteresisMetrics(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_15_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_15_SPC = hysteresisMetrics(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_20_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_20_SPC = hysteresisMetrics(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5a_08_23_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5a_08_23_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5a_08_23_SPC = hysteresisMetrics(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5b_08_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5b_08_26_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5b_08_26_SPC = hysteresisMetrics(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
VAUL_storm1b_07_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_07_27_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_07_27_turb = hysteresisMetrics(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_08_08_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_08_08_turb = hysteresisMetrics(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_15_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_15_turb = hysteresisMetrics(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_20_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_20_turb = hysteresisMetrics(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5a_08_23_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5a_08_23_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5a_08_23_turb = hysteresisMetrics(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5b_08_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5b_08_26_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5b_08_26_turb = hysteresisMetrics(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
VAUL_storm1b_07_27_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1b_07_27_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm1b_07_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1b_07_27_abs = hysteresisMetrics(VAUL_storm1b_07_27_Q, VAUL_storm1b_07_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm3_08_08_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm3_08_08_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm3_08_08_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm3_08_08_abs = hysteresisMetrics(VAUL_storm3_08_08_Q, VAUL_storm3_08_08_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4a_08_15_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm4a_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4a_08_15_abs = hysteresisMetrics(VAUL_storm4a_08_15_Q, VAUL_storm4a_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm4b_08_20_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm4b_08_20_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm4b_08_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm4b_08_20_abs = hysteresisMetrics(VAUL_storm4b_08_20_Q, VAUL_storm4b_08_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5a_08_23_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5a_08_23_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm5a_08_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5a_08_23_abs = hysteresisMetrics(VAUL_storm5a_08_23_Q, VAUL_storm5a_08_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm5b_08_26_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm5b_08_26_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm5b_08_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm5b_08_26_abs = hysteresisMetrics(VAUL_storm5b_08_26_Q, VAUL_storm5b_08_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

VAUL results
```{r}
VAUL.hyst.results.list = list(
                              py$hysdict_VAUL_storm1b_07_27_NO3,
                              py$hysdict_VAUL_storm1b_07_27_fDOM,
                              py$hysdict_VAUL_storm1b_07_27_SPC,
                              py$hysdict_VAUL_storm1b_07_27_turb,
                              py$hysdict_VAUL_storm1b_07_27_abs,
                              
                              py$hysdict_VAUL_storm3_08_08_NO3,
                              py$hysdict_VAUL_storm3_08_08_fDOM,
                              py$hysdict_VAUL_storm3_08_08_SPC,
                              py$hysdict_VAUL_storm3_08_08_turb,
                              py$hysdict_VAUL_storm3_08_08_abs,
                              py$hysdict_VAUL_storm4a_08_15_NO3,
                              py$hysdict_VAUL_storm4a_08_15_fDOM,
                              py$hysdict_VAUL_storm4a_08_15_SPC,
                              py$hysdict_VAUL_storm4a_08_15_turb,
                              py$hysdict_VAUL_storm4a_08_15_abs,
                              py$hysdict_VAUL_storm4b_08_20_fDOM,
                              py$hysdict_VAUL_storm4b_08_20_SPC,
                              py$hysdict_VAUL_storm4b_08_20_turb,
                              py$hysdict_VAUL_storm4b_08_20_abs,
                              py$hysdict_VAUL_storm5a_08_23_fDOM,
                              py$hysdict_VAUL_storm5a_08_23_SPC,
                              py$hysdict_VAUL_storm5a_08_23_turb,
                              
                              py$hysdict_VAUL_storm5b_08_26_fDOM,
                              py$hysdict_VAUL_storm5b_08_26_SPC,
                              py$hysdict_VAUL_storm5b_08_26_turb,
                              py$hysdict_VAUL_storm5b_08_26_abs)
                              
                              

VAUL.hyst.results.list.2 = list()
for (i in 1:length(VAUL.hyst.results.list)){
VAUL.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
VAUL.hyst.results.list[[i]][["HI_mean_with_Interp"]],
VAUL.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
VAUL.hyst.results.list[[i]][["Normalized slope of response"]],
VAUL.hyst.results.list[[i]][["interpolated Max width of response"]],
VAUL.hyst.results.list[[i]][["Min response"]],
VAUL.hyst.results.list[[i]][["Max response"]],
VAUL.hyst.results.list[[i]][["Peak Q"]]
))))
names(VAUL.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(VAUL.hyst.results.list)){
  HIs.list[[i]] = unlist(VAUL.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

VAUL.hyst.results.list.3 =list()
for (i in 1:length(VAUL.hyst.results.list)){
  VAUL.hyst.results.list.3[[i]] = cbind(VAUL.hyst.results.list.2[[i]], HIs.tests[[i]])
}

VAUL.hyst.results.df = bind_rows(VAUL.hyst.results.list.3, .id = "column_label")

VAUL.hyst.results.df$storm.ID = c(
                                  "VAUL_storm1b_07_27_NO3",
                                  "VAUL_storm1b_07_27_fDOM",
                                  "VAUL_storm1b_07_27_SPC",
                                  "VAUL_storm1b_07_27_turb",
                                  "VAUL_storm1b_07_27_abs",
                                  
                                  "VAUL_storm3_08_08_NO3",
                                  "VAUL_storm3_08_08_fDOM",
                                  "VAUL_storm3_08_08_SPC",
                                  "VAUL_storm3_08_08_turb",
                                  "VAUL_storm3_08_08_abs",
                                  "VAUL_storm4a_08_15_NO3",
                                  "VAUL_storm4a_08_15_fDOM",
                                  "VAUL_storm4a_08_15_SPC",
                                  "VAUL_storm4a_08_15_turb",
                                  "VAUL_storm4a_08_15_abs",
                                  "VAUL_storm4b_08_20_fDOM",
                                  "VAUL_storm4b_08_20_SPC",
                                  "VAUL_storm4b_08_20_turb",
                                  "VAUL_storm4b_08_20_abs",
                                  "VAUL_storm5a_08_23_fDOM",
                                  "VAUL_storm5a_08_23_SPC",
                                  "VAUL_storm5a_08_23_turb",
                                  "VAUL_storm5b_08_26_fDOM",
                                  "VAUL_storm5b_08_26_SPC",
                                  "VAUL_storm5b_08_26_turb",
                                  "VAUL_storm5b_08_26_abs"
                                  )


VAUL.hyst.results.df$site.ID = "VAUL"

write.csv(VAUL.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/VAUL/VAUL.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
# pdf("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/VAUL/VAUL.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= VAUL.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

VAUL.HI.df = bind_rows(HIs.df.list, .id = "column_label")
VAUL.HI.df$storm.ID = c(
                        rep("VAUL_storm1b_07_27_NO3", 50),
                        rep("VAUL_storm1b_07_27_fDOM", 50),
                        rep("VAUL_storm1b_07_27_SPC", 50),
                        rep("VAUL_storm1b_07_27_turb", 50),
                        rep("VAUL_storm1b_07_27_abs", 50),
                        
                        rep("VAUL_storm3_08_08_NO3", 50),
                        rep("VAUL_storm3_08_08_fDOM", 50),
                        rep("VAUL_storm3_08_08_SPC", 50),
                        rep("VAUL_storm3_08_08_turb", 50),
                        rep("VAUL_storm3_08_08_abs", 50),
                        rep("VAUL_storm4a_08_15_NO3", 50),
                        rep("VAUL_storm4a_08_15_fDOM", 50),
                        rep("VAUL_storm4a_08_15_SPC", 50),
                        rep("VAUL_storm4a_08_15_turb", 50),
                        rep("VAUL_storm4a_08_15_abs", 50),
                        rep("VAUL_storm4b_08_20_fDOM", 50),
                        rep("VAUL_storm4b_08_20_SPC", 50),
                        rep("VAUL_storm4b_08_20_turb", 50),
                        rep("VAUL_storm4b_08_20_abs", 50),
                        rep("VAUL_storm5a_08_23_fDOM", 50),
                        rep("VAUL_storm5a_08_23_SPC", 50),
                        rep("VAUL_storm5a_08_23_turb", 50),
                        rep("VAUL_storm5b_08_26_fDOM", 50),
                        rep("VAUL_storm5b_08_26_SPC", 50),
                        rep("VAUL_storm5b_08_26_turb", 50),
                        rep("VAUL_storm5b_08_26_abs", 49))

VAUL.HI.df$storm.ID = as.factor(VAUL.HI.df$storm.ID)
VAUL.HI.df = separate(data=VAUL.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(VAUL.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/VAUL/VAUL.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/VAUL/VAUL.HI.df.csv")


VAUL.HI.df$date <- as.Date(with(VAUL.HI.df, paste(month, day, sep = "-")), "%m-%d")
VAUL.HI.df$doy <- yday(VAUL.HI.df$date) 

g0 <- ggplot(VAUL.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/VAUL/VAUL.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/VAUL/VAUL.HI.df.doy.csv")

```


MOOS
```{python}
# MOOS #
MOOS_storm1_07_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm1_07_23_Q.csv")
MOOS_storm1_07_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm1_07_23_NO3.csv")
MOOS_storm1_07_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm1_07_23_fDOM.csv")
MOOS_storm1_07_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm1_07_23_SPC.csv")
MOOS_storm1_07_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm1_07_23_turb.csv")
MOOS_storm1_07_23_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm1_07_23_abs.csv")

# MOOS_storm1_07_23_Q = MOOS_storm1_07_23_Q.dropna(subset=['datavalue'])
# MOOS_storm1_07_23_NO3 = MOOS_storm1_07_23_NO3.dropna(subset=['datavalue'])
# MOOS_storm1_07_23_fDOM = MOOS_storm1_07_23_fDOM.dropna(subset=['datavalue'])
# MOOS_storm1_07_23_SPC = MOOS_storm1_07_23_SPC.dropna(subset=['datavalue'])
# MOOS_storm1_07_23_turb = MOOS_storm1_07_23_turb.dropna(subset=['datavalue'])

MOOS_storm2_07_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm2_07_27_Q.csv")
MOOS_storm2_07_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm2_07_27_fDOM.csv")
MOOS_storm2_07_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm2_07_27_SPC.csv")
MOOS_storm2_07_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm2_07_27_turb.csv")
MOOS_storm2_07_27_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm2_07_27_abs.csv")

# MOOS_storm2_07_27_Q = MOOS_storm2_07_27_Q.dropna(subset=['datavalue'])
# MOOS_storm2_07_27_fDOM = MOOS_storm2_07_27_fDOM.dropna(subset=['datavalue'])
# MOOS_storm2_07_27_SPC = MOOS_storm2_07_27_SPC.dropna(subset=['datavalue'])
# MOOS_storm2_07_27_turb = MOOS_storm2_07_27_turb.dropna(subset=['datavalue'])

MOOS_storm3a_08_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3a_08_06_Q.csv")
MOOS_storm3a_08_06_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3a_08_06_fDOM.csv")
MOOS_storm3a_08_06_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3a_08_06_SPC.csv")
MOOS_storm3a_08_06_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3a_08_06_turb.csv")
MOOS_storm3a_08_06_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3a_08_06_abs.csv")

# MOOS_storm3a_08_06_Q = MOOS_storm3a_08_06_Q.dropna(subset=['datavalue'])
# MOOS_storm3a_08_06_fDOM = MOOS_storm3a_08_06_fDOM.dropna(subset=['datavalue'])
# MOOS_storm3a_08_06_SPC = MOOS_storm3a_08_06_SPC.dropna(subset=['datavalue'])
# MOOS_storm3a_08_06_turb = MOOS_storm3a_08_06_turb.dropna(subset=['datavalue'])

MOOS_storm3b_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3b_08_08_Q.csv")
MOOS_storm3b_08_08_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3b_08_08_fDOM.csv")
MOOS_storm3b_08_08_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3b_08_08_SPC.csv")
MOOS_storm3b_08_08_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3b_08_08_turb.csv")
MOOS_storm3b_08_08_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm3b_08_08_abs.csv")

# MOOS_storm3b_08_08_Q = MOOS_storm3b_08_08_Q.dropna(subset=['datavalue'])
# MOOS_storm3b_08_08_fDOM = MOOS_storm3b_08_08_fDOM.dropna(subset=['datavalue'])
# MOOS_storm3b_08_08_SPC = MOOS_storm3b_08_08_SPC.dropna(subset=['datavalue'])
# MOOS_storm3b_08_08_turb = MOOS_storm3b_08_08_turb.dropna(subset=['datavalue'])

MOOS_storm4a_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4a_08_15_Q.csv")
MOOS_storm4a_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4a_08_15_fDOM.csv")
MOOS_storm4a_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4a_08_15_SPC.csv")
MOOS_storm4a_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4a_08_15_turb.csv")
MOOS_storm4a_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4a_08_15_abs.csv")

# MOOS_storm4a_08_15_Q = MOOS_storm4a_08_15_Q.dropna(subset=['datavalue'])
# MOOS_storm4a_08_15_fDOM = MOOS_storm4a_08_15_fDOM.dropna(subset=['datavalue'])
# MOOS_storm4a_08_15_SPC = MOOS_storm4a_08_15_SPC.dropna(subset=['datavalue'])
# MOOS_storm4a_08_15_turb = MOOS_storm4a_08_15_turb.dropna(subset=['datavalue'])

MOOS_storm4b_08_17_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4b_08_17_Q.csv")
MOOS_storm4b_08_17_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4b_08_17_fDOM.csv")
MOOS_storm4b_08_17_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4b_08_17_SPC.csv")
MOOS_storm4b_08_17_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4b_08_17_turb.csv")
MOOS_storm4b_08_17_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm4b_08_17_abs.csv")

# MOOS_storm4b_08_17_Q = MOOS_storm4b_08_17_Q.dropna(subset=['datavalue'])
# MOOS_storm4b_08_17_fDOM = MOOS_storm4b_08_17_fDOM.dropna(subset=['datavalue'])
# MOOS_storm4b_08_17_SPC = MOOS_storm4b_08_17_SPC.dropna(subset=['datavalue'])
# MOOS_storm4b_08_17_turb = MOOS_storm4b_08_17_turb.dropna(subset=['datavalue'])

MOOS_storm5a_08_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5a_08_19_Q.csv")
MOOS_storm5a_08_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5a_08_19_fDOM.csv")
MOOS_storm5a_08_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5a_08_19_SPC.csv")
MOOS_storm5a_08_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5a_08_19_turb.csv")
MOOS_storm5a_08_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5a_08_19_abs.csv")

# MOOS_storm5a_08_19_Q = MOOS_storm5a_08_19_Q.dropna(subset=['datavalue'])
# MOOS_storm5a_08_19_fDOM = MOOS_storm5a_08_19_fDOM.dropna(subset=['datavalue'])
# MOOS_storm5a_08_19_SPC = MOOS_storm5a_08_19_SPC.dropna(subset=['datavalue'])
# MOOS_storm5a_08_19_turb = MOOS_storm5a_08_19_turb.dropna(subset=['datavalue'])

MOOS_storm5b_08_21_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5b_08_21_Q.csv")
MOOS_storm5b_08_21_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5b_08_21_fDOM.csv")
MOOS_storm5b_08_21_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5b_08_21_SPC.csv")
MOOS_storm5b_08_21_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5b_08_21_turb.csv")
MOOS_storm5b_08_21_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm5b_08_21_abs.csv")

# MOOS_storm5b_08_21_Q = MOOS_storm5b_08_21_Q.dropna(subset=['datavalue'])
# MOOS_storm5b_08_21_fDOM = MOOS_storm5b_08_21_fDOM.dropna(subset=['datavalue'])
# MOOS_storm5b_08_21_SPC = MOOS_storm5b_08_21_SPC.dropna(subset=['datavalue'])
# MOOS_storm5b_08_21_turb = MOOS_storm5b_08_21_turb.dropna(subset=['datavalue'])

MOOS_storm6_08_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm6_08_25_Q.csv")
MOOS_storm6_08_25_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm6_08_25_fDOM.csv")
MOOS_storm6_08_25_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm6_08_25_SPC.csv")
MOOS_storm6_08_25_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm6_08_25_turb.csv")
MOOS_storm6_08_25_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm6_08_25_abs.csv")

# MOOS_storm6_08_25_Q = MOOS_storm6_08_25_Q.dropna(subset=['datavalue'])
# MOOS_storm6_08_25_fDOM = MOOS_storm6_08_25_fDOM.dropna(subset=['datavalue'])
# MOOS_storm6_08_25_SPC = MOOS_storm6_08_25_SPC.dropna(subset=['datavalue'])
# MOOS_storm6_08_25_turb = MOOS_storm6_08_25_turb.dropna(subset=['datavalue'])


MOOS_storm7_08_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm7_08_27_Q.csv")
MOOS_storm7_08_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm7_08_27_fDOM.csv")
MOOS_storm7_08_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm7_08_27_SPC.csv")
MOOS_storm7_08_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm7_08_27_turb.csv")
MOOS_storm7_08_27_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/MOOS/MOOS_storm7_08_27_abs.csv")

```

MOOS_storms
```{python}
## fDOM ##
MOOS_storm1_07_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_23_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_23_fDOM = hysteresisMetrics(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_27_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_27_fDOM = hysteresisMetrics(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_08_06_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_08_06_fDOM = hysteresisMetrics(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3b_08_08_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3b_08_08_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3b_08_08_fDOM = hysteresisMetrics(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4a_08_15_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4a_08_15_fDOM = hysteresisMetrics(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4b_08_17_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4b_08_17_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4b_08_17_fDOM = hysteresisMetrics(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5a_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5a_08_19_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5a_08_19_fDOM = hysteresisMetrics(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5b_08_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5b_08_21_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5b_08_21_fDOM = hysteresisMetrics(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_25_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_25_fDOM = hysteresisMetrics(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_27_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_27_fDOM = hysteresisMetrics(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## SPC ##
MOOS_storm1_07_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_23_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_23_SPC = hysteresisMetrics(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_27_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_27_SPC = hysteresisMetrics(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_08_06_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_08_06_SPC = hysteresisMetrics(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3b_08_08_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3b_08_08_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3b_08_08_SPC = hysteresisMetrics(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4a_08_15_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4a_08_15_SPC = hysteresisMetrics(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4b_08_17_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4b_08_17_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4b_08_17_SPC = hysteresisMetrics(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5a_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5a_08_19_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5a_08_19_SPC = hysteresisMetrics(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5b_08_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5b_08_21_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5b_08_21_SPC = hysteresisMetrics(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_25_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_25_SPC = hysteresisMetrics(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_27_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_27_SPC = hysteresisMetrics(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
MOOS_storm1_07_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_23_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_23_turb = hysteresisMetrics(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_27_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_27_turb = hysteresisMetrics(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_08_06_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_08_06_turb = hysteresisMetrics(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3b_08_08_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3b_08_08_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3b_08_08_turb = hysteresisMetrics(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4a_08_15_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4a_08_15_turb = hysteresisMetrics(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4b_08_17_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4b_08_17_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4b_08_17_turb = hysteresisMetrics(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5a_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5a_08_19_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5a_08_19_turb = hysteresisMetrics(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5b_08_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5b_08_21_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5b_08_21_turb = hysteresisMetrics(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_25_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_25_turb = hysteresisMetrics(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_27_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_27_turb = hysteresisMetrics(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
MOOS_storm1_07_23_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_23_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_23_abs = hysteresisMetrics(MOOS_storm1_07_23_Q, MOOS_storm1_07_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2_07_27_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm2_07_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2_07_27_abs = hysteresisMetrics(MOOS_storm2_07_27_Q, MOOS_storm2_07_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3a_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3a_08_06_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3a_08_06_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3a_08_06_abs = hysteresisMetrics(MOOS_storm3a_08_06_Q, MOOS_storm3a_08_06_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3b_08_08_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3b_08_08_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3b_08_08_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3b_08_08_abs = hysteresisMetrics(MOOS_storm3b_08_08_Q, MOOS_storm3b_08_08_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4a_08_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4a_08_15_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm4a_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4a_08_15_abs = hysteresisMetrics(MOOS_storm4a_08_15_Q, MOOS_storm4a_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4b_08_17_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4b_08_17_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm4b_08_17_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4b_08_17_abs = hysteresisMetrics(MOOS_storm4b_08_17_Q, MOOS_storm4b_08_17_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5a_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5a_08_19_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm5a_08_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5a_08_19_abs = hysteresisMetrics(MOOS_storm5a_08_19_Q, MOOS_storm5a_08_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm5b_08_21_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm5b_08_21_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm5b_08_21_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm5b_08_21_abs = hysteresisMetrics(MOOS_storm5b_08_21_Q, MOOS_storm5b_08_21_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm6_08_25_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm6_08_25_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm6_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm6_08_25_abs = hysteresisMetrics(MOOS_storm6_08_25_Q, MOOS_storm6_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm7_08_27_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm7_08_27_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm7_08_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm7_08_27_abs = hysteresisMetrics(MOOS_storm7_08_27_Q, MOOS_storm7_08_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

MOOS results
```{r}
MOOS.hyst.results.list = list(py$hysdict_MOOS_storm1_07_23_fDOM,
                              py$hysdict_MOOS_storm1_07_23_SPC,
                              py$hysdict_MOOS_storm1_07_23_turb,
                              py$hysdict_MOOS_storm2_07_27_fDOM,
                              py$hysdict_MOOS_storm2_07_27_SPC,
                              py$hysdict_MOOS_storm2_07_27_turb,
                              py$hysdict_MOOS_storm3a_08_06_fDOM,
                              py$hysdict_MOOS_storm3a_08_06_SPC,
                              py$hysdict_MOOS_storm3a_08_06_turb,
                              py$hysdict_MOOS_storm3b_08_08_fDOM,
                              py$hysdict_MOOS_storm3b_08_08_SPC,
                              py$hysdict_MOOS_storm3b_08_08_turb,
                              py$hysdict_MOOS_storm4a_08_15_fDOM,
                              py$hysdict_MOOS_storm4a_08_15_SPC,
                              py$hysdict_MOOS_storm4a_08_15_turb,
                              py$hysdict_MOOS_storm4b_08_17_fDOM,
                              py$hysdict_MOOS_storm4b_08_17_SPC,
                              py$hysdict_MOOS_storm4b_08_17_turb,
                              py$hysdict_MOOS_storm5a_08_19_fDOM,
                              py$hysdict_MOOS_storm5a_08_19_SPC,
                              py$hysdict_MOOS_storm5a_08_19_turb,
                              py$hysdict_MOOS_storm5b_08_21_fDOM,
                              py$hysdict_MOOS_storm5b_08_21_SPC,
                              py$hysdict_MOOS_storm5b_08_21_turb,
                              py$hysdict_MOOS_storm6_08_25_fDOM,
                              py$hysdict_MOOS_storm6_08_25_SPC,
                              py$hysdict_MOOS_storm6_08_25_turb,
                              py$hysdict_MOOS_storm7_08_27_fDOM,
                              py$hysdict_MOOS_storm7_08_27_SPC,
                              py$hysdict_MOOS_storm7_08_27_turb
                              )
                              
                              

MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c("MOOS_storm1_07_23_fDOM",
                                  "MOOS_storm1_07_23_SPC",
                                  "MOOS_storm1_07_23_turb",
                                  "MOOS_storm2_07_27_fDOM",
                                  "MOOS_storm2_07_27_SPC",
                                  "MOOS_storm2_07_27_turb",
                                  "MOOS_storm3a_08_06_fDOM",
                                  "MOOS_storm3a_08_06_SPC",
                                  "MOOS_storm3a_08_06_turb",
                                  "MOOS_storm3b_08_08_fDOM",
                                  "MOOS_storm3b_08_08_SPC",
                                  "MOOS_storm3b_08_08_turb",
                                  "MOOS_storm4a_08_15_fDOM",
                                  "MOOS_storm4a_08_15_SPC",
                                  "MOOS_storm4a_08_15_turb",
                                  "MOOS_storm4b_08_17_fDOM",
                                  "MOOS_storm4b_08_17_SPC",
                                  "MOOS_storm4b_08_17_turb",
                                  "MOOS_storm5a_08_19_fDOM",
                                  "MOOS_storm5a_08_19_SPC",
                                  "MOOS_storm5a_08_19_turb",
                                  "MOOS_storm5b_08_21_fDOM",
                                  "MOOS_storm5b_08_21_SPC",
                                  "MOOS_storm5b_08_21_turb",
                                  "MOOS_storm6_08_25_fDOM",
                                  "MOOS_storm6_08_25_SPC",
                                  "MOOS_storm6_08_25_turb",
                                  "MOOS_storm7_08_27_fDOM",
                                  "MOOS_storm7_08_27_SPC",
                                  "MOOS_storm7_08_27_turb"
                                  )


MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/MOOS/MOOS.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(rep("MOOS_storm1_07_23_fDOM", 50),
                        rep("MOOS_storm1_07_23_SPC", 50),
                        rep("MOOS_storm1_07_23_turb", 50),
                        rep("MOOS_storm2_07_27_fDOM", 50),
                        rep("MOOS_storm2_07_27_SPC", 50),
                        rep("MOOS_storm2_07_27_turb", 50),
                        rep("MOOS_storm3a_08_06_fDOM", 50),
                        rep("MOOS_storm3a_08_06_SPC", 50),
                        rep("MOOS_storm3a_08_06_turb", 50),
                        rep("MOOS_storm3b_08_08_fDOM", 50),
                        rep("MOOS_storm3b_08_08_SPC", 50),
                        rep("MOOS_storm3b_08_08_turb", 50),
                        rep("MOOS_storm4a_08_15_fDOM", 50),
                        rep("MOOS_storm4a_08_15_SPC", 50),
                        rep("MOOS_storm4a_08_15_turb", 50),
                        rep("MOOS_storm4b_08_17_fDOM", 50),
                        rep("MOOS_storm4b_08_17_SPC", 50),
                        rep("MOOS_storm4b_08_17_turb", 50),
                        rep("MOOS_storm5a_08_19_fDOM", 50),
                        rep("MOOS_storm5a_08_19_SPC", 50),
                        rep("MOOS_storm5a_08_19_turb", 50),
                        rep("MOOS_storm5b_08_21_fDOM", 50),
                        rep("MOOS_storm5b_08_21_SPC", 50),
                        rep("MOOS_storm5b_08_21_turb", 50),
                        rep("MOOS_storm6_08_25_fDOM", 50),
                        rep("MOOS_storm6_08_25_SPC", 50),
                        rep("MOOS_storm6_08_25_turb", 50),
                        rep("MOOS_storm7_08_27_fDOM", 50),
                        rep("MOOS_storm7_08_27_SPC", 50),
                        rep("MOOS_storm7_08_27_turb", 50))
                        

MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/MOOS/MOOS.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/MOOS/MOOS.HI.df.csv")


MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/MOOS/MOOS.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/MOOS/MOOS.HI.df.doy.csv")


```


FRCH
```{python}
# FRCH #
FRCH_storm2_07_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm2_07_27_Q.csv")
FRCH_storm2_07_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm2_07_27_NO3.csv")
FRCH_storm2_07_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm2_07_27_fDOM.csv")
FRCH_storm2_07_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm2_07_27_SPC.csv")
FRCH_storm2_07_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm2_07_27_turb.csv")
FRCH_storm2_07_27_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm2_07_27_abs.csv")

FRCH_storm2_07_27_Q = FRCH_storm2_07_27_Q.dropna(subset=['datavalue'])
FRCH_storm2_07_27_NO3 = FRCH_storm2_07_27_NO3.dropna(subset=['datavalue'])
FRCH_storm2_07_27_fDOM = FRCH_storm2_07_27_fDOM.dropna(subset=['datavalue'])
FRCH_storm2_07_27_SPC = FRCH_storm2_07_27_SPC.dropna(subset=['datavalue'])
FRCH_storm2_07_27_turb = FRCH_storm2_07_27_turb.dropna(subset=['datavalue'])
FRCH_storm2_07_27_abs = FRCH_storm2_07_27_abs.dropna(subset=['datavalue'])

FRCH_storm3_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm3_08_05_Q.csv")
FRCH_storm3_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm3_08_05_NO3.csv")
FRCH_storm3_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm3_08_05_fDOM.csv")
FRCH_storm3_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm3_08_05_SPC.csv")
FRCH_storm3_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm3_08_05_turb.csv")
FRCH_storm3_08_05_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm3_08_05_abs.csv")

FRCH_storm3_08_05_Q = FRCH_storm3_08_05_Q.dropna(subset=['datavalue'])
FRCH_storm3_08_05_NO3 = FRCH_storm3_08_05_NO3.dropna(subset=['datavalue'])
FRCH_storm3_08_05_fDOM = FRCH_storm3_08_05_fDOM.dropna(subset=['datavalue'])
FRCH_storm3_08_05_SPC = FRCH_storm3_08_05_SPC.dropna(subset=['datavalue'])
FRCH_storm3_08_05_turb = FRCH_storm3_08_05_turb.dropna(subset=['datavalue'])
FRCH_storm3_08_05_abs = FRCH_storm3_08_05_abs.dropna(subset=['datavalue'])

FRCH_storm4_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm4_08_08_Q.csv")
FRCH_storm4_08_08_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm4_08_08_NO3.csv")
FRCH_storm4_08_08_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm4_08_08_fDOM.csv")
FRCH_storm4_08_08_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm4_08_08_SPC.csv")
FRCH_storm4_08_08_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm4_08_08_turb.csv")
FRCH_storm4_08_08_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm4_08_08_abs.csv")

FRCH_storm4_08_08_Q = FRCH_storm4_08_08_Q.dropna(subset=['datavalue'])
FRCH_storm4_08_08_NO3 = FRCH_storm4_08_08_NO3.dropna(subset=['datavalue'])
FRCH_storm4_08_08_fDOM = FRCH_storm4_08_08_fDOM.dropna(subset=['datavalue'])
FRCH_storm4_08_08_SPC = FRCH_storm4_08_08_SPC.dropna(subset=['datavalue'])
FRCH_storm4_08_08_turb = FRCH_storm4_08_08_turb.dropna(subset=['datavalue'])
FRCH_storm4_08_08_abs = FRCH_storm4_08_08_abs.dropna(subset=['datavalue'])

FRCH_storm5a_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5a_08_15_Q.csv")
FRCH_storm5a_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5a_08_15_NO3.csv")
FRCH_storm5a_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5a_08_15_fDOM.csv")
FRCH_storm5a_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5a_08_15_SPC.csv")
FRCH_storm5a_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5a_08_15_turb.csv")
FRCH_storm5a_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5a_08_15_abs.csv")

FRCH_storm5a_08_15_Q = FRCH_storm5a_08_15_Q.dropna(subset=['datavalue'])
FRCH_storm5a_08_15_NO3 = FRCH_storm5a_08_15_NO3.dropna(subset=['datavalue'])
FRCH_storm5a_08_15_fDOM = FRCH_storm5a_08_15_fDOM.dropna(subset=['datavalue'])
FRCH_storm5a_08_15_SPC = FRCH_storm5a_08_15_SPC.dropna(subset=['datavalue'])
FRCH_storm5a_08_15_turb = FRCH_storm5a_08_15_turb.dropna(subset=['datavalue'])
FRCH_storm5a_08_15_abs = FRCH_storm5a_08_15_abs.dropna(subset=['datavalue'])

FRCH_storm5b_08_17_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5b_08_17_Q.csv")
FRCH_storm5b_08_17_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5b_08_17_NO3.csv")
FRCH_storm5b_08_17_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5b_08_17_fDOM.csv")
FRCH_storm5b_08_17_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5b_08_17_SPC.csv")
FRCH_storm5b_08_17_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5b_08_17_turb.csv")
FRCH_storm5b_08_17_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm5b_08_17_abs.csv")

FRCH_storm5b_08_17_Q = FRCH_storm5b_08_17_Q.dropna(subset=['datavalue'])
FRCH_storm5b_08_17_NO3 = FRCH_storm5b_08_17_NO3.dropna(subset=['datavalue'])
FRCH_storm5b_08_17_fDOM = FRCH_storm5b_08_17_fDOM.dropna(subset=['datavalue'])
FRCH_storm5b_08_17_SPC = FRCH_storm5b_08_17_SPC.dropna(subset=['datavalue'])
FRCH_storm5b_08_17_turb = FRCH_storm5b_08_17_turb.dropna(subset=['datavalue'])
FRCH_storm5b_08_17_abs = FRCH_storm5b_08_17_abs.dropna(subset=['datavalue'])

FRCH_storm6a_08_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6a_08_19_Q.csv")
FRCH_storm6a_08_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6a_08_19_NO3.csv")
FRCH_storm6a_08_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6a_08_19_fDOM.csv")
FRCH_storm6a_08_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6a_08_19_SPC.csv")
FRCH_storm6a_08_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6a_08_19_turb.csv")
FRCH_storm6a_08_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6a_08_19_abs.csv")

FRCH_storm6a_08_19_Q = FRCH_storm6a_08_19_Q.dropna(subset=['datavalue'])
FRCH_storm6a_08_19_NO3 = FRCH_storm6a_08_19_NO3.dropna(subset=['datavalue'])
FRCH_storm6a_08_19_fDOM = FRCH_storm6a_08_19_fDOM.dropna(subset=['datavalue'])
FRCH_storm6a_08_19_SPC = FRCH_storm6a_08_19_SPC.dropna(subset=['datavalue'])
FRCH_storm6a_08_19_turb = FRCH_storm6a_08_19_turb.dropna(subset=['datavalue'])
FRCH_storm6a_08_19_abs = FRCH_storm6a_08_19_abs.dropna(subset=['datavalue'])

FRCH_storm6b_08_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6b_08_20_Q.csv")
FRCH_storm6b_08_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6b_08_20_NO3.csv")
FRCH_storm6b_08_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6b_08_20_fDOM.csv")
FRCH_storm6b_08_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6b_08_20_SPC.csv")
FRCH_storm6b_08_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6b_08_20_turb.csv")
FRCH_storm6b_08_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm6b_08_20_abs.csv")

FRCH_storm6b_08_20_Q = FRCH_storm6b_08_20_Q.dropna(subset=['datavalue'])
FRCH_storm6b_08_20_NO3 = FRCH_storm6b_08_20_NO3.dropna(subset=['datavalue'])
FRCH_storm6b_08_20_fDOM = FRCH_storm6b_08_20_fDOM.dropna(subset=['datavalue'])
FRCH_storm6b_08_20_SPC = FRCH_storm6b_08_20_SPC.dropna(subset=['datavalue'])
FRCH_storm6b_08_20_turb = FRCH_storm6b_08_20_turb.dropna(subset=['datavalue'])
FRCH_storm6b_08_20_abs = FRCH_storm6b_08_20_abs.dropna(subset=['datavalue'])

FRCH_storm7_08_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm7_08_25_Q.csv")
FRCH_storm7_08_25_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm7_08_25_NO3.csv")
FRCH_storm7_08_25_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm7_08_25_fDOM.csv")
FRCH_storm7_08_25_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm7_08_25_SPC.csv")
FRCH_storm7_08_25_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm7_08_25_turb.csv")
FRCH_storm7_08_25_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm7_08_25_abs.csv")

FRCH_storm7_08_25_Q = FRCH_storm7_08_25_Q.dropna(subset=['datavalue'])
FRCH_storm7_08_25_NO3 = FRCH_storm7_08_25_NO3.dropna(subset=['datavalue'])
FRCH_storm7_08_25_fDOM = FRCH_storm7_08_25_fDOM.dropna(subset=['datavalue'])
FRCH_storm7_08_25_SPC = FRCH_storm7_08_25_SPC.dropna(subset=['datavalue'])
FRCH_storm7_08_25_turb = FRCH_storm7_08_25_turb.dropna(subset=['datavalue'])
FRCH_storm7_08_25_abs = FRCH_storm7_08_25_abs.dropna(subset=['datavalue'])

FRCH_storm8_08_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm8_08_27_Q.csv")
FRCH_storm8_08_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm8_08_27_NO3.csv")
FRCH_storm8_08_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm8_08_27_fDOM.csv")
FRCH_storm8_08_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm8_08_27_SPC.csv")
FRCH_storm8_08_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm8_08_27_turb.csv")
FRCH_storm8_08_27_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/FRCH/FRCH_storm8_08_27_abs.csv")

FRCH_storm8_08_27_Q = FRCH_storm8_08_27_Q.dropna(subset=['datavalue'])
FRCH_storm8_08_27_NO3 =FRCH_storm8_08_27_NO3.dropna(subset=['datavalue'])
FRCH_storm8_08_27_fDOM = FRCH_storm8_08_27_fDOM.dropna(subset=['datavalue'])
FRCH_storm8_08_27_SPC = FRCH_storm8_08_27_SPC.dropna(subset=['datavalue'])
FRCH_storm8_08_27_turb = FRCH_storm8_08_27_turb.dropna(subset=['datavalue'])
FRCH_storm8_08_27_abs = FRCH_storm8_08_27_abs.dropna(subset=['datavalue'])

```


FRCH_storms
```{python}
## NO3 ##
FRCH_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_27_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_27_NO3 = hysteresisMetrics(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_08_05_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_08_05_NO3 = hysteresisMetrics(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_08_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_08_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_08_NO3 = hysteresisMetrics(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_15_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_15_NO3 = hysteresisMetrics(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5b_08_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5b_08_17_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5b_08_17_NO3 = hysteresisMetrics(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6a_08_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_19_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_19_NO3 = hysteresisMetrics(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6b_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6b_08_20_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6b_08_20_NO3 = hysteresisMetrics(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_25_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_25_NO3 = hysteresisMetrics(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_08_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_08_27_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_08_27_NO3 = hysteresisMetrics(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##

FRCH_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_27_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_27_fDOM = hysteresisMetrics(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_08_05_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_08_05_fDOM = hysteresisMetrics(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_08_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_08_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_08_fDOM = hysteresisMetrics(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_15_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_15_fDOM = hysteresisMetrics(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5b_08_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5b_08_17_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5b_08_17_fDOM = hysteresisMetrics(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6a_08_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_19_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_19_fDOM = hysteresisMetrics(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6b_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6b_08_20_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6b_08_20_fDOM = hysteresisMetrics(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_25_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_25_fDOM = hysteresisMetrics(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_08_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_08_27_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_08_27_fDOM = hysteresisMetrics(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## SPC ##

FRCH_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_27_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_27_SPC = hysteresisMetrics(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_08_05_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_08_05_SPC = hysteresisMetrics(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_08_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_08_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_08_SPC = hysteresisMetrics(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_15_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_15_SPC = hysteresisMetrics(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5b_08_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5b_08_17_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5b_08_17_SPC = hysteresisMetrics(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6a_08_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_19_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_19_SPC = hysteresisMetrics(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6b_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6b_08_20_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6b_08_20_SPC = hysteresisMetrics(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_25_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_25_SPC = hysteresisMetrics(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_08_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_08_27_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_08_27_SPC = hysteresisMetrics(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##

FRCH_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_27_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_27_turb = hysteresisMetrics(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_08_05_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_08_05_turb = hysteresisMetrics(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_08_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_08_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_08_turb = hysteresisMetrics(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_15_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_15_turb = hysteresisMetrics(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5b_08_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5b_08_17_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5b_08_17_turb = hysteresisMetrics(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6a_08_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_19_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_19_turb = hysteresisMetrics(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6b_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6b_08_20_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6b_08_20_turb = hysteresisMetrics(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_25_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_25_turb = hysteresisMetrics(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_08_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_08_27_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_08_27_turb = hysteresisMetrics(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
FRCH_storm2_07_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_07_27_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm2_07_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_07_27_abs = hysteresisMetrics(FRCH_storm2_07_27_Q, FRCH_storm2_07_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_08_05_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_08_05_abs = hysteresisMetrics(FRCH_storm3_08_05_Q, FRCH_storm3_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_08_08_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_08_08_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4_08_08_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_08_08_abs = hysteresisMetrics(FRCH_storm4_08_08_Q, FRCH_storm4_08_08_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5a_08_15_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5a_08_15_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm5a_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5a_08_15_abs = hysteresisMetrics(FRCH_storm5a_08_15_Q, FRCH_storm5a_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm5b_08_17_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm5b_08_17_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm5b_08_17_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm5b_08_17_abs = hysteresisMetrics(FRCH_storm5b_08_17_Q, FRCH_storm5b_08_17_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6a_08_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6a_08_19_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm6a_08_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6a_08_19_abs = hysteresisMetrics(FRCH_storm6a_08_19_Q, FRCH_storm6a_08_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm6b_08_20_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm6b_08_20_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm6b_08_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm6b_08_20_abs = hysteresisMetrics(FRCH_storm6b_08_20_Q, FRCH_storm6b_08_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm7_08_25_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm7_08_25_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm7_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm7_08_25_abs = hysteresisMetrics(FRCH_storm7_08_25_Q, FRCH_storm7_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm8_08_27_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm8_08_27_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm8_08_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm8_08_27_abs = hysteresisMetrics(FRCH_storm8_08_27_Q, FRCH_storm8_08_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

FRCH results
```{r}
FRCH.hyst.results.list = list(
                              py$hysdict_FRCH_storm2_07_27_NO3,
                              py$hysdict_FRCH_storm2_07_27_fDOM,
                              py$hysdict_FRCH_storm2_07_27_SPC,
                              py$hysdict_FRCH_storm2_07_27_turb,
                              py$hysdict_FRCH_storm2_07_27_abs,
                              py$hysdict_FRCH_storm3_08_05_NO3,
                             
                              py$hysdict_FRCH_storm3_08_05_SPC,
                              py$hysdict_FRCH_storm3_08_05_turb,
                              py$hysdict_FRCH_storm3_08_05_abs,
                              py$hysdict_FRCH_storm4_08_08_NO3,
                              
                              py$hysdict_FRCH_storm4_08_08_SPC,
                              py$hysdict_FRCH_storm4_08_08_turb,
                              py$hysdict_FRCH_storm4_08_08_abs,
                              py$hysdict_FRCH_storm5a_08_15_NO3,
                              py$hysdict_FRCH_storm5a_08_15_fDOM,
                              py$hysdict_FRCH_storm5a_08_15_SPC,
                              py$hysdict_FRCH_storm5a_08_15_turb,
                              py$hysdict_FRCH_storm5a_08_15_abs,
                              py$hysdict_FRCH_storm5b_08_17_NO3,
                              py$hysdict_FRCH_storm5b_08_17_fDOM,
                              py$hysdict_FRCH_storm5b_08_17_SPC,
                              py$hysdict_FRCH_storm5b_08_17_turb,
                              py$hysdict_FRCH_storm5b_08_17_abs,
                              py$hysdict_FRCH_storm6a_08_19_NO3,
                              py$hysdict_FRCH_storm6a_08_19_fDOM,
                              py$hysdict_FRCH_storm6a_08_19_SPC,
                              py$hysdict_FRCH_storm6a_08_19_turb,
                              py$hysdict_FRCH_storm6a_08_19_abs,
                              py$hysdict_FRCH_storm6b_08_20_NO3,
                              py$hysdict_FRCH_storm6b_08_20_fDOM,
                              py$hysdict_FRCH_storm6b_08_20_SPC,
                              py$hysdict_FRCH_storm6b_08_20_turb,
                              py$hysdict_FRCH_storm6b_08_20_abs,
                              py$hysdict_FRCH_storm7_08_25_NO3,
                              py$hysdict_FRCH_storm7_08_25_fDOM,
                              py$hysdict_FRCH_storm7_08_25_SPC,
                              py$hysdict_FRCH_storm7_08_25_turb,
                              py$hysdict_FRCH_storm7_08_25_abs,
                              py$hysdict_FRCH_storm8_08_27_NO3,
                              py$hysdict_FRCH_storm8_08_27_fDOM,
                              py$hysdict_FRCH_storm8_08_27_SPC,
                              py$hysdict_FRCH_storm8_08_27_turb,
                              py$hysdict_FRCH_storm8_08_27_abs
                              )
                              
                              

FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm2_07_27_NO3",
                                  "FRCH_storm2_07_27_fDOM",
                                  "FRCH_storm2_07_27_SPC",
                                  "FRCH_storm2_07_27_turb",
                                  "FRCH_storm2_07_27_abs",
                                  "FRCH_storm3_07_27_NO3",
                                  
                                  "FRCH_storm3_07_27_SPC",
                                  "FRCH_storm3_07_27_turb",
                                  "FRCH_storm3_07_27_abs",
                                  "FRCH_storm4_08_08_NO3",
                                  
                                  "FRCH_storm4_08_08_SPC",
                                  "FRCH_storm4_08_08_turb",
                                  "FRCH_storm4_08_08_abs",
                                  "FRCH_storm5a_08_15_NO3",
                                  "FRCH_storm5a_08_15_fDOM",
                                  "FRCH_storm5a_08_15_SPC",
                                  "FRCH_storm5a_08_15_turb",
                                  "FRCH_storm5a_08_15_abs",
                                  "FRCH_storm5b_08_17_NO3",
                                  "FRCH_storm5b_08_17_fDOM",
                                  "FRCH_storm5b_08_17_SPC",
                                  "FRCH_storm5b_08_17_turb",
                                  "FRCH_storm5b_08_17_abs",
                                  "FRCH_storm6a_08_19_NO3",
                                  "FRCH_storm6a_08_19_fDOM",
                                  "FRCH_storm6a_08_19_SPC",
                                  "FRCH_storm6a_08_19_turb",
                                  "FRCH_storm6a_08_19_abs",
                                  "FRCH_storm6b_08_20_NO3",
                                  "FRCH_storm6b_08_20_fDOM",
                                  "FRCH_storm6b_08_20_SPC",
                                  "FRCH_storm6b_08_20_turb",
                                  "FRCH_storm6b_08_20_abs",
                                  "FRCH_storm7_08_25_NO3",
                                  "FRCH_storm7_08_25_fDOM",
                                  "FRCH_storm7_08_25_SPC",
                                  "FRCH_storm7_08_25_turb",
                                  "FRCH_storm7_08_25_abs",
                                  "FRCH_storm8_08_27_NO3",
                                  "FRCH_storm8_08_27_fDOM",
                                  "FRCH_storm8_08_27_SPC",
                                  "FRCH_storm8_08_27_turb",
                                  "FRCH_storm8_08_27_abs"
                                  )


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/FRCH/FRCH.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(
                        rep("FRCH_storm2_07_23_NO3", 50),
                        rep("FRCH_storm2_07_23_fDOM", 50),
                        rep("FRCH_storm2_07_23_SPC", 50),
                        rep("FRCH_storm2_07_23_turb", 50),
                        rep("FRCH_storm2_07_23_abs", 50),
                        rep("FRCH_storm3_08_05_NO3", 50),
                        
                        rep("FRCH_storm3_08_05_SPC", 50),
                        rep("FRCH_storm3_08_05_turb", 50),
                        rep("FRCH_storm3_08_05_abs", 50),
                        rep("FRCH_storm4_08_08_NO3", 50),
                        
                        rep("FRCH_storm4_08_08_SPC", 50),
                        rep("FRCH_storm4_08_08_turb", 50),
                        rep("FRCH_storm4_08_08_abs", 50),
                        rep("FRCH_storm5a_08_15_NO3", 50),
                        rep("FRCH_storm5a_08_15_fDOM", 50),
                        rep("FRCH_storm5a_08_15_SPC", 50),
                        rep("FRCH_storm5a_08_15_turb", 50),
                        rep("FRCH_storm5a_08_15_abs", 50),
                        rep("FRCH_storm5b_08_17_NO3", 50),
                        rep("FRCH_storm5b_08_17_fDOM", 50),
                        rep("FRCH_storm5b_08_17_SPC", 50),
                        rep("FRCH_storm5b_08_17_turb", 50),
                        rep("FRCH_storm5b_08_17_abs", 50),
                        rep("FRCH_storm6a_08_19_NO3", 50),
                        rep("FRCH_storm6a_08_19_fDOM", 50),
                        rep("FRCH_storm6a_08_19_SPC", 50),
                        rep("FRCH_storm6a_08_19_turb", 50),
                        rep("FRCH_storm6a_08_19_abs", 50),
                        rep("FRCH_storm6b_08_20_NO3", 50),
                        rep("FRCH_storm6b_08_20_fDOM", 50),
                        rep("FRCH_storm6b_08_20_SPC", 50),
                        rep("FRCH_storm6b_08_20_turb", 50),
                        rep("FRCH_storm6b_08_20_abs", 50),
                        rep("FRCH_storm7_08_25_NO3", 50),
                        rep("FRCH_storm7_08_25_fDOM", 50),
                        rep("FRCH_storm7_08_25_SPC", 50),
                        rep("FRCH_storm7_08_25_turb", 50),
                        rep("FRCH_storm7_08_25_abs", 50),
                        rep("FRCH_storm8_08_27_NO3", 50),
                        rep("FRCH_storm8_08_27_fDOM", 50),
                        rep("FRCH_storm8_08_27_SPC", 50),
                        rep("FRCH_storm8_08_27_turb", 50),
                        rep("FRCH_storm8_08_27_abs", 50))
                        
                        

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/FRCH/FRCH.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/FRCH/FRCH.HI.df.csv")

FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/FRCH/FRCH.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/FRCH/FRCH.HI.df.doy.csv")

```


POKE
```{python}
# POKE #
POKE_storm1_05_16_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm1_05_16_Q.csv")
POKE_storm1_05_16_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm1_05_16_NO3.csv")
POKE_storm1_05_16_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm1_05_16_fDOM.csv")
POKE_storm1_05_16_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm1_05_16_SPC.csv")
POKE_storm1_05_16_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm1_05_16_Turb.csv")
POKE_storm1_05_16_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm1_05_16_abs.csv")

# POKE_storm1_05_16_Q = POKE_storm1_05_16_Q.dropna(subset=['datavalue'])
# POKE_storm1_05_16_NO3 = POKE_storm1_05_16_NO3.dropna(subset=['datavalue'])
# POKE_storm1_05_16_fDOM = POKE_storm1_05_16_fDOM.dropna(subset=['datavalue'])
# POKE_storm1_05_16_SPC = POKE_storm1_05_16_SPC.dropna(subset=['datavalue'])
# POKE_storm1_05_16_turb = POKE_storm1_05_16_turb.dropna(subset=['datavalue'])
# 
POKE_storm2_06_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm2_06_01_Q.csv")
POKE_storm2_06_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm2_06_01_NO3.csv")
POKE_storm2_06_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm2_06_01_fDOM.csv")
POKE_storm2_06_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm2_06_01_SPC.csv")
POKE_storm2_06_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm2_06_01_Turb.csv")
POKE_storm2_06_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm2_06_01_abs.csv")

POKE_storm3_06_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm3_06_19_Q.csv")
POKE_storm3_06_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm3_06_19_NO3.csv")
POKE_storm3_06_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm3_06_19_fDOM.csv")
POKE_storm3_06_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm3_06_19_SPC.csv")
POKE_storm3_06_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm3_06_19_Turb.csv")
POKE_storm3_06_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm3_06_19_abs.csv")

POKE_storm4_07_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm4_07_23_Q.csv")
POKE_storm4_07_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm4_07_23_NO3.csv")
POKE_storm4_07_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm4_07_23_fDOM.csv")
POKE_storm4_07_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm4_07_23_SPC.csv")
POKE_storm4_07_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm4_07_23_Turb.csv")
POKE_storm4_07_23_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm4_07_23_abs.csv")

POKE_storm5_07_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm5_07_27_Q.csv")
POKE_storm5_07_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm5_07_27_NO3.csv")
POKE_storm5_07_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm5_07_27_fDOM.csv")
POKE_storm5_07_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm5_07_27_SPC.csv")
POKE_storm5_07_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm5_07_27_Turb.csv")
POKE_storm5_07_27_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm5_07_27_abs.csv")

POKE_storm6_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm6_08_08_Q.csv")
POKE_storm6_08_08_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm6_08_08_NO3.csv")
POKE_storm6_08_08_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm6_08_08_fDOM.csv")
POKE_storm6_08_08_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm6_08_08_SPC.csv")
POKE_storm6_08_08_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm6_08_08_Turb.csv")
POKE_storm6_08_08_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm6_08_08_abs.csv")

POKE_storm7a_08_14_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7a_08_14_Q.csv")
POKE_storm7a_08_14_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7a_08_14_NO3.csv")
POKE_storm7a_08_14_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7a_08_14_fDOM.csv")
POKE_storm7a_08_14_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7a_08_14_SPC.csv")
POKE_storm7a_08_14_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7a_08_14_Turb.csv")
POKE_storm7a_08_14_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7a_08_14_abs.csv")

POKE_storm7b_08_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7b_08_19_Q.csv")
POKE_storm7b_08_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7b_08_19_NO3.csv")
POKE_storm7b_08_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7b_08_19_fDOM.csv")
POKE_storm7b_08_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7b_08_19_SPC.csv")
POKE_storm7b_08_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7b_08_19_Turb.csv")
POKE_storm7b_08_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7b_08_19_abs.csv")

POKE_storm7c_08_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7c_08_23_Q.csv")
POKE_storm7c_08_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7c_08_23_NO3.csv")
POKE_storm7c_08_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7c_08_23_fDOM.csv")
POKE_storm7c_08_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7c_08_23_SPC.csv")
POKE_storm7c_08_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7c_08_23_Turb.csv")
POKE_storm7c_08_23_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7c_08_23_abs.csv")

POKE_storm7d_08_26_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7d_08_26_Q.csv")
POKE_storm7d_08_26_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7d_08_26_NO3.csv")
POKE_storm7d_08_26_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7d_08_26_fDOM.csv")
POKE_storm7d_08_26_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7d_08_26_SPC.csv")
POKE_storm7d_08_26_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7d_08_26_Turb.csv")
POKE_storm7d_08_26_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/POKE/POKE_storm7d_08_26_abs.csv")

# POKE_storm7d_08_26_Q = POKE_storm7d_08_26_Q.dropna(subset=['datavalue'])
# POKE_storm7d_08_26_NO3 = POKE_storm7d_08_26_NO3.dropna(subset=['datavalue'])
# POKE_storm7d_08_26_fDOM = POKE_storm7d_08_26_fDOM.dropna(subset=['datavalue'])
# POKE_storm7d_08_26_SPC = POKE_storm7d_08_26_SPC.dropna(subset=['datavalue'])
# POKE_storm7d_08_26_turb = POKE_storm7d_08_26_turb.dropna(subset=['datavalue'])

```


POKE_storms
```{python}
## NO3 ##
POKE_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_05_16_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_05_16_NO3 = hysteresisMetrics(POKE_storm1_05_16_Q, POKE_storm1_05_16_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_01_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_01_NO3 = hysteresisMetrics(POKE_storm2_06_01_Q, POKE_storm2_06_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_19_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_19_NO3 = hysteresisMetrics(POKE_storm3_06_19_Q, POKE_storm3_06_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_23_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm4_07_23_NO3 = hysteresisMetrics(POKE_storm4_07_23_Q, POKE_storm4_07_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_07_27_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm5_07_27_NO3 = hysteresisMetrics(POKE_storm5_07_27_Q, POKE_storm5_07_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_08_08_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 15 minutes between records
hysdict_POKE_storm6_08_08_NO3 = hysteresisMetrics(POKE_storm6_08_08_Q, POKE_storm6_08_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7a_08_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7a_08_14_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7a_08_14_NO3 = hysteresisMetrics(POKE_storm7a_08_14_Q, POKE_storm7a_08_14_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7b_08_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7b_08_19_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7b_08_19_NO3 = hysteresisMetrics(POKE_storm7b_08_19_Q, POKE_storm7b_08_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7c_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7c_08_23_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7c_08_23_NO3 = hysteresisMetrics(POKE_storm7c_08_23_Q, POKE_storm7c_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7d_08_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7d_08_26_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7d_08_26_NO3 = hysteresisMetrics(POKE_storm7d_08_26_Q, POKE_storm7d_08_26_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
POKE_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_05_16_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_05_16_fDOM = hysteresisMetrics(POKE_storm1_05_16_Q, POKE_storm1_05_16_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_01_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_01_fDOM = hysteresisMetrics(POKE_storm2_06_01_Q, POKE_storm2_06_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_19_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_19_fDOM = hysteresisMetrics(POKE_storm3_06_19_Q, POKE_storm3_06_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_23_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm4_07_23_fDOM = hysteresisMetrics(POKE_storm4_07_23_Q, POKE_storm4_07_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_07_27_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 #5 minutes between records
hysdict_POKE_storm5_07_27_fDOM = hysteresisMetrics(POKE_storm5_07_27_Q, POKE_storm5_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_08_08_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm6_08_08_fDOM = hysteresisMetrics(POKE_storm6_08_08_Q, POKE_storm6_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7a_08_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7a_08_14_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7a_08_14_fDOM = hysteresisMetrics(POKE_storm7a_08_14_Q, POKE_storm7a_08_14_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7b_08_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7b_08_19_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7b_08_19_fDOM = hysteresisMetrics(POKE_storm7b_08_19_Q, POKE_storm7b_08_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7c_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7c_08_23_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7c_08_23_fDOM = hysteresisMetrics(POKE_storm7c_08_23_Q, POKE_storm7c_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7d_08_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7d_08_26_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7d_08_26_fDOM = hysteresisMetrics(POKE_storm7d_08_26_Q, POKE_storm7d_08_26_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## SPC ##
POKE_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_05_16_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_05_16_SPC = hysteresisMetrics(POKE_storm1_05_16_Q, POKE_storm1_05_16_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_01_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_01_SPC = hysteresisMetrics(POKE_storm2_06_01_Q, POKE_storm2_06_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_19_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_19_SPC = hysteresisMetrics(POKE_storm3_06_19_Q, POKE_storm3_06_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_23_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm4_07_23_SPC = hysteresisMetrics(POKE_storm4_07_23_Q, POKE_storm4_07_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_07_27_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm5_07_27_SPC = hysteresisMetrics(POKE_storm5_07_27_Q, POKE_storm5_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_08_08_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm6_08_08_SPC = hysteresisMetrics(POKE_storm6_08_08_Q, POKE_storm6_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7a_08_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7a_08_14_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7a_08_14_SPC = hysteresisMetrics(POKE_storm7a_08_14_Q, POKE_storm7a_08_14_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7b_08_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7b_08_19_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7b_08_19_SPC = hysteresisMetrics(POKE_storm7b_08_19_Q, POKE_storm7b_08_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7c_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7c_08_23_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7c_08_23_SPC = hysteresisMetrics(POKE_storm7c_08_23_Q, POKE_storm7c_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7d_08_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7d_08_26_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7d_08_26_SPC = hysteresisMetrics(POKE_storm7d_08_26_Q, POKE_storm7d_08_26_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## turb ##
POKE_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_05_16_turb['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_05_16_turb = hysteresisMetrics(POKE_storm1_05_16_Q, POKE_storm1_05_16_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_01_turb['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_01_turb = hysteresisMetrics(POKE_storm2_06_01_Q, POKE_storm2_06_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_19_turb['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_19_turb = hysteresisMetrics(POKE_storm3_06_19_Q, POKE_storm3_06_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_23_turb['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm4_07_23_turb = hysteresisMetrics(POKE_storm4_07_23_Q, POKE_storm4_07_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_07_27_turb['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm5_07_27_turb = hysteresisMetrics(POKE_storm5_07_27_Q, POKE_storm5_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_08_08_turb['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm6_08_08_turb = hysteresisMetrics(POKE_storm6_08_08_Q, POKE_storm6_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7a_08_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7a_08_14_turb['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7a_08_14_turb = hysteresisMetrics(POKE_storm7a_08_14_Q, POKE_storm7a_08_14_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7b_08_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7b_08_19_turb['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7b_08_19_turb = hysteresisMetrics(POKE_storm7b_08_19_Q, POKE_storm7b_08_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7c_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7c_08_23_turb['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7c_08_23_turb = hysteresisMetrics(POKE_storm7c_08_23_Q, POKE_storm7c_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7d_08_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7d_08_26_turb['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7d_08_26_turb = hysteresisMetrics(POKE_storm7d_08_26_Q, POKE_storm7d_08_26_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## ABS ##
POKE_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_05_16_abs['valuedatetime'] =  pd.to_datetime(POKE_storm1_05_16_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_05_16_abs = hysteresisMetrics(POKE_storm1_05_16_Q, POKE_storm1_05_16_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_06_01_abs['valuedatetime'] =  pd.to_datetime(POKE_storm2_06_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_06_01_abs = hysteresisMetrics(POKE_storm2_06_01_Q, POKE_storm2_06_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_06_19_abs['valuedatetime'] =  pd.to_datetime(POKE_storm3_06_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_06_19_abs = hysteresisMetrics(POKE_storm3_06_19_Q, POKE_storm3_06_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_07_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_07_23_abs['valuedatetime'] =  pd.to_datetime(POKE_storm4_07_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm4_07_23_abs = hysteresisMetrics(POKE_storm4_07_23_Q, POKE_storm4_07_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm5_07_27_abs['valuedatetime'] =  pd.to_datetime(POKE_storm5_07_27_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm5_07_27_abs = hysteresisMetrics(POKE_storm5_07_27_Q, POKE_storm5_07_27_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm6_08_08_abs['valuedatetime'] =  pd.to_datetime(POKE_storm6_08_08_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 15 minutes between records
hysdict_POKE_storm6_08_08_abs = hysteresisMetrics(POKE_storm6_08_08_Q, POKE_storm6_08_08_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7a_08_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7a_08_14_abs['valuedatetime'] =  pd.to_datetime(POKE_storm7a_08_14_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7a_08_14_abs = hysteresisMetrics(POKE_storm7a_08_14_Q, POKE_storm7a_08_14_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7b_08_19_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7b_08_19_abs['valuedatetime'] =  pd.to_datetime(POKE_storm7b_08_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7b_08_19_abs = hysteresisMetrics(POKE_storm7b_08_19_Q, POKE_storm7b_08_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7c_08_23_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7c_08_23_abs['valuedatetime'] =  pd.to_datetime(POKE_storm7c_08_23_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_POKE_storm7c_08_23_abs = hysteresisMetrics(POKE_storm7c_08_23_Q, POKE_storm7c_08_23_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm7d_08_26_Q['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm7d_08_26_abs['valuedatetime'] =  pd.to_datetime(POKE_storm7d_08_26_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm7d_08_26_abs = hysteresisMetrics(POKE_storm7d_08_26_Q, POKE_storm7d_08_26_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


POKE results 
```{r}
POKE.hyst.results.list = list(py$hysdict_POKE_storm1_05_16_fDOM,
                              py$hysdict_POKE_storm1_05_16_SPC,
                              py$hysdict_POKE_storm1_05_16_turb,
                              py$hysdict_POKE_storm2_06_01_NO3,
                              py$hysdict_POKE_storm2_06_01_fDOM,
                              py$hysdict_POKE_storm2_06_01_SPC,
                              py$hysdict_POKE_storm2_06_01_turb,
                              py$hysdict_POKE_storm2_06_01_abs,
                              py$hysdict_POKE_storm3_06_19_NO3,
                              py$hysdict_POKE_storm3_06_19_abs,

                              py$hysdict_POKE_storm4_07_23_NO3,
                              py$hysdict_POKE_storm4_07_23_abs,

                              py$hysdict_POKE_storm5_07_27_NO3,
                              py$hysdict_POKE_storm5_07_27_fDOM,

                              py$hysdict_POKE_storm5_07_27_turb,
                              py$hysdict_POKE_storm5_07_27_abs,
                              py$hysdict_POKE_storm6_08_08_NO3,
                              py$hysdict_POKE_storm6_08_08_fDOM,
                              py$hysdict_POKE_storm6_08_08_SPC,
                              py$hysdict_POKE_storm6_08_08_turb,
                              py$hysdict_POKE_storm6_08_08_abs,
                              py$hysdict_POKE_storm7a_08_14_NO3,
                              py$hysdict_POKE_storm7a_08_14_abs,

                              py$hysdict_POKE_storm7b_08_19_NO3,
                              py$hysdict_POKE_storm7b_08_19_abs,

                              py$hysdict_POKE_storm7c_08_23_NO3,
                              py$hysdict_POKE_storm7c_08_23_abs,
                              py$hysdict_POKE_storm7d_08_26_abs)


POKE.hyst.results.list.2 = list()
for (i in 1:length(POKE.hyst.results.list)){
POKE.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
POKE.hyst.results.list[[i]][["HI_mean_with_Interp"]],
POKE.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
POKE.hyst.results.list[[i]][["Normalized slope of response"]],
POKE.hyst.results.list[[i]][["interpolated Max width of response"]],
POKE.hyst.results.list[[i]][["Min response"]],
POKE.hyst.results.list[[i]][["Max response"]],
POKE.hyst.results.list[[i]][["Peak Q"]]
))))
names(POKE.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(POKE.hyst.results.list)){
  HIs.list[[i]] = unlist(POKE.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

POKE.hyst.results.list.3 =list()
for (i in 1:length(POKE.hyst.results.list)){
  POKE.hyst.results.list.3[[i]] = cbind(POKE.hyst.results.list.2[[i]], HIs.tests[[i]])
}

POKE.hyst.results.df = bind_rows(POKE.hyst.results.list.3, .id = "column_label")

POKE.hyst.results.df$storm.ID = c("POKE_storm1_05_16_fDOM",
                                  "POKE_storm1_05_16_SPC",
                                  "POKE_storm1_05_16_turb",
                                  "POKE_storm2_06_01_NO3",
                                  "POKE_storm2_06_01_fDOM",
                                  "POKE_storm2_06_01_SPC",
                                  "POKE_storm2_06_01_turb",
                                  "POKE_storm2_06_01_abs",
                                  "POKE_storm3_06_19_NO3",
                                  "POKE_storm3_06_19_abs",
                                  
                                
                                  "POKE_storm4_07_23_NO3",
                                  "POKE_storm4_07_23_abs",
                                  
                                  "POKE_storm5_07_27_NO3",
                                  "POKE_storm5_07_27_fDOM",
                                  
                                  "POKE_storm5_07_27_turb",
                                  "POKE_storm5_07_27_abs",
                                  "POKE_storm6_08_08_NO3",
                                  "POKE_storm6_08_08_fDOM",
                                  "POKE_storm6_08_08_SPC",
                                  "POKE_storm6_08_08_turb",
                                  "POKE_storm6_08_08_abs",
                                  "POKE_storm7a_08_14_NO3",
                                  "POKE_storm7a_08_14_abs",
                                  
                                  "POKE_storm7b_08_19_NO3",
                                  "POKE_storm7b_08_19_abs",
                                  
                                  "POKE_storm7c_08_23_NO3",
                                  "POKE_storm7c_08_23_abs",
                                  "POKE_storm7d_08_26_abs"
                                  )


POKE.hyst.results.df$site.ID = "POKE"

write.csv(POKE.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/POKE/POKE.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/POKE/POKE.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= POKE.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

POKE.HI.df = bind_rows(HIs.df.list, .id = "column_label")
POKE.HI.df$storm.ID = c(rep("POKE_storm1_05_16_fDOM", 50),
                        rep("POKE_storm1_05_16_SPC", 50),
                        rep("POKE_storm1_05_16_turb", 50),
                        rep("POKE_storm2_06_01_NO3", 50),
                        rep("POKE_storm2_06_01_fDOM", 50),
                        rep("POKE_storm2_06_01_SPC", 50),
                        rep("POKE_storm2_06_01_turb", 50),
                        rep("POKE_storm2_06_01_abs", 50),
                        rep("POKE_storm3_06_19_NO3", 50),
                        rep("POKE_storm3_06_19_abs", 50),
                        
                        rep("POKE_storm4_07_23_NO3", 50),
                        rep("POKE_storm4_07_23_abs", 50),
                        rep("POKE_storm5_07_27_NO3", 50),
                        rep("POKE_storm5_07_27_fDOM", 50),
                        
                        rep("POKE_storm5_07_27_turb", 50),
                        rep("POKE_storm5_07_27_abs", 50),
                        rep("POKE_storm6_08_08_NO3", 50),
                        rep("POKE_storm6_08_08_fDOM", 50),
                        rep("POKE_storm6_08_08_SPC", 50),
                        rep("POKE_storm6_08_08_turb", 50),
                        rep("POKE_storm6_08_08_abs", 50),
                        rep("POKE_storm7a_08_14_NO3", 50),
                        rep("POKE_storm7a_08_14_abs", 50),
                        
                        rep("POKE_storm7b_08_19_NO3", 50),
                        rep("POKE_storm7b_08_19_abs", 50),
                        
                        rep("FRCH_storm7c_08_23_NO3", 50),
                        rep("FRCH_storm7c_08_23_abs", 50),
                        rep("FRCH_storm7d_08_26_abs", 50))
                        
                        
                        
                        

POKE.HI.df$storm.ID = as.factor(POKE.HI.df$storm.ID)
POKE.HI.df = separate(data=POKE.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(POKE.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/POKE/POKE.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/POKE/POKE.HI.df.csv")



POKE.HI.df$date <- as.Date(with(POKE.HI.df, paste(month, day, sep = "-")), "%m-%d")
POKE.HI.df$doy <- yday(POKE.HI.df$date) 

g0 <- ggplot(POKE.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/POKE/POKE.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/POKE/POKE.HI.df.doy.csv")

```

STRT
```{python}
# STRT #
STRT_storm1a_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1a_08_15_Q.csv")
STRT_storm1a_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1a_08_15_NO3.csv")
STRT_storm1a_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1a_08_15_fDOM.csv")
STRT_storm1a_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1a_08_15_SPC.csv")
STRT_storm1a_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1a_08_15_Turb.csv")
STRT_storm1a_08_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1a_08_15_abs.csv")

# STRT_storm1a_08_15_Q = STRT_storm1a_08_15_Q.dropna(subset=['datavalue'])
# STRT_storm1a_08_15_NO3 = STRT_storm1a_08_15_NO3.dropna(subset=['datavalue'])
# STRT_storm1a_08_15_fDOM = STRT_storm1a_08_15_fDOM.dropna(subset=['datavalue'])
# STRT_storm1a_08_15_SPC = STRT_storm1a_08_15_SPC.dropna(subset=['datavalue'])
# STRT_storm1a_08_15_turb = STRT_storm1a_08_15_turb.dropna(subset=['datavalue'])

STRT_storm1b_08_17_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1b_08_17_Q.csv")
STRT_storm1b_08_17_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1b_08_17_NO3.csv")
STRT_storm1b_08_17_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1b_08_17_fDOM.csv")
STRT_storm1b_08_17_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1b_08_17_SPC.csv")
STRT_storm1b_08_17_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1b_08_17_Turb.csv")
STRT_storm1b_08_17_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm1b_08_17_abs.csv")

# STRT_storm1b_08_17_Q = STRT_storm1b_08_17_Q.dropna(subset=['datavalue'])
# STRT_storm1b_08_17_NO3 = STRT_storm1b_08_17_NO3.dropna(subset=['datavalue'])
# STRT_storm1b_08_17_fDOM = STRT_storm1b_08_17_fDOM.dropna(subset=['datavalue'])
# STRT_storm1b_08_17_SPC = STRT_storm1b_08_17_SPC.dropna(subset=['datavalue'])
# STRT_storm1b_08_17_turb = STRT_storm1b_08_17_turb.dropna(subset=['datavalue'])

STRT_storm2a_08_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2a_08_19_Q.csv")
STRT_storm2a_08_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2a_08_19_NO3.csv")
STRT_storm2a_08_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2a_08_19_fDOM.csv")
STRT_storm2a_08_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2a_08_19_SPC.csv")
STRT_storm2a_08_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2a_08_19_Turb.csv")
STRT_storm2a_08_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2a_08_19_abs.csv")

# STRT_storm2a_08_19_Q = STRT_storm2a_08_19_Q.dropna(subset=['datavalue'])
# STRT_storm2a_08_19_NO3 = STRT_storm2a_08_19_NO3.dropna(subset=['datavalue'])
# STRT_storm2a_08_19_fDOM = STRT_storm2a_08_19_fDOM.dropna(subset=['datavalue'])
# STRT_storm2a_08_19_SPC = STRT_storm2a_08_19_SPC.dropna(subset=['datavalue'])
# STRT_storm2a_08_19_turb = STRT_storm2a_08_19_turb.dropna(subset=['datavalue'])

STRT_storm2b_08_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2b_08_20_Q.csv")
STRT_storm2b_08_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2b_08_20_NO3.csv")
STRT_storm2b_08_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2b_08_20_fDOM.csv")
STRT_storm2b_08_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2b_08_20_SPC.csv")
STRT_storm2b_08_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2b_08_20_Turb.csv")
STRT_storm2b_08_20_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm2b_08_20_abs.csv")

# STRT_storm2b_08_20_Q = STRT_storm2b_08_20_Q.dropna(subset=['datavalue'])
# STRT_storm2b_08_20_NO3 = STRT_storm2b_08_20_NO3.dropna(subset=['datavalue'])
# STRT_storm2b_08_20_fDOM = STRT_storm2b_08_20_fDOM.dropna(subset=['datavalue'])
# STRT_storm2b_08_20_SPC = STRT_storm2b_08_20_SPC.dropna(subset=['datavalue'])
# STRT_storm2b_08_20_turb = STRT_storm2b_08_20_turb.dropna(subset=['datavalue'])

STRT_storm3_08_25_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm3_08_25_Q.csv")
STRT_storm3_08_25_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm3_08_25_NO3.csv")
STRT_storm3_08_25_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm3_08_25_fDOM.csv")
STRT_storm3_08_25_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm3_08_25_SPC.csv")
STRT_storm3_08_25_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm3_08_25_Turb.csv")
STRT_storm3_08_25_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/STRT/STRT_storm3_08_25_abs.csv")

# STRT_storm3_08_25_Q = STRT_storm3_08_25_Q.dropna(subset=['datavalue'])
# STRT_storm3_08_25_NO3 = STRT_storm3_08_25_NO3.dropna(subset=['datavalue'])
# STRT_storm3_08_25_fDOM = STRT_storm3_08_25_fDOM.dropna(subset=['datavalue'])
# STRT_storm3_08_25_SPC = STRT_storm3_08_25_SPC.dropna(subset=['datavalue'])
# STRT_storm3_08_25_turb = STRT_storm3_08_25_turb.dropna(subset=['datavalue'])

```

STRT_storms
```{python}
## NO3 ##
STRT_storm1a_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_08_15_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1a_08_15_NO3 = hysteresisMetrics(STRT_storm1a_08_15_Q, STRT_storm1a_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_08_17_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_08_17_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1b_08_17_NO3 = hysteresisMetrics(STRT_storm1b_08_17_Q, STRT_storm1b_08_17_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2a_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2a_08_19_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2a_08_19_NO3 = hysteresisMetrics(STRT_storm2a_08_19_Q, STRT_storm2a_08_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2b_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2b_08_20_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2b_08_20_NO3 = hysteresisMetrics(STRT_storm2b_08_20_Q, STRT_storm2b_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_08_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_08_25_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_08_25_NO3 = hysteresisMetrics(STRT_storm3_08_25_Q, STRT_storm3_08_25_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
STRT_storm1a_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_08_15_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1a_08_15_fDOM = hysteresisMetrics(STRT_storm1a_08_15_Q, STRT_storm1a_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_08_17_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_08_17_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1b_08_17_fDOM = hysteresisMetrics(STRT_storm1b_08_17_Q, STRT_storm1b_08_17_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2a_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2a_08_19_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2a_08_19_fDOM = hysteresisMetrics(STRT_storm2a_08_19_Q, STRT_storm2a_08_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2b_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2b_08_20_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2b_08_20_fDOM = hysteresisMetrics(STRT_storm2b_08_20_Q, STRT_storm2b_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_08_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_08_25_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_08_25_fDOM = hysteresisMetrics(STRT_storm3_08_25_Q, STRT_storm3_08_25_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')


## SPC ##
STRT_storm1a_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_08_15_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1a_08_15_SPC = hysteresisMetrics(STRT_storm1a_08_15_Q, STRT_storm1a_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_08_17_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_08_17_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1b_08_17_SPC = hysteresisMetrics(STRT_storm1b_08_17_Q, STRT_storm1b_08_17_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2a_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2a_08_19_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2a_08_19_SPC = hysteresisMetrics(STRT_storm2a_08_19_Q, STRT_storm2a_08_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2b_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2b_08_20_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2b_08_20_SPC = hysteresisMetrics(STRT_storm2b_08_20_Q, STRT_storm2b_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_08_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_08_25_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_08_25_SPC = hysteresisMetrics(STRT_storm3_08_25_Q, STRT_storm3_08_25_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
STRT_storm1a_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_08_15_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1a_08_15_turb = hysteresisMetrics(STRT_storm1a_08_15_Q, STRT_storm1a_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_08_17_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_08_17_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1b_08_17_turb = hysteresisMetrics(STRT_storm1b_08_17_Q, STRT_storm1b_08_17_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2a_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2a_08_19_turb['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2a_08_19_turb = hysteresisMetrics(STRT_storm2a_08_19_Q, STRT_storm2a_08_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2b_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2b_08_20_turb['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2b_08_20_turb = hysteresisMetrics(STRT_storm2b_08_20_Q, STRT_storm2b_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_08_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_08_25_turb['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_08_25_turb = hysteresisMetrics(STRT_storm3_08_25_Q, STRT_storm3_08_25_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## ABS ##
STRT_storm1a_08_15_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1a_08_15_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1a_08_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1a_08_15_abs = hysteresisMetrics(STRT_storm1a_08_15_Q, STRT_storm1a_08_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm1b_08_17_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1b_08_17_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1b_08_17_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1b_08_17_abs = hysteresisMetrics(STRT_storm1b_08_17_Q, STRT_storm1b_08_17_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2a_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2a_08_19_abs['valuedatetime'] =  pd.to_datetime(STRT_storm2a_08_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2a_08_19_abs = hysteresisMetrics(STRT_storm2a_08_19_Q, STRT_storm2a_08_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2b_08_20_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2b_08_20_abs['valuedatetime'] =  pd.to_datetime(STRT_storm2b_08_20_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2b_08_20_abs = hysteresisMetrics(STRT_storm2b_08_20_Q, STRT_storm2b_08_20_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_08_25_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_08_25_abs['valuedatetime'] =  pd.to_datetime(STRT_storm3_08_25_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_08_25_abs = hysteresisMetrics(STRT_storm3_08_25_Q, STRT_storm3_08_25_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

STRT results 
```{r}
STRT.hyst.results.list = list(py$hysdict_STRT_storm1a_08_15_NO3,
                              py$hysdict_STRT_storm1a_08_15_fDOM,
                              py$hysdict_STRT_storm1a_08_15_SPC,
                              py$hysdict_STRT_storm1a_08_15_turb,
                              py$hysdict_STRT_storm1a_08_15_abs,
                              py$hysdict_STRT_storm1b_08_17_NO3,
                              py$hysdict_STRT_storm1b_08_17_fDOM,
                              py$hysdict_STRT_storm1b_08_17_SPC,
                              py$hysdict_STRT_storm1b_08_17_turb,
                              py$hysdict_STRT_storm1b_08_17_abs,
                              py$hysdict_STRT_storm2a_08_19_NO3,
                              py$hysdict_STRT_storm2a_08_19_fDOM,
                              py$hysdict_STRT_storm2a_08_19_SPC,
                              py$hysdict_STRT_storm2a_08_19_turb,
                              py$hysdict_STRT_storm2a_08_19_abs,
                              py$hysdict_STRT_storm2b_08_20_NO3,
                              py$hysdict_STRT_storm2b_08_20_fDOM,
                              py$hysdict_STRT_storm2b_08_20_SPC,
                              py$hysdict_STRT_storm2b_08_20_turb,
                              py$hysdict_STRT_storm2b_08_20_abs,
                              py$hysdict_STRT_storm3_08_25_NO3,
                              py$hysdict_STRT_storm3_08_25_fDOM,
                              py$hysdict_STRT_storm3_08_25_SPC,
                              py$hysdict_STRT_storm3_08_25_turb,
                              py$hysdict_STRT_storm3_08_25_abs
                              )

STRT.hyst.results.list.2 = list()
for (i in 1:length(STRT.hyst.results.list)){
STRT.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
STRT.hyst.results.list[[i]][["HI_mean_with_Interp"]],
STRT.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
STRT.hyst.results.list[[i]][["Normalized slope of response"]],
STRT.hyst.results.list[[i]][["interpolated Max width of response"]],
STRT.hyst.results.list[[i]][["Min response"]],
STRT.hyst.results.list[[i]][["Max response"]],
STRT.hyst.results.list[[i]][["Peak Q"]]
))))
names(STRT.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(STRT.hyst.results.list)){
  HIs.list[[i]] = unlist(STRT.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

STRT.hyst.results.list.3 =list()
for (i in 1:length(STRT.hyst.results.list)){
  STRT.hyst.results.list.3[[i]] = cbind(STRT.hyst.results.list.2[[i]], HIs.tests[[i]])
}

STRT.hyst.results.df = bind_rows(STRT.hyst.results.list.3, .id = "column_label")

STRT.hyst.results.df$storm.ID = c("STRT_storm1a_08_15_NO3",
                                  "STRT_storm1a_08_15_fDOM",
                                  "STRT_storm1a_08_15_SPC",
                                  "STRT_storm1a_08_15_turb",
                                  "STRT_storm1a_08_15_abs",
                                  "STRT_storm1b_08_17_NO3",
                                  "STRT_storm1b_08_17_fDOM",
                                  "STRT_storm1b_08_17_SPC",
                                  "STRT_storm1b_08_17_turb",
                                  "STRT_storm1b_08_17_abs",
                                  "STRT_storm2a_08_19_NO3",
                                  "STRT_storm2a_08_19_fDOM",
                                  "STRT_storm2a_08_19_SPC",
                                  "STRT_storm2a_08_19_turb",
                                  "STRT_storm2a_08_19_abs",
                                  "STRT_storm2b_08_20_NO3",
                                  "STRT_storm2b_08_20_fDOM",
                                  "STRT_storm2b_08_20_SPC",
                                  "STRT_storm2b_08_20_turb",
                                  "STRT_storm2b_08_20_abs",
                                  "STRT_storm3 08_25_NO3",
                                  "STRT_storm3 08_25_fDOM",
                                  "STRT_storm3 08_25_SPC",
                                  "STRT_storm3 08_25_turb",
                                  "STRT_storm3 08_25_abs")
                                  


              

STRT.hyst.results.df$site.ID = "STRT"

write.csv(STRT.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/STRT/STRT.hyst.results.csv")


# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/STRT/STRT.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= STRT.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

STRT.HI.df = bind_rows(HIs.df.list, .id = "column_label")
STRT.HI.df$storm.ID = c(rep("STRT_storm1a_08_15_NO3", 50),
                        rep("STRT_storm1a_08_15_fDOM", 50),
                        rep("STRT_storm1a_08_15_SPC", 50),
                        rep("STRT_storm1a_08_15_turb", 50),
                        rep("STRT_storm1a_08_15_abs", 50),
                        rep("STRT_storm1b_08_17_NO3", 50),
                        rep("STRT_storm1b_08_17_fDOM", 50),
                        rep("STRT_storm1b_08_17_SPC", 50),
                        rep("STRT_storm1b_08_17_turb", 50),
                        rep("STRT_storm1b_08_17_abs", 50),
                        rep("STRT_storm2a_08_19_NO3", 50),
                        rep("STRT_storm2a_08_19_fDOM", 50),
                        rep("STRT_storm2a_08_19_SPC", 50),
                        rep("STRT_storm2a_08_19_turb", 50),
                        rep("STRT_storm2a_08_19_abs", 50),
                        rep("STRT_storm2b_08_20_NO3", 50),
                        rep("STRT_storm2b_08_20_fDOM", 50),
                        rep("STRT_storm2b_08_20_SPC", 50),
                        rep("STRT_storm2b_08_20_turb", 50),
                        rep("STRT_storm2b_08_20_abs", 50),
                        rep("STRT_storm3_08_25_NO3", 50),
                        rep("STRT_storm3_08_25_fDOM", 50),
                        rep("STRT_storm3_08_25_SPC", 50),
                        rep("STRT_storm3_08_25_turb", 50),
                        rep("STRT_storm3_08_25_abs", 50))
                        


STRT.HI.df$storm.ID = as.factor(STRT.HI.df$storm.ID)
STRT.HI.df = separate(data=STRT.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(STRT.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/STRT/STRT.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(STRT.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/STRT/STRT.HI.df.csv")

STRT.HI.df$date <- as.Date(with(STRT.HI.df, paste(month, day, sep = "-")), "%m-%d")
STRT.HI.df$doy <- yday(STRT.HI.df$date) 

g0 <- ggplot(STRT.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/STRT/STRT.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(STRT.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/STRT/STRT.HI.df.doy.csv")
```

CARI
```{python}
# FRCH #
CARI_storm1_05_16_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm1_05_16_Q.csv")
CARI_storm1_05_16_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm1_05_16_NO3.csv")
CARI_storm1_05_16_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm1_05_16_fDOM.csv")
CARI_storm1_05_16_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm1_05_16_SPC.csv")
CARI_storm1_05_16_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm1_05_16_Turb.csv")

CARI_storm2_06_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm2_06_01_Q.csv")
CARI_storm2_06_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm2_06_01_NO3.csv")
CARI_storm2_06_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm2_06_01_fDOM.csv")
CARI_storm2_06_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm2_06_01_SPC.csv")
CARI_storm2_06_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm2_06_01_Turb.csv")

CARI_storm3_06_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm3_06_19_Q.csv")
CARI_storm3_06_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm3_06_19_NO3.csv")
CARI_storm3_06_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm3_06_19_fDOM.csv")
CARI_storm3_06_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm3_06_19_SPC.csv")
CARI_storm3_06_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm3_06_19_Turb.csv")

CARI_storm4_07_24_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm4_07_24_Q.csv")
CARI_storm4_07_24_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm4_07_24_NO3.csv")
CARI_storm4_07_24_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm4_07_24_fDOM.csv")
CARI_storm4_07_24_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm4_07_24_SPC.csv")
CARI_storm4_07_24_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm4_07_24_Turb.csv")

CARI_storm5_07_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm5_07_27_Q.csv")
CARI_storm5_07_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm5_07_27_NO3.csv")
CARI_storm5_07_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm5_07_27_fDOM.csv")
CARI_storm5_07_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm5_07_27_SPC.csv")
CARI_storm5_07_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm5_07_27_Turb.csv")

CARI_storm6_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm6_08_08_Q.csv")
CARI_storm6_08_08_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm6_08_08_NO3.csv")
CARI_storm6_08_08_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm6_08_08_fDOM.csv")
CARI_storm6_08_08_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm6_08_08_SPC.csv")
CARI_storm6_08_08_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm6_08_08_Turb.csv")

CARI_storm7_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm7_08_15_Q.csv")
CARI_storm7_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm7_08_15_NO3.csv")
CARI_storm7_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm7_08_15_fDOM.csv")
CARI_storm7_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm7_08_15_SPC.csv")
CARI_storm7_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm7_08_15_Turb.csv")

CARI_storm8_08_20_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm8_08_20_Q.csv")
CARI_storm8_08_20_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm8_08_20_NO3.csv")
CARI_storm8_08_20_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm8_08_20_fDOM.csv")
CARI_storm8_08_20_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm8_08_20_SPC.csv")
CARI_storm8_08_20_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm8_08_20_Turb.csv")

CARI_storm9_08_23_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm9_08_23_Q.csv")
CARI_storm9_08_23_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm9_08_23_NO3.csv")
CARI_storm9_08_23_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm9_08_23_fDOM.csv")
CARI_storm9_08_23_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm9_08_23_SPC.csv")
CARI_storm9_08_23_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm9_08_23_Turb.csv")

CARI_storm10_08_27_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm10_08_27_Q.csv")
CARI_storm10_08_27_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm10_08_27_NO3.csv")
CARI_storm10_08_27_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm10_08_27_fDOM.csv")
CARI_storm10_08_27_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm10_08_27_SPC.csv")
CARI_storm10_08_27_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2021/CARI/CARI_storm10_08_27_Turb.csv")
```

CARI_storms
```{python}
## NO3 ##
CARI_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_16_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_16_NO3 = hysteresisMetrics(CARI_storm1_05_16_Q, CARI_storm1_05_16_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_01_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_01_NO3 = hysteresisMetrics(CARI_storm2_06_01_Q, CARI_storm2_06_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_19_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_19_NO3 = hysteresisMetrics(CARI_storm3_06_19_Q, CARI_storm3_06_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_24_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_24_NO3 = hysteresisMetrics(CARI_storm4_07_24_Q, CARI_storm4_07_24_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_27_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_27_NO3 = hysteresisMetrics(CARI_storm5_07_27_Q, CARI_storm5_07_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_08_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_08_NO3 = hysteresisMetrics(CARI_storm6_08_08_Q, CARI_storm6_08_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_15_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_15_NO3 = hysteresisMetrics(CARI_storm7_08_15_Q, CARI_storm7_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_20_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_20_NO3 = hysteresisMetrics(CARI_storm8_08_20_Q, CARI_storm8_08_20_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_23_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_23_NO3 = hysteresisMetrics(CARI_storm9_08_23_Q, CARI_storm9_08_23_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_27_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_27_NO3 = hysteresisMetrics(CARI_storm10_08_27_Q, CARI_storm10_08_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## NO3 ##
CARI_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_16_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_16_fDOM = hysteresisMetrics(CARI_storm1_05_16_Q, CARI_storm1_05_16_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_01_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_01_fDOM = hysteresisMetrics(CARI_storm2_06_01_Q, CARI_storm2_06_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_19_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_19_fDOM = hysteresisMetrics(CARI_storm3_06_19_Q, CARI_storm3_06_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_24_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_24_fDOM = hysteresisMetrics(CARI_storm4_07_24_Q, CARI_storm4_07_24_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_27_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_27_fDOM = hysteresisMetrics(CARI_storm5_07_27_Q, CARI_storm5_07_27_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_08_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_08_fDOM = hysteresisMetrics(CARI_storm6_08_08_Q, CARI_storm6_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_15_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_15_fDOM = hysteresisMetrics(CARI_storm7_08_15_Q, CARI_storm7_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_20_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_20_fDOM = hysteresisMetrics(CARI_storm8_08_20_Q, CARI_storm8_08_20_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_23_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_23_fDOM = hysteresisMetrics(CARI_storm9_08_23_Q, CARI_storm9_08_23_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_27_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_27_NO3 = hysteresisMetrics(CARI_storm10_08_27_Q, CARI_storm10_08_27_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
CARI_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_16_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_16_SPC = hysteresisMetrics(CARI_storm1_05_16_Q, CARI_storm1_05_16_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_01_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_01_SPC = hysteresisMetrics(CARI_storm2_06_01_Q, CARI_storm2_06_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_19_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_19_SPC = hysteresisMetrics(CARI_storm3_06_19_Q, CARI_storm3_06_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_24_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_24_SPC = hysteresisMetrics(CARI_storm4_07_24_Q, CARI_storm4_07_24_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_27_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_27_SPC = hysteresisMetrics(CARI_storm5_07_27_Q, CARI_storm5_07_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_08_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_08_SPC = hysteresisMetrics(CARI_storm6_08_08_Q, CARI_storm6_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_15_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_15_SPC = hysteresisMetrics(CARI_storm7_08_15_Q, CARI_storm7_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_20_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_20_SPC = hysteresisMetrics(CARI_storm8_08_20_Q, CARI_storm8_08_20_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_23_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_23_SPC = hysteresisMetrics(CARI_storm9_08_23_Q, CARI_storm9_08_23_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_27_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_27_SPC = hysteresisMetrics(CARI_storm10_08_27_Q, CARI_storm10_08_27_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
CARI_storm1_05_16_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_05_16_turb['valuedatetime'] =  pd.to_datetime(CARI_storm1_05_16_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_05_16_turb = hysteresisMetrics(CARI_storm1_05_16_Q, CARI_storm1_05_16_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_06_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_06_01_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2_06_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_06_01_turb = hysteresisMetrics(CARI_storm2_06_01_Q, CARI_storm2_06_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_06_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_06_19_turb['valuedatetime'] =  pd.to_datetime(CARI_storm3_06_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_06_19_turb = hysteresisMetrics(CARI_storm3_06_19_Q, CARI_storm3_06_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4_07_24_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4_07_24_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4_07_24_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4_07_24_turb = hysteresisMetrics(CARI_storm4_07_24_Q, CARI_storm4_07_24_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_07_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_07_27_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5_07_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_07_27_turb = hysteresisMetrics(CARI_storm5_07_27_Q, CARI_storm5_07_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_08_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_08_turb = hysteresisMetrics(CARI_storm6_08_08_Q, CARI_storm6_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_15_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_15_turb = hysteresisMetrics(CARI_storm7_08_15_Q, CARI_storm7_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_08_20_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_08_20_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8_08_20_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_08_20_turb = hysteresisMetrics(CARI_storm8_08_20_Q, CARI_storm8_08_20_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm9_08_23_Q['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm9_08_23_turb['valuedatetime'] =  pd.to_datetime(CARI_storm9_08_23_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm9_08_23_turb = hysteresisMetrics(CARI_storm9_08_23_Q, CARI_storm9_08_23_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm10_08_27_Q['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm10_08_27_turb['valuedatetime'] =  pd.to_datetime(CARI_storm10_08_27_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm10_08_27_turb = hysteresisMetrics(CARI_storm10_08_27_Q, CARI_storm10_08_27_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```
CARI results 
```{r}

CARI.hyst.results.list = list(py$hysdict_CARI_storm1_05_16_NO3,
                              py$hysdict_CARI_storm1_05_16_fDOM,
                              py$hysdict_CARI_storm1_05_16_SPC,
                              py$hysdict_CARI_storm1_05_16_turb,
                              py$hysdict_CARI_storm2_06_01_NO3,
                              py$hysdict_CARI_storm2_06_01_fDOM,
                              py$hysdict_CARI_storm2_06_01_SPC,
                              py$hysdict_CARI_storm2_06_01_turb,
                              py$hysdict_CARI_storm3_06_19_NO3,
                              py$hysdict_CARI_storm3_06_19_fDOM,
                              py$hysdict_CARI_storm3_06_19_SPC,
                              py$hysdict_CARI_storm3_06_19_turb,
                              py$hysdict_CARI_storm4_07_24_NO3,
                              py$hysdict_CARI_storm4_07_24_fDOM,
                              py$hysdict_CARI_storm4_07_24_SPC,
                              py$hysdict_CARI_storm4_07_24_turb,
                              py$hysdict_CARI_storm5_07_27_NO3,
                              py$hysdict_CARI_storm5_07_27_fDOM,
                              py$hysdict_CARI_storm5_07_27_SPC,
                              py$hysdict_CARI_storm5_07_27_turb,
                              py$hysdict_CARI_storm6_08_08_NO3,
                              py$hysdict_CARI_storm6_08_08_fDOM,
                              py$hysdict_CARI_storm6_08_08_SPC,
                              py$hysdict_CARI_storm6_08_08_turb,
                              py$hysdict_CARI_storm7_08_15_NO3,
                              py$hysdict_CARI_storm7_08_15_fDOM,
                              py$hysdict_CARI_storm7_08_15_SPC,
                              py$hysdict_CARI_storm7_08_15_turb,
                              py$hysdict_CARI_storm8_08_20_NO3,
                              py$hysdict_CARI_storm8_08_20_fDOM,
                              py$hysdict_CARI_storm8_08_20_SPC,
                              py$hysdict_CARI_storm8_08_20_turb,
                              py$hysdict_CARI_storm9_08_23_NO3,
                              py$hysdict_CARI_storm9_08_23_fDOM,
                              py$hysdict_CARI_storm9_08_23_SPC,
                              py$hysdict_CARI_storm9_08_23_turb
                              
                             
                              )
                             

CARI.hyst.results.list.2 = list()
for (i in 1:length(CARI.hyst.results.list)){
CARI.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
CARI.hyst.results.list[[i]][["HI_mean_with_Interp"]],
CARI.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
CARI.hyst.results.list[[i]][["Normalized slope of response"]],
CARI.hyst.results.list[[i]][["interpolated Max width of response"]],
CARI.hyst.results.list[[i]][["Min response"]],
CARI.hyst.results.list[[i]][["Max response"]],
CARI.hyst.results.list[[i]][["Peak Q"]]
))))
names(CARI.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}


HIs.list = list()
HIs.tests = list()
for (i in 1:length(CARI.hyst.results.list)){
  HIs.list[[i]] = unlist(CARI.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

CARI.hyst.results.list.3 =list()
for (i in 1:length(CARI.hyst.results.list)){
  CARI.hyst.results.list.3[[i]] = cbind(CARI.hyst.results.list.2[[i]], HIs.tests[[i]])
}

CARI.hyst.results.df = bind_rows(CARI.hyst.results.list.3, .id = "column_label")

CARI.hyst.results.df$storm.ID = c("CARI_storm1_05_16_NO3",
                                  "CARI_storm1_05_16_fDOM",
                                  "CARI_storm1_05_16_SPC",
                                  "CARI_storm1_05_16_turb",
                                  "CARI_storm2_06_01_NO3",
                                  "CARI_storm2_06_01_fDOM",
                                  "CARI_storm2_06_01_SPC",
                                  "CARI_storm2_06_01_turb",
                                  "CARI_storm3_06_19_NO3",
                                  "CARI_storm3_06_19_fDOM",
                                  "CARI_storm3_06_19_SPC",
                                  "CARI_storm3_06_19_turb",
                                  "CARI_storm4_07_24_NO3",
                                  "CARI_storm4_07_24_fDOM",
                                  "CARI_storm4_07_24_SPC",
                                  "CARI_storm4_07_24_turb",
                                  "CARI_storm5_07_27_NO3",
                                  "CARI_storm5_07_27_fDOM",
                                  "CARI_storm5_07_27_SPC",
                                  "CARI_storm5_07_27_turb",
                                  "CARI_storm6_08_08_NO3",
                                  "CARI_storm6_08_08_fDOM",
                                  "CARI_storm6_08_08_SPC",
                                  "CARI_storm6_08_08_turb",
                                  "CARI_storm7_08_15_NO3",
                                  "CARI_storm7_08_15_fDOM",
                                  "CARI_storm7_08_15_SPC",
                                  "CARI_storm7_08_15_turb",
                                  "CARI_storm8_08_20_NO3",
                                  "CARI_storm8_08_20_fDOM",
                                  "CARI_storm8_08_20_SPC",
                                  "CARI_storm8_08_20_turb",
                                  "CARI_storm9_08_23_NO3",
                                  "CARI_storm9_08_23_fDOM",
                                  "CARI_storm9_08_23_SPC",
                                  "CARI_storm9_08_23_turb")
                             
                            

CARI.hyst.results.df$site.ID = "CARI"

write.csv(CARI.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/CARI/CARI.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/CARI/CARI.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= CARI.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

CARI.HI.df = bind_rows(HIs.df.list, .id = "column_label")
CARI.HI.df$storm.ID = c(rep("CARI_storm1_05_16_NO3", 50),
                        rep("CARI_storm1_05_16_fDOM", 50),
                        rep("CARI_storm1_05_16_SPC", 50),
                        rep("CARI_storm1_05_16_turb", 50),
                        rep("CARI_storm2_06_01_NO3", 50),
                        rep("CARI_storm2_06_01_fDOM", 50),
                        rep("CARI_storm2_06_01_SPC", 50),
                        rep("CARI_storm2_06_01_turb", 50),
                        rep("CARI_storm3_06_19_NO3", 50),
                        rep("CARI_storm3_06_19_fDOM", 50),
                        rep("CARI_storm3_06_19_SPC", 50),
                        rep("CARI_storm3_06_19_turb", 50),
                        rep("CARI_storm4_07_24_NO3", 50),
                        rep("CARI_storm4_07_24_fDOM", 50),
                        rep("CARI_storm4_07_24_SPC", 50),
                        rep("CARI_storm4_07_24_turb", 50),
                        rep("CARI_storm5_07_27_NO3", 50),
                        rep("CARI_storm5_07_27_fDOM", 50),
                        rep("CARI_storm5_07_27_SPC", 50),
                        rep("CARI_storm5_07_27_turb", 50),
                        rep("CARI_storm6_08_08_NO3", 50),
                        rep("CARI_storm6_08_08_fDOM", 50),
                        rep("CARI_storm6_08_08_SPC", 50),
                        rep("CARI_storm6_08_08_turb", 50),
                        rep("CARI_storm7_08_15_NO3", 50),
                        rep("CARI_storm7_08_15_fDOM", 50),
                        rep("CARI_storm7_08_15_SPC", 50),
                        rep("CARI_storm7_08_15_turb", 50),
                        rep("CARI_storm8_08_20_NO3", 49),
                        rep("CARI_storm8_08_20_fDOM", 50),
                        rep("CARI_storm8_08_20_SPC", 50),
                        rep("CARI_storm8_08_20_turb", 50),
                        rep("CARI_storm9_08_23_NO3", 50),
                        rep("CARI_storm9_08_23_fDOM", 50),
                        rep("CARI_storm9_08_23_SPC", 50),
                        rep("CARI_storm9_08_23_turb", 50))


CARI.HI.df$storm.ID = as.factor(CARI.HI.df$storm.ID)
CARI.HI.df = separate(data=CARI.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}


g0 <- ggplot(CARI.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/CARI/CARI.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/CARI/CARI.HI.df.csv")


CARI.HI.df$date <- as.Date(with(CARI.HI.df, paste(month, day, sep = "-")), "%m-%d")
CARI.HI.df$doy <- yday(CARI.HI.df$date) 

g0 <- ggplot(CARI.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2021/CARI/CARI.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2021/CARI/CARI.HI.df.doy.csv")
```


###################################################################################################################################################### 2022 ####################################################
########################################################################################################

#### load data to pandas 2022
### FRCH ###
```{python}
# FRCH #
FRCH_storm1_07_10_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm1_07_10_Q.csv")
FRCH_storm1_07_10_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm1_07_10_NO3.csv")
FRCH_storm1_07_10_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm1_07_10_fDOM.csv")
FRCH_storm1_07_10_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm1_07_10_SPC.csv")
FRCH_storm1_07_10_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm1_07_10_turb.csv")
FRCH_storm1_07_10_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm1_07_10_abs.csv")

FRCH_storm2_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm2_08_05_Q.csv")
FRCH_storm2_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm2_08_05_NO3.csv")
FRCH_storm2_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm2_08_05_fDOM.csv")
FRCH_storm2_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm2_08_05_SPC.csv")
FRCH_storm2_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm2_08_05_turb.csv")
FRCH_storm2_08_05_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm2_08_05_abs.csv")

FRCH_storm3_09_14_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm3_09_14_Q.csv")
FRCH_storm3_09_14_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm3_09_14_NO3.csv")
FRCH_storm3_09_14_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm3_09_14_fDOM.csv")
FRCH_storm3_09_14_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm3_09_14_SPC.csv")
FRCH_storm3_09_14_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm3_09_14_turb.csv")
FRCH_storm3_09_14_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm3_09_14_abs.csv")

FRCH_storm4_09_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm4_09_19_Q.csv")
FRCH_storm4_09_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm4_09_19_NO3.csv")
FRCH_storm4_09_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm4_09_19_fDOM.csv")
FRCH_storm4_09_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm4_09_19_SPC.csv")
FRCH_storm4_09_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm4_09_19_turb.csv")
FRCH_storm4_09_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/FRCH/FRCH_storm4_09_19_abs.csv")

```


FRCH_storms
```{python}
## NO3 ##
FRCH_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_10_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_10_NO3 = hysteresisMetrics(FRCH_storm1_07_10_Q, FRCH_storm1_07_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_08_05_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_08_05_NO3 = hysteresisMetrics(FRCH_storm2_08_05_Q, FRCH_storm2_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_09_14_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_09_14_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_09_14_NO3 = hysteresisMetrics(FRCH_storm3_09_14_Q, FRCH_storm3_09_14_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_09_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_09_19_NO3['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_09_19_NO3 = hysteresisMetrics(FRCH_storm4_09_19_Q, FRCH_storm4_09_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
FRCH_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_10_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_10_fDOM = hysteresisMetrics(FRCH_storm1_07_10_Q, FRCH_storm1_07_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_08_05_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_08_05_fDOM = hysteresisMetrics(FRCH_storm2_08_05_Q, FRCH_storm2_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_09_14_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_09_14_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_09_14_fDOM = hysteresisMetrics(FRCH_storm3_09_14_Q, FRCH_storm3_09_14_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_09_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_09_19_fDOM['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_09_19_fDOM = hysteresisMetrics(FRCH_storm4_09_19_Q, FRCH_storm4_09_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
FRCH_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_10_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_10_SPC = hysteresisMetrics(FRCH_storm1_07_10_Q, FRCH_storm1_07_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_08_05_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_08_05_SPC = hysteresisMetrics(FRCH_storm2_08_05_Q, FRCH_storm2_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_09_14_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_09_14_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_09_14_SPC = hysteresisMetrics(FRCH_storm3_09_14_Q, FRCH_storm3_09_14_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_09_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_09_19_SPC['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_09_19_SPC = hysteresisMetrics(FRCH_storm4_09_19_Q, FRCH_storm4_09_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
FRCH_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_10_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_10_turb = hysteresisMetrics(FRCH_storm1_07_10_Q, FRCH_storm1_07_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_08_05_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_08_05_turb = hysteresisMetrics(FRCH_storm2_08_05_Q, FRCH_storm2_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_09_14_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_09_14_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_09_14_turb = hysteresisMetrics(FRCH_storm3_09_14_Q, FRCH_storm3_09_14_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_09_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_09_19_turb['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_09_19_turb = hysteresisMetrics(FRCH_storm4_09_19_Q, FRCH_storm4_09_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## abs ##
FRCH_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm1_07_10_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm1_07_10_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm1_07_10_abs = hysteresisMetrics(FRCH_storm1_07_10_Q, FRCH_storm1_07_10_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm2_08_05_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm2_08_05_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm2_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm2_08_05_abs = hysteresisMetrics(FRCH_storm2_08_05_Q, FRCH_storm2_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm3_09_14_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm3_09_14_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm3_09_14_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm3_09_14_abs = hysteresisMetrics(FRCH_storm3_09_14_Q, FRCH_storm3_09_14_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

FRCH_storm4_09_19_Q['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
FRCH_storm4_09_19_abs['valuedatetime'] =  pd.to_datetime(FRCH_storm4_09_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_FRCH_storm4_09_19_abs = hysteresisMetrics(FRCH_storm4_09_19_Q, FRCH_storm4_09_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

 FRCH  results
```{r}

FRCH.hyst.results.list = list(py$hysdict_FRCH_storm1_07_10_NO3,
                              py$hysdict_FRCH_storm1_07_10_fDOM,
                              py$hysdict_FRCH_storm1_07_10_SPC,
                              py$hysdict_FRCH_storm1_07_10_turb,
                              py$hysdict_FRCH_storm1_07_10_abs,
                              py$hysdict_FRCH_storm2_08_05_NO3,
                              py$hysdict_FRCH_storm2_08_05_fDOM,
                              py$hysdict_FRCH_storm2_08_05_SPC,
                              py$hysdict_FRCH_storm2_08_05_turb,
                              py$hysdict_FRCH_storm2_08_05_abs,
                              py$hysdict_FRCH_storm3_09_14_NO3,
                              py$hysdict_FRCH_storm3_09_14_fDOM,
                              py$hysdict_FRCH_storm3_09_14_SPC,
                              py$hysdict_FRCH_storm3_09_14_turb,
                              py$hysdict_FRCH_storm3_09_14_abs,
                              py$hysdict_FRCH_storm4_09_19_NO3,
                              py$hysdict_FRCH_storm4_09_19_fDOM,
                              py$hysdict_FRCH_storm4_09_19_SPC,
                              py$hysdict_FRCH_storm4_09_19_turb,
                              py$hysdict_FRCH_storm4_09_19_abs
                              )


FRCH.hyst.results.list.2 = list()
for (i in 1:length(FRCH.hyst.results.list)){
FRCH.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
FRCH.hyst.results.list[[i]][["HI_mean_with_Interp"]],
FRCH.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
FRCH.hyst.results.list[[i]][["Normalized slope of response"]],
FRCH.hyst.results.list[[i]][["interpolated Max width of response"]],
FRCH.hyst.results.list[[i]][["Min response"]],
FRCH.hyst.results.list[[i]][["Max response"]],
FRCH.hyst.results.list[[i]][["Peak Q"]]
))))
names(FRCH.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(FRCH.hyst.results.list)){
  HIs.list[[i]] = unlist(FRCH.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

FRCH.hyst.results.list.3 =list()
for (i in 1:length(FRCH.hyst.results.list)){
  FRCH.hyst.results.list.3[[i]] = cbind(FRCH.hyst.results.list.2[[i]], HIs.tests[[i]])
}

FRCH.hyst.results.df = bind_rows(FRCH.hyst.results.list.3, .id = "column_label")

FRCH.hyst.results.df$storm.ID = c("FRCH_storm1_07_10_NO3",
                                  "FRCH_storm1_07_10_fDOM",
                                  "FRCH_storm1_07_10_SPC",
                                  "FRCH_storm1_07_10_turb",
                                  "FRCH_storm1_07_10_abs",
                                  "FRCH_storm2_08_05_NO3",
                                  "FRCH_storm2_08_05_fDOM",
                                  "FRCH_storm2_08_05_SPC",
                                  "FRCH_storm2_08_05_turb",
                                  "FRCH_storm2_08_05_abs",
                                  "FRCH_storm3_09_14_NO3",
                                  "FRCH_storm3_09_14_fDOM",
                                  "FRCH_storm3_09_14_SPC",
                                  "FRCH_storm3_09_14_turb",
                                  "FRCH_storm3_09_14_abs",
                                  "FRCH_storm4_09_19_NO3",
                                  "FRCH_storm4_09_19_fDOM",
                                  "FRCH_storm4_09_19_SPC",
                                  "FRCH_storm4_09_19_turb",
                                  "FRCH_storm4_09_19_abs"
                                  )


FRCH.hyst.results.df$site.ID = "FRCH"

write.csv(FRCH.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/FRCH/FRCH.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
#pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2020/FRCH/FRCH.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
     ylab="norm.response", xlab="Q intervals", main= FRCH.hyst.results.df$storm.ID[i])
abline(h=0, lty=2)
}
dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

FRCH.HI.df = bind_rows(HIs.df.list, .id = "column_label")
FRCH.HI.df$storm.ID = c(rep("FRCH_storm1_07_10_NO3", 50),
                        rep("FRCH_storm1_07_10_fDOM", 50),
                        rep("FRCH_storm1_07_10_SPC", 50),
                        rep("FRCH_storm1_07_10_turb", 50),
                        rep("FRCH_storm1_07_10_abs", 50),
                        rep("FRCH_storm2_08_05_NO3", 50),
                        rep("FRCH_storm2_08_05_fDOM", 50),
                        rep("FRCH_storm2_08_05_SPC", 50),
                        rep("FRCH_storm2_08_05_turb", 50),
                        rep("FRCH_storm2_08_05_abs", 50),
                        rep("FRCH_storm3_09_14_NO3", 50),
                        rep("FRCH_storm3_09_14_fDOM", 50),
                        rep("FRCH_storm3_09_14_SPC", 50),
                        rep("FRCH_storm3_09_14_turb", 50),
                        rep("FRCH_storm3_09_14_abs", 50),
                        rep("FRCH_storm4_09_19_NO3", 50),
                        rep("FRCH_storm4_09_19_fDOM", 50),
                        rep("FRCH_storm4_09_19_SPC", 50),
                        rep("FRCH_storm4_09_19_turb", 50),
                        rep("FRCH_storm4_09_19_abs", 50))
                        

FRCH.HI.df$storm.ID = as.factor(FRCH.HI.df$storm.ID)
FRCH.HI.df = separate(data=FRCH.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(FRCH.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/FRCH/FRCH.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/FRCH/FRCH.HI.df.csv")

FRCH.HI.df$date <- as.Date(with(FRCH.HI.df, paste(month, day, sep = "-")), "%m-%d")
FRCH.HI.df$doy <- yday(FRCH.HI.df$date) 

g0 <- ggplot(FRCH.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)
ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/FRCH/FRCH.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(FRCH.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/FRCH/FRCH.HI.df.doy.csv")

```


### MOOS
```{python}
# MOOS #
MOOS_storm1_07_10_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm1_07_10_Q.csv")
MOOS_storm1_07_10_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm1_07_10_NO3.csv")
MOOS_storm1_07_10_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm1_07_10_fDOM.csv")
MOOS_storm1_07_10_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm1_07_10_SPC.csv")
MOOS_storm1_07_10_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm1_07_10_turb.csv")
MOOS_storm1_07_10_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm1_07_10_abs.csv")


MOOS_storm2a_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2a_08_05_Q.csv")
MOOS_storm2a_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2a_08_05_NO3.csv")
MOOS_storm2a_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2a_08_05_fDOM.csv")
MOOS_storm2a_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2a_08_05_SPC.csv")
MOOS_storm2a_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2a_08_05_turb.csv")
MOOS_storm2a_08_05_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2a_08_05_abs.csv")


MOOS_storm2b_08_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2b_08_06_Q.csv")
MOOS_storm2b_08_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2b_08_06_NO3.csv")
MOOS_storm2b_08_06_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2b_08_06_fDOM.csv")
MOOS_storm2b_08_06_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2b_08_06_SPC.csv")
MOOS_storm2b_08_06_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2b_08_06_turb.csv")
MOOS_storm2b_08_06_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm2b_08_06_abs.csv")


MOOS_storm3_08_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm3_08_19_Q.csv")
MOOS_storm3_08_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm3_08_19_NO3.csv")
MOOS_storm3_08_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm3_08_19_fDOM.csv")
MOOS_storm3_08_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm3_08_19_SPC.csv")
MOOS_storm3_08_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm3_08_19_turb.csv")
MOOS_storm3_08_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm3_08_19_abs.csv")

MOOS_storm4_09_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm4_09_15_Q.csv")
MOOS_storm4_09_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm4_09_15_NO3.csv")
MOOS_storm4_09_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm4_09_15_fDOM.csv")
MOOS_storm4_09_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm4_09_15_SPC.csv")
MOOS_storm4_09_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm4_09_15_turb.csv")
MOOS_storm4_09_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/MOOS/MOOS_storm4_09_15_abs.csv")

```

MOOS_storms
```{python}
## NO3 ##
MOOS_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_10_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_10_NO3 = hysteresisMetrics(MOOS_storm1_07_10_Q, MOOS_storm1_07_10_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_08_05_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_08_05_NO3 = hysteresisMetrics(MOOS_storm2a_08_05_Q, MOOS_storm2a_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_08_06_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_08_06_NO3 = hysteresisMetrics(MOOS_storm2b_08_06_Q, MOOS_storm2b_08_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_08_19_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_08_19_NO3 = hysteresisMetrics(MOOS_storm3_08_19_Q, MOOS_storm3_08_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_09_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_09_15_NO3['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_09_15_NO3 = hysteresisMetrics(MOOS_storm4_09_15_Q, MOOS_storm4_09_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
MOOS_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_10_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_10_fDOM = hysteresisMetrics(MOOS_storm1_07_10_Q, MOOS_storm1_07_10_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_08_05_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_08_05_fDOM = hysteresisMetrics(MOOS_storm2a_08_05_Q, MOOS_storm2a_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_08_06_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_08_06_fDOM = hysteresisMetrics(MOOS_storm2b_08_06_Q, MOOS_storm2b_08_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_08_19_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_08_19_fDOM = hysteresisMetrics(MOOS_storm3_08_19_Q, MOOS_storm3_08_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_09_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_09_15_fDOM['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_09_15_fDOM = hysteresisMetrics(MOOS_storm4_09_15_Q, MOOS_storm4_09_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
MOOS_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_10_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_10_SPC = hysteresisMetrics(MOOS_storm1_07_10_Q, MOOS_storm1_07_10_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_08_05_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_08_05_SPC = hysteresisMetrics(MOOS_storm2a_08_05_Q, MOOS_storm2a_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_08_06_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_08_06_SPC = hysteresisMetrics(MOOS_storm2b_08_06_Q, MOOS_storm2b_08_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_08_19_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_08_19_SPC = hysteresisMetrics(MOOS_storm3_08_19_Q, MOOS_storm3_08_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_09_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_09_15_SPC['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_09_15_SPC = hysteresisMetrics(MOOS_storm4_09_15_Q, MOOS_storm4_09_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
MOOS_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_10_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_10_turb = hysteresisMetrics(MOOS_storm1_07_10_Q, MOOS_storm1_07_10_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_08_05_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_08_05_turb = hysteresisMetrics(MOOS_storm2a_08_05_Q, MOOS_storm2a_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_08_06_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_08_06_turb = hysteresisMetrics(MOOS_storm2b_08_06_Q, MOOS_storm2b_08_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_08_19_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_08_19_turb = hysteresisMetrics(MOOS_storm3_08_19_Q, MOOS_storm3_08_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_09_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_09_15_turb['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_09_15_turb = hysteresisMetrics(MOOS_storm4_09_15_Q, MOOS_storm4_09_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## abs ##
MOOS_storm1_07_10_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm1_07_10_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm1_07_10_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm1_07_10_abs = hysteresisMetrics(MOOS_storm1_07_10_Q, MOOS_storm1_07_10_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2a_08_05_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2a_08_05_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm2a_08_05_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2a_08_05_abs = hysteresisMetrics(MOOS_storm2a_08_05_Q, MOOS_storm2a_08_05_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm2b_08_06_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm2b_08_06_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm2b_08_06_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm2b_08_06_abs = hysteresisMetrics(MOOS_storm2b_08_06_Q, MOOS_storm2b_08_06_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm3_08_19_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm3_08_19_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm3_08_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm3_08_19_abs = hysteresisMetrics(MOOS_storm3_08_19_Q, MOOS_storm3_08_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

MOOS_storm4_09_15_Q['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
MOOS_storm4_09_15_abs['valuedatetime'] =  pd.to_datetime(MOOS_storm4_09_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_MOOS_storm4_09_15_abs = hysteresisMetrics(MOOS_storm4_09_15_Q, MOOS_storm4_09_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

MOOS results
```{r}
MOOS.hyst.results.list = list(py$hysdict_MOOS_storm1_07_10_NO3,
                              py$hysdict_MOOS_storm1_07_10_fDOM,
                              py$hysdict_MOOS_storm1_07_10_SPC,
                              py$hysdict_MOOS_storm1_07_10_turb,
                              py$hysdict_MOOS_storm1_07_10_abs,
                              py$hysdict_MOOS_storm2a_08_05_NO3,
                              py$hysdict_MOOS_storm2a_08_05_fDOM,
                              py$hysdict_MOOS_storm2a_08_05_SPC,
                              py$hysdict_MOOS_storm2a_08_05_turb,
                              py$hysdict_MOOS_storm2a_08_05_abs,
                              py$hysdict_MOOS_storm2b_08_06_NO3,
                              py$hysdict_MOOS_storm2b_08_06_fDOM,
                              py$hysdict_MOOS_storm2b_08_06_SPC,
                              py$hysdict_MOOS_storm2b_08_06_turb,
                              py$hysdict_MOOS_storm2b_08_06_abs,
                              py$hysdict_MOOS_storm3_08_19_NO3,
                              py$hysdict_MOOS_storm3_08_19_fDOM,
                              py$hysdict_MOOS_storm3_08_19_SPC,
                              py$hysdict_MOOS_storm3_08_19_turb,
                              py$hysdict_MOOS_storm3_08_19_abs,
                              py$hysdict_MOOS_storm4_09_15_NO3,
                              py$hysdict_MOOS_storm4_09_15_fDOM,
                              py$hysdict_MOOS_storm4_09_15_SPC,
                              py$hysdict_MOOS_storm4_09_15_turb,
                              py$hysdict_MOOS_storm4_09_15_abs
                              )
                              
                              

MOOS.hyst.results.list.2 = list()
for (i in 1:length(MOOS.hyst.results.list)){
MOOS.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
MOOS.hyst.results.list[[i]][["HI_mean_with_Interp"]],
MOOS.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
MOOS.hyst.results.list[[i]][["Normalized slope of response"]],
MOOS.hyst.results.list[[i]][["interpolated Max width of response"]],
MOOS.hyst.results.list[[i]][["Min response"]],
MOOS.hyst.results.list[[i]][["Max response"]],
MOOS.hyst.results.list[[i]][["Peak Q"]]
))))
names(MOOS.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(MOOS.hyst.results.list)){
  HIs.list[[i]] = unlist(MOOS.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

MOOS.hyst.results.list.3 =list()
for (i in 1:length(MOOS.hyst.results.list)){
  MOOS.hyst.results.list.3[[i]] = cbind(MOOS.hyst.results.list.2[[i]], HIs.tests[[i]])
}

MOOS.hyst.results.df = bind_rows(MOOS.hyst.results.list.3, .id = "column_label")

MOOS.hyst.results.df$storm.ID = c("MOOS_storm1_07_10_NO3",
                                  "MOOS_storm1_07_10_fDOM",
                                  "MOOS_storm1_07_10_SPC",
                                  "MOOS_storm1_07_10_turb",
                                  "MOOS_storm1_07_10_abs",
                                  "MOOS_storm2a_08_05_NO3",
                                  "MOOS_storm2a_08_05_fDOM",
                                  "MOOS_storm2a_08_05_SPC",
                                  "MOOS_storm2a_08_05_turb",
                                  "MOOS_storm2a_08_05_abs",
                                  "MOOS_storm2b_08_06_NO3",
                                  "MOOS_storm2b_08_06_fDOM",
                                  "MOOS_storm2b_08_06_SPC",
                                  "MOOS_storm2b_08_06_turb",
                                  "MOOS_storm2b_08_06_abs",
                                  "MOOS_storm3_08_19_NO3",
                                  "MOOS_storm3_08_19_fDOM",
                                  "MOOS_storm3_08_19_SPC",
                                  "MOOS_storm3_08_19_turb",
                                  "MOOS_storm3_08_19_abs",
                                  "MOOS_storm4_09_15_NO3",
                                  "MOOS_storm4_09_15_fDOM",
                                  "MOOS_storm4_09_15_SPC",
                                  "MOOS_storm4_09_15_turb",
                                  "MOOS_storm4_09_15_abs")
                                  


MOOS.hyst.results.df$site.ID = "MOOS"

write.csv(MOOS.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/MOOS/MOOS.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/MOOS/MOOS.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= MOOS.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

MOOS.HI.df = bind_rows(HIs.df.list, .id = "column_label")
MOOS.HI.df$storm.ID = c(rep("MOOS_storm1_07_10_NO3", 50),
                        rep("MOOS_storm1_07_10_fDOM", 50),
                        rep("MOOS_storm1_07_10_SPC", 50),
                        rep("MOOS_storm1_07_10_turb", 50),
                        rep("MOOS_storm1_07_10_abs", 50),
                        rep("MOOS_storm2a_08_05_NO3", 50),
                        rep("MOOS_storm2a_08_05_fDOM", 50),
                        rep("MOOS_storm2a_08_05_SPC", 50),
                        rep("MOOS_storm2a_08_05_turb", 50),
                        rep("MOOS_storm2a_08_05_abs", 50),
                        rep("MOOS_storm2b_08_06_NO3", 50),
                        rep("MOOS_storm2b_08_06_fDOM", 50),
                        rep("MOOS_storm2b_08_06_SPC", 50),
                        rep("MOOS_storm2b_08_06_turb", 50),
                        rep("MOOS_storm2b_08_06_abs", 50),
                        rep("MOOS_storm3_08_19_NO3", 50),
                        rep("MOOS_storm3_08_19_fDOM", 50),
                        rep("MOOS_storm3_08_19_SPC", 50),
                        rep("MOOS_storm3_08_19_turb", 50),
                        rep("MOOS_storm3_08_19_abs", 50),
                        rep("MOOS_storm4_09_15_NO3", 50),
                        rep("MOOS_storm4_09_15_fDOM", 50),
                        rep("MOOS_storm4_09_15_SPC", 50),
                        rep("MOOS_storm4_09_15_turb", 50),
                        rep("MOOS_storm4_09_15_abs", 50))
                        
                        

MOOS.HI.df$storm.ID = as.factor(MOOS.HI.df$storm.ID)
MOOS.HI.df = separate(data=MOOS.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(MOOS.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/MOOS/MOOS.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/MOOS/MOOS.HI.df.csv")


MOOS.HI.df$date <- as.Date(with(MOOS.HI.df, paste(month, day, sep = "-")), "%m-%d")
MOOS.HI.df$doy <- yday(MOOS.HI.df$date) 

g0 <- ggplot(MOOS.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/MOOS/MOOS.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(MOOS.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/MOOS/MOOS.HI.df.doy.csv")


```

### POKE ###

```{python}
# POKE #
POKE_storm1_07_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm1_07_15_Q.csv")
POKE_storm1_07_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm1_07_15_NO3.csv")
POKE_storm1_07_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm1_07_15_fDOM.csv")
POKE_storm1_07_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm1_07_15_SPC.csv")
POKE_storm1_07_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm1_07_15_Turb.csv")
POKE_storm1_07_15_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm1_07_15_abs.csv")

POKE_storm2_09_03_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm2_09_03_Q.csv")
POKE_storm2_09_03_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm2_09_03_NO3.csv")
POKE_storm2_09_03_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm2_09_03_fDOM.csv")
POKE_storm2_09_03_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm2_09_03_SPC.csv")
POKE_storm2_09_03_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm2_09_03_Turb.csv")
POKE_storm2_09_03_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm2_09_03_abs.csv")

POKE_storm3_09_09_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm3_09_09_Q.csv")
POKE_storm3_09_09_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm3_09_09_NO3.csv")
POKE_storm3_09_09_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm3_09_09_fDOM.csv")
POKE_storm3_09_09_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm3_09_09_SPC.csv")
POKE_storm3_09_09_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm3_09_09_Turb.csv")
POKE_storm3_09_09_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm3_09_09_abs.csv")

POKE_storm4_09_14_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm4_09_14_Q.csv")
POKE_storm4_09_14_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm4_09_14_NO3.csv")
POKE_storm4_09_14_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm4_09_14_fDOM.csv")
POKE_storm4_09_14_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm4_09_14_SPC.csv")
POKE_storm4_09_14_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm4_09_14_Turb.csv")
POKE_storm4_09_14_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/POKE/POKE_storm4_09_14_abs.csv")


```


POKE_storms
```{python}
## NO3 ##
POKE_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_07_15_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_07_15_NO3 = hysteresisMetrics(POKE_storm1_07_15_Q, POKE_storm1_07_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_09_03_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_09_03_NO3 = hysteresisMetrics(POKE_storm2_09_03_Q, POKE_storm2_09_03_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_09_09_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_09_09_NO3 = hysteresisMetrics(POKE_storm3_09_09_Q, POKE_storm3_09_09_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_09_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_09_14_NO3['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_09_14_NO3 = hysteresisMetrics(POKE_storm4_09_14_Q, POKE_storm4_09_14_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
POKE_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_07_15_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_07_15_fDOM = hysteresisMetrics(POKE_storm1_07_15_Q, POKE_storm1_07_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_09_03_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_09_03_fDOM = hysteresisMetrics(POKE_storm2_09_03_Q, POKE_storm2_09_03_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_09_09_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_09_09_fDOM = hysteresisMetrics(POKE_storm3_09_09_Q, POKE_storm3_09_09_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_09_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_09_14_fDOM['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_09_14_fDOM = hysteresisMetrics(POKE_storm4_09_14_Q, POKE_storm4_09_14_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
POKE_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_07_15_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_07_15_SPC = hysteresisMetrics(POKE_storm1_07_15_Q, POKE_storm1_07_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_09_03_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_09_03_SPC = hysteresisMetrics(POKE_storm2_09_03_Q, POKE_storm2_09_03_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_09_09_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_09_09_SPC = hysteresisMetrics(POKE_storm3_09_09_Q, POKE_storm3_09_09_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_09_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_09_14_SPC['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_09_14_SPC = hysteresisMetrics(POKE_storm4_09_14_Q, POKE_storm4_09_14_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
POKE_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_07_15_turb['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_07_15_turb = hysteresisMetrics(POKE_storm1_07_15_Q, POKE_storm1_07_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_09_03_turb['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_09_03_turb = hysteresisMetrics(POKE_storm2_09_03_Q, POKE_storm2_09_03_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_09_09_turb['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_09_09_turb = hysteresisMetrics(POKE_storm3_09_09_Q, POKE_storm3_09_09_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_09_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_09_14_turb['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_09_14_turb = hysteresisMetrics(POKE_storm4_09_14_Q, POKE_storm4_09_14_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## abs ##
POKE_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm1_07_15_abs['valuedatetime'] =  pd.to_datetime(POKE_storm1_07_15_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm1_07_15_abs = hysteresisMetrics(POKE_storm1_07_15_Q, POKE_storm1_07_15_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm2_09_03_Q['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm2_09_03_abs['valuedatetime'] =  pd.to_datetime(POKE_storm2_09_03_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm2_09_03_abs = hysteresisMetrics(POKE_storm2_09_03_Q, POKE_storm2_09_03_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm3_09_09_Q['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm3_09_09_abs['valuedatetime'] =  pd.to_datetime(POKE_storm3_09_09_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm3_09_09_abs = hysteresisMetrics(POKE_storm3_09_09_Q, POKE_storm3_09_09_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

POKE_storm4_09_14_Q['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
POKE_storm4_09_14_abs['valuedatetime'] =  pd.to_datetime(POKE_storm4_09_14_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_POKE_storm4_09_14_abs = hysteresisMetrics(POKE_storm4_09_14_Q, POKE_storm4_09_14_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```


POKE results 
```{r}
POKE.hyst.results.list = list(py$hysdict_POKE_storm1_07_15_NO3,
                              py$hysdict_POKE_storm1_07_15_fDOM,
                              py$hysdict_POKE_storm1_07_15_SPC,
                              py$hysdict_POKE_storm1_07_15_turb,
                              py$hysdict_POKE_storm1_07_15_abs,
                              py$hysdict_POKE_storm2_09_03_NO3,
                              py$hysdict_POKE_storm2_09_03_fDOM,
                              py$hysdict_POKE_storm2_09_03_SPC,
                              py$hysdict_POKE_storm2_09_03_turb,
                              py$hysdict_POKE_storm2_09_03_abs,
                              py$hysdict_POKE_storm3_09_09_NO3,
                              py$hysdict_POKE_storm3_09_09_fDOM,
                              py$hysdict_POKE_storm3_09_09_SPC,
                              py$hysdict_POKE_storm3_09_09_turb,
                              py$hysdict_POKE_storm3_09_09_abs,
                              py$hysdict_POKE_storm4_09_14_NO3,
                              py$hysdict_POKE_storm4_09_14_fDOM,
                              py$hysdict_POKE_storm4_09_14_SPC,
                              py$hysdict_POKE_storm4_09_14_turb,
                              py$hysdict_POKE_storm4_09_14_abs
                              )

                              
POKE.hyst.results.list.2 = list()
for (i in 1:length(POKE.hyst.results.list)){
POKE.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
POKE.hyst.results.list[[i]][["HI_mean_with_Interp"]],
POKE.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
POKE.hyst.results.list[[i]][["Normalized slope of response"]],
POKE.hyst.results.list[[i]][["interpolated Max width of response"]],
POKE.hyst.results.list[[i]][["Min response"]],
POKE.hyst.results.list[[i]][["Max response"]],
POKE.hyst.results.list[[i]][["Peak Q"]]
))))
names(POKE.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(POKE.hyst.results.list)){
  HIs.list[[i]] = unlist(POKE.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

POKE.hyst.results.list.3 =list()
for (i in 1:length(POKE.hyst.results.list)){
  POKE.hyst.results.list.3[[i]] = cbind(POKE.hyst.results.list.2[[i]], HIs.tests[[i]])
}

POKE.hyst.results.df = bind_rows(POKE.hyst.results.list.3, .id = "column_label")

POKE.hyst.results.df$storm.ID = c("POKE_storm1_07_15_NO3",
                                  "POKE_storm1_07_15_fDOM",
                                  "POKE_storm1_07_15_SPC",
                                  "POKE_storm1_07_15_turb",
                                  "POKE_storm1_07_15_abs",
                                  "POKE_storm2_09_03_NO3",
                                  "POKE_storm2_09_03_fDOM",
                                  "POKE_storm2_09_03_SPC",
                                  "POKE_storm2_09_03_turb",
                                  "POKE_storm2_09_03_abs",
                                  "POKE_storm3_09_09_NO3",
                                  "POKE_storm3_09_09_fDOM",
                                  "POKE_storm3_09_09_SPC",
                                  "POKE_storm3_09_09_turb",
                                  "POKE_storm3_09_09_abs",
                                  "POKE_storm4_09_14_NO3",
                                  "POKE_storm4_09_14_fDOM",
                                  "POKE_storm4_09_14_SPC",
                                  "POKE_storm4_09_14_turb",
                                  "POKE_storm4_09_14_abs")
                                  


POKE.hyst.results.df$site.ID = "POKE"

write.csv(POKE.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/POKE/POKE.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/POKE/POKE.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= POKE.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

POKE.HI.df = bind_rows(HIs.df.list, .id = "column_label")
POKE.HI.df$storm.ID = c(rep("POKE_storm1_07_15_NO3", 50),
                        rep("POKE_storm1_07_15_fDOM", 50),
                        rep("POKE_storm1_07_15_SPC", 50),
                        rep("POKE_storm1_07_15_turb", 50),
                        rep("POKE_storm1_07_15_abs", 50),
                        rep("POKE_storm2_09_03_NO3", 50),
                        rep("POKE_storm2_09_03_fDOM", 50),
                        rep("POKE_storm2_09_03_SPC", 50),
                        rep("POKE_storm2_09_03_turb", 50),
                        rep("POKE_storm2_09_03_abs", 50),
                        rep("POKE_storm3_09_09_NO3", 50),
                        rep("POKE_storm3_09_09_fDOM", 50),
                        rep("POKE_storm3_09_09_SPC", 50),
                        rep("POKE_storm3_09_09_turb", 50),
                        rep("POKE_storm3_09_09_abs", 50),
                        rep("POKE_storm4_09_14_NO3", 50),
                        rep("POKE_storm4_09_14_fDOM", 50),
                        rep("POKE_storm4_09_14_SPC", 50),
                        rep("POKE_storm4_09_14_turb", 50),
                        rep("POKE_storm4_09_14_abs", 50))
                        
                        
                        
                        

POKE.HI.df$storm.ID = as.factor(POKE.HI.df$storm.ID)
POKE.HI.df = separate(data=POKE.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(POKE.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/POKE/POKE.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/POKE/POKE.HI.df.csv")



POKE.HI.df$date <- as.Date(with(POKE.HI.df, paste(month, day, sep = "-")), "%m-%d")
POKE.HI.df$doy <- yday(POKE.HI.df$date) 

g0 <- ggplot(POKE.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/POKE/POKE.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(POKE.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/POKE/POKE.HI.df.doy.csv")

```


### VAUL ###
```{python}
# VAUL #
VAUL_storm1_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm1_08_01_Q.csv")
VAUL_storm1_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm1_08_01_NO3.csv")
VAUL_storm1_08_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm1_08_01_fDOM.csv")
VAUL_storm1_08_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm1_08_01_SPC.csv")
VAUL_storm1_08_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm1_08_01_turb.csv")
VAUL_storm1_08_01_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm1_08_01_abs.csv")


VAUL_storm2_09_14_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm2_09_14_Q.csv")
VAUL_storm2_09_14_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm2_09_14_NO3.csv")
VAUL_storm2_09_14_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm2_09_14_fDOM.csv")
VAUL_storm2_09_14_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm2_09_14_SPC.csv")
VAUL_storm2_09_14_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm2_09_14_turb.csv")
VAUL_storm2_09_14_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/VAUL/VAUL_storm2_09_14_abs.csv")

```



VAUL_storms
```{python}
## NO3 ##
VAUL_storm1_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_08_01_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_08_01_NO3 = hysteresisMetrics(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_09_14_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_09_14_NO3['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_09_14_NO3 = hysteresisMetrics(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
VAUL_storm1_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_08_01_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_08_01_fDOM = hysteresisMetrics(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_09_14_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_09_14_fDOM['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_09_14_fDOM = hysteresisMetrics(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
VAUL_storm1_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_08_01_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_08_01_SPC = hysteresisMetrics(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_09_14_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_09_14_SPC['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_09_14_SPC = hysteresisMetrics(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
VAUL_storm1_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_08_01_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_08_01_turb = hysteresisMetrics(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_09_14_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_09_14_turb['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_09_14_turb = hysteresisMetrics(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## abs ##
VAUL_storm1_08_01_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm1_08_01_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm1_08_01_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm1_08_01_abs = hysteresisMetrics(VAUL_storm1_08_01_Q, VAUL_storm1_08_01_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

VAUL_storm2_09_14_Q['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
VAUL_storm2_09_14_abs['valuedatetime'] =  pd.to_datetime(VAUL_storm2_09_14_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_VAUL_storm2_09_14_abs = hysteresisMetrics(VAUL_storm2_09_14_Q, VAUL_storm2_09_14_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```

VAUL results
```{r}
VAUL.hyst.results.list = list(py$hysdict_VAUL_storm1_08_01_NO3,
                             
                             
                              
                              py$hysdict_VAUL_storm1_08_01_abs,
                              py$hysdict_VAUL_storm2_09_14_NO3,
                              py$hysdict_VAUL_storm2_09_14_fDOM,
                              py$hysdict_VAUL_storm2_09_14_SPC,
                              py$hysdict_VAUL_storm2_09_14_turb,
                              py$hysdict_VAUL_storm2_09_14_abs)
                              
                              
                              

VAUL.hyst.results.list.2 = list()
for (i in 1:length(VAUL.hyst.results.list)){
VAUL.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
VAUL.hyst.results.list[[i]][["HI_mean_with_Interp"]],
VAUL.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
VAUL.hyst.results.list[[i]][["Normalized slope of response"]],
VAUL.hyst.results.list[[i]][["interpolated Max width of response"]],
VAUL.hyst.results.list[[i]][["Min response"]],
VAUL.hyst.results.list[[i]][["Max response"]],
VAUL.hyst.results.list[[i]][["Peak Q"]]
))))
names(VAUL.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(VAUL.hyst.results.list)){
  HIs.list[[i]] = unlist(VAUL.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

VAUL.hyst.results.list.3 =list()
for (i in 1:length(VAUL.hyst.results.list)){
  VAUL.hyst.results.list.3[[i]] = cbind(VAUL.hyst.results.list.2[[i]], HIs.tests[[i]])
}

VAUL.hyst.results.df = bind_rows(VAUL.hyst.results.list.3, .id = "column_label")

VAUL.hyst.results.df$storm.ID = c("VAUL_storm1_08_01_NO3",
                                  "VAUL_storm1_08_01_abs",
                                  "VAUL_storm1_09_14_NO3",
                                  "VAUL_storm1_09_14_fDOM",
                                  "VAUL_storm1_09_14_SPC",
                                  "VAUL_storm1_09_14_turb",
                                  "VAUL_storm1_09_14_abs")
                                  


VAUL.hyst.results.df$site.ID = "VAUL"

write.csv(VAUL.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/VAUL/VAUL.hyst.results.csv")

# plot HI by normalized discharge
HIs.Q.list =list()
HIs.df.list = list()
pdf("~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/VAUL/VAUL.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= VAUL.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

VAUL.HI.df = bind_rows(HIs.df.list, .id = "column_label")
VAUL.HI.df$storm.ID = c(rep("VAUL_storm1_08_01_NO3", 50),
                        rep("VAUL_storm1_08_01_abs", 50),
                        rep("VAUL_storm2_09_14_NO3", 50),
                        rep("VAUL_storm2_09_14_fDOM", 50),
                        rep("VAUL_storm2_09_14_SPC", 50),
                        rep("VAUL_storm2_09_14_turb", 50),
                        rep("VAUL_storm2_09_14_abs", 50))

VAUL.HI.df$storm.ID = as.factor(VAUL.HI.df$storm.ID)
VAUL.HI.df = separate(data=VAUL.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)
par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(VAUL.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/VAUL/VAUL.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/VAUL/VAUL.HI.df.csv")


VAUL.HI.df$date <- as.Date(with(VAUL.HI.df, paste(month, day, sep = "-")), "%m-%d")
VAUL.HI.df$doy <- yday(VAUL.HI.df$date) 

g0 <- ggplot(VAUL.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/VAUL/VAUL.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(VAUL.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/VAUL/VAUL.HI.df.doy.csv")

```

### STRT ###
```{python}
# STRT #
STRT_storm1_08_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm1_08_19_Q.csv")
STRT_storm1_08_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm1_08_19_NO3.csv")
STRT_storm1_08_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm1_08_19_fDOM.csv")
STRT_storm1_08_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm1_08_19_SPC.csv")
STRT_storm1_08_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm1_08_19_Turb.csv")
STRT_storm1_08_19_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm1_08_19_abs.csv")

STRT_storm2_09_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm2_09_04_Q.csv")
STRT_storm2_09_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm2_09_04_NO3.csv")
STRT_storm2_09_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm2_09_04_fDOM.csv")
STRT_storm2_09_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm2_09_04_SPC.csv")
STRT_storm2_09_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm2_09_04_Turb.csv")
STRT_storm2_09_04_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm2_09_04_abs.csv")

STRT_storm3_09_22_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm3_09_22_Q.csv")
STRT_storm3_09_22_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm3_09_22_NO3.csv")
STRT_storm3_09_22_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm3_09_22_fDOM.csv")
STRT_storm3_09_22_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm3_09_22_SPC.csv")
STRT_storm3_09_22_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm3_09_22_Turb.csv")
STRT_storm3_09_22_abs = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/STRT/STRT_storm3_09_22_abs.csv")


```

STRT_storms
```{python}
## NO3 ##
STRT_storm1_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_08_19_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1_08_19_NO3 = hysteresisMetrics(STRT_storm1_08_19_Q, STRT_storm1_08_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_09_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_09_04_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2_09_04_NO3 = hysteresisMetrics(STRT_storm2_09_04_Q, STRT_storm2_09_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_09_22_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_09_22_NO3['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_09_22_NO3 = hysteresisMetrics(STRT_storm3_09_22_Q, STRT_storm3_09_22_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
STRT_storm1_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_08_19_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1_08_19_fDOM = hysteresisMetrics(STRT_storm1_08_19_Q, STRT_storm1_08_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_09_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_09_04_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2_09_04_fDOM = hysteresisMetrics(STRT_storm2_09_04_Q, STRT_storm2_09_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_09_22_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_09_22_fDOM['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_09_22_fDOM = hysteresisMetrics(STRT_storm3_09_22_Q, STRT_storm3_09_22_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
STRT_storm1_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_08_19_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1_08_19_SPC = hysteresisMetrics(STRT_storm1_08_19_Q, STRT_storm1_08_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_09_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_09_04_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2_09_04_SPC = hysteresisMetrics(STRT_storm2_09_04_Q, STRT_storm2_09_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_09_22_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_09_22_SPC['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_09_22_SPC = hysteresisMetrics(STRT_storm3_09_22_Q, STRT_storm3_09_22_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
STRT_storm1_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_08_19_turb['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1_08_19_turb = hysteresisMetrics(STRT_storm1_08_19_Q, STRT_storm1_08_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_09_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_09_04_turb['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2_09_04_turb = hysteresisMetrics(STRT_storm2_09_04_Q, STRT_storm2_09_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_09_22_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_09_22_turb['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_09_22_turb = hysteresisMetrics(STRT_storm3_09_22_Q, STRT_storm3_09_22_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## abs ##
STRT_storm1_08_19_Q['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm1_08_19_abs['valuedatetime'] =  pd.to_datetime(STRT_storm1_08_19_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm1_08_19_abs = hysteresisMetrics(STRT_storm1_08_19_Q, STRT_storm1_08_19_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm2_09_04_Q['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm2_09_04_abs['valuedatetime'] =  pd.to_datetime(STRT_storm2_09_04_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm2_09_04_abs = hysteresisMetrics(STRT_storm2_09_04_Q, STRT_storm2_09_04_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

STRT_storm3_09_22_Q['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
STRT_storm3_09_22_abs['valuedatetime'] =  pd.to_datetime(STRT_storm3_09_22_abs['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 5 # 5 minutes between records
hysdict_STRT_storm3_09_22_abs = hysteresisMetrics(STRT_storm3_09_22_Q, STRT_storm3_09_22_abs, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')
```

STRT results 
```{r}
STRT.hyst.results.list = list(py$hysdict_STRT_storm1_08_19_NO3,
                              py$hysdict_STRT_storm1_08_19_fDOM,
                              py$hysdict_STRT_storm1_08_19_SPC,
                              py$hysdict_STRT_storm1_08_19_turb,
                              py$hysdict_STRT_storm1_08_19_abs,
                              py$hysdict_STRT_storm2_09_04_NO3,
                              py$hysdict_STRT_storm2_09_04_fDOM,
                              py$hysdict_STRT_storm2_09_04_SPC,
                              py$hysdict_STRT_storm2_09_04_turb,
                              py$hysdict_STRT_storm2_09_04_abs,
                              py$hysdict_STRT_storm3_09_22_NO3,
                              py$hysdict_STRT_storm3_09_22_fDOM,
                              py$hysdict_STRT_storm3_09_22_SPC,
                              py$hysdict_STRT_storm3_09_22_turb,
                              py$hysdict_STRT_storm3_09_22_abs)
                              
STRT.hyst.results.list.2 = list()
for (i in 1:length(STRT.hyst.results.list)){
STRT.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
STRT.hyst.results.list[[i]][["HI_mean_with_Interp"]],
STRT.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
STRT.hyst.results.list[[i]][["Normalized slope of response"]],
STRT.hyst.results.list[[i]][["interpolated Max width of response"]],
STRT.hyst.results.list[[i]][["Min response"]],
STRT.hyst.results.list[[i]][["Max response"]],
STRT.hyst.results.list[[i]][["Peak Q"]]
))))
names(STRT.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}

HIs.list = list()
HIs.tests = list()
for (i in 1:length(STRT.hyst.results.list)){
  HIs.list[[i]] = unlist(STRT.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

STRT.hyst.results.list.3 =list()
for (i in 1:length(STRT.hyst.results.list)){
  STRT.hyst.results.list.3[[i]] = cbind(STRT.hyst.results.list.2[[i]], HIs.tests[[i]])
}

STRT.hyst.results.df = bind_rows(STRT.hyst.results.list.3, .id = "column_label")

STRT.hyst.results.df$storm.ID = c("STRT_storm1_08_19_NO3",
                                  "STRT_storm1_08_19_fDOM",
                                  "STRT_storm1_08_19_SPC",
                                  "STRT_storm1_08_19_turb",
                                  "STRT_storm1_08_19_abs",
                                  "STRT_storm2_09_04_NO3",
                                  "STRT_storm2_09_04_fDOM",
                                  "STRT_storm2_09_04_SPC",
                                  "STRT_storm2_09_04_turb",
                                  "STRT_storm2_09_04_abs",
                                  "STRT_storm3_09_22_NO3",
                                  "STRT_storm3_09_22_fDOM",
                                  "STRT_storm3_09_22_SPC",
                                  "STRT_storm3_09_22_turb",
                                  "STRT_storm3_09_22_abs")
                                  

              

STRT.hyst.results.df$site.ID = "STRT"

write.csv(STRT.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/STRT/STRT.hyst.results.csv")


# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/STRT/STRT.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= STRT.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

STRT.HI.df = bind_rows(HIs.df.list, .id = "column_label")
STRT.HI.df$storm.ID = c(rep("STRT_storm1_08_19_NO3", 50),
                        rep("STRT_storm1_08_19_fDOM", 50),
                        rep("STRT_storm1_08_19_SPC", 50),
                        rep("STRT_storm1_08_19_turb", 50),
                        rep("STRT_storm1_08_19_abs", 50),
                        rep("STRT_storm2_09_04_NO3", 50),
                        rep("STRT_storm2_09_04_fDOM", 50),
                        rep("STRT_storm2_09_04_SPC", 50),
                        rep("STRT_storm2_09_04_turb", 50),
                        rep("STRT_storm2_09_04_abs", 50),
                        rep("STRT_storm3_09_22_NO3", 50),
                        rep("STRT_storm3_09_22_fDOM", 50),
                        rep("STRT_storm3_09_22_SPC", 50),
                        rep("STRT_storm3_09_22_turb", 50),
                        rep("STRT_storm3_09_22_abs", 50))
                        
                        


STRT.HI.df$storm.ID = as.factor(STRT.HI.df$storm.ID)
STRT.HI.df = separate(data=STRT.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}
g0 <- ggplot(STRT.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/STRT/STRT.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(STRT.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/STRT/STRT.HI.df.csv")

STRT.HI.df$date <- as.Date(with(STRT.HI.df, paste(month, day, sep = "-")), "%m-%d")
STRT.HI.df$doy <- yday(STRT.HI.df$date) 

g0 <- ggplot(STRT.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/STRT/STRT.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(STRT.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/STRT/STRT.HI.df.doy.csv")
```


### CARI ###
CARI
```{python}
# CARI #
CARI_storm1_07_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm1_07_15_Q.csv")
CARI_storm1_07_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm1_07_15_NO3.csv")
CARI_storm1_07_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm1_07_15_fDOM.csv")
CARI_storm1_07_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm1_07_15_SPC.csv")
CARI_storm1_07_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm1_07_15_Turb.csv")

CARI_storm2_07_19_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm2_07_19_Q.csv")
CARI_storm2_07_19_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm2_07_19_NO3.csv")
CARI_storm2_07_19_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm2_07_19_fDOM.csv")
CARI_storm2_07_19_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm2_07_19_SPC.csv")
CARI_storm2_07_19_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm2_07_19_Turb.csv")

CARI_storm3_08_01_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm3_08_01_Q.csv")
CARI_storm3_08_01_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm3_08_01_NO3.csv")
CARI_storm3_08_01_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm3_08_01_fDOM.csv")
CARI_storm3_08_01_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm3_08_01_SPC.csv")
CARI_storm3_08_01_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm3_08_01_Turb.csv")

CARI_storm4a_08_05_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4a_08_05_Q.csv")
CARI_storm4a_08_05_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4a_08_05_NO3.csv")
CARI_storm4a_08_05_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4a_08_05_fDOM.csv")
CARI_storm4a_08_05_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4a_08_05_SPC.csv")
CARI_storm4a_08_05_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4a_08_05_Turb.csv")

CARI_storm4b_08_06_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4b_08_06_Q.csv")
CARI_storm4b_08_06_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4b_08_06_NO3.csv")
CARI_storm4b_08_06_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4b_08_06_fDOM.csv")
CARI_storm4b_08_06_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4b_08_06_SPC.csv")
CARI_storm4b_08_06_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm4b_08_06_Turb.csv")

CARI_storm5_08_08_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm5_08_08_Q.csv")
CARI_storm5_08_08_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm5_08_08_NO3.csv")
CARI_storm5_08_08_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm5_08_08_fDOM.csv")
CARI_storm5_08_08_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm5_08_08_SPC.csv")
CARI_storm5_08_08_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm5_08_08_Turb.csv")

CARI_storm6_08_15_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm6_08_15_Q.csv")
CARI_storm6_08_15_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm6_08_15_NO3.csv")
CARI_storm6_08_15_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm6_08_15_fDOM.csv")
CARI_storm6_08_15_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm6_08_15_SPC.csv")
CARI_storm6_08_15_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm6_08_15_Turb.csv")

CARI_storm7_08_18_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm7_08_18_Q.csv")
CARI_storm7_08_18_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm7_08_18_NO3.csv")
CARI_storm7_08_18_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm7_08_18_fDOM.csv")
CARI_storm7_08_18_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm7_08_18_SPC.csv")
CARI_storm7_08_18_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm7_08_18_Turb.csv")

CARI_storm8_09_04_Q = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm8_09_04_Q.csv")
CARI_storm8_09_04_NO3 = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm8_09_04_NO3.csv")
CARI_storm8_09_04_fDOM = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm8_09_04_fDOM.csv")
CARI_storm8_09_04_SPC = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm8_09_04_SPC.csv")
CARI_storm8_09_04_turb = pd.read_csv("~/Documents/Storms_clean_repo/Storm_Events/2022/CARI/CARI_storm8_09_04_Turb.csv")
```

CARI_storms
```{python}
## NO3 ##
CARI_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_07_15_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_07_15_NO3 = hysteresisMetrics(CARI_storm1_07_15_Q, CARI_storm1_07_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_07_19_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_07_19_NO3 = hysteresisMetrics(CARI_storm2_07_19_Q, CARI_storm2_07_19_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_08_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_08_01_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_08_01_NO3 = hysteresisMetrics(CARI_storm3_08_01_Q, CARI_storm3_08_01_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_08_05_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_08_05_NO3 = hysteresisMetrics(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_08_06_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_08_06_NO3 = hysteresisMetrics(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_08_08_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_08_08_NO3 = hysteresisMetrics(CARI_storm5_08_08_Q, CARI_storm5_08_08_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_15_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_15_NO3 = hysteresisMetrics(CARI_storm6_08_15_Q, CARI_storm6_08_15_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_18_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_18_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_18_NO3 = hysteresisMetrics(CARI_storm7_08_18_Q, CARI_storm7_08_18_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_09_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_09_04_NO3['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_NO3['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_09_04_NO3 = hysteresisMetrics(CARI_storm8_09_04_Q, CARI_storm8_09_04_NO3, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## fDOM ##
CARI_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_07_15_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_07_15_fDOM = hysteresisMetrics(CARI_storm1_07_15_Q, CARI_storm1_07_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_07_19_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_07_19_fDOM = hysteresisMetrics(CARI_storm2_07_19_Q, CARI_storm2_07_19_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_08_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_08_01_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_08_01_fDOM = hysteresisMetrics(CARI_storm3_08_01_Q, CARI_storm3_08_01_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_08_05_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_08_05_fDOM = hysteresisMetrics(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_08_06_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_08_06_fDOM = hysteresisMetrics(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_08_08_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_08_08_fDOM = hysteresisMetrics(CARI_storm5_08_08_Q, CARI_storm5_08_08_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_15_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_15_fDOM = hysteresisMetrics(CARI_storm6_08_15_Q, CARI_storm6_08_15_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_18_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_18_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_18_fDOM = hysteresisMetrics(CARI_storm7_08_18_Q, CARI_storm7_08_18_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_09_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_09_04_fDOM['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_fDOM['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_09_04_fDOM = hysteresisMetrics(CARI_storm8_09_04_Q, CARI_storm8_09_04_fDOM, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## SPC ##
CARI_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_07_15_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_07_15_SPC = hysteresisMetrics(CARI_storm1_07_15_Q, CARI_storm1_07_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_07_19_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_07_19_SPC = hysteresisMetrics(CARI_storm2_07_19_Q, CARI_storm2_07_19_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_08_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_08_01_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_08_01_SPC = hysteresisMetrics(CARI_storm3_08_01_Q, CARI_storm3_08_01_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_08_05_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_08_05_SPC = hysteresisMetrics(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_08_06_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_08_06_SPC = hysteresisMetrics(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_08_08_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_08_08_SPC = hysteresisMetrics(CARI_storm5_08_08_Q, CARI_storm5_08_08_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_15_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_15_SPC = hysteresisMetrics(CARI_storm6_08_15_Q, CARI_storm6_08_15_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_18_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_18_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_18_SPC = hysteresisMetrics(CARI_storm7_08_18_Q, CARI_storm7_08_18_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_09_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_09_04_SPC['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_SPC['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_09_04_SPC = hysteresisMetrics(CARI_storm8_09_04_Q, CARI_storm8_09_04_SPC, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

## turb ##
CARI_storm1_07_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm1_07_15_turb['valuedatetime'] =  pd.to_datetime(CARI_storm1_07_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm1_07_15_turb = hysteresisMetrics(CARI_storm1_07_15_Q, CARI_storm1_07_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm2_07_19_Q['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm2_07_19_turb['valuedatetime'] =  pd.to_datetime(CARI_storm2_07_19_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm2_07_19_turb = hysteresisMetrics(CARI_storm2_07_19_Q, CARI_storm2_07_19_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm3_08_01_Q['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm3_08_01_turb['valuedatetime'] =  pd.to_datetime(CARI_storm3_08_01_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm3_08_01_turb = hysteresisMetrics(CARI_storm3_08_01_Q, CARI_storm3_08_01_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4a_08_05_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4a_08_05_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4a_08_05_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4a_08_05_turb = hysteresisMetrics(CARI_storm4a_08_05_Q, CARI_storm4a_08_05_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm4b_08_06_Q['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm4b_08_06_turb['valuedatetime'] =  pd.to_datetime(CARI_storm4b_08_06_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm4b_08_06_turb = hysteresisMetrics(CARI_storm4b_08_06_Q, CARI_storm4b_08_06_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm5_08_08_Q['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm5_08_08_turb['valuedatetime'] =  pd.to_datetime(CARI_storm5_08_08_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm5_08_08_turb = hysteresisMetrics(CARI_storm5_08_08_Q, CARI_storm5_08_08_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm6_08_15_Q['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm6_08_15_turb['valuedatetime'] =  pd.to_datetime(CARI_storm6_08_15_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm6_08_15_turb = hysteresisMetrics(CARI_storm6_08_15_Q, CARI_storm6_08_15_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm7_08_18_Q['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm7_08_18_turb['valuedatetime'] =  pd.to_datetime(CARI_storm7_08_18_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm7_08_18_turb = hysteresisMetrics(CARI_storm7_08_18_Q, CARI_storm7_08_18_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

CARI_storm8_09_04_Q['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_Q['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
CARI_storm8_09_04_turb['valuedatetime'] =  pd.to_datetime(CARI_storm8_09_04_turb['valuedatetime'], format='%Y-%m-%d %H:%M:%S')
timespacing = 15 # 15 minutes between records
hysdict_CARI_storm8_09_04_turb = hysteresisMetrics(CARI_storm8_09_04_Q, CARI_storm8_09_04_turb, timespacing, timespacing, debug=False, interpall=True, discharge_time_spacing_units='minutes', response_time_spacing_units='minutes', discharge_units='Lsec')

```
CARI results 
```{r}

CARI.hyst.results.list = list(py$hysdict_CARI_storm1_07_15_NO3,
                              py$hysdict_CARI_storm1_07_15_fDOM,
                              py$hysdict_CARI_storm1_07_15_SPC,
                              py$hysdict_CARI_storm1_07_15_turb,
                              py$hysdict_CARI_storm2_07_19_NO3,
                              py$hysdict_CARI_storm2_07_19_fDOM,
                              py$hysdict_CARI_storm2_07_19_SPC,
                              py$hysdict_CARI_storm2_07_19_turb,
                              py$hysdict_CARI_storm3_08_01_NO3,
                              py$hysdict_CARI_storm3_08_01_fDOM,
                              py$hysdict_CARI_storm3_08_01_SPC,
                              py$hysdict_CARI_storm3_08_01_turb,
                              py$hysdict_CARI_storm4a_08_05_NO3,
                              py$hysdict_CARI_storm4a_08_05_fDOM,
                              py$hysdict_CARI_storm4a_08_05_SPC,
                              py$hysdict_CARI_storm4a_08_05_turb,
                              py$hysdict_CARI_storm4b_08_06_NO3,
                              py$hysdict_CARI_storm4b_08_06_fDOM,
                              py$hysdict_CARI_storm4b_08_06_SPC,
                              py$hysdict_CARI_storm4b_08_06_turb,
                              py$hysdict_CARI_storm5_08_08_NO3,
                              py$hysdict_CARI_storm5_08_08_fDOM,
                              py$hysdict_CARI_storm5_08_08_SPC,
                              py$hysdict_CARI_storm5_08_08_turb,
                              py$hysdict_CARI_storm6_08_15_NO3,
                              py$hysdict_CARI_storm6_08_15_fDOM,
                              py$hysdict_CARI_storm6_08_15_SPC,
                              py$hysdict_CARI_storm6_08_15_turb,
                              py$hysdict_CARI_storm7_08_18_NO3,
                              py$hysdict_CARI_storm7_08_18_fDOM,
                              py$hysdict_CARI_storm7_08_18_SPC,
                              py$hysdict_CARI_storm7_08_18_turb,
                              py$hysdict_CARI_storm8_09_04_NO3,
                              py$hysdict_CARI_storm8_09_04_fDOM,
                              py$hysdict_CARI_storm8_09_04_SPC,
                              py$hysdict_CARI_storm8_09_04_turb)
                             
                              
                             

CARI.hyst.results.list.2 = list()
for (i in 1:length(CARI.hyst.results.list)){
CARI.hyst.results.list.2[[i]] = as.data.frame(t(as.numeric(c(
CARI.hyst.results.list[[i]][["HI_mean_with_Interp"]],
CARI.hyst.results.list[[i]][["HI_standard_deviation_with_Interp"]],
CARI.hyst.results.list[[i]][["Normalized slope of response"]],
CARI.hyst.results.list[[i]][["interpolated Max width of response"]],
CARI.hyst.results.list[[i]][["Min response"]],
CARI.hyst.results.list[[i]][["Max response"]],
CARI.hyst.results.list[[i]][["Peak Q"]]
))))
names(CARI.hyst.results.list.2[[i]]) = c("HI_mean_Interp", "HI_sd_with_Interp", "N.S.", "Max_width_Interp", "Min_response", "Max_response", "Peak_Q")
}


HIs.list = list()
HIs.tests = list()
for (i in 1:length(CARI.hyst.results.list)){
  HIs.list[[i]] = unlist(CARI.hyst.results.list[[i]][["Hysteresis_Index"]],recursive=FALSE)
  HIs.tests[[i]] = as.data.frame(t(round(as.numeric(c(shapiro.test(HIs.list[[i]])$statistic, shapiro.test(HIs.list[[i]])$p.value,
                     t.test(HIs.list[[i]], mu=0)$statistic, t.test(HIs.list[[i]], mu=0)$p.value, 
                     t.test(HIs.list[[i]], mu=0)$conf.int[1],t.test(HIs.list[[i]], mu=0)$conf.int[2],
                     wilcox.test(HIs.list[[i]], mu=0)$statistic, wilcox.test(HIs.list[[i]], mu=0)$p.value)), 4)))
  names(HIs.tests[[i]]) = c("ShapiroTest.W", "ShapiroTest.p", "t.test.stat", "t.test.p", "t.test.CIlow", "t.test.CIhigh",
                            "wilcox.test.stat", "wilcox.test.p")
}

CARI.hyst.results.list.3 =list()
for (i in 1:length(CARI.hyst.results.list)){
  CARI.hyst.results.list.3[[i]] = cbind(CARI.hyst.results.list.2[[i]], HIs.tests[[i]])
}

CARI.hyst.results.df = bind_rows(CARI.hyst.results.list.3, .id = "column_label")

CARI.hyst.results.df$storm.ID = c("CARI_storm1_07_15_NO3",
                                  "CARI_storm1_07_15_fDOM",
                                  "CARI_storm1_07_15_SPC",
                                  "CARI_storm1_07_15_turb",
                                  "CARI_storm2_07_19_NO3",
                                  "CARI_storm2_07_19_fDOM",
                                  "CARI_storm2_07_19_SPC",
                                  "CARI_storm2_07_19_turb",
                                  "CARI_storm3_08_01_NO3",
                                  "CARI_storm3_08_01_fDOM",
                                  "CARI_storm3_08_01_SPC",
                                  "CARI_storm3_08_01_turb",
                                  "CARI_storm4a_08_05_NO3",
                                  "CARI_storm4a_08_05_fDOM",
                                  "CARI_storm4a_08_05_SPC",
                                  "CARI_storm4a_08_05_turb",
                                  "CARI_storm4b_08_06_NO3",
                                  "CARI_storm4b_08_06_fDOM",
                                  "CARI_storm4b_08_06_SPC",
                                  "CARI_storm4b_08_06_turb",
                                  "CARI_storm5_08_08_NO3",
                                  "CARI_storm5_08_08_fDOM",
                                  "CARI_storm5_08_08_SPC",
                                  "CARI_storm5_08_08_turb",
                                  "CARI_storm6_08_15_NO3",
                                  "CARI_storm6_08_15_fDOM",
                                  "CARI_storm6_08_15_SPC",
                                  "CARI_storm6_08_15_turb",
                                  "CARI_storm7_08_18_NO3",
                                  "CARI_storm7_08_18_fDOM",
                                  "CARI_storm7_08_18_SPC",
                                  "CARI_storm7_08_18_turb",
                                  "CARI_storm8_09_04_NO3",
                                  "CARI_storm8_09_04_fDOM",
                                  "CARI_storm8_09_04_SPC",
                                  "CARI_storm8_09_04_turb")
                                  
                             
                            

CARI.hyst.results.df$site.ID = "CARI"

write.csv(CARI.hyst.results.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/CARI/CARI.hyst.results.csv")

# plot HI by normalized discharge
# HIs.Q.list =list()
# HIs.df.list = list()
# pdf("~/Documents/Storms/Output_from_analysis/HI_plots/2021/CARI/CARI.hyst.HI_Q.plots.pdf", width = 25, height =15, onefile=FALSE)
# par(mfrow=c(4,7))
# for (i in 1:length(HIs.list)) {
#   HIs.Q.list[[i]] = names(HIs.list[[i]])
#   HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
#   HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
#   HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
#   HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
# plot(HIs.df.list[[i]][["V1"]] ~ HIs.df.list[[i]][["V2"]], type="l",
#      ylab="norm.response", xlab="Q intervals", main= CARI.hyst.results.df$storm.ID[i])
# abline(h=0, lty=2)
# }
# dev.off()

## plot HI with bootstrapped 95% CIs around the median ##
HIs.Q.list =list()
HIs.df.list = list()
par(mfrow=c(1,1))
for (i in 1:length(HIs.list)) {
  HIs.Q.list[[i]] = names(HIs.list[[i]])
  HIs.Q.list[[i]] = (sapply(strsplit(HIs.Q.list[[i]], " "), "[[", 4))
  HIs.Q.list[[i]] = as.numeric(gsub("%", "", HIs.Q.list[[i]]))
  HIs.df.list[[i]] = as.data.frame(cbind(HIs.list[[i]], HIs.Q.list[[i]]))
  HIs.df.list[[i]]= HIs.df.list[[i]][order(HIs.df.list[[i]][["V2"]]),]
  names(HIs.df.list[[i]]) = c("HI", "Q_interval")
}

CARI.HI.df = bind_rows(HIs.df.list, .id = "column_label")
CARI.HI.df$storm.ID = c(rep("CARI_storm1_07_15_NO3", 50),
                        rep("CARI_storm1_07_15_fDOM", 50),
                        rep("CARI_storm1_07_15_SPC", 50),
                        rep("CARI_storm1_07_15_turb", 50),
                        rep("CARI_storm2_07_19_NO3", 50),
                        rep("CARI_storm2_07_19_fDOM", 50),
                        rep("CARI_storm2_07_19_SPC", 50),
                        rep("CARI_storm2_07_19_turb", 50),
                        rep("CARI_storm3_08_01_NO3", 49),
                        rep("CARI_storm3_08_01_fDOM", 50),
                        rep("CARI_storm3_08_01_SPC", 49),
                        rep("CARI_storm3_08_01_turb", 50),
                        rep("CARI_storm4a_08_05_NO3", 50),
                        rep("CARI_storm4a_08_05_fDOM", 50),
                        rep("CARI_storm4a_08_05_SPC", 50),
                        rep("CARI_storm4a_08_05_turb", 50),
                        rep("CARI_storm4b_08_06_NO3", 50),
                        rep("CARI_storm4b_08_06_fDOM", 50),
                        rep("CARI_storm4b_08_06_SPC", 50),
                        rep("CARI_storm4b_08_06_turb", 50),
                        rep("CARI_storm5_08_08_NO3", 50),
                        rep("CARI_storm5_08_08_fDOM", 50),
                        rep("CARI_storm5_08_08_SPC", 50),
                        rep("CARI_storm5_08_08_turb", 50),
                        rep("CARI_storm6_08_15_NO3", 50),
                        rep("CARI_storm6_08_15_fDOM", 50),
                        rep("CARI_storm6_08_15_SPC", 50),
                        rep("CARI_storm6_08_15_turb", 50),
                        rep("CARI_storm7_08_18_NO3", 50),
                        rep("CARI_storm7_08_18_fDOM", 50),
                        rep("CARI_storm7_08_18_SPC", 50),
                        rep("CARI_storm7_08_18_turb", 50),
                        rep("CARI_storm8_09_04_NO3", 50),
                        rep("CARI_storm8_09_04_fDOM", 50),
                        rep("CARI_storm8_09_04_SPC", 50),
                        rep("CARI_storm8_09_04_turb", 50))
                        


CARI.HI.df$storm.ID = as.factor(CARI.HI.df$storm.ID)
CARI.HI.df = separate(data=CARI.HI.df, col=storm.ID, into=c("site.ID","storm.num", "month", "day", "response"), sep = "_", remove = F)

par(mfrow=c(1,1))
median_cl_boot <- function(x, conf = 0.95) {
  lconf <- (1 - conf)/2
  uconf <- 1 - lconf
  require(boot)
  bmedian <- function(x, ind) median(x[ind])
  bt <- boot(x, bmedian, 10000)
  bb <- boot.ci(bt, conf = 0.95, type = "perc")
  data.frame(y = median(x), ymin = quantile(bt$t, lconf), ymax = quantile(bt$t, 
                                                                          uconf))
}


g0 <- ggplot(CARI.HI.df, aes(x = storm.num, y = HI, label=storm.num, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/CARI/CARI.HI.median.boot.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/CARI/CARI.HI.df.csv")


CARI.HI.df$date <- as.Date(with(CARI.HI.df, paste(month, day, sep = "-")), "%m-%d")
CARI.HI.df$doy <- yday(CARI.HI.df$date) 

g0 <- ggplot(CARI.HI.df, aes(x = doy, y = HI, label=doy, fill=response))
g1 = g0 + geom_jitter(width = 0.1, fill = "grey", colour = "#0571B0", alpha=0.25, size=3) + 
  theme(axis.text.x = element_text(angle = 0))+  labs(x="") + facet_wrap(~ response, scales = "free_x") +
  theme_bw() +geom_hline(yintercept=0) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + theme(legend.position = "none")
g2 <- g1 + 
  stat_summary(fun.data = median_cl_boot, geom = "errorbar",
               colour = "black", width = 0.2, size=1) + 
  stat_summary(fun.y = median, geom = "point", 
               colour = "black", size = 3)

ggsave("~/Documents/Storms_clean_repo/plots/HI_plots/2022/CARI/CARI.HI.median.boot.doy.pdf", plot=g2, width = 8, height = 6, units ="in")
write.csv(CARI.HI.df, "~/Documents/Storms_clean_repo/Output_from_analysis/03_HI_FI/2022/CARI/CARI.HI.df.doy.csv")
```