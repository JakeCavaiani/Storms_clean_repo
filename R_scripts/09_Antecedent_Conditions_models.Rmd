---
title: "09_Antecedent_Conditions_models"
author: "Jake Cavaiani"
date: "9/2/2022"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
---
The purpose of this script is to model HI/BETA against storm attributes, antecedent moisture conditions, and seasonality for each individual catchment and constituent using linear regression 

Input: Antecedent moisture conditions with HI_FI_BETA and catchment characteristics!

Step 1) import full file 
Step 2) standardize and center the data
Step 3) Model! Model structure is lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_xxxx)
Step 4) Check model assumptions
Step 5) Plot all models 

Output: linear model plot 

```{r load-packages, include=FALSE}
library(magrittr)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(data.table)
library(scales)
library(lme4)
library(nlme)
library(datasets)
library(arm)
library(AICcmodavg)
library(gridExtra)
library(grid)
library(ggpmisc)
library(boot)
library(here)
library(broom)
library(viridis)
library(car)
library(MuMIn)
library(ggeffects)
library(dotwhisker)

library(ggeffects)
library(dotwhisker)
library(broom)
library(jtools)
library(GGally)

```




```{r}
# Read in data # 

AMC <- read.csv(here("Output_from_analysis", "07_Combine_HI_BETA_FI", "antecedent_HI_FI_AllYears.csv"))

AMC <- AMC[c("Hyst_index", "HI_ymin", "HI_ymax", "site.ID", "storm.ID", "month.x", "day.x", "response_var", "Flush_index", "FI_ymin", "FI_ymax", "year", "Parameter",  "Beta_index", "SE", "CI", "Beta_ymin", "Beta_ymax", "t", "df", "p", "precip", "temp", "precip.week", "precip.month", "ThreeMonth", "temp.week", "TOTAL.TIME", "Intensity", "doy", "burn", "pf", "date", "TimeSinceChena")] # selecting the columns that I want


colNames <- c("Hyst_index", "HI_ymin", "HI_ymax", "site.ID", "storm.ID", "month", "day", "response_var", "Flush_index", "FI_ymin", "FI_ymax", "year", "Parameter", "Beta_index", "SE", "CI", "Beta_ymin", "Beta_ymax", "t", "df", "p", "StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Duration", "Intensity", "doy", "burn", "pf", "date", "TimeSinceChena")

names(AMC)<- colNames # renaming columns 

# making sure that every year has the same pf extent and burn extent 
AMC <- AMC %>% 
  dplyr::mutate(across(c(pf),
                       ~ifelse(site.ID == "MOOS" | site.ID == "VAUL", "high", "low")))

AMC <- AMC %>% 
  dplyr::mutate(across(c(burn),
                       ~ifelse(site.ID == "FRCH" | site.ID == "VAUL" | site.ID == "CARI", "unburned", "burned")))

# making sure the 2022 intensity column in filled in 
AMC <- AMC %>% 
  dplyr::mutate(across(c(Intensity),
                       ~ifelse(year == "2022", 1, .)))


##subsetting by solute 
# NO3 #
HI_FI_NO3 = subset(AMC, response_var == "NO3")
# fDOM #
HI_FI_fDOM = subset(AMC, response_var == "fDOM")
# SPC #
HI_FI_SPC = subset(AMC, response_var == "SPC")
# turb #
HI_FI_turb = subset(AMC, response_var == "turb")

```

### Scaling and normalizing data ### 
```{r, echo=FALSE}

# scaling data # 
#scaling # 
AMC[c("StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Intensity", "TimeSinceChena")] <- lapply(AMC[c("StormPrecip", "StormTemp", "PrecipWeek", "PrecipMonth", "ThreeMonth", "TempWeek", "Intensity", "TimeSinceChena")], function(x) c(scale(x)))

HI_FI_NO3 = subset(AMC, response_var == "NO3")
# fDOM #
HI_FI_fDOM = subset(AMC, response_var == "fDOM")
# SPC #
HI_FI_SPC = subset(AMC, response_var == "SPC")
# turb #
HI_FI_turb = subset(AMC, response_var == "turb")

```

### HI ###
# NO3 
``` {r}
#### Correlation 
NO3_data <- HI_FI_NO3[,c("Hyst_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]


NO3_data <- na.omit(NO3_data) # 267 to 258 rows 

ggpairs(NO3_data,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("NO3_pairs.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

1) StormTemp is heavily correlated with TempWeek leading up to a storm (0.778) but TempWeek is slightly more correlated with HI (-.05 to -.03)

2) StormTemp is also correlated with time since chena (-0.735) but time since chena is more correlated with HI (0.251 vs. -0.173) so this makes me want to keep Time since Chena and temperature a week before considering that is a more marginal comparison with HI and the temperature predictors. 

3)Precip week is correlated with precip month (0.511) but precip week is more correlated with HI than precip month (-0.242 vs. 0.048)

4)Precip month is correlated with three month precip (0.591) but three month precip is more correlated with HI (0.220 vs. 0.048)

5) Three month is correlated with Time since Chena (0.619) but time since chena is more correlated with HI (0.251 vs. 0.220)

* to sum up this makes me want to drop storm temperature and three month precipitation.....but lets run the model with all of the candidate predictors first and go from there 


```{r}
HI_FI_NO3_MOOS <- subset(HI_FI_NO3, site.ID == "MOOS")
HI_FI_NO3_FRCH <- subset(HI_FI_NO3, site.ID == "FRCH")
HI_FI_NO3_CARI <- subset(HI_FI_NO3, site.ID == "CARI")
HI_FI_NO3_POKE <- subset(HI_FI_NO3, site.ID == "POKE")
HI_FI_NO3_VAUL <- subset(HI_FI_NO3, site.ID == "VAUL")
HI_FI_NO3_STRT <- subset(HI_FI_NO3, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_NO3_MOOS,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("NO3_pairs_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)


```

```{r}
ggpairs(HI_FI_NO3_FRCH,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("NO3_pairs_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)


```

```{r}
ggpairs(HI_FI_NO3_CARI,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("NO3_pairs_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```

```{r}
ggpairs(HI_FI_NO3_POKE,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("NO3_pairs_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```

```{r}
ggpairs(HI_FI_NO3_VAUL,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("NO3_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_VAUL)

vif(VAUL.model)
plot(VAUL.model)

summary(VAUL.model)


```
normality doesnt look great....lets try and log transform 

```{r}
HI_FI_NO3_VAUL$logHI <- log(abs(HI_FI_NO3_VAUL$Hyst_index))
VAUL.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_VAUL)

vif(VAUL.model.log)
plot(VAUL.model.log)
summary(VAUL.model.log)

```
Does this need to be further transformed? 

```{r}
ggpairs(HI_FI_NO3_STRT,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("NO3_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)

```
lets log transform 

```{r}
HI_FI_NO3_STRT$logHI <- log(abs(HI_FI_NO3_STRT$Hyst_index))
STRT.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_STRT)

vif(STRT.model.log)
plot(STRT.model.log)
summary(STRT.model.log)

```
Doesnt look much better -  do we need to further transform?

```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model,
           CARI.model, POKE.model,
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) + 
  xlim(-0.5, 0.75)

vn = expression(paste(HI*-N*O[3]^"-"))
no3_hi <- Plot_1 + 
  xlab("") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
scale_y_discrete(labels= c("Seasonality", 
                             "Precipitation Month", 
                             "Precipitation Week",
                             "Storm Precipitation")) +
  theme_bw() +
  ggtitle(vn) +
  theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
        plot.title = element_text(size=20))
  
ggsave("HI_NO3_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)


# ggsave("HI_NO3.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)
```

### fDOM ###
``` {r}
# correlation 
fDOM_data <- HI_FI_fDOM[,c("Hyst_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
fDOM_data <- na.omit(fDOM_data) # 273 to 273 rows 

HI_FI_fDOM$logHI <- log(abs(HI_FI_fDOM$Hyst_index))

ggpairs(fDOM_data,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("fDOM_pairs.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

```{r}
HI_FI_fDOM_MOOS <- subset(HI_FI_fDOM, site.ID == "MOOS")
HI_FI_fDOM_FRCH <- subset(HI_FI_fDOM, site.ID == "FRCH")
HI_FI_fDOM_CARI <- subset(HI_FI_fDOM, site.ID == "CARI")
HI_FI_fDOM_POKE <- subset(HI_FI_fDOM, site.ID == "POKE")
HI_FI_fDOM_VAUL <- subset(HI_FI_fDOM, site.ID == "VAUL")
HI_FI_fDOM_STRT <- subset(HI_FI_fDOM, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_fDOM_MOOS,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("fDOM_pairs_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```

```{r}
ggpairs(HI_FI_fDOM_FRCH,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("fDOM_pairs_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```
what does a log transform look like 

```{r}
FRCH.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_FRCH)

vif(FRCH.model.log)
plot(FRCH.model.log)

```
THis looks worse, lets stick with the original

```{r}
ggpairs(HI_FI_fDOM_CARI,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("fDOM_pairs_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```
lets log transform

```{r}
CARI.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_CARI)

vif(CARI.model.log)
plot(CARI.model.log)

```
maybe further transform?
```{r}
ggpairs(HI_FI_fDOM_POKE,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("fDOM_pairs_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```

```{r}
ggpairs(HI_FI_fDOM_VAUL,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("fDOM_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)
```
Vifs may be a little high for precipweek 
```{r}
ggpairs(HI_FI_fDOM_STRT,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("fDOM_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)
```

```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) +
  theme(aspect.ratio = 1) + 
  xlim(-0.3, 0.6)
  

fDOM_hi <- Plot_1 + 
  xlab("") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
scale_y_discrete(labels= c("Seasonality", 
                             "Precipitation Month", 
                             "Precipitation Week",
                             "Storm Precipitation"))
  # theme_bw() +
  # ggtitle("HI-fDOM") +
  # theme(axis.text.x=element_text(size=15), 
  #       axis.text.y = element_blank(),
  #       axis.title.x = element_text(size = 20),
  #       axis.title.y = element_text(size = 20),
  #       legend.position = "none",
  #       plot.title = element_text(size = 20))
  
fDOM_hi <- Plot_1 + 
  xlab("") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
scale_y_discrete(labels= c("Seasonality", 
                             "Precipitation Month", 
                             "Precipitation Week",
                             "Storm Precipitation")) +
  theme_bw() +
  ggtitle("HI-fDOM") +
  theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
        plot.title = element_text(size=20))

ggsave("HI_fDOM_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)

# ggsave("HI_fDOM.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)
```

### SPC ###
``` {r}
# correlation 
SPC_data <- HI_FI_SPC[,c("Hyst_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
SPC_data <- na.omit(SPC_data) # 271 to 268 rows 

HI_FI_SPC$logHI <- log(abs(HI_FI_SPC$Hyst_index))

ggpairs(SPC_data,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("SPC_pairs.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

```{r}
HI_FI_SPC_MOOS <- subset(HI_FI_SPC, site.ID == "MOOS")
HI_FI_SPC_FRCH <- subset(HI_FI_SPC, site.ID == "FRCH")
HI_FI_SPC_CARI <- subset(HI_FI_SPC, site.ID == "CARI")
HI_FI_SPC_POKE <- subset(HI_FI_SPC, site.ID == "POKE")
HI_FI_SPC_VAUL <- subset(HI_FI_SPC, site.ID == "VAUL")
HI_FI_SPC_STRT <- subset(HI_FI_SPC, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_SPC_MOOS,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("SPC_pairs_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```

```{r}
ggpairs(HI_FI_SPC_FRCH,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("SPC_pairs_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```

```{r}
ggpairs(HI_FI_SPC_CARI,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("SPC_pairs_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```

```{r}
ggpairs(HI_FI_SPC_POKE,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("SPC_pairs_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```
lets log transform 

```{r}
POKE.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_POKE)

vif(POKE.model.log)
plot(POKE.model.log)

```
mostly works except one point 

```{r}
ggpairs(HI_FI_SPC_VAUL,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("SPC_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)

```
Lets log transform 

```{r}
VAUL.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_VAUL)

vif(VAUL.model.log)
plot(VAUL.model.log)


```

```{r}
ggpairs(HI_FI_SPC_STRT,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("SPC_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)

```

```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5"))+
  theme(aspect.ratio = 1) +
  xlim(-0.45, 0.7)

SPC_hi <- Plot_1 + 
  xlab("Coefficient estimate") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
scale_y_discrete(labels= c("Seasonality", 
                             "Precipitation Month", 
                             "Precipitation Week",
                             "Storm Precipitation")) +
  theme_bw() +
  ggtitle("HI-SPC") +
  theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
        plot.title = element_text(size = 20))
  
ggsave("HI_SPC_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)

ggsave("HI_SPC.pdf",
       path = here("plots", "Coefficient_Plots", "HI"),
       width = 7, height = 7)
```

### turb ###
``` {r}
# correlation 
turb_data <- HI_FI_turb[,c("Hyst_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
turb_data <- na.omit(turb_data) # 276 to 273 rows 

HI_FI_turb$logHI <- log(abs(HI_FI_turb$Hyst_index))

ggpairs(turb_data,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("turb_pairs.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

```{r}
HI_FI_turb_MOOS <- subset(HI_FI_turb, site.ID == "MOOS")
HI_FI_turb_FRCH <- subset(HI_FI_turb, site.ID == "FRCH")
HI_FI_turb_CARI <- subset(HI_FI_turb, site.ID == "CARI")
HI_FI_turb_POKE <- subset(HI_FI_turb, site.ID == "POKE")
HI_FI_turb_VAUL <- subset(HI_FI_turb, site.ID == "VAUL")
HI_FI_turb_STRT <- subset(HI_FI_turb, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_turb_MOOS,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("turb_pairs_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```
lets log transform 

```{r}
MOOS.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_MOOS)

vif(MOOS.model.log)
plot(MOOS.model.log)
summary(MOOS.model.log)
```


```{r}
ggpairs(HI_FI_turb_FRCH,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("turb_pairs_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```

```{r}
ggpairs(HI_FI_turb_CARI,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("turb_pairs_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```

```{r}
ggpairs(HI_FI_turb_POKE,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("turb_pairs_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```

```{r}
ggpairs(HI_FI_turb_VAUL,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("turb_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)
```

```{r}
ggpairs(HI_FI_turb_STRT,
        columns = c("Hyst_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("turb_pairs_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Hyst_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)
```
lets log transform 

```{r}
STRT.model.log <- lm(logHI ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_STRT)

vif(STRT.model.log)
plot(STRT.model.log)

```
may need further transformation 


```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) +
  theme(aspect.ratio = 1) +
  xlim(-0.15, 0.3)

turb_hi <- Plot_1 + 
  xlab("Coefficient estimate") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
  theme_bw() +
  ggtitle("HI-turbidity") +
  theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_blank(),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
        plot.title = element_text(size = 20))
  

ggsave("HI_turb_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)

# ggsave("HI_turb.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)
```





### BETA ###
# NO3 
``` {r}
#### Correlation 
NO3_data <- HI_FI_NO3[,c("Beta_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
NO3_data <- na.omit(NO3_data) # 267 to 247 rows 

HI_FI_NO3$logBETA <- log(abs(HI_FI_NO3$Beta_index))

ggpairs(NO3_data,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("NO3_pairs_BETA.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

1) StormTemp is heavily correlated with TempWeek leading up to a storm (0.778) but TempWeek is slightly more correlated with HI (-.05 to -.03)

2) StormTemp is also correlated with time since chena (-0.735) but time since chena is more correlated with HI (0.251 vs. -0.173) so this makes me want to keep Time since Chena and temperature a week before considering that is a more marginal comparison with HI and the temperature predictors. 

3)Precip week is correlated with precip month (0.511) but precip week is more correlated with HI than precip month (-0.242 vs. 0.048)

4)Precip month is correlated with three month precip (0.591) but three month precip is more correlated with HI (0.220 vs. 0.048)

5) Three month is correlated with Time since Chena (0.619) but time since chena is more correlated with HI (0.251 vs. 0.220)

* to sum up this makes me want to drop storm temperature and three month precipitation.....but lets run the model with all of the candidate predictors first and go from there 


```{r}
HI_FI_NO3_MOOS <- subset(HI_FI_NO3, site.ID == "MOOS")
HI_FI_NO3_FRCH <- subset(HI_FI_NO3, site.ID == "FRCH")
HI_FI_NO3_CARI <- subset(HI_FI_NO3, site.ID == "CARI")
HI_FI_NO3_POKE <- subset(HI_FI_NO3, site.ID == "POKE")
HI_FI_NO3_VAUL <- subset(HI_FI_NO3, site.ID == "VAUL")
HI_FI_NO3_STRT <- subset(HI_FI_NO3, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_NO3_MOOS,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("NO3_pairs_BETA_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```

```{r}
ggpairs(HI_FI_NO3_FRCH,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("NO3_pairs_BETA_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```

```{r}
ggpairs(HI_FI_NO3_CARI,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("NO3_pairs_BETA_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)

```

```{r}
ggpairs(HI_FI_NO3_POKE,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("NO3_pairs_BETA_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```

```{r}
ggpairs(HI_FI_NO3_VAUL,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("NO3_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)

```

```{r}
ggpairs(HI_FI_NO3_STRT,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("NO3_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)

```
let me log transform

```{r}
STRT.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_NO3_STRT)

vif(STRT.model.log)
plot(STRT.model.log)

```



```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, 
           scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) 

vn = expression(paste(ß*-N*O[3]^"-"))
no3_beta <- Plot_1 + 
  xlab("") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
scale_y_discrete(labels= c("Seasonality", 
                             "Precipitation Month", 
                             "Precipitation Week",
                             "Storm Precipitation")) +
  theme_bw() +
   ggtitle(vn) +
theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
        plot.title = element_text(size = 20))
 
ggsave("BETA_NO3_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)

# ggsave("BETA_NO3.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)


```

### fDOM ###
``` {r}
# correlation 
fDOM_data <- HI_FI_fDOM[,c("Beta_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
fDOM_data <- na.omit(fDOM_data) # 273 to 264 rows 

HI_FI_fDOM$logBETA <- log(abs(HI_FI_fDOM$Beta_index))

ggpairs(fDOM_data,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("fDOM_pairs_BETA.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

```{r}
HI_FI_fDOM_MOOS <- subset(HI_FI_fDOM, site.ID == "MOOS")
HI_FI_fDOM_FRCH <- subset(HI_FI_fDOM, site.ID == "FRCH")
HI_FI_fDOM_CARI <- subset(HI_FI_fDOM, site.ID == "CARI")
HI_FI_fDOM_POKE <- subset(HI_FI_fDOM, site.ID == "POKE")
HI_FI_fDOM_VAUL <- subset(HI_FI_fDOM, site.ID == "VAUL")
HI_FI_fDOM_STRT <- subset(HI_FI_fDOM, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_fDOM_MOOS,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("fDOM_pairs_BETA_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```

```{r}
ggpairs(HI_FI_fDOM_FRCH,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("fDOM_pairs_BETA_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)

HI_FI_fDOM_FRCH <- HI_FI_fDOM_FRCH[-c(25,30), ]

FRCH.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```

```{r}
ggpairs(HI_FI_fDOM_CARI,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("fDOM_pairs_BETA_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```

```{r}
ggpairs(HI_FI_fDOM_POKE,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("fDOM_pairs_BETA_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)

HI_FI_fDOM_POKE <- HI_FI_fDOM_POKE[-c(12,32),]

POKE.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```

```{r}
ggpairs(HI_FI_fDOM_VAUL,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("fDOM_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)

HI_FI_fDOM_VAUL <- HI_FI_fDOM_VAUL[-c(4),]


VAUL.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)
```

```{r}
ggpairs(HI_FI_fDOM_STRT,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("fDOM_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_fDOM_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)
```

```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) 

fDOM_beta <- Plot_1 + 
  xlab("") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
  theme_bw() +
   ggtitle("ß-fDOM") +
theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_blank(),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
      plot.title = element_text(size = 20)) 

ggsave("BETA_fDOM_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)
 

# ggsave("BETA_fDOM.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)
```

### SPC ###
``` {r}
# correlation 
SPC_data <- HI_FI_SPC[,c("Beta_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
SPC_data <- na.omit(SPC_data) # 271 to 259 rows 

HI_FI_SPC$logBETA <- log(abs(HI_FI_SPC$Beta_index))
ggpairs(SPC_data,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("SPC_pairs_BETA.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

```{r}
HI_FI_SPC_MOOS <- subset(HI_FI_SPC, site.ID == "MOOS")
HI_FI_SPC_FRCH <- subset(HI_FI_SPC, site.ID == "FRCH")
HI_FI_SPC_CARI <- subset(HI_FI_SPC, site.ID == "CARI")
HI_FI_SPC_POKE <- subset(HI_FI_SPC, site.ID == "POKE")
HI_FI_SPC_VAUL <- subset(HI_FI_SPC, site.ID == "VAUL")
HI_FI_SPC_STRT <- subset(HI_FI_SPC, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_SPC_MOOS,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("SPC_pairs_BETA_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```
Lets log transform

```{r}
MOOS.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_MOOS)

vif(MOOS.model.log)
plot(MOOS.model.log)
summary(MOOS.model.log)
```
i dont know if this is better 

```{r}
ggpairs(HI_FI_SPC_FRCH,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("SPC_pairs_BETA_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```

```{r}
ggpairs(HI_FI_SPC_CARI,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("SPC_pairs_BETA_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```

```{r}
ggpairs(HI_FI_SPC_POKE,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("SPC_pairs_BETA_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)
```

```{r}
ggpairs(HI_FI_SPC_VAUL,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("SPC_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)
```
lets log transform 

```{r}
VAUL.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_VAUL)

vif(VAUL.model.log)
plot(VAUL.model.log)
summary(VAUL.model.log)
```

much better
```{r}
ggpairs(HI_FI_SPC_STRT,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("SPC_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)
```

lets log transform 

```{r}
STRT.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_SPC_STRT)

vif(STRT.model.log)
plot(STRT.model.log)
summary(STRT.model.log)
```


```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) 

SPC_beta <- Plot_1 + 
  xlab("Coefficient estimate") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
scale_y_discrete(labels= c("Seasonality", 
                             "Precipitation Month", 
                             "Precipitation Week",
                             "Storm Precipitation")) +
  theme_bw()+
   ggtitle("ß-SPC") +
  theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none",
        plot.title = element_text(size = 20))

ggsave("BETA_SPC_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)
 
# ggsave("BETA_SPC.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)
```

### turb ###
``` {r}
# correlation 
turb_data <- HI_FI_turb[,c("Beta_index", "site.ID", "StormPrecip", "PrecipWeek", "PrecipMonth", "ThreeMonth", "Intensity", "TimeSinceChena", "pf", "burn", "year")]
turb_data <- na.omit(turb_data) # 276 to 266 rows 

HI_FI_turb$logBETA <- log(abs(HI_FI_turb$Beta_index))

ggpairs(turb_data,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))
        
ggsave("turb_pairs_BETA.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)
```

```{r}
HI_FI_turb_MOOS <- subset(HI_FI_turb, site.ID == "MOOS")
HI_FI_turb_FRCH <- subset(HI_FI_turb, site.ID == "FRCH")
HI_FI_turb_CARI <- subset(HI_FI_turb, site.ID == "CARI")
HI_FI_turb_POKE <- subset(HI_FI_turb, site.ID == "POKE")
HI_FI_turb_VAUL <- subset(HI_FI_turb, site.ID == "VAUL")
HI_FI_turb_STRT <- subset(HI_FI_turb, site.ID == "STRT")
```

```{r}
ggpairs(HI_FI_turb_MOOS,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#A6761D"))
        
ggsave("turb_pairs_BETA_MOOS.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


MOOS.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_MOOS)

vif(MOOS.model)
plot(MOOS.model)
summary(MOOS.model)
```

```{r}
ggpairs(HI_FI_turb_FRCH,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#FF7F00"))
        
ggsave("turb_pairs_BETA_FRCH.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


FRCH.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_FRCH)

vif(FRCH.model)
plot(FRCH.model)
summary(FRCH.model)
```
lets loog transform 

```{r}
FRCH.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_FRCH)

vif(FRCH.model.log)
plot(FRCH.model.log)

```
may need further transformation 

```{r}
ggpairs(HI_FI_turb_CARI,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#3288BD"))
        
ggsave("turb_pairs_BETA_CARI.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


CARI.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_CARI)

vif(CARI.model)
plot(CARI.model)
summary(CARI.model)
```

```{r}
ggpairs(HI_FI_turb_POKE,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#6A3D9A"))
        
ggsave("turb_pairs_BETA_POKE.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


POKE.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_POKE)

vif(POKE.model)
plot(POKE.model)
summary(POKE.model)

```
log transform 

```{r}
POKE.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_POKE)

vif(POKE.model.log)
plot(POKE.model.log)
summary(POKE.model.log)
```



```{r}
ggpairs(HI_FI_turb_VAUL,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#E7298A"))
        
ggsave("turb_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


VAUL.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_VAUL)

vif(VAUL.model)
plot(VAUL.model)
summary(VAUL.model)
```

log transform 

```{r}
VAUL.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_POKE)

vif(VAUL.model.log)
plot(VAUL.model.log)

```
looks worse 

```{r}
ggpairs(HI_FI_turb_STRT,
        columns = c("Beta_index", "StormPrecip", "PrecipWeek", "PrecipMonth","ThreeMonth", "Intensity", "TimeSinceChena"),
        ggplot2::aes(color = site.ID))+
  scale_color_manual(values = c("#66C2A5"))
        
ggsave("turb_pairs_BETA_VAUL.pdf",
       path = here("Output_from_analysis", "09_Antecedent_Conditions_models", "plots"),
       width = 10, height = 10)


STRT.model <- lm(Beta_index ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_STRT)

vif(STRT.model)
plot(STRT.model)
summary(STRT.model)
```
lets log transform 

```{r}

STRT.model.log <- lm(logBETA ~ StormPrecip + PrecipWeek + PrecipMonth + TimeSinceChena, data = HI_FI_turb_STRT)

vif(STRT.model.log)
plot(STRT.model.log)

```



```{r}
Plot_1 <- plot_summs(MOOS.model, FRCH.model, 
           CARI.model, POKE.model, 
           VAUL.model, STRT.model, scale = TRUE,
           model.names = c("MOOS", "FRCH", "CARI", "POKE", "VAUL", "STRT"),
           colors = c("#A6761D", "#FF7F00","#3288BD", "#6A3D9A", "#E7298A", "#66C2A5")) 

turb_beta <- Plot_1 + 
  xlab("Coefficient estimate") + ylab("") +
  geom_vline(xintercept = 0,
             colour = "grey80",
             linetype = 1) +
  theme_bw() +
  ggtitle("ß-turbidity") +
  theme(axis.text.x=element_text(size=15), 
        axis.text.y = element_blank(),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.position = "none", 
        plot.title = element_text(size = 20))

ggsave("BETA_turb_AMC.pdf",
       path = here("plots", "Publication"),
       width = 7, height = 7)
  

# ggsave("BETA_turb.pdf",
#        path = here("plots", "Coefficient_Plots", "HI"),
#        width = 7, height = 7)
```


# plots for thesis # 
```{r}
library(ggpubr)
ggarrange(fDOM_hi,no3_hi,
          SPC_hi, turb_hi,
          ncol = 2, nrow = 2,
          common.legend = TRUE,
          labels = c("A)", "B)",
                     "C)", "D)"),
          legend = "bottom",
          align = "hv")


ggsave("HIs_AMC.pdf",
       path = here("plots", "Publication"),
       width = 12, height = 12)

ggarrange(fDOM_beta, no3_beta, 
          SPC_beta, turb_beta,
          ncol = 2, nrow = 2,
          common.legend = TRUE,
          labels = c("A)", "B)",
                     "C)", "D)"),
          legend = "bottom",
          align = "hv")

ggsave("BETAs_AMC.pdf",
       path = here("plots", "Publication"),
       width = 12, height = 12)
# 
# ggsave("NO3_fDOM.pdf",
#        path = here("plots", "Coefficient_Plots"),
#        width = 10, height = 10)
# 
# ggarrange(spc_hi, turb_hi,
#           spc_beta, turb_beta,
#           ncol = 2, nrow = 2,
#           common.legend = TRUE,
#           labels = c("A)", "B)",
#                      "C)", "D)"),
#           legend = "bottom")
# 
# ggsave("SPC_turb.pdf",
#        path = here("plots", "Coefficient_Plots"),
#        width = 10, height = 10)
# 
# # annotate_figure(a, 
# #                 top =                         "Column 1 Title,                                                                            Column 2 Title")

```



