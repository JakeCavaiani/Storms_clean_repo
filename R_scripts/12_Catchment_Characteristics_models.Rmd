---
title: "12_Catchment_Characteristics_models"
author: "Jake Cavaiani"
date: "9/14/2022"
output:
  word_document: default
  html_document: default
---
The purpose of this script is to if landscape characteristics are significant predictors for any of our storm metrics using simple linear regression and than AIC to determine which model was the best

Input: Antecedent moisture conditions with HI_FI_BETA and catchment characteristics!

Step 1) import full file 
Step 2) standardize and center the data
Step 3) Correlation matrix to see which landscape characteristics are heavily correlated with each other and if they are...we can not include them within our model 

Step 4) Model against landscape characteristics for each constituent:

HI.no3.slope <- lm(meanHI ~ Slope, 
             data = NO3_data)

Step 5) Check model assumptions 
Step 6) AIC to see which is the best model
Step 7) Plot!

Output: linear regression plots with each catchment and a 95% confidence interval band 

#load libraries 
```{r}
library(here)
library(tidyverse)
library(nlme)
library(forecast)
library(stats)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)
library(ggpmisc)
library(ggpubr)
library(ggExtra)
library(lubridate)
library(nlme)
library(MuMIn)
library(multcomp)
library(lme4)
library(car)
library(ggeffects)
library(dotwhisker)
library(broom)
library(jtools)
library(sjPlot)
library(AICcmodavg)
library(gtable)
library(gridExtra)
library(grid)
```


``` {r}
# reading in data 
AMC <- read.csv(here("Output_from_analysis", "08_Catchment_characteristics", "Antecedent_HI_BETA_Catchment.csv"))

AMC <- AMC[c("Hyst_index", "HI_ymin", "HI_ymax", "site.ID", "storm.ID", "response_var", "Flush_index", "FI_ymin", "FI_ymax", "month.y", "day.y", "year", "Beta_index", "Beta_ymin", "Beta_ymax", "precip", "temp", "precip.week", "precip.month", "ThreeMonth", "temp.week", "TOTAL.TIME", "Intensity", "doy", "burn", "pf", "date", "TimeSinceChena", "SLOPE_MEAN", "fireyear_lg", "pctburn_lg", "areaburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central", "NDVI_p50__mean", "NDVI_p50__standard_deviation")] # selecting the columns that I want


AMC <- AMC[!duplicated(AMC$Hyst_index), ] # removing duplicated rows 

```


```{r}
# taking the mean HI for each catchment and year 
CV.all.year <- AMC %>% group_by(response_var,site.ID, year) %>%
  dplyr::summarise(meanHI = mean(Hyst_index, na.rm = TRUE),
                   meanBETA = mean(Beta_index, na.rm = TRUE),
                   sdHI = sd(Hyst_index, na.rm = TRUE),
                   sdBETA = sd(Beta_index, na.rm = TRUE),
                  CVhi = sdHI/meanHI,
                  CVbeta = sdBETA/meanBETA,
                  CatBurn = paste(burn),
                  CatPF = paste(pf),
                  Slope = as.numeric(SLOPE_MEAN),
                  fireyear_lg = as.numeric(fireyear_lg),
                  pctburn_lg = as.numeric(pctburn_lg),
                  areaburn_lg = as.numeric(areaburn_lg),
                  PF = as.numeric(Pf_Prob_1m_mean_x),
                  NDVI_change = as.numeric(NDVI_p50__mean_abs_change),
                  NDVI_derivative = as.numeric(NDVI_p50__mean_second_derivative_central),
                  NDVI = as.numeric(NDVI_p50__mean),
                  NDVIsd = as.numeric(NDVI_p50__standard_deviation))


CV.all.year <- CV.all.year[!duplicated(CV.all.year$meanHI), ] # removing duplicated rows
# NDVI didnt properly merge over so manually putting in the NDVI value 
# I am taking the average value from 2018-2020 and applying it to all the years (it shouldnt be changing that much within a couple years of unburned areas)

# CARI Average: 0.2106070103
# FRCH Average: 0.2125723437
# MOOS Average: 0.2294949194
# POKE Average: 0.232423168
# STRT Average: 0.2558581085
# VAUL Average: 0.227537246

CV.all.year <- CV.all.year %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "CARI", 0.2106070103, .)))

CV.all.year <- CV.all.year %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "FRCH", 0.2125723437, .)))

CV.all.year <- CV.all.year %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "MOOS", 0.2294949194, .)))

CV.all.year <- CV.all.year %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "POKE", 0.232423168, .)))

CV.all.year <- CV.all.year %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "STRT", 0.2558581085, .)))

CV.all.year <- CV.all.year %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "VAUL", 0.227537246, .)))

CV.all <- AMC %>% group_by(response_var,site.ID) %>%
  dplyr::summarise(n = n(),
                   meanHI = mean(Hyst_index, na.rm = TRUE),
                   meanBETA = mean(Beta_index, na.rm = TRUE),
                   sdHI = sd(Hyst_index, na.rm = TRUE),
                   sdBETA = sd(Beta_index, na.rm = TRUE),
                  CVhi = sdHI/meanHI,
                  CVbeta = sdBETA/meanBETA,
                  CatBurn = paste(burn),
                  CatPF = paste(pf),
                  Slope = as.numeric(SLOPE_MEAN),
                  fireyear_lg = as.numeric(fireyear_lg),
                  pctburn_lg = as.numeric(pctburn_lg),
                  areaburn_lg = as.numeric(areaburn_lg),
                  PF = as.numeric(Pf_Prob_1m_mean_x),
                  NDVI = as.numeric(NDVI_p50__mean)) %>% 
  mutate(seHI = sdHI/sqrt(n),
         seBETA = sdBETA/sqrt(n))


CV.all <- CV.all[!duplicated(CV.all$meanHI), ] # removing duplicated rows

CV.all <- CV.all %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "CARI", 0.2106070103, .)))

CV.all <- CV.all %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "FRCH", 0.2125723437, .)))

CV.all <- CV.all %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "MOOS", 0.2294949194, .)))

CV.all <- CV.all %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "POKE", 0.232423168, .)))

CV.all <- CV.all %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "STRT", 0.2558581085, .)))

CV.all <- CV.all %>%
  mutate(across(c(NDVI), 
                ~ifelse(site.ID == "VAUL", 0.227537246, .)))

```

```{r}
# scaling data # 
#scaling # 
CV.all.year[c("Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI_change", "NDVI_derivative", "NDVI", "NDVIsd")] <- lapply(CV.all.year[c("Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI_change", "NDVI_derivative", "NDVI", "NDVIsd")], function(x) c(scale(x)))

CV_all_year_NO3 = subset(CV.all.year, response_var == "NO3")
# fDOM #
CV_all_year_fDOM = subset(CV.all.year, response_var == "fDOM")
# SPC #
CV_all_year_SPC = subset(CV.all.year, response_var == "SPC")
# turb #
CV_all_year_turb = subset(CV.all.year, response_var == "turb")


# all years in one 
CV.all[c("Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI")] <- lapply(CV.all[c("Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI")], function(x) c(scale(x)))

# These values are coming from the DOD_characteristics chunk down below so it gets a little out of order but I just want to quickly run these regressions with this deciduous metric 
CV.all$Deciduous.2020 <- NA

CV.all <- CV.all %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "VAUL", -1.068837,.)))

CV.all <- CV.all %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "CARI", -1.3259120,.)))

CV.all <- CV.all %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "STRT", -0.4386875,.)))

CV.all <- CV.all %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "MOOS", 1.1782128,.)))

CV.all <- CV.all %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "FRCH", 1.0810027,.)))

CV.all <- CV.all %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "POKE", 0.5722677,.)))

CV_all_NO3 = subset(CV.all, response_var == "NO3")
# fDOM #
CV_all_fDOM = subset(CV.all, response_var == "fDOM")
# SPC #
CV_all_SPC = subset(CV.all, response_var == "SPC")
# turb #
CV_all_turb = subset(CV.all, response_var == "turb")

```

```{r}
# testing to see if outliers are real from the input data 
# VAUL_2019 for NO3 has a really low meanHI...lets investigate that 

# VAUL_NO3_2019 <- subset(AMC, site.ID == "VAUL" & year == "2019" & response_var == "NO3")
# 
# mean(VAUL_NO3_2019$Hyst_index)
# 
# ggplot(VAUL_NO3_2019, aes(Beta_index, Hyst_index)) +
#   geom_errorbar(aes(ymin = HI_ymin, ymax = HI_ymax), color = "black", alpha = 0.5, size = 0.5, width = 0.05) +
#   geom_errorbarh(aes(xmin = Beta_ymin, xmax = Beta_ymax), colour = "black", alpha = 0.5, size = .5, height = 0.05) +
#   geom_point(aes(colour = factor(site.ID), shape = pf), size = 2.5) +
#   geom_hline(yintercept = 0) + geom_vline(xintercept = 0) 
# 
# ggplot(HI_FI_NO3, aes(Beta_index, Hyst_index)) + 
#   geom_errorbar(aes(ymin = HI_ymin, ymax = HI_ymax), colour = "black", alpha = 0.5, size = .5, width = 0.05)+ 
#   geom_errorbarh(aes(xmin = Beta_ymin, xmax = Beta_ymax), colour = "black", alpha = 0.5, size = .5, height = 0.05) +
#   geom_point(aes(colour = factor(site.ID), shape = pf), size = 2.5) +
#   geom_hline(yintercept = 0) + geom_vline(xintercept = 0) +
#   scale_color_manual(values=c("#3288BD","#FF7F00", "#A6761D", "#6A3D9A", "#66C2A5", "#E7298A")) + 
#   theme_bw() +
#   ylim(-1.5, 1.5) + xlim(-1.5, 1.5)+
#   ggtitle(vn)+ 
#   ylab("HI") +
#   xlab("") +
#   theme(panel.border = element_blank(), 
#         panel.grid.major = element_blank(),
#         panel.grid.minor = element_blank(), 
#         axis.line = element_line(colour = "black"), 
#         text = element_text(size = 15),
#         legend.position = "none") +
#     labs(
#       colour = "Catchment",
#       shape = "PF Extent")

```

# Catchment characteristics
This plot will show us what characteristics are correlated with each other and what we can put in our model 
```{r}
Catchment_characteristics <- read.csv(here("Ancillary_data", "AK_polys_190903_Predictors.csv"))

Catchment_characteristics <- Catchment_characteristics[c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation")]

# scaling data # 
#scaling # 
Catchment_characteristics[c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation")] <- lapply(Catchment_characteristics[c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x","NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation")], function(x) c(scale(x)))

ggpairs(Catchment_characteristics,
        columns = c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation"),
        ggplot2::aes())

ggsave("ALL_pairs.pdf",
       path = here("Ancillary_data"),
       width = 10, height = 10)

```

```{r}
DOD_characteristics <- read.csv(here("Ancillary_data", "DOD_Sites_AK_polys_190903_Predictors.csv")) # this file only contains our DoD sites rather than the whole shabang 

DOD_characteristics <- DOD_characteristics[c("site.ID", "SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation")]

DOD_characteristics$Deciduous.2016 <- NA # adding decidous metrics that we got from Neal

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2016),
                ~ifelse(site.ID == "VAUL", 20.6,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2016),
                ~ifelse(site.ID == "CARI", 22.5,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2016),
                ~ifelse(site.ID == "STRT", 16.9,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2016),
                ~ifelse(site.ID == "MOOS", 21.6,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2016),
                ~ifelse(site.ID == "FRCH", 29.6,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2016),
                ~ifelse(site.ID == "POKE", 27.3,.)))

DOD_characteristics$Deciduous.2020 <- NA

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "VAUL", 18.77078206,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "CARI", 18.32282211,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "STRT", 19.85717556,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "MOOS", 22.65342014,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "FRCH", 22.48530634,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Deciduous.2020),
                ~ifelse(site.ID == "POKE", 21.60550729,.)))

DOD_characteristics$Evergreen <- NA

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Evergreen),
                ~ifelse(site.ID == "VAUL", 50.8,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Evergreen),
                ~ifelse(site.ID == "CARI", 51.9,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Evergreen),
                ~ifelse(site.ID == "STRT", 15.2,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Evergreen),
                ~ifelse(site.ID == "MOOS", 10.3,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Evergreen),
                ~ifelse(site.ID == "FRCH", 53.4,.)))

DOD_characteristics <- DOD_characteristics %>% 
  mutate(across(c(Evergreen),
                ~ifelse(site.ID == "POKE", 30.5,.)))


# scaling data # 
#scaling # 
DOD_characteristics[c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation", "Deciduous.2016", "Deciduous.2020", "Evergreen")] <- lapply(DOD_characteristics[c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation", "Deciduous.2016", "Deciduous.2020", "Evergreen")], function(x) c(scale(x)))

ggpairs(DOD_characteristics,
        columns = c("SLOPE_MEAN", "pctburn_lg", "Pf_Prob_1m_mean_x", "NDVI_p50__mean_abs_change", "NDVI_p50__mean_second_derivative_central",  "NDVI_p50__mean", "NDVI_p50__standard_deviation", "Deciduous.2020"),
        ggplot2::aes(color = site.ID)) +
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))

ggsave("DOD_pairs.pdf",
       path = here("Ancillary_data"),
       width = 10, height = 10)

```

# NO3
```{r}
NO3_data_year<- CV_all_year_NO3[,c("site.ID", "year", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI_change", "NDVI_derivative", "NDVI", "NDVIsd", "CatBurn", "CatPF")]

NO3_data<- CV_all_NO3[,c("site.ID", "n", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "Deciduous.2020", "CatBurn", "CatPF", "seHI", "seBETA")]

# We tried doing out models are discrete characterization about PF extent (High vs. Moderate) and it doesnt appear that this is the best way to go about it.
# 1) maybe we will use mean NDVI as a proxy for PF...lets see if these are correlated with burn 

ggpairs(NO3_data_year,
        columns = c("meanHI","Slope", "pctburn_lg", "PF", "NDVI_change", "NDVI_derivative", "NDVI", "NDVIsd"),
        ggplot2::aes(colour = site.ID)) +
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))

ggsave("NO3_HI_pairs.pdf",
       path = here("Output_from_analysis", "12_Catchment_Characteristics_models", "plots"),
       width = 10, height = 10)

```

```{r}
ggpairs(NO3_data_year,
        columns = c("meanBETA","Slope", "pctburn_lg", "PF", "NDVI"),
        ggplot2::aes(colour = site.ID)) +
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))

ggsave("NO3_BETA_pairs.pdf",
       path = here("Output_from_analysis", "12_Catchment_Characteristics_models", "plots"),
       width = 10, height = 10)

```

```{r}
ggpairs(NO3_data_year,
        columns = c("sdHI","Slope", "pctburn_lg", "PF", "NDVI"),
        ggplot2::aes(colour = site.ID)) +
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))

ggsave("NO3_sdHI_pairs.pdf",
       path = here("Output_from_analysis", "12_Catchment_Characteristics_models", "plots"),
       width = 10, height = 10)

```

```{r}
ggpairs(NO3_data_year,
        columns = c("sdBETA","Slope", "pctburn_lg", "PF", "NDVI"),
        ggplot2::aes(colour = site.ID)) +
  scale_color_manual(values = c("#3288BD", "#FF7F00","#A6761D", "#6A3D9A", "#66C2A5", "#E7298A"))

ggsave("NO3_sdBETA_pairs.pdf",
       path = here("Output_from_analysis", "12_Catchment_Characteristics_models", "plots"),
       width = 10, height = 10)

```

# NO3
# HI 
```{r}
HI.no3.slope <- lm(meanHI ~ Slope, 
             data = NO3_data)

HI.no3.burn <- lm(meanHI ~ pctburn_lg, 
             data = NO3_data)

HI.no3.deciduous <- lm(meanHI ~ Deciduous.2020,
                       data = NO3_data)

models <- list(HI.no3.slope, HI.no3.burn, HI.no3.deciduous) 
aictab(cand.set = models) # burn is the better model 
summary(HI.no3.burn)
```

# R^2 plot 
```{r}
#no3.hi.burn
vn = expression(paste("Mean HI-"*N*O[3]^"-"))
no3.hi.burn <- ggplot(NO3_data, aes(x = pctburn_lg, y = meanHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  geom_errorbar(aes(x=pctburn_lg, ymin=meanHI-seHI, ymax=meanHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  theme_classic() +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn Extent") +
  ylab(vn) +
  theme(aspect.ratio = 1) 

### Deciduous 
# ggplot(NO3_data, aes(x = Deciduous.2020, y = meanHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
#                parse = TRUE, size = 6) + 
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20), 
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###

ggsave("HI_NO3_burn.pdf",
       path = here("plots", "Catchment_characteristics", "HI"),
       width = 7, height = 7)
```

# BETA
```{r}
BETA.no3.slope <- lm(meanBETA ~ Slope, 
             data = NO3_data)

BETA.no3.burn <- lm(meanBETA ~ pctburn_lg, 
             data = NO3_data)

BETA.no3.deciduous <- lm(meanBETA ~ Deciduous.2020, 
             data = NO3_data)

models <- list(BETA.no3.slope, BETA.no3.burn, BETA.no3.deciduous)
aictab(cand.set = models) # burn is the better model delta AIC > 2
summary(BETA.no3.burn) # p-value: 0.2065
```

# R^2 plot 
```{r}
vn = expression(paste("Mean ß-"*N*O[3]^"-"))

no3.beta.burn <- ggplot(NO3_data, aes(x = pctburn_lg, y = meanBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  geom_errorbar(aes(x=pctburn_lg, ymin=meanBETA-seBETA, ymax=meanBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  theme_classic() +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn Extent") +
  ylab(vn) +
  theme(aspect.ratio = 1)

### Deciduous 
# ggplot(NO3_data, aes(x = Deciduous.2020, y = meanBETA)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###

ggsave("BETA_NO3_burn.pdf",
       path = here("plots", "Catchment_characteristics", "BETA"),
       width = 7, height = 7)


```

# sdHI
```{r}
sdHI.no3.slope <- lm(sdHI ~ Slope, 
             data = NO3_data)

sdHI.no3.burn <- lm(sdHI ~ pctburn_lg, 
             data = NO3_data)

sdHI.no3.deciduous <- lm(sdHI ~ Deciduous.2020, 
             data = NO3_data)


models <- list(sdHI.no3.slope, sdHI.no3.burn, sdHI.no3.deciduous)
aictab(cand.set = models) # slope model is better...they are both negative? is that okay?
summary(sdHI.no3.slope) # p-value = 0.0501

```

# R^2 plot 
```{r}
vn = expression(paste("SD HI-"*N*O[3]^"-"))

no3.sdhi.slope <- ggplot(NO3_data, aes(x = Slope, y = sdHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  geom_errorbar(aes(x=Slope, ymin=sdHI-seHI, ymax=sdHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  theme_classic() +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Catchment Slope") +
  ylab(vn) +
  theme(aspect.ratio = 1)

### Deciduous 
# ggplot(NO3_data, aes(x = Deciduous.2020, y = sdHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###

ggsave("sdHI_NO3_slope.pdf",
       path = here("plots", "Catchment_characteristics", "HI"),
       width = 7, height = 7)

```

# sdBETA
```{r}
sdBETA.no3.slope <- lm(sdBETA ~ Slope, 
             data = NO3_data)

sdBETA.no3.burn <- lm(sdBETA ~ pctburn_lg, 
             data = NO3_data)

sdBETA.no3.deciduous <- lm(sdBETA ~ Deciduous.2020, 
             data = NO3_data)

models <- list(sdBETA.no3.slope, sdBETA.no3.burn, sdBETA.no3.deciduous)
aictab(cand.set = models) # burn model is better but the AIC difference isnt greater than 2 so we would say according to our text that these models perform in the same way right?
summary(sdBETA.no3.burn) # p-value: 0.00686
summary(sdBETA.no3.slope) # p-value: 0.09170
```

# R^2 plot 
```{r}
vn = expression(paste("SD ß-"*N*O[3]^"-"))

no3.sdbeta.burn <- ggplot(NO3_data, aes(x = pctburn_lg, y = sdBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  geom_errorbar(aes(x=pctburn_lg, ymin=sdBETA-seBETA, ymax=sdBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  theme_classic() +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn extent") +
  ylab(vn) +
  theme(aspect.ratio = 1)

### Deciduous 
# ggplot(NO3_data, aes(x = Deciduous.2020, y = sdBETA)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###

ggsave("sdBETA_NO3_burn.pdf",
       path = here("plots", "Catchment_characteristics", "BETA"),
       width = 7, height = 7)


```

# fDOM # 
```{r}
fDOM_data_year<- CV_all_year_fDOM[,c("site.ID", "year", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "CatBurn", "CatPF")]

fDOM_data<- CV_all_fDOM[,c("site.ID", "n", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "Deciduous.2020", "CatBurn", "CatPF", "seHI", "seBETA")]

```

```{r}

HI.fDOM.slope <- lm(meanHI ~ Slope, 
             data = fDOM_data)

HI.fDOM.burn <- lm(meanHI ~ pctburn_lg, 
             data = fDOM_data)

HI.fDOM.deciduous <- lm(meanHI ~ Deciduous.2020, 
             data = fDOM_data)

models <- list(HI.fDOM.slope, HI.fDOM.burn, HI.fDOM.deciduous)
aictab(cand.set = models) # slope is better model, deltaAIC > 2
summary(HI.fDOM.slope) # p-value 0.0624
```

# R^2 plot 
```{r}
fdom.hi.slope <- ggplot(fDOM_data, aes(x = Slope, y = meanHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  geom_errorbar(aes(x=Slope, ymin=meanHI-seHI, ymax=meanHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic() +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Catchment slope") +
  ylab("Mean HI-fDOM")

### Deciduous 
# ggplot(fDOM_data, aes(x = Deciduous.2020, y = meanHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###

ggsave("HI_fDOM_slope.pdf",
       path = here("plots", "Catchment_characteristics", "HI"),
       width = 7, height = 7)

```


# BETA
```{r}
BETA.fDOM.slope <- lm(meanBETA ~ Slope, 
             data = fDOM_data)

BETA.fDOM.burn <- lm(meanBETA ~ pctburn_lg, 
             data = fDOM_data)

BETA.fDOM.deciduous <- lm(meanBETA ~ Deciduous.2020, 
             data = fDOM_data)

models <- list(BETA.fDOM.slope, BETA.fDOM.burn, BETA.fDOM.deciduous)
aictab(cand.set = models) # slope is the better model: deltaAIC>2
summary(BETA.fDOM.slope) #0.037
```

# R^2 plot 
```{r}
fDOM.beta.slope <- ggplot(fDOM_data, aes(x = Slope, y = meanBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  geom_errorbar(aes(x=Slope, ymin=meanBETA-seBETA, ymax=meanBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic() +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Catchment slope") +
  ylab("Mean ß-fDOM")

### Deciduous 
# ggplot(fDOM_data, aes(x = Deciduous.2020, y = meanBETA)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###

ggsave("BETA_fDOM_slope.pdf",
       path = here("plots", "Catchment_characteristics", "BETA"),
       width = 7, height = 7)
```

# sdHI
```{r}
sdHI.fDOM.slope <- lm(sdHI ~ Slope, 
             data = fDOM_data)

sdHI.fDOM.burn <- lm(sdHI ~ pctburn_lg, 
             data = fDOM_data)

sdHI.fDOM.deciduous <- lm(sdHI ~ Deciduous.2020, 
             data = fDOM_data)

models <- list(sdHI.fDOM.slope, sdHI.fDOM.burn, sdHI.fDOM.deciduous)
aictab(cand.set = models) # burn is the better model deltaAIC>2
summary(sdHI.fDOM.burn) # p-value 0.182369
```

# R^2 plot 
```{r}
fDOM.sdhi.burn <- ggplot(fDOM_data, aes(x = pctburn_lg, y = sdHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 5) + 
  theme_classic()+
  geom_errorbar(aes(x=pctburn_lg, ymin=sdHI-seHI, ymax=sdHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn extent") +
  ylab("SD HI-fDOM")

### Deciduous 
# ggplot(fDOM_data, aes(x = Deciduous.2020, y = sdHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab(vn) +
#   theme(aspect.ratio = 1)

###
ggsave("sdHI_fDOM_burn.pdf",
       path = here("plots", "Catchment_characteristics", "HI"),
       width = 7, height = 7)


```

# sdBETA
```{r}
sdBETA.fDOM.slope <- lm(sdBETA ~ Slope, 
             data = fDOM_data)

sdBETA.fDOM.burn <- lm(sdBETA ~ pctburn_lg, 
             data = fDOM_data)

sdBETA.fDOM.deciduous <- lm(sdBETA ~ Deciduous.2020, 
             data = fDOM_data)

models <- list(sdBETA.fDOM.slope, sdBETA.fDOM.burn, sdBETA.fDOM.deciduous)
aictab(cand.set = models) # slope model better but the deltaAIC is not >2
summary(sdBETA.fDOM.slope) # 0.53313 
```

# R^2 plot 
```{r}
fDOM.sdbeta.slope <- ggplot(fDOM_data, aes(x = Slope, y = sdBETA)) +
  geom_point() +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE) + 
  geom_errorbar(aes(x=Slope, ymin=sdBETA-seBETA, ymax=sdBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn extent") +
  ylab("SD ß-fDOM")
### Deciduous 
ggplot(fDOM_data, aes(x = Deciduous.2020, y = sdBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
               parse = TRUE, size = 6) +
  theme_classic() +
  theme(axis.text.x=element_text(size=20),
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("% Deciduous") +
  ylab("SD ß-fDOM") +
  theme(aspect.ratio = 1)

###

```


# SPC # 
```{r}
SPC_data_year<- CV_all_year_SPC[,c("site.ID", "year", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "CatBurn", "CatPF")]

SPC_data<- CV_all_SPC[,c("site.ID", "n", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "Deciduous.2020", "CatBurn", "CatPF", "seHI", "seBETA")]

```

```{r}

HI.SPC.slope <- lm(meanHI ~ Slope, 
             data = SPC_data)

HI.SPC.burn <- lm(meanHI ~ pctburn_lg, 
             data = SPC_data)

HI.SPC.deciduous <- lm(meanHI ~ Deciduous.2020, 
             data = SPC_data)

models <- list(HI.SPC.slope, HI.SPC.burn, HI.SPC.deciduous)
aictab(cand.set = models) # slope is better model, deltaAIC > 2
summary(HI.SPC.slope) # p-value 0.0347
```

# R^2 plot 
```{r}
spc.hi.slope <- ggplot(SPC_data, aes(x = Slope, y = meanHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 6) + 
  geom_errorbar(aes(x=Slope, ymin=meanHI-seHI, ymax=meanHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic()+
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Catchment slope") +
  ylab("Mean HI-SPC")

### Deciduous 
# ggplot(SPC_data, aes(x = Deciduous.2020, y = meanHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab("SD ß-fDOM") +
#   theme(aspect.ratio = 1)

###

ggsave("HI_SPC_slope.pdf",
       path = here("plots", "Catchment_characteristics", "HI"),
       width = 7, height = 7)


```


# BETA
```{r}
BETA.SPC.slope <- lm(meanBETA ~ Slope, 
             data = SPC_data)

BETA.SPC.burn <- lm(meanBETA ~ pctburn_lg, 
             data = SPC_data)

BETA.SPC.deciduous <- lm(meanBETA ~ Deciduous.2020, 
             data = SPC_data)

models <- list(BETA.SPC.slope, BETA.SPC.burn, BETA.SPC.deciduous)
aictab(cand.set = models) # slope is the better model but deltaAIC are not greater than 2
summary(BETA.SPC.slope) # 0.1140
summary(BETA.SPC.burn) # 0.1140
```

# R^2 plot 
```{r}
spc.beta.slope <- ggplot(SPC_data, aes(x = Slope, y = meanBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 6) + 
  geom_errorbar(aes(x=Slope, ymin=meanBETA-seBETA, ymax=meanBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic()+
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Catchment slope") +
  ylab("Mean ß-SPC")

### Deciduous 
# ggplot(SPC_data, aes(x = Deciduous.2020, y = meanBETA)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab("SD ß-fDOM") +
#   theme(aspect.ratio = 1)

###

ggsave("BETA_SPC_slope.pdf",
       path = here("plots", "Catchment_characteristics", "BETA"),
       width = 7, height = 7)

```

# sdHI
```{r}
sdHI.SPC.slope <- lm(sdHI ~ Slope, 
             data = SPC_data)

sdHI.SPC.burn <- lm(sdHI ~ pctburn_lg, 
             data = SPC_data)

sdHI.SPC.deciduous <- lm(sdHI ~ Deciduous.2020, 
             data = SPC_data)

models <- list(sdHI.SPC.slope, sdHI.SPC.burn, sdHI.SPC.deciduous)
aictab(cand.set = models) # burn is the better model but deltaAIC is not greater than 2 
summary(sdHI.SPC.burn) # p-value 0.388143
```

# R^2 plot 
```{r}
spc.sdhi.burn <- ggplot(SPC_data, aes(x = pctburn_lg, y = sdHI)) +
  geom_point() +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE) + 
  geom_errorbar(aes(x=pctburn_lg, ymin=sdHI-seHI, ymax=sdHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic()+
  xlab("Percent Burn") +
  ylab("Standard Deviation HI")

### Deciduous 
# ggplot(SPC_data, aes(x = Deciduous.2020, y = sdHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab("SD ß-fDOM") +
#   theme(aspect.ratio = 1)

###

```

# sdBETA
```{r}
sdBETA.SPC.slope <- lm(sdBETA ~ Slope, 
             data = SPC_data)

sdBETA.SPC.burn <- lm(sdBETA ~ pctburn_lg, 
             data = SPC_data)

sdBETA.SPC.deciduous <- lm(sdBETA ~ Deciduous.2020, 
             data = SPC_data)

models <- list(sdBETA.SPC.slope, sdBETA.SPC.burn, sdBETA.SPC.deciduous)
aictab(cand.set = models) # burn model better deltaAIC>2
summary(sdBETA.SPC.burn) # 0.0596
```

# R^2 plot 
```{r}
spc.sdbeta.burn <- ggplot(SPC_data, aes(x = pctburn_lg, y = sdBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 6) + 
  geom_errorbar(aes(x=pctburn_lg, ymin=sdBETA-seBETA, ymax=sdBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic()+
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn extent") +
  ylab("SD ß-SPC")

### Deciduous 
# ggplot(SPC_data, aes(x = Deciduous.2020, y = sdBETA)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab("SD ß-fDOM") +
#   theme(aspect.ratio = 1)

###

ggsave("sdBETA_SPC_burn.pdf",
       path = here("plots", "Catchment_characteristics", "BETA"),
       width = 7, height = 7)

```


# Turb # 
```{r}
turb_data_year<- CV_all_year_turb[,c("site.ID", "year", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "CatBurn", "CatPF")]

turb_data<- CV_all_turb[,c("site.ID",  "n", "meanHI", "meanBETA", "sdHI", "sdBETA", "Slope", "fireyear_lg", "pctburn_lg", "areaburn_lg", "PF", "NDVI", "Deciduous.2020", "CatBurn", "CatPF", "seHI", "seBETA")]

```

```{r}

HI.turb.slope <- lm(meanHI ~ Slope, 
             data = turb_data)

HI.turb.burn <- lm(meanHI ~ pctburn_lg, 
             data = turb_data)

HI.turb.deciduous <- lm(meanHI ~ Deciduous.2020, 
             data = turb_data)

models <- list(HI.turb.slope, HI.turb.burn, HI.turb.deciduous)
aictab(cand.set = models) # burn is better model but deltaAIC is not greater than 2 

```

# R^2 plot 
```{r}
turb.hi.burn <- ggplot(turb_data, aes(x = pctburn_lg, y = meanHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 6) + 
  geom_errorbar(aes(x=pctburn_lg, ymin=meanHI-seHI, ymax=meanHI+seHI), width=0.2, colour="black", alpha=0.9, size=1.0) +
  theme_classic()+
  theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Burn extent") +
  ylab("Mean HI-turbidity")
summary(HI.turb.burn) # p-value 0.353

### Deciduous 
# ggplot(turb_data, aes(x = Deciduous.2020, y = meanHI)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab("SD ß-fDOM") +
#   theme(aspect.ratio = 1)

###

```


# BETA
```{r}
BETA.turb.slope <- lm(meanBETA ~ Slope, 
             data = turb_data)

BETA.turb.burn <- lm(meanBETA ~ pctburn_lg, 
             data = turb_data)

BETA.turb.deciduous <- lm(meanBETA ~ Deciduous.2020, 
             data = turb_data)

models <- list(BETA.turb.slope, BETA.turb.burn, BETA.turb.deciduous)
aictab(cand.set = models) # slope is the better model but deltaAIC is not greater than 2 

```

# R^2 plot 
```{r}
turb.beta.slope <- ggplot(turb_data, aes(x = Slope, y = meanBETA)) +
  geom_point() +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE) + 
  theme_classic()+
  xlab("Slope") +
  ylab("Mean BETA")
summary(BETA.turb.slope) # 0.61108

### Deciduous 
ggplot(turb_data, aes(x = Deciduous.2020, y = meanBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
               parse = TRUE, size = 6) +
  theme_classic() +
  theme(axis.text.x=element_text(size=20),
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("% Deciduous") +
  ylab("Mean ß-Turbidity") +
  theme(aspect.ratio = 1)

###
```

# sdHI
```{r}
sdHI.turb.slope <- lm(sdHI ~ Slope, 
             data = turb_data)

sdHI.turb.burn <- lm(sdHI ~ pctburn_lg, 
             data = turb_data)

sdHI.turb.deciduous <- lm(sdHI ~ Deciduous.2020, 
             data = turb_data)

models <- list(sdHI.turb.slope, sdHI.turb.burn, sdHI.turb.deciduous)
aictab(cand.set = models) # burn is the better model but delta AIC is not greater than 2 

```

# R^2 plot 
```{r}
turb.sdhi.burn <- ggplot(turb_data, aes(x = pctburn_lg, y = sdHI)) +
  geom_point() +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, aes(group = 1)) +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "right",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE) + 
  theme_classic()+
  xlab("Percent Burn") +
  ylab("Standard Deviation HI")
summary(sdHI.turb.burn) # p-value 0.73519

### Deciduous 
ggplot(turb_data, aes(x = Deciduous.2020, y = sdHI)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
               parse = TRUE, size = 6) +
  theme_classic() +
  theme(axis.text.x=element_text(size=20),
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("% Deciduous") +
  ylab("SD HI-Turbidity") +
  theme(aspect.ratio = 1)

###
```

# sdBETA
```{r}
sdBETA.turb.slope <- lm(sdBETA ~ Slope, 
             data = turb_data)

sdBETA.turb.burn <- lm(sdBETA ~ pctburn_lg, 
             data = turb_data)

sdBETA.turb.deciduous <- lm(sdBETA ~ Deciduous.2020, 
             data = turb_data)

models <- list(sdBETA.turb.slope, sdBETA.turb.burn, sdBETA.turb.deciduous)
aictab(cand.set = models) # slope model better: deltaAIC >2
summary(sdBETA.turb.slope) # 0.06055
```

# R^2 plot 
```{r}
turb.sdbeta.slope <- ggplot(turb_data, aes(x = Slope, y = sdBETA)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
  stat_poly_eq(formula = y~x,
               label.y = "top", label.x = "left",
               aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
               parse = TRUE, size = 6) + 
    theme_classic()+
  geom_errorbar(aes(x=Slope, ymin=sdBETA-seBETA, ymax=sdBETA+seBETA), width=0.2, colour="black", alpha=0.9, size=1.0) +
    theme(axis.text.x=element_text(size=20), 
        axis.text.y = element_text(size = 20),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.key.size = unit(2.0, 'cm'),
        strip.text = element_text(size = 20)) +
  xlab("Catchment slope") +
  ylab("SD ß-turbidity")

### Deciduous 
# ggplot(turb_data, aes(x = Deciduous.2020, y = sdBETA)) +
#   geom_point(size = 3) +
#   geom_smooth(method = "lm", na.rm = TRUE, fullrange = TRUE, color = "black") +
#   stat_poly_eq(formula = y~x,
#                label.y = "top", label.x = "left",
#                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#                parse = TRUE, size = 6) +
#   theme_classic() +
#   theme(axis.text.x=element_text(size=20),
#         axis.text.y = element_text(size = 20),
#         axis.title.x = element_text(size = 20),
#         axis.title.y = element_text(size = 20),
#         legend.key.size = unit(2.0, 'cm'),
#         strip.text = element_text(size = 20)) +
#   xlab("% Deciduous") +
#   ylab("SD B-Turbidity") +
#   theme(aspect.ratio = 1)

###

ggsave("sdBETA_Turb_burn.pdf",
       path = here("plots", "Catchment_characteristics", "BETA"),
       width = 7, height = 7)

```



### PLOTS FOR THESIS ###

```{r}
ggarrange(no3.hi.burn, no3.beta.burn,
          no3.sdhi.slope, no3.sdbeta.burn,
           ncol = 2, nrow = 2,
           common.legend = TRUE,
           labels = c("A)", "B)", 
                      "C)", "D)"),
        legend = "bottom")

ggsave("no3_characteristics.pdf",
       path = here("plots", "Catchment_characteristics"),
       width = 10, height = 10)

ggarrange(fdom.hi.slope, fDOM.beta.slope,
          fDOM.sdhi.burn,
           ncol = 2, nrow = 2,
           common.legend = TRUE,
           labels = c("A)", "B)", 
                      "C)"),
        legend = "bottom")

ggsave("fDOM_characteristics.pdf",
       path = here("plots", "Catchment_characteristics"),
       width = 10, height = 10)

ggarrange(spc.hi.slope, spc.beta.slope,
          spc.sdbeta.burn,
           ncol = 2, nrow = 2,
           common.legend = TRUE,
           labels = c("A)", "B)", 
                      "C)"),
        legend = "bottom")

ggsave("SPC_characteristics.pdf",
       path = here("plots", "Catchment_characteristics"),
       width = 10, height = 10)

ggarrange(turb.hi.burn, turb.sdbeta.slope,
           ncol = 2, nrow = 2,
           common.legend = TRUE,
           labels = c("A)", "B)"), 
        legend = "bottom")

ggsave("turb_characteristics.pdf",
       path = here("plots", "Catchment_characteristics"),
       width = 10, height = 10)



```


















