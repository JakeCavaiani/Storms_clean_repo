---
title: "18_Publication_plotting_roundup"
output: html_document
date: "2023-11-21"
editor_options: 
  chunk_output_type: console
---

```{r - libraries}
library(ggplot2)
library(ggnewscale)
library(here)
library(lubridate)
library(tidyverse)
library(ggpattern)
library(ggsignif)
library(tidyquant)
library(ggpubr)
library(extrafont)
```



```{r - daily stream concentration by year: 10_gls_models}
mean_daily <- read.csv(here("Output_from_analysis", "08_Catchment_characteristics", "mean_daily.csv"))

mean_daily$datetimeAK <- ymd(mean_daily$day)
mean_daily <- mean_daily[order(mean_daily$year, mean_daily$site.ID), ]

mean_daily$year <- as.character(mean_daily$year)

mean_daily$Burn <- NA

mean_daily <- mean_daily %>% 
  mutate(across(c(Burn),
                ~ifelse(site.ID == "CARI" | site.ID == "FRCH" | site.ID == "VAUL", "unburned", "burned")))

mean_daily$PF <- NA

mean_daily <- mean_daily %>% 
  mutate(across(c(PF),
                ~ifelse(site.ID == "VAUL" | site.ID == "MOOS", "High", "Low")))


vn = expression(paste(N*O[3]^"-"))
# mean concentration across years for each site 
mean_daily_site <- mean_daily %>% 
  group_by(site.ID) %>% 
  dplyr::summarise(meanNO3 = mean(dailyNO3, na.rm = TRUE),
                   meanfDOM = mean(dailyfDOM, na.rm = TRUE),
                   meanSPC = mean(dailySPC, na.rm = TRUE),
                   meanTurb = mean(dailyTurb, na.rm = TRUE))

```

### PLOTTING ####
```{r - NO3}
vn = expression(paste(N*O[3]^"-"*(Î¼M)))

mean_daily_new <- mean_daily
mean_daily_new$site.ID <- factor(mean_daily_new$site.ID,     # Reorder factor levels
                         c("CARI", "FRCH", "VAUL", "MOOS", "POKE", "STRT"))


# all years  #
# POKE - 25%
# CARI - 29%
# STRT - 30%
# FRCH - 33%
# MOOS - 38%
# VAUL - 58%
desired_order <- c("POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL")

# with letters # 
annotations <- data.frame(
  year = c("2015", "2015",
           "2018", "2018", "2018", 
           "2019", "2019", "2019", "2019", "2019", "2019",
           "2020", "2020", "2020", "2020", "2020", "2020",
           "2021", "2021", "2021", "2021", "2021", "2021",
           "2022", "2022", "2022", "2022", "2022", "2022"),
  site.ID = c("FRCH", "MOOS",
              "CARI",  "FRCH", "MOOS",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL"),
  Label = c("", "", 
            "", "", "", 
            "", "", "", "", "", "", 
            "a", "a", "ab", "a", "b", "c", 
            "ab", "b", "a", "a", "ab", "ab", 
            "a", "ac", "bc", "ac", "b", "b"),
  y_position = c(50, 50, 
                 50, 50, 50, 
                 50, 50, 50, 50, 50, 50,
                 45, 45, 45, 45, 45, 45,
                 45, 45, 45, 45, 45, 45,
                 45, 45, 45, 45, 45, 45),
  Burn = c("unburned", "burned",
           "unburned", "unburned", "burned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned"))

ggplot(mean_daily_new, aes(x = site.ID, y = dailyNO3, pattern = Burn, fill = site.ID)) +
        ggdist::stat_halfeye(adjust = 0.5, 
                       justification = -.3,
                       .width = -0,
                       point_colour = NA,
                       scale = 0.5) +
  geom_boxplot(width = .25,
                 outlier.colour = NA,
                 alpha = 0.5) +
   geom_boxplot_pattern(position = position_dodge(preserve = "single"), 
                        width = .25,
                        color = "black", 
                        pattern_fill = "white", 
                        pattern_angle = 45, 
                        pattern_density = 0.1, 
                        pattern_spacing = 0.025, 
                        pattern_key_scale_factor = 0.6) +
  scale_pattern_manual(values = c(burned = "stripe", unburned = "none")) +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  coord_cartesian(xlim = c(1, 6.05)) +
  
  scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5"), guide = "none") +
  facet_wrap(~year) +
  geom_text(data = annotations, aes(label = Label, y = y_position), 
            position = position_dodge(width = 0.75), size = 8) +
  theme_tq() +
  theme(axis.text.x = element_text(size = 16),
        axis.title.y = element_text(size = 25),
        axis.text.y = element_text(size = 20),
        strip.text = element_text(size = 20), 
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 20)) +
  labs(x= "", y = vn) 

ggsave("NO3_facet_year_3.pdf",
       path = here("plots", "Publication"),
       width = 15, height = 12)

grDevices::cairo_pdf("NO3_facet_year_3.pdf")

cairo

```

```{r - DOC}
# all years  #
# POKE - 25%
# CARI - 29%
# STRT - 30%
# FRCH - 33%
# MOOS - 38%
# VAUL - 58%
desired_order <- c("POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL")

# with letters # 
annotations <- data.frame(
  year = c("2015", "2015",
           "2018", "2018", "2018", 
           "2019", "2019", "2019", "2019", "2019", "2019",
           "2020", "2020", "2020", "2020", "2020", "2020",
           "2021", "2021", "2021", "2021", "2021", "2021",
           "2022", "2022", "2022", "2022", "2022", "2022"),
  site.ID = c("FRCH", "MOOS",
              "CARI",  "FRCH", "MOOS",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL"),
  Label = c("", "", 
            "a", "a", "b", 
            "a", "a", "a", "ab", "bc", "c", 
            "d", "a", "a", "a", "b", "c", 
            "d", "abd", "a", "ad", "bc", "c", 
            "d", "abd", "a", "ad", "bc", "c"),
  y_position = c(350, 350, 
                 350, 350, 350, 
                 350, 350, 350, 350, 350, 350,
                 350, 350, 350, 350, 350, 350,
                 350, 350, 350, 350, 350, 350,
                 350, 350, 350, 350, 350, 350),
  Burn = c("unburned", "burned",
           "unburned", "unburned", "burned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned"))

ggplot(mean_daily_new, aes(x = site.ID, y = dailyfDOM, pattern = Burn, fill = site.ID)) +
        ggdist::stat_halfeye(adjust = 0.5, 
                       justification = -.3,
                       .width = -0,
                       point_colour = NA,
                       scale = 0.5) +
  geom_boxplot(width = .25,
                 outlier.colour = NA,
                 alpha = 0.5) +
   geom_boxplot_pattern(position = position_dodge(preserve = "single"), 
                        width = .25,
                        color = "black", 
                        pattern_fill = "white", 
                        pattern_angle = 45, 
                        pattern_density = 0.1, 
                        pattern_spacing = 0.025, 
                        pattern_key_scale_factor = 0.6) +
  scale_pattern_manual(values = c(burned = "stripe", unburned = "none")) +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  coord_cartesian(xlim = c(1, 6.05)) +
  
  scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5"), guide = "none") +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  facet_wrap(~year) +
  geom_text(data = annotations, aes(label = Label, y = y_position), 
            position = position_dodge(width = 0.75), size = 8) +
  theme_tq() +
  theme(axis.text.x = element_text(size = 16),
        axis.title.y = element_text(size = 25),
        axis.text.y = element_text(size = 20),
        strip.text = element_text(size = 20), 
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 20)) +
  labs(x= "", y = "fDOM (QSU)")

ggsave("DOC_facet_year.pdf",
       path = here("plots", "Publication"),
       width = 15, height = 12)

```

```{r - SPC}
# all years  #
# POKE - 25%
# CARI - 29%
# STRT - 30%
# FRCH - 33%
# MOOS - 38%
# VAUL - 58%
desired_order <- c("POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL")

# with letters # 
annotations <- data.frame(
  year = c("2015", "2015",
           "2018", "2018", "2018", 
           "2019", "2019", "2019", "2019", "2019", "2019",
           "2020", "2020", "2020", "2020", "2020", "2020",
           "2021", "2021", "2021", "2021", "2021", "2021",
           "2022", "2022", "2022", "2022", "2022", "2022"),
  site.ID = c("FRCH", "MOOS",
              "CARI",  "FRCH", "MOOS",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL"),
  Label = c("", "", 
            "a", "a", "b", 
            "ab", "a", "ab", "a", "ab", "b", 
            "ab", "a", "ab", "a", "ab", "b", 
            "d", "b", "ad", "ab", "ad", "c", 
            "d", "b", "ad", "ab", "ad", "c"),
  y_position = c(100, 100, 
                 150, 150, 150, 
                 750, 750, 750, 750, 750, 750,
                 500, 500, 500, 500, 500, 500,
                 900, 900, 900, 900, 900, 900,
                 1000, 1000, 1000, 1000, 1000, 1000),
  Burn = c("unburned", "burned",
           "unburned", "unburned", "burned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned"))

ggplot(mean_daily_new, aes(x = site.ID, y = dailySPC, pattern = Burn, fill = site.ID)) +
        ggdist::stat_halfeye(adjust = 0.5, 
                       justification = -.3,
                       .width = -0,
                       point_colour = NA,
                       scale = 0.5) +
  geom_boxplot(width = .25,
                 outlier.colour = NA,
                 alpha = 0.5) +
   geom_boxplot_pattern(position = position_dodge(preserve = "single"), 
                        width = .25,
                        color = "black", 
                        pattern_fill = "white", 
                        pattern_angle = 45, 
                        pattern_density = 0.1, 
                        pattern_spacing = 0.025, 
                        pattern_key_scale_factor = 0.6) +
  scale_y_log10() +
  scale_pattern_manual(values = c(burned = "stripe", unburned = "none")) +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  coord_cartesian(xlim = c(1, 6.05)) +
  
  scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5"), guide = "none") +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  facet_wrap(~year, scales = "free") +
  geom_text(data = annotations, aes(label = Label, y = y_position), 
            position = position_dodge(width = 0.75), size = 8) +
  theme_tq() +
  theme(axis.text.x = element_text(size = 16),
        axis.title.y = element_text(size = 25),
        axis.text.y = element_text(size = 20),
        strip.text = element_text(size = 20), 
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 20)) +
  labs(x= "", y = "SPC (uS/cm)")

ggsave("SPC_facet_year.pdf",
       path = here("plots", "Publication"),
       width = 15, height = 12)

```

```{r - Turb}
# all years  #
# POKE - 25%
# CARI - 29%
# STRT - 30%
# FRCH - 33%
# MOOS - 38%
# VAUL - 58%
desired_order <- c("POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL")

# with letters # 
annotations <- data.frame(
  year = c("2015", "2015",
           "2018", "2018", "2018", 
           "2019", "2019", "2019", "2019", "2019", "2019",
           "2020", "2020", "2020", "2020", "2020", "2020",
           "2021", "2021", "2021", "2021", "2021", "2021",
           "2022", "2022", "2022", "2022", "2022", "2022"),
  site.ID = c("FRCH", "MOOS",
              "CARI",  "FRCH", "MOOS",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL",
              "POKE", "CARI", "STRT", "FRCH", "MOOS", "VAUL"),
  Label = c("", "", 
            "", "", "", 
            "ab", "a", "ab", "b", "ab", "ab", 
            "ab", "a", "ab", "b", "ab", "ab", 
            "a", "a", "ab", "bc", "bc", "b", 
            "a", "a", "a", "a", "a", "b"),
  y_position = c(100, 100, 
                 150, 150, 150, 
                 750, 750, 750, 750, 750, 750,
                 500, 500, 500, 500, 500, 500,
                 900, 900, 900, 900, 900, 900,
                 1000, 1000, 1000, 1000, 1000, 1000),
  Burn = c("unburned", "burned",
           "unburned", "unburned", "burned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned",
           "burned", "unburned", "burned", "unburned", "burned", "unburned"))

ggplot(mean_daily_new, aes(x = site.ID, y = dailyTurb, pattern = Burn, fill = site.ID)) +
        ggdist::stat_halfeye(adjust = 0.5, 
                       justification = -.3,
                       .width = -0,
                       point_colour = NA,
                       scale = 0.5) +
  geom_boxplot(width = .25,
                 outlier.colour = NA,
                 alpha = 0.5) +
   geom_boxplot_pattern(position = position_dodge(preserve = "single"), 
                        width = .25,
                        color = "black", 
                        pattern_fill = "white", 
                        pattern_angle = 45, 
                        pattern_density = 0.1, 
                        pattern_spacing = 0.025, 
                        pattern_key_scale_factor = 0.6) +
  scale_y_log10() +
  scale_pattern_manual(values = c(burned = "stripe", unburned = "none")) +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  coord_cartesian(xlim = c(1, 6.05)) +
  
  scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5"), guide = "none") +
  scale_x_discrete(limits = desired_order,
                   labels = c("POKE" = "POKE\n(25%)",
                              "CARI" = "CARI\n(29%)",
                              "STRT" = "STRT\n(30%)",
                              "FRCH" = "FRCH\n(33%)",
                              "MOOS" = "MOOS\n(38%)",
                              "VAUL" = "VAUL\n(58%)")) +
  facet_wrap(~year, scales = "free") +
  geom_text(data = annotations, aes(label = Label, y = y_position), 
            position = position_dodge(width = 0.75), size = 8) +
  theme_tq() +
  theme(axis.text.x = element_text(size = 16),
        axis.title.y = element_text(size = 25),
        axis.text.y = element_text(size = 20),
        strip.text = element_text(size = 20), 
        legend.title = element_text(size = 20),
        legend.text = element_text(size = 20)) +
  labs(x= "", y = "Turbidity (FNU)")

ggsave("Turb_facet_year.pdf",
       path = here("plots", "Publication"),
       width = 15, height = 12)

```


### Graveyard code ####
```{r code graveyard}
# Sample data
x <- 1:10
y <- x^2

# Create a plot
plot(x, y, type = "l", main = "Example Plot")

# Save the plot as a PDF using Cairo_pdf
cairo_pdf("output_plot.pdf", width = 6, height = 4)
dev.off()
cair

# Jacob code #
# ggplot(mean_daily_new, aes(x = interaction(PF, Burn), y = dailyNO3)) +
#   geom_boxplot(aes(fill = PF), alpha = 0.7, outlier.shape = NA) +
#   scale_fill_discrete(name = "Permafrost Extent") +
#   scale_fill_manual(values = c("grey","white"),name = "Permafrost Extent") +
#   # scale_fill_discrete() +
#   new_scale_fill() +
#   geom_point(aes(fill = interaction(PF,site.ID)), shape = 21,
#              position = position_jitterdodge(dodge.width = 0.5), size = 3) +
#   scale_fill_manual(values = c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5"), labels = c("Caribou", "French", "Vault", "Moose","Poker", "Stuart"), name = "Stream Site") +
#   labs(x= "", y = vn) +
#   facet_wrap(.~year) +
#   theme(axis.text.x = element_blank(),
#         axis.ticks.x = element_blank(),
#         panel.spacing.x = unit(0, "lines"),
#         strip.background = element_rect(fill = "transparent")) +
#   theme(panel.grid.major = element_blank(),
#         panel.grid.minor = element_blank(),
#         panel.background = element_blank(),
#         panel.border = element_rect(colour = "black", fill=NA, size=2))+theme(aspect.ratio = 1) +
#   theme(legend.title = element_text(size=15),legend.text = element_text(size=15)) + theme(
#           axis.text = element_text(size = 15),    
#           axis.title = element_text(size = 15),
#           strip.text = element_text(size = 15))
# 
# ggsave("NO3_facet_year.pdf",
#        path = here("plots", "Publication"),
#        width = 10, height = 10)
# 
# # 
# # Another take on the above code but
# ggplot(mean_daily_new, aes(x = site.ID, y = dailyNO3, pattern = PF, fill = site.ID)) +
#    geom_boxplot() +
#    geom_boxplot_pattern(position = position_dodge(preserve = "single"), color = "black", pattern_fill = "white", pattern_angle = 45, pattern_density = 0.1, pattern_spacing = 0.025, pattern_key_scale_factor = 0.6) +
#   scale_pattern_manual(values = c(High = "stripe", Moderate = "none")) +
#   scale_fill_manual(values=c("#3288BD","#FF7F00", "#E7298A", "#A6761D", "#6A3D9A", "#66C2A5"), guide = "none") +
#   new_scale_fill() +
#    geom_boxplot(aes(fill = Burn), alpha = 0.5, outlier.shape = NA) +
#    scale_fill_manual(values = c("black","white"),name = "Burn") +
#    labs(x= "", y = vn) +
#   facet_wrap(.~year) +
#   theme(axis.text.x=element_text(size=20, angle = 90, vjust = 0.5, hjust=1),
#         axis.ticks.x = element_blank(),
#         panel.spacing.x = unit(0, "lines"),
#         strip.background = element_rect(fill = "transparent")) +
#   theme(panel.grid.major = element_blank(),
#         panel.grid.minor = element_blank(),
#         panel.background = element_blank(),
#         panel.border = element_rect(colour = "black", fill=NA, size=2))+theme(aspect.ratio = 1) +
#   theme(legend.title = element_text(size=15),legend.text = element_text(size=15)) + theme(
#           axis.text = element_text(size = 15),    
#           axis.title = element_text(size = 15),
#           strip.text = element_text(size = 15))
#   
# ggsave("NO3_facet_year_2.pdf",
#        path = here("plots", "Publication"),
#        width = 10, height = 10)
# 
# 
# # boxplots with density plots
# ggplot(mean_daily_new, aes(x = site.ID, y = dailyNO3, fill = site.ID)) +
#    ggdist::stat_halfeye(adjust = 0.5, 
#                        justification = -.2,
#                        .width = 0,
#                        point_colour = NA) +
#   geom_boxplot(width = .25,
#                  outlier.colour = NA,
#                  alpha = 0.5) +
#   ggdist::stat_dots(side = "left",
#                     justification = 1.1, 
#                     binwidth = 0.25) +
#   facet_wrap(~year) +
#   theme_classic()
#     
# ggsave("NO3_facet_year_density.pdf",
#        path = here("plots", "Publication"),
#        width = 10, height = 10)
# 
# 
# ### Chat GPT code for letters of statistical significance ###
# # Install and load necessary packages
# # Generate some example data
# set.seed(123)
# data <- data.frame(
#   Group = rep(c("A", "B", "C"), each = 30),
#   Value = c(rnorm(30), rnorm(30, mean = 1), rnorm(30, mean = 2))
# )
# 
# # Create a boxplot
# p <- ggplot(data, aes(x = Group, y = Value)) +
#   geom_boxplot()
# 
# # Add significance letters
# p + geom_signif(comparisons = list(c("A", "B"), c("B", "C"), c("A", "C")),
#                 map_signif_level = TRUE)
#    
# 
# 
# ### lets try and build out of the code with levels of significance for an individual year 
# # 2015
# chem_2015 <- mean_daily_new %>% 
#   filter(year == "2015")
# 
# chem_2015$site.ID <- factor(chem_2015$site.ID)
# 
# ggplot(chem_2015, aes(x = site.ID, y = dailyNO3)) +
#   geom_boxplot() + 
#   geom_signif(comparisons = list(c("FRCH", "MOOS")), 
#               map_signif_level = TRUE)
# 
# # 2018
# chem_2018 <- mean_daily_new %>% 
#   filter(year == "2018")
# 
# ggplot(chem_2018, aes(x = site.ID, y = dailyNO3)) +
#   geom_boxplot() + 
#   geom_signif(comparisons = list(c("CARI", "FRCH"), c("FRCH", "MOOS"), c("CARI", "MOOS")), 
#               map_signif_level = TRUE,
#                 step_increase = 0.2)
# 
# # 2015 and 2018
# chem_2015_2018 <- rbind(chem_2015, chem_2018)
# 
# ggplot(chem_2015_2018, aes(x = site.ID, y = dailyNO3, fill = site.ID)) +
#   geom_boxplot() + 
#   scale_fill_manual(values=c("#FF7F00", "#A6761D", "#3288BD"), guide = "none") +
#   geom_signif(comparisons = list(c("CARI", "FRCH"), c("FRCH", "MOOS"), c("CARI", "MOOS")), 
#               map_signif_level = TRUE,
#                 step_increase = 0.2) +
#   facet_wrap(~year) +
#   theme_bw() +
#   theme(legend.position = "none") +
#   labs(x= "", y = vn) 
#   
# ggsave("NO3_facet_year_1.pdf",
#        path = here("plots", "Publication"),
#        width = 10, height = 10)
# 
# # with hatch for WF #
# ggplot(chem_2015_2018, aes(x = site.ID, y = dailyNO3, pattern = Burn, fill = site.ID)) +
#   ggdist::stat_halfeye(adjust = 0.5, 
#                        justification = -.2,
#                        .width = -0,
#                        point_colour = NA,
#                        scale = 0.5) +
#    geom_boxplot(width = .25,
#                  outlier.colour = NA,
#                  alpha = 0.5) +
#    geom_boxplot_pattern(position = position_dodge(preserve = "single"), 
#                         width = .25,
#                         color = "black", 
#                         pattern_fill = "white", 
#                         pattern_angle = 45, 
#                         pattern_density = 0.1, 
#                         pattern_spacing = 0.025, 
#                         pattern_key_scale_factor = 0.6) +
#   scale_pattern_manual(values = c(burned = "stripe", unburned = "none")) +
#   scale_fill_manual(values=c("#FF7F00", "#A6761D", "#3288BD"), guide = "none") +
#   geom_signif(comparisons = list(c("CARI", "FRCH"), c("FRCH", "MOOS"), c("CARI", "MOOS")), 
#               map_signif_level = TRUE,
#               step_increase = 0.2) +
#   scale_x_discrete(labels = c("FRCH" = "FRCH\n(33%)",
#                               "MOOS" = "MOOS\n(38%)",
#                               "CARI" = "CARI\n(29%)")) +
#                               
#   facet_wrap(~year) +
#   theme_tq() +
#   labs(x= "", y = vn) 
#   
# ggsave("NO3_facet_year_1.pdf",
#        path = here("plots", "Publication"),
#        width = 10, height = 10)


```



